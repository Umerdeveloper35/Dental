/*!
 * Bootstrap v3.4.1 (https://getbootstrap.com/)
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under the MIT license
 */

if (typeof jQuery === 'undefined') {
  throw new Error('Bootstrap\'s JavaScript requires jQuery')
}

+function ($) {
  'use strict';
  var version = $.fn.jquery.split(' ')[0].split('.')
  if ((version[0] < 2 && version[1] < 9) || (version[0] == 1 && version[1] == 9 && version[2] < 1) || (version[0] > 3)) {
    throw new Error('Bootstrap\'s JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4')
  }
}(jQuery);

/* ========================================================================
 * Bootstrap: transition.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: https://modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // https://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);

/* ========================================================================
 * Bootstrap: alert.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // ALERT CLASS DEFINITION
  // ======================

  var dismiss = '[data-dismiss="alert"]'
  var Alert   = function (el) {
    $(el).on('click', dismiss, this.close)
  }

  Alert.VERSION = '3.4.1'

  Alert.TRANSITION_DURATION = 150

  Alert.prototype.close = function (e) {
    var $this    = $(this)
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    selector    = selector === '#' ? [] : selector
    var $parent = $(document).find(selector)

    if (e) e.preventDefault()

    if (!$parent.length) {
      $parent = $this.closest('.alert')
    }

    $parent.trigger(e = $.Event('close.bs.alert'))

    if (e.isDefaultPrevented()) return

    $parent.removeClass('in')

    function removeElement() {
      // detach from parent, fire event then clean up data
      $parent.detach().trigger('closed.bs.alert').remove()
    }

    $.support.transition && $parent.hasClass('fade') ?
      $parent
        .one('bsTransitionEnd', removeElement)
        .emulateTransitionEnd(Alert.TRANSITION_DURATION) :
      removeElement()
  }


  // ALERT PLUGIN DEFINITION
  // =======================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.alert')

      if (!data) $this.data('bs.alert', (data = new Alert(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.alert

  $.fn.alert             = Plugin
  $.fn.alert.Constructor = Alert


  // ALERT NO CONFLICT
  // =================

  $.fn.alert.noConflict = function () {
    $.fn.alert = old
    return this
  }


  // ALERT DATA-API
  // ==============

  $(document).on('click.bs.alert.data-api', dismiss, Alert.prototype.close)

}(jQuery);

/* ========================================================================
 * Bootstrap: button.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // BUTTON PUBLIC CLASS DEFINITION
  // ==============================

  var Button = function (element, options) {
    this.$element  = $(element)
    this.options   = $.extend({}, Button.DEFAULTS, options)
    this.isLoading = false
  }

  Button.VERSION  = '3.4.1'

  Button.DEFAULTS = {
    loadingText: 'loading...'
  }

  Button.prototype.setState = function (state) {
    var d    = 'disabled'
    var $el  = this.$element
    var val  = $el.is('input') ? 'val' : 'html'
    var data = $el.data()

    state += 'Text'

    if (data.resetText == null) $el.data('resetText', $el[val]())

    // push to event loop to allow forms to submit
    setTimeout($.proxy(function () {
      $el[val](data[state] == null ? this.options[state] : data[state])

      if (state == 'loadingText') {
        this.isLoading = true
        $el.addClass(d).attr(d, d).prop(d, true)
      } else if (this.isLoading) {
        this.isLoading = false
        $el.removeClass(d).removeAttr(d).prop(d, false)
      }
    }, this), 0)
  }

  Button.prototype.toggle = function () {
    var changed = true
    var $parent = this.$element.closest('[data-toggle="buttons"]')

    if ($parent.length) {
      var $input = this.$element.find('input')
      if ($input.prop('type') == 'radio') {
        if ($input.prop('checked')) changed = false
        $parent.find('.active').removeClass('active')
        this.$element.addClass('active')
      } else if ($input.prop('type') == 'checkbox') {
        if (($input.prop('checked')) !== this.$element.hasClass('active')) changed = false
        this.$element.toggleClass('active')
      }
      $input.prop('checked', this.$element.hasClass('active'))
      if (changed) $input.trigger('change')
    } else {
      this.$element.attr('aria-pressed', !this.$element.hasClass('active'))
      this.$element.toggleClass('active')
    }
  }


  // BUTTON PLUGIN DEFINITION
  // ========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.button')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.button', (data = new Button(this, options)))

      if (option == 'toggle') data.toggle()
      else if (option) data.setState(option)
    })
  }

  var old = $.fn.button

  $.fn.button             = Plugin
  $.fn.button.Constructor = Button


  // BUTTON NO CONFLICT
  // ==================

  $.fn.button.noConflict = function () {
    $.fn.button = old
    return this
  }


  // BUTTON DATA-API
  // ===============

  $(document)
    .on('click.bs.button.data-api', '[data-toggle^="button"]', function (e) {
      var $btn = $(e.target).closest('.btn')
      Plugin.call($btn, 'toggle')
      if (!($(e.target).is('input[type="radio"], input[type="checkbox"]'))) {
        // Prevent double click on radios, and the double selections (so cancellation) on checkboxes
        e.preventDefault()
        // The target component still receive the focus
        if ($btn.is('input,button')) $btn.trigger('focus')
        else $btn.find('input:visible,button:visible').first().trigger('focus')
      }
    })
    .on('focus.bs.button.data-api blur.bs.button.data-api', '[data-toggle^="button"]', function (e) {
      $(e.target).closest('.btn').toggleClass('focus', /^focus(in)?$/.test(e.type))
    })

}(jQuery);

/* ========================================================================
 * Bootstrap: carousel.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CAROUSEL CLASS DEFINITION
  // =========================

  var Carousel = function (element, options) {
    this.$element    = $(element)
    this.$indicators = this.$element.find('.carousel-indicators')
    this.options     = options
    this.paused      = null
    this.sliding     = null
    this.interval    = null
    this.$active     = null
    this.$items      = null

    this.options.keyboard && this.$element.on('keydown.bs.carousel', $.proxy(this.keydown, this))

    this.options.pause == 'hover' && !('ontouchstart' in document.documentElement) && this.$element
      .on('mouseenter.bs.carousel', $.proxy(this.pause, this))
      .on('mouseleave.bs.carousel', $.proxy(this.cycle, this))
  }

  Carousel.VERSION  = '3.4.1'

  Carousel.TRANSITION_DURATION = 600

  Carousel.DEFAULTS = {
    interval: 5000,
    pause: 'hover',
    wrap: true,
    keyboard: true
  }

  Carousel.prototype.keydown = function (e) {
    if (/input|textarea/i.test(e.target.tagName)) return
    switch (e.which) {
      case 37: this.prev(); break
      case 39: this.next(); break
      default: return
    }

    e.preventDefault()
  }

  Carousel.prototype.cycle = function (e) {
    e || (this.paused = false)

    this.interval && clearInterval(this.interval)

    this.options.interval
      && !this.paused
      && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))

    return this
  }

  Carousel.prototype.getItemIndex = function (item) {
    this.$items = item.parent().children('.item')
    return this.$items.index(item || this.$active)
  }

  Carousel.prototype.getItemForDirection = function (direction, active) {
    var activeIndex = this.getItemIndex(active)
    var willWrap = (direction == 'prev' && activeIndex === 0)
                || (direction == 'next' && activeIndex == (this.$items.length - 1))
    if (willWrap && !this.options.wrap) return active
    var delta = direction == 'prev' ? -1 : 1
    var itemIndex = (activeIndex + delta) % this.$items.length
    return this.$items.eq(itemIndex)
  }

  Carousel.prototype.to = function (pos) {
    var that        = this
    var activeIndex = this.getItemIndex(this.$active = this.$element.find('.item.active'))

    if (pos > (this.$items.length - 1) || pos < 0) return

    if (this.sliding)       return this.$element.one('slid.bs.carousel', function () { that.to(pos) }) // yes, "slid"
    if (activeIndex == pos) return this.pause().cycle()

    return this.slide(pos > activeIndex ? 'next' : 'prev', this.$items.eq(pos))
  }

  Carousel.prototype.pause = function (e) {
    e || (this.paused = true)

    if (this.$element.find('.next, .prev').length && $.support.transition) {
      this.$element.trigger($.support.transition.end)
      this.cycle(true)
    }

    this.interval = clearInterval(this.interval)

    return this
  }

  Carousel.prototype.next = function () {
    if (this.sliding) return
    return this.slide('next')
  }

  Carousel.prototype.prev = function () {
    if (this.sliding) return
    return this.slide('prev')
  }

  Carousel.prototype.slide = function (type, next) {
    var $active   = this.$element.find('.item.active')
    var $next     = next || this.getItemForDirection(type, $active)
    var isCycling = this.interval
    var direction = type == 'next' ? 'left' : 'right'
    var that      = this

    if ($next.hasClass('active')) return (this.sliding = false)

    var relatedTarget = $next[0]
    var slideEvent = $.Event('slide.bs.carousel', {
      relatedTarget: relatedTarget,
      direction: direction
    })
    this.$element.trigger(slideEvent)
    if (slideEvent.isDefaultPrevented()) return

    this.sliding = true

    isCycling && this.pause()

    if (this.$indicators.length) {
      this.$indicators.find('.active').removeClass('active')
      var $nextIndicator = $(this.$indicators.children()[this.getItemIndex($next)])
      $nextIndicator && $nextIndicator.addClass('active')
    }

    var slidEvent = $.Event('slid.bs.carousel', { relatedTarget: relatedTarget, direction: direction }) // yes, "slid"
    if ($.support.transition && this.$element.hasClass('slide')) {
      $next.addClass(type)
      if (typeof $next === 'object' && $next.length) {
        $next[0].offsetWidth // force reflow
      }
      $active.addClass(direction)
      $next.addClass(direction)
      $active
        .one('bsTransitionEnd', function () {
          $next.removeClass([type, direction].join(' ')).addClass('active')
          $active.removeClass(['active', direction].join(' '))
          that.sliding = false
          setTimeout(function () {
            that.$element.trigger(slidEvent)
          }, 0)
        })
        .emulateTransitionEnd(Carousel.TRANSITION_DURATION)
    } else {
      $active.removeClass('active')
      $next.addClass('active')
      this.sliding = false
      this.$element.trigger(slidEvent)
    }

    isCycling && this.cycle()

    return this
  }


  // CAROUSEL PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.carousel')
      var options = $.extend({}, Carousel.DEFAULTS, $this.data(), typeof option == 'object' && option)
      var action  = typeof option == 'string' ? option : options.slide

      if (!data) $this.data('bs.carousel', (data = new Carousel(this, options)))
      if (typeof option == 'number') data.to(option)
      else if (action) data[action]()
      else if (options.interval) data.pause().cycle()
    })
  }

  var old = $.fn.carousel

  $.fn.carousel             = Plugin
  $.fn.carousel.Constructor = Carousel


  // CAROUSEL NO CONFLICT
  // ====================

  $.fn.carousel.noConflict = function () {
    $.fn.carousel = old
    return this
  }


  // CAROUSEL DATA-API
  // =================

  var clickHandler = function (e) {
    var $this   = $(this)
    var href    = $this.attr('href')
    if (href) {
      href = href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7
    }

    var target  = $this.attr('data-target') || href
    var $target = $(document).find(target)

    if (!$target.hasClass('carousel')) return

    var options = $.extend({}, $target.data(), $this.data())
    var slideIndex = $this.attr('data-slide-to')
    if (slideIndex) options.interval = false

    Plugin.call($target, options)

    if (slideIndex) {
      $target.data('bs.carousel').to(slideIndex)
    }

    e.preventDefault()
  }

  $(document)
    .on('click.bs.carousel.data-api', '[data-slide]', clickHandler)
    .on('click.bs.carousel.data-api', '[data-slide-to]', clickHandler)

  $(window).on('load', function () {
    $('[data-ride="carousel"]').each(function () {
      var $carousel = $(this)
      Plugin.call($carousel, $carousel.data())
    })
  })

}(jQuery);

/* ========================================================================
 * Bootstrap: collapse.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.4.1'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(document).find(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(document).find(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);

/* ========================================================================
 * Bootstrap: dropdown.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.4.1'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector !== '#' ? $(document).find(selector) : null

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);

/* ========================================================================
 * Bootstrap: modal.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#modals
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // MODAL CLASS DEFINITION
  // ======================

  var Modal = function (element, options) {
    this.options = options
    this.$body = $(document.body)
    this.$element = $(element)
    this.$dialog = this.$element.find('.modal-dialog')
    this.$backdrop = null
    this.isShown = null
    this.originalBodyPad = null
    this.scrollbarWidth = 0
    this.ignoreBackdropClick = false
    this.fixedContent = '.navbar-fixed-top, .navbar-fixed-bottom'

    if (this.options.remote) {
      this.$element
        .find('.modal-content')
        .load(this.options.remote, $.proxy(function () {
          this.$element.trigger('loaded.bs.modal')
        }, this))
    }
  }

  Modal.VERSION = '3.4.1'

  Modal.TRANSITION_DURATION = 300
  Modal.BACKDROP_TRANSITION_DURATION = 150

  Modal.DEFAULTS = {
    backdrop: true,
    keyboard: true,
    show: true
  }

  Modal.prototype.toggle = function (_relatedTarget) {
    return this.isShown ? this.hide() : this.show(_relatedTarget)
  }

  Modal.prototype.show = function (_relatedTarget) {
    var that = this
    var e = $.Event('show.bs.modal', { relatedTarget: _relatedTarget })

    this.$element.trigger(e)

    if (this.isShown || e.isDefaultPrevented()) return

    this.isShown = true

    this.checkScrollbar()
    this.setScrollbar()
    this.$body.addClass('modal-open')

    this.escape()
    this.resize()

    this.$element.on('click.dismiss.bs.modal', '[data-dismiss="modal"]', $.proxy(this.hide, this))

    this.$dialog.on('mousedown.dismiss.bs.modal', function () {
      that.$element.one('mouseup.dismiss.bs.modal', function (e) {
        if ($(e.target).is(that.$element)) that.ignoreBackdropClick = true
      })
    })

    this.backdrop(function () {
      var transition = $.support.transition && that.$element.hasClass('fade')

      if (!that.$element.parent().length) {
        that.$element.appendTo(that.$body) // don't move modals dom position
      }

      that.$element
        .show()
        .scrollTop(0)

      that.adjustDialog()

      if (transition) {
        that.$element[0].offsetWidth // force reflow
      }

      that.$element.addClass('in')

      that.enforceFocus()

      var e = $.Event('shown.bs.modal', { relatedTarget: _relatedTarget })

      transition ?
        that.$dialog // wait for modal to slide in
          .one('bsTransitionEnd', function () {
            that.$element.trigger('focus').trigger(e)
          })
          .emulateTransitionEnd(Modal.TRANSITION_DURATION) :
        that.$element.trigger('focus').trigger(e)
    })
  }

  Modal.prototype.hide = function (e) {
    if (e) e.preventDefault()

    e = $.Event('hide.bs.modal')

    this.$element.trigger(e)

    if (!this.isShown || e.isDefaultPrevented()) return

    this.isShown = false

    this.escape()
    this.resize()

    $(document).off('focusin.bs.modal')

    this.$element
      .removeClass('in')
      .off('click.dismiss.bs.modal')
      .off('mouseup.dismiss.bs.modal')

    this.$dialog.off('mousedown.dismiss.bs.modal')

    $.support.transition && this.$element.hasClass('fade') ?
      this.$element
        .one('bsTransitionEnd', $.proxy(this.hideModal, this))
        .emulateTransitionEnd(Modal.TRANSITION_DURATION) :
      this.hideModal()
  }

  Modal.prototype.enforceFocus = function () {
    $(document)
      .off('focusin.bs.modal') // guard against infinite focus loop
      .on('focusin.bs.modal', $.proxy(function (e) {
        if (document !== e.target &&
          this.$element[0] !== e.target &&
          !this.$element.has(e.target).length) {
          this.$element.trigger('focus')
        }
      }, this))
  }

  Modal.prototype.escape = function () {
    if (this.isShown && this.options.keyboard) {
      this.$element.on('keydown.dismiss.bs.modal', $.proxy(function (e) {
        e.which == 27 && this.hide()
      }, this))
    } else if (!this.isShown) {
      this.$element.off('keydown.dismiss.bs.modal')
    }
  }

  Modal.prototype.resize = function () {
    if (this.isShown) {
      $(window).on('resize.bs.modal', $.proxy(this.handleUpdate, this))
    } else {
      $(window).off('resize.bs.modal')
    }
  }

  Modal.prototype.hideModal = function () {
    var that = this
    this.$element.hide()
    this.backdrop(function () {
      that.$body.removeClass('modal-open')
      that.resetAdjustments()
      that.resetScrollbar()
      that.$element.trigger('hidden.bs.modal')
    })
  }

  Modal.prototype.removeBackdrop = function () {
    this.$backdrop && this.$backdrop.remove()
    this.$backdrop = null
  }

  Modal.prototype.backdrop = function (callback) {
    var that = this
    var animate = this.$element.hasClass('fade') ? 'fade' : ''

    if (this.isShown && this.options.backdrop) {
      var doAnimate = $.support.transition && animate

      this.$backdrop = $(document.createElement('div'))
        .addClass('modal-backdrop ' + animate)
        .appendTo(this.$body)

      this.$element.on('click.dismiss.bs.modal', $.proxy(function (e) {
        if (this.ignoreBackdropClick) {
          this.ignoreBackdropClick = false
          return
        }
        if (e.target !== e.currentTarget) return
        this.options.backdrop == 'static'
          ? this.$element[0].focus()
          : this.hide()
      }, this))

      if (doAnimate) this.$backdrop[0].offsetWidth // force reflow

      this.$backdrop.addClass('in')

      if (!callback) return

      doAnimate ?
        this.$backdrop
          .one('bsTransitionEnd', callback)
          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :
        callback()

    } else if (!this.isShown && this.$backdrop) {
      this.$backdrop.removeClass('in')

      var callbackRemove = function () {
        that.removeBackdrop()
        callback && callback()
      }
      $.support.transition && this.$element.hasClass('fade') ?
        this.$backdrop
          .one('bsTransitionEnd', callbackRemove)
          .emulateTransitionEnd(Modal.BACKDROP_TRANSITION_DURATION) :
        callbackRemove()

    } else if (callback) {
      callback()
    }
  }

  // these following methods are used to handle overflowing modals

  Modal.prototype.handleUpdate = function () {
    this.adjustDialog()
  }

  Modal.prototype.adjustDialog = function () {
    var modalIsOverflowing = this.$element[0].scrollHeight > document.documentElement.clientHeight

    this.$element.css({
      paddingLeft: !this.bodyIsOverflowing && modalIsOverflowing ? this.scrollbarWidth : '',
      paddingRight: this.bodyIsOverflowing && !modalIsOverflowing ? this.scrollbarWidth : ''
    })
  }

  Modal.prototype.resetAdjustments = function () {
    this.$element.css({
      paddingLeft: '',
      paddingRight: ''
    })
  }

  Modal.prototype.checkScrollbar = function () {
    var fullWindowWidth = window.innerWidth
    if (!fullWindowWidth) { // workaround for missing window.innerWidth in IE8
      var documentElementRect = document.documentElement.getBoundingClientRect()
      fullWindowWidth = documentElementRect.right - Math.abs(documentElementRect.left)
    }
    this.bodyIsOverflowing = document.body.clientWidth < fullWindowWidth
    this.scrollbarWidth = this.measureScrollbar()
  }

  Modal.prototype.setScrollbar = function () {
    var bodyPad = parseInt((this.$body.css('padding-right') || 0), 10)
    this.originalBodyPad = document.body.style.paddingRight || ''
    var scrollbarWidth = this.scrollbarWidth
    if (this.bodyIsOverflowing) {
      this.$body.css('padding-right', bodyPad + scrollbarWidth)
      $(this.fixedContent).each(function (index, element) {
        var actualPadding = element.style.paddingRight
        var calculatedPadding = $(element).css('padding-right')
        $(element)
          .data('padding-right', actualPadding)
          .css('padding-right', parseFloat(calculatedPadding) + scrollbarWidth + 'px')
      })
    }
  }

  Modal.prototype.resetScrollbar = function () {
    this.$body.css('padding-right', this.originalBodyPad)
    $(this.fixedContent).each(function (index, element) {
      var padding = $(element).data('padding-right')
      $(element).removeData('padding-right')
      element.style.paddingRight = padding ? padding : ''
    })
  }

  Modal.prototype.measureScrollbar = function () { // thx walsh
    var scrollDiv = document.createElement('div')
    scrollDiv.className = 'modal-scrollbar-measure'
    this.$body.append(scrollDiv)
    var scrollbarWidth = scrollDiv.offsetWidth - scrollDiv.clientWidth
    this.$body[0].removeChild(scrollDiv)
    return scrollbarWidth
  }


  // MODAL PLUGIN DEFINITION
  // =======================

  function Plugin(option, _relatedTarget) {
    return this.each(function () {
      var $this = $(this)
      var data = $this.data('bs.modal')
      var options = $.extend({}, Modal.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data) $this.data('bs.modal', (data = new Modal(this, options)))
      if (typeof option == 'string') data[option](_relatedTarget)
      else if (options.show) data.show(_relatedTarget)
    })
  }

  var old = $.fn.modal

  $.fn.modal = Plugin
  $.fn.modal.Constructor = Modal


  // MODAL NO CONFLICT
  // =================

  $.fn.modal.noConflict = function () {
    $.fn.modal = old
    return this
  }


  // MODAL DATA-API
  // ==============

  $(document).on('click.bs.modal.data-api', '[data-toggle="modal"]', function (e) {
    var $this = $(this)
    var href = $this.attr('href')
    var target = $this.attr('data-target') ||
      (href && href.replace(/.*(?=#[^\s]+$)/, '')) // strip for ie7

    var $target = $(document).find(target)
    var option = $target.data('bs.modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())

    if ($this.is('a')) e.preventDefault()

    $target.one('show.bs.modal', function (showEvent) {
      if (showEvent.isDefaultPrevented()) return // only register focus restorer if modal will actually get shown
      $target.one('hidden.bs.modal', function () {
        $this.is(':visible') && $this.trigger('focus')
      })
    })
    Plugin.call($target, option, this)
  })

}(jQuery);

/* ========================================================================
 * Bootstrap: tooltip.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

+function ($) {
  'use strict';

  var DISALLOWED_ATTRIBUTES = ['sanitize', 'whiteList', 'sanitizeFn']

  var uriAttrs = [
    'background',
    'cite',
    'href',
    'itemtype',
    'longdesc',
    'poster',
    'src',
    'xlink:href'
  ]

  var ARIA_ATTRIBUTE_PATTERN = /^aria-[\w-]*$/i

  var DefaultWhitelist = {
    // Global attributes allowed on any supplied element below.
    '*': ['class', 'dir', 'id', 'lang', 'role', ARIA_ATTRIBUTE_PATTERN],
    a: ['target', 'href', 'title', 'rel'],
    area: [],
    b: [],
    br: [],
    col: [],
    code: [],
    div: [],
    em: [],
    hr: [],
    h1: [],
    h2: [],
    h3: [],
    h4: [],
    h5: [],
    h6: [],
    i: [],
    img: ['src', 'alt', 'title', 'width', 'height'],
    li: [],
    ol: [],
    p: [],
    pre: [],
    s: [],
    small: [],
    span: [],
    sub: [],
    sup: [],
    strong: [],
    u: [],
    ul: []
  }

  /**
   * A pattern that recognizes a commonly useful subset of URLs that are safe.
   *
   * Shoutout to Angular 7 https://github.com/angular/angular/blob/7.2.4/packages/core/src/sanitization/url_sanitizer.ts
   */
  var SAFE_URL_PATTERN = /^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi

  /**
   * A pattern that matches safe data URLs. Only matches image, video and audio types.
   *
   * Shoutout to Angular 7 https://github.com/angular/angular/blob/7.2.4/packages/core/src/sanitization/url_sanitizer.ts
   */
  var DATA_URL_PATTERN = /^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+/]+=*$/i

  function allowedAttribute(attr, allowedAttributeList) {
    var attrName = attr.nodeName.toLowerCase()

    if ($.inArray(attrName, allowedAttributeList) !== -1) {
      if ($.inArray(attrName, uriAttrs) !== -1) {
        return Boolean(attr.nodeValue.match(SAFE_URL_PATTERN) || attr.nodeValue.match(DATA_URL_PATTERN))
      }

      return true
    }

    var regExp = $(allowedAttributeList).filter(function (index, value) {
      return value instanceof RegExp
    })

    // Check if a regular expression validates the attribute.
    for (var i = 0, l = regExp.length; i < l; i++) {
      if (attrName.match(regExp[i])) {
        return true
      }
    }

    return false
  }

  function sanitizeHtml(unsafeHtml, whiteList, sanitizeFn) {
    if (unsafeHtml.length === 0) {
      return unsafeHtml
    }

    if (sanitizeFn && typeof sanitizeFn === 'function') {
      return sanitizeFn(unsafeHtml)
    }

    // IE 8 and below don't support createHTMLDocument
    if (!document.implementation || !document.implementation.createHTMLDocument) {
      return unsafeHtml
    }

    var createdDocument = document.implementation.createHTMLDocument('sanitization')
    createdDocument.body.innerHTML = unsafeHtml

    var whitelistKeys = $.map(whiteList, function (el, i) { return i })
    var elements = $(createdDocument.body).find('*')

    for (var i = 0, len = elements.length; i < len; i++) {
      var el = elements[i]
      var elName = el.nodeName.toLowerCase()

      if ($.inArray(elName, whitelistKeys) === -1) {
        el.parentNode.removeChild(el)

        continue
      }

      var attributeList = $.map(el.attributes, function (el) { return el })
      var whitelistedAttributes = [].concat(whiteList['*'] || [], whiteList[elName] || [])

      for (var j = 0, len2 = attributeList.length; j < len2; j++) {
        if (!allowedAttribute(attributeList[j], whitelistedAttributes)) {
          el.removeAttribute(attributeList[j].nodeName)
        }
      }
    }

    return createdDocument.body.innerHTML
  }

  // TOOLTIP PUBLIC CLASS DEFINITION
  // ===============================

  var Tooltip = function (element, options) {
    this.type       = null
    this.options    = null
    this.enabled    = null
    this.timeout    = null
    this.hoverState = null
    this.$element   = null
    this.inState    = null

    this.init('tooltip', element, options)
  }

  Tooltip.VERSION  = '3.4.1'

  Tooltip.TRANSITION_DURATION = 150

  Tooltip.DEFAULTS = {
    animation: true,
    placement: 'top',
    selector: false,
    template: '<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',
    trigger: 'hover focus',
    title: '',
    delay: 0,
    html: false,
    container: false,
    viewport: {
      selector: 'body',
      padding: 0
    },
    sanitize : true,
    sanitizeFn : null,
    whiteList : DefaultWhitelist
  }

  Tooltip.prototype.init = function (type, element, options) {
    this.enabled   = true
    this.type      = type
    this.$element  = $(element)
    this.options   = this.getOptions(options)
    this.$viewport = this.options.viewport && $(document).find($.isFunction(this.options.viewport) ? this.options.viewport.call(this, this.$element) : (this.options.viewport.selector || this.options.viewport))
    this.inState   = { click: false, hover: false, focus: false }

    if (this.$element[0] instanceof document.constructor && !this.options.selector) {
      throw new Error('`selector` option must be specified when initializing ' + this.type + ' on the window.document object!')
    }

    var triggers = this.options.trigger.split(' ')

    for (var i = triggers.length; i--;) {
      var trigger = triggers[i]

      if (trigger == 'click') {
        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))
      } else if (trigger != 'manual') {
        var eventIn  = trigger == 'hover' ? 'mouseenter' : 'focusin'
        var eventOut = trigger == 'hover' ? 'mouseleave' : 'focusout'

        this.$element.on(eventIn  + '.' + this.type, this.options.selector, $.proxy(this.enter, this))
        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))
      }
    }

    this.options.selector ?
      (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :
      this.fixTitle()
  }

  Tooltip.prototype.getDefaults = function () {
    return Tooltip.DEFAULTS
  }

  Tooltip.prototype.getOptions = function (options) {
    var dataAttributes = this.$element.data()

    for (var dataAttr in dataAttributes) {
      if (dataAttributes.hasOwnProperty(dataAttr) && $.inArray(dataAttr, DISALLOWED_ATTRIBUTES) !== -1) {
        delete dataAttributes[dataAttr]
      }
    }

    options = $.extend({}, this.getDefaults(), dataAttributes, options)

    if (options.delay && typeof options.delay == 'number') {
      options.delay = {
        show: options.delay,
        hide: options.delay
      }
    }

    if (options.sanitize) {
      options.template = sanitizeHtml(options.template, options.whiteList, options.sanitizeFn)
    }

    return options
  }

  Tooltip.prototype.getDelegateOptions = function () {
    var options  = {}
    var defaults = this.getDefaults()

    this._options && $.each(this._options, function (key, value) {
      if (defaults[key] != value) options[key] = value
    })

    return options
  }

  Tooltip.prototype.enter = function (obj) {
    var self = obj instanceof this.constructor ?
      obj : $(obj.currentTarget).data('bs.' + this.type)

    if (!self) {
      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
      $(obj.currentTarget).data('bs.' + this.type, self)
    }

    if (obj instanceof $.Event) {
      self.inState[obj.type == 'focusin' ? 'focus' : 'hover'] = true
    }

    if (self.tip().hasClass('in') || self.hoverState == 'in') {
      self.hoverState = 'in'
      return
    }

    clearTimeout(self.timeout)

    self.hoverState = 'in'

    if (!self.options.delay || !self.options.delay.show) return self.show()

    self.timeout = setTimeout(function () {
      if (self.hoverState == 'in') self.show()
    }, self.options.delay.show)
  }

  Tooltip.prototype.isInStateTrue = function () {
    for (var key in this.inState) {
      if (this.inState[key]) return true
    }

    return false
  }

  Tooltip.prototype.leave = function (obj) {
    var self = obj instanceof this.constructor ?
      obj : $(obj.currentTarget).data('bs.' + this.type)

    if (!self) {
      self = new this.constructor(obj.currentTarget, this.getDelegateOptions())
      $(obj.currentTarget).data('bs.' + this.type, self)
    }

    if (obj instanceof $.Event) {
      self.inState[obj.type == 'focusout' ? 'focus' : 'hover'] = false
    }

    if (self.isInStateTrue()) return

    clearTimeout(self.timeout)

    self.hoverState = 'out'

    if (!self.options.delay || !self.options.delay.hide) return self.hide()

    self.timeout = setTimeout(function () {
      if (self.hoverState == 'out') self.hide()
    }, self.options.delay.hide)
  }

  Tooltip.prototype.show = function () {
    var e = $.Event('show.bs.' + this.type)

    if (this.hasContent() && this.enabled) {
      this.$element.trigger(e)

      var inDom = $.contains(this.$element[0].ownerDocument.documentElement, this.$element[0])
      if (e.isDefaultPrevented() || !inDom) return
      var that = this

      var $tip = this.tip()

      var tipId = this.getUID(this.type)

      this.setContent()
      $tip.attr('id', tipId)
      this.$element.attr('aria-describedby', tipId)

      if (this.options.animation) $tip.addClass('fade')

      var placement = typeof this.options.placement == 'function' ?
        this.options.placement.call(this, $tip[0], this.$element[0]) :
        this.options.placement

      var autoToken = /\s?auto?\s?/i
      var autoPlace = autoToken.test(placement)
      if (autoPlace) placement = placement.replace(autoToken, '') || 'top'

      $tip
        .detach()
        .css({ top: 0, left: 0, display: 'block' })
        .addClass(placement)
        .data('bs.' + this.type, this)

      this.options.container ? $tip.appendTo($(document).find(this.options.container)) : $tip.insertAfter(this.$element)
      this.$element.trigger('inserted.bs.' + this.type)

      var pos          = this.getPosition()
      var actualWidth  = $tip[0].offsetWidth
      var actualHeight = $tip[0].offsetHeight

      if (autoPlace) {
        var orgPlacement = placement
        var viewportDim = this.getPosition(this.$viewport)

        placement = placement == 'bottom' && pos.bottom + actualHeight > viewportDim.bottom ? 'top'    :
                    placement == 'top'    && pos.top    - actualHeight < viewportDim.top    ? 'bottom' :
                    placement == 'right'  && pos.right  + actualWidth  > viewportDim.width  ? 'left'   :
                    placement == 'left'   && pos.left   - actualWidth  < viewportDim.left   ? 'right'  :
                    placement

        $tip
          .removeClass(orgPlacement)
          .addClass(placement)
      }

      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)

      this.applyPlacement(calculatedOffset, placement)

      var complete = function () {
        var prevHoverState = that.hoverState
        that.$element.trigger('shown.bs.' + that.type)
        that.hoverState = null

        if (prevHoverState == 'out') that.leave(that)
      }

      $.support.transition && this.$tip.hasClass('fade') ?
        $tip
          .one('bsTransitionEnd', complete)
          .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :
        complete()
    }
  }

  Tooltip.prototype.applyPlacement = function (offset, placement) {
    var $tip   = this.tip()
    var width  = $tip[0].offsetWidth
    var height = $tip[0].offsetHeight

    // manually read margins because getBoundingClientRect includes difference
    var marginTop = parseInt($tip.css('margin-top'), 10)
    var marginLeft = parseInt($tip.css('margin-left'), 10)

    // we must check for NaN for ie 8/9
    if (isNaN(marginTop))  marginTop  = 0
    if (isNaN(marginLeft)) marginLeft = 0

    offset.top  += marginTop
    offset.left += marginLeft

    // $.fn.offset doesn't round pixel values
    // so we use setOffset directly with our own function B-0
    $.offset.setOffset($tip[0], $.extend({
      using: function (props) {
        $tip.css({
          top: Math.round(props.top),
          left: Math.round(props.left)
        })
      }
    }, offset), 0)

    $tip.addClass('in')

    // check to see if placing tip in new offset caused the tip to resize itself
    var actualWidth  = $tip[0].offsetWidth
    var actualHeight = $tip[0].offsetHeight

    if (placement == 'top' && actualHeight != height) {
      offset.top = offset.top + height - actualHeight
    }

    var delta = this.getViewportAdjustedDelta(placement, offset, actualWidth, actualHeight)

    if (delta.left) offset.left += delta.left
    else offset.top += delta.top

    var isVertical          = /top|bottom/.test(placement)
    var arrowDelta          = isVertical ? delta.left * 2 - width + actualWidth : delta.top * 2 - height + actualHeight
    var arrowOffsetPosition = isVertical ? 'offsetWidth' : 'offsetHeight'

    $tip.offset(offset)
    this.replaceArrow(arrowDelta, $tip[0][arrowOffsetPosition], isVertical)
  }

  Tooltip.prototype.replaceArrow = function (delta, dimension, isVertical) {
    this.arrow()
      .css(isVertical ? 'left' : 'top', 50 * (1 - delta / dimension) + '%')
      .css(isVertical ? 'top' : 'left', '')
  }

  Tooltip.prototype.setContent = function () {
    var $tip  = this.tip()
    var title = this.getTitle()

    if (this.options.html) {
      if (this.options.sanitize) {
        title = sanitizeHtml(title, this.options.whiteList, this.options.sanitizeFn)
      }

      $tip.find('.tooltip-inner').html(title)
    } else {
      $tip.find('.tooltip-inner').text(title)
    }

    $tip.removeClass('fade in top bottom left right')
  }

  Tooltip.prototype.hide = function (callback) {
    var that = this
    var $tip = $(this.$tip)
    var e    = $.Event('hide.bs.' + this.type)

    function complete() {
      if (that.hoverState != 'in') $tip.detach()
      if (that.$element) { // TODO: Check whether guarding this code with this `if` is really necessary.
        that.$element
          .removeAttr('aria-describedby')
          .trigger('hidden.bs.' + that.type)
      }
      callback && callback()
    }

    this.$element.trigger(e)

    if (e.isDefaultPrevented()) return

    $tip.removeClass('in')

    $.support.transition && $tip.hasClass('fade') ?
      $tip
        .one('bsTransitionEnd', complete)
        .emulateTransitionEnd(Tooltip.TRANSITION_DURATION) :
      complete()

    this.hoverState = null

    return this
  }

  Tooltip.prototype.fixTitle = function () {
    var $e = this.$element
    if ($e.attr('title') || typeof $e.attr('data-original-title') != 'string') {
      $e.attr('data-original-title', $e.attr('title') || '').attr('title', '')
    }
  }

  Tooltip.prototype.hasContent = function () {
    return this.getTitle()
  }

  Tooltip.prototype.getPosition = function ($element) {
    $element   = $element || this.$element

    var el     = $element[0]
    var isBody = el.tagName == 'BODY'

    var elRect    = el.getBoundingClientRect()
    if (elRect.width == null) {
      // width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093
      elRect = $.extend({}, elRect, { width: elRect.right - elRect.left, height: elRect.bottom - elRect.top })
    }
    var isSvg = window.SVGElement && el instanceof window.SVGElement
    // Avoid using $.offset() on SVGs since it gives incorrect results in jQuery 3.
    // See https://github.com/twbs/bootstrap/issues/20280
    var elOffset  = isBody ? { top: 0, left: 0 } : (isSvg ? null : $element.offset())
    var scroll    = { scroll: isBody ? document.documentElement.scrollTop || document.body.scrollTop : $element.scrollTop() }
    var outerDims = isBody ? { width: $(window).width(), height: $(window).height() } : null

    return $.extend({}, elRect, scroll, outerDims, elOffset)
  }

  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {
    return placement == 'bottom' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2 } :
           placement == 'top'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2 } :
           placement == 'left'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :
        /* placement == 'right' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width }

  }

  Tooltip.prototype.getViewportAdjustedDelta = function (placement, pos, actualWidth, actualHeight) {
    var delta = { top: 0, left: 0 }
    if (!this.$viewport) return delta

    var viewportPadding = this.options.viewport && this.options.viewport.padding || 0
    var viewportDimensions = this.getPosition(this.$viewport)

    if (/right|left/.test(placement)) {
      var topEdgeOffset    = pos.top - viewportPadding - viewportDimensions.scroll
      var bottomEdgeOffset = pos.top + viewportPadding - viewportDimensions.scroll + actualHeight
      if (topEdgeOffset < viewportDimensions.top) { // top overflow
        delta.top = viewportDimensions.top - topEdgeOffset
      } else if (bottomEdgeOffset > viewportDimensions.top + viewportDimensions.height) { // bottom overflow
        delta.top = viewportDimensions.top + viewportDimensions.height - bottomEdgeOffset
      }
    } else {
      var leftEdgeOffset  = pos.left - viewportPadding
      var rightEdgeOffset = pos.left + viewportPadding + actualWidth
      if (leftEdgeOffset < viewportDimensions.left) { // left overflow
        delta.left = viewportDimensions.left - leftEdgeOffset
      } else if (rightEdgeOffset > viewportDimensions.right) { // right overflow
        delta.left = viewportDimensions.left + viewportDimensions.width - rightEdgeOffset
      }
    }

    return delta
  }

  Tooltip.prototype.getTitle = function () {
    var title
    var $e = this.$element
    var o  = this.options

    title = $e.attr('data-original-title')
      || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)

    return title
  }

  Tooltip.prototype.getUID = function (prefix) {
    do prefix += ~~(Math.random() * 1000000)
    while (document.getElementById(prefix))
    return prefix
  }

  Tooltip.prototype.tip = function () {
    if (!this.$tip) {
      this.$tip = $(this.options.template)
      if (this.$tip.length != 1) {
        throw new Error(this.type + ' `template` option must consist of exactly 1 top-level element!')
      }
    }
    return this.$tip
  }

  Tooltip.prototype.arrow = function () {
    return (this.$arrow = this.$arrow || this.tip().find('.tooltip-arrow'))
  }

  Tooltip.prototype.enable = function () {
    this.enabled = true
  }

  Tooltip.prototype.disable = function () {
    this.enabled = false
  }

  Tooltip.prototype.toggleEnabled = function () {
    this.enabled = !this.enabled
  }

  Tooltip.prototype.toggle = function (e) {
    var self = this
    if (e) {
      self = $(e.currentTarget).data('bs.' + this.type)
      if (!self) {
        self = new this.constructor(e.currentTarget, this.getDelegateOptions())
        $(e.currentTarget).data('bs.' + this.type, self)
      }
    }

    if (e) {
      self.inState.click = !self.inState.click
      if (self.isInStateTrue()) self.enter(self)
      else self.leave(self)
    } else {
      self.tip().hasClass('in') ? self.leave(self) : self.enter(self)
    }
  }

  Tooltip.prototype.destroy = function () {
    var that = this
    clearTimeout(this.timeout)
    this.hide(function () {
      that.$element.off('.' + that.type).removeData('bs.' + that.type)
      if (that.$tip) {
        that.$tip.detach()
      }
      that.$tip = null
      that.$arrow = null
      that.$viewport = null
      that.$element = null
    })
  }

  Tooltip.prototype.sanitizeHtml = function (unsafeHtml) {
    return sanitizeHtml(unsafeHtml, this.options.whiteList, this.options.sanitizeFn)
  }

  // TOOLTIP PLUGIN DEFINITION
  // =========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.tooltip')
      var options = typeof option == 'object' && option

      if (!data && /destroy|hide/.test(option)) return
      if (!data) $this.data('bs.tooltip', (data = new Tooltip(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.tooltip

  $.fn.tooltip             = Plugin
  $.fn.tooltip.Constructor = Tooltip


  // TOOLTIP NO CONFLICT
  // ===================

  $.fn.tooltip.noConflict = function () {
    $.fn.tooltip = old
    return this
  }

}(jQuery);

/* ========================================================================
 * Bootstrap: popover.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // POPOVER PUBLIC CLASS DEFINITION
  // ===============================

  var Popover = function (element, options) {
    this.init('popover', element, options)
  }

  if (!$.fn.tooltip) throw new Error('Popover requires tooltip.js')

  Popover.VERSION  = '3.4.1'

  Popover.DEFAULTS = $.extend({}, $.fn.tooltip.Constructor.DEFAULTS, {
    placement: 'right',
    trigger: 'click',
    content: '',
    template: '<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
  })


  // NOTE: POPOVER EXTENDS tooltip.js
  // ================================

  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)

  Popover.prototype.constructor = Popover

  Popover.prototype.getDefaults = function () {
    return Popover.DEFAULTS
  }

  Popover.prototype.setContent = function () {
    var $tip    = this.tip()
    var title   = this.getTitle()
    var content = this.getContent()

    if (this.options.html) {
      var typeContent = typeof content

      if (this.options.sanitize) {
        title = this.sanitizeHtml(title)

        if (typeContent === 'string') {
          content = this.sanitizeHtml(content)
        }
      }

      $tip.find('.popover-title').html(title)
      $tip.find('.popover-content').children().detach().end()[
        typeContent === 'string' ? 'html' : 'append'
      ](content)
    } else {
      $tip.find('.popover-title').text(title)
      $tip.find('.popover-content').children().detach().end().text(content)
    }

    $tip.removeClass('fade top bottom left right in')

    // IE8 doesn't accept hiding via the `:empty` pseudo selector, we have to do
    // this manually by checking the contents.
    if (!$tip.find('.popover-title').html()) $tip.find('.popover-title').hide()
  }

  Popover.prototype.hasContent = function () {
    return this.getTitle() || this.getContent()
  }

  Popover.prototype.getContent = function () {
    var $e = this.$element
    var o  = this.options

    return $e.attr('data-content')
      || (typeof o.content == 'function' ?
        o.content.call($e[0]) :
        o.content)
  }

  Popover.prototype.arrow = function () {
    return (this.$arrow = this.$arrow || this.tip().find('.arrow'))
  }


  // POPOVER PLUGIN DEFINITION
  // =========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.popover')
      var options = typeof option == 'object' && option

      if (!data && /destroy|hide/.test(option)) return
      if (!data) $this.data('bs.popover', (data = new Popover(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.popover

  $.fn.popover             = Plugin
  $.fn.popover.Constructor = Popover


  // POPOVER NO CONFLICT
  // ===================

  $.fn.popover.noConflict = function () {
    $.fn.popover = old
    return this
  }

}(jQuery);

/* ========================================================================
 * Bootstrap: scrollspy.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // SCROLLSPY CLASS DEFINITION
  // ==========================

  function ScrollSpy(element, options) {
    this.$body          = $(document.body)
    this.$scrollElement = $(element).is(document.body) ? $(window) : $(element)
    this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)
    this.selector       = (this.options.target || '') + ' .nav li > a'
    this.offsets        = []
    this.targets        = []
    this.activeTarget   = null
    this.scrollHeight   = 0

    this.$scrollElement.on('scroll.bs.scrollspy', $.proxy(this.process, this))
    this.refresh()
    this.process()
  }

  ScrollSpy.VERSION  = '3.4.1'

  ScrollSpy.DEFAULTS = {
    offset: 10
  }

  ScrollSpy.prototype.getScrollHeight = function () {
    return this.$scrollElement[0].scrollHeight || Math.max(this.$body[0].scrollHeight, document.documentElement.scrollHeight)
  }

  ScrollSpy.prototype.refresh = function () {
    var that          = this
    var offsetMethod  = 'offset'
    var offsetBase    = 0

    this.offsets      = []
    this.targets      = []
    this.scrollHeight = this.getScrollHeight()

    if (!$.isWindow(this.$scrollElement[0])) {
      offsetMethod = 'position'
      offsetBase   = this.$scrollElement.scrollTop()
    }

    this.$body
      .find(this.selector)
      .map(function () {
        var $el   = $(this)
        var href  = $el.data('target') || $el.attr('href')
        var $href = /^#./.test(href) && $(href)

        return ($href
          && $href.length
          && $href.is(':visible')
          && [[$href[offsetMethod]().top + offsetBase, href]]) || null
      })
      .sort(function (a, b) { return a[0] - b[0] })
      .each(function () {
        that.offsets.push(this[0])
        that.targets.push(this[1])
      })
  }

  ScrollSpy.prototype.process = function () {
    var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset
    var scrollHeight = this.getScrollHeight()
    var maxScroll    = this.options.offset + scrollHeight - this.$scrollElement.height()
    var offsets      = this.offsets
    var targets      = this.targets
    var activeTarget = this.activeTarget
    var i

    if (this.scrollHeight != scrollHeight) {
      this.refresh()
    }

    if (scrollTop >= maxScroll) {
      return activeTarget != (i = targets[targets.length - 1]) && this.activate(i)
    }

    if (activeTarget && scrollTop < offsets[0]) {
      this.activeTarget = null
      return this.clear()
    }

    for (i = offsets.length; i--;) {
      activeTarget != targets[i]
        && scrollTop >= offsets[i]
        && (offsets[i + 1] === undefined || scrollTop < offsets[i + 1])
        && this.activate(targets[i])
    }
  }

  ScrollSpy.prototype.activate = function (target) {
    this.activeTarget = target

    this.clear()

    var selector = this.selector +
      '[data-target="' + target + '"],' +
      this.selector + '[href="' + target + '"]'

    var active = $(selector)
      .parents('li')
      .addClass('active')

    if (active.parent('.dropdown-menu').length) {
      active = active
        .closest('li.dropdown')
        .addClass('active')
    }

    active.trigger('activate.bs.scrollspy')
  }

  ScrollSpy.prototype.clear = function () {
    $(this.selector)
      .parentsUntil(this.options.target, '.active')
      .removeClass('active')
  }


  // SCROLLSPY PLUGIN DEFINITION
  // ===========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.scrollspy')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.scrollspy', (data = new ScrollSpy(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.scrollspy

  $.fn.scrollspy             = Plugin
  $.fn.scrollspy.Constructor = ScrollSpy


  // SCROLLSPY NO CONFLICT
  // =====================

  $.fn.scrollspy.noConflict = function () {
    $.fn.scrollspy = old
    return this
  }


  // SCROLLSPY DATA-API
  // ==================

  $(window).on('load.bs.scrollspy.data-api', function () {
    $('[data-spy="scroll"]').each(function () {
      var $spy = $(this)
      Plugin.call($spy, $spy.data())
    })
  })

}(jQuery);

/* ========================================================================
 * Bootstrap: tab.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // TAB CLASS DEFINITION
  // ====================

  var Tab = function (element) {
    // jscs:disable requireDollarBeforejQueryAssignment
    this.element = $(element)
    // jscs:enable requireDollarBeforejQueryAssignment
  }

  Tab.VERSION = '3.4.1'

  Tab.TRANSITION_DURATION = 150

  Tab.prototype.show = function () {
    var $this    = this.element
    var $ul      = $this.closest('ul:not(.dropdown-menu)')
    var selector = $this.data('target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    if ($this.parent('li').hasClass('active')) return

    var $previous = $ul.find('.active:last a')
    var hideEvent = $.Event('hide.bs.tab', {
      relatedTarget: $this[0]
    })
    var showEvent = $.Event('show.bs.tab', {
      relatedTarget: $previous[0]
    })

    $previous.trigger(hideEvent)
    $this.trigger(showEvent)

    if (showEvent.isDefaultPrevented() || hideEvent.isDefaultPrevented()) return

    var $target = $(document).find(selector)

    this.activate($this.closest('li'), $ul)
    this.activate($target, $target.parent(), function () {
      $previous.trigger({
        type: 'hidden.bs.tab',
        relatedTarget: $this[0]
      })
      $this.trigger({
        type: 'shown.bs.tab',
        relatedTarget: $previous[0]
      })
    })
  }

  Tab.prototype.activate = function (element, container, callback) {
    var $active    = container.find('> .active')
    var transition = callback
      && $.support.transition
      && ($active.length && $active.hasClass('fade') || !!container.find('> .fade').length)

    function next() {
      $active
        .removeClass('active')
        .find('> .dropdown-menu > .active')
        .removeClass('active')
        .end()
        .find('[data-toggle="tab"]')
        .attr('aria-expanded', false)

      element
        .addClass('active')
        .find('[data-toggle="tab"]')
        .attr('aria-expanded', true)

      if (transition) {
        element[0].offsetWidth // reflow for transition
        element.addClass('in')
      } else {
        element.removeClass('fade')
      }

      if (element.parent('.dropdown-menu').length) {
        element
          .closest('li.dropdown')
          .addClass('active')
          .end()
          .find('[data-toggle="tab"]')
          .attr('aria-expanded', true)
      }

      callback && callback()
    }

    $active.length && transition ?
      $active
        .one('bsTransitionEnd', next)
        .emulateTransitionEnd(Tab.TRANSITION_DURATION) :
      next()

    $active.removeClass('in')
  }


  // TAB PLUGIN DEFINITION
  // =====================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.tab')

      if (!data) $this.data('bs.tab', (data = new Tab(this)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.tab

  $.fn.tab             = Plugin
  $.fn.tab.Constructor = Tab


  // TAB NO CONFLICT
  // ===============

  $.fn.tab.noConflict = function () {
    $.fn.tab = old
    return this
  }


  // TAB DATA-API
  // ============

  var clickHandler = function (e) {
    e.preventDefault()
    Plugin.call($(this), 'show')
  }

  $(document)
    .on('click.bs.tab.data-api', '[data-toggle="tab"]', clickHandler)
    .on('click.bs.tab.data-api', '[data-toggle="pill"]', clickHandler)

}(jQuery);

/* ========================================================================
 * Bootstrap: affix.js v3.4.1
 * https://getbootstrap.com/docs/3.4/javascript/#affix
 * ========================================================================
 * Copyright 2011-2019 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // AFFIX CLASS DEFINITION
  // ======================

  var Affix = function (element, options) {
    this.options = $.extend({}, Affix.DEFAULTS, options)

    var target = this.options.target === Affix.DEFAULTS.target ? $(this.options.target) : $(document).find(this.options.target)

    this.$target = target
      .on('scroll.bs.affix.data-api', $.proxy(this.checkPosition, this))
      .on('click.bs.affix.data-api',  $.proxy(this.checkPositionWithEventLoop, this))

    this.$element     = $(element)
    this.affixed      = null
    this.unpin        = null
    this.pinnedOffset = null

    this.checkPosition()
  }

  Affix.VERSION  = '3.4.1'

  Affix.RESET    = 'affix affix-top affix-bottom'

  Affix.DEFAULTS = {
    offset: 0,
    target: window
  }

  Affix.prototype.getState = function (scrollHeight, height, offsetTop, offsetBottom) {
    var scrollTop    = this.$target.scrollTop()
    var position     = this.$element.offset()
    var targetHeight = this.$target.height()

    if (offsetTop != null && this.affixed == 'top') return scrollTop < offsetTop ? 'top' : false

    if (this.affixed == 'bottom') {
      if (offsetTop != null) return (scrollTop + this.unpin <= position.top) ? false : 'bottom'
      return (scrollTop + targetHeight <= scrollHeight - offsetBottom) ? false : 'bottom'
    }

    var initializing   = this.affixed == null
    var colliderTop    = initializing ? scrollTop : position.top
    var colliderHeight = initializing ? targetHeight : height

    if (offsetTop != null && scrollTop <= offsetTop) return 'top'
    if (offsetBottom != null && (colliderTop + colliderHeight >= scrollHeight - offsetBottom)) return 'bottom'

    return false
  }

  Affix.prototype.getPinnedOffset = function () {
    if (this.pinnedOffset) return this.pinnedOffset
    this.$element.removeClass(Affix.RESET).addClass('affix')
    var scrollTop = this.$target.scrollTop()
    var position  = this.$element.offset()
    return (this.pinnedOffset = position.top - scrollTop)
  }

  Affix.prototype.checkPositionWithEventLoop = function () {
    setTimeout($.proxy(this.checkPosition, this), 1)
  }

  Affix.prototype.checkPosition = function () {
    if (!this.$element.is(':visible')) return

    var height       = this.$element.height()
    var offset       = this.options.offset
    var offsetTop    = offset.top
    var offsetBottom = offset.bottom
    var scrollHeight = Math.max($(document).height(), $(document.body).height())

    if (typeof offset != 'object')         offsetBottom = offsetTop = offset
    if (typeof offsetTop == 'function')    offsetTop    = offset.top(this.$element)
    if (typeof offsetBottom == 'function') offsetBottom = offset.bottom(this.$element)

    var affix = this.getState(scrollHeight, height, offsetTop, offsetBottom)

    if (this.affixed != affix) {
      if (this.unpin != null) this.$element.css('top', '')

      var affixType = 'affix' + (affix ? '-' + affix : '')
      var e         = $.Event(affixType + '.bs.affix')

      this.$element.trigger(e)

      if (e.isDefaultPrevented()) return

      this.affixed = affix
      this.unpin = affix == 'bottom' ? this.getPinnedOffset() : null

      this.$element
        .removeClass(Affix.RESET)
        .addClass(affixType)
        .trigger(affixType.replace('affix', 'affixed') + '.bs.affix')
    }

    if (affix == 'bottom') {
      this.$element.offset({
        top: scrollHeight - height - offsetBottom
      })
    }
  }


  // AFFIX PLUGIN DEFINITION
  // =======================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.affix')
      var options = typeof option == 'object' && option

      if (!data) $this.data('bs.affix', (data = new Affix(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.affix

  $.fn.affix             = Plugin
  $.fn.affix.Constructor = Affix


  // AFFIX NO CONFLICT
  // =================

  $.fn.affix.noConflict = function () {
    $.fn.affix = old
    return this
  }


  // AFFIX DATA-API
  // ==============

  $(window).on('load', function () {
    $('[data-spy="affix"]').each(function () {
      var $spy = $(this)
      var data = $spy.data()

      data.offset = data.offset || {}

      if (data.offsetBottom != null) data.offset.bottom = data.offsetBottom
      if (data.offsetTop    != null) data.offset.top    = data.offsetTop

      Plugin.call($spy, data)
    })
  })

}(jQuery);

!function(t,e){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),s=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||u,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function s(e){return t.parseJSON(e)}function o(t){var e,n,i=[],r=u.length;for(e=0;r>e;e++)(n=u.key(e)).match(t)&&i.push(n.replace(t,""));return i}var u;try{u=window.localStorage,u.setItem("~~~","!"),u.removeItem("~~~")}catch(a){u=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(n){"QuotaExceededError"===n.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),s(this.ls.getItem(this._prefix(t)))},set:function(t,n,s){return e.isNumber(s)?this._safeSet(this._ttlKey(t),r(i()+s)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=o(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=s(this.ls.getItem(this._ttlKey(t)));return e.isNumber(n)&&i()>n?!0:!1}}),n}(),o=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=t.cache===!1?new r(0):u}var i=0,s={},o=6,u=new r(10);return n.setMaxPendingRequests=function(t){o=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),h._cache.set(a,t)}function r(){e(!0)}function u(){i--,delete s[a],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var a,c,h=this;a=this._fingerprint(t),this.cancelled||a!==this.lastReq||((c=s[a])?c.done(n).fail(r):o>i?(i++,s[a]=this._send(t).done(n).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,s;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},s=this._fingerprint(n),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),u=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[a]=[],t[u]={},t}function s(t){for(var e={},n=[],i=0,r=t.length;r>i;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function o(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var s=t.length,o=e.length;s>n&&o>i;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var u="c",a="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;n.datums[s=n.identify(t)]=t,o=i(n.datumTokenizer(t)),e.each(o,function(t){var e,i,o;for(e=n.trie,i=t.split("");o=i.shift();)e=e[u][o]||(e[u][o]=r()),e[a].push(s)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,c=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,s;if(r&&0===r.length)return!1;for(e=c.trie,n=t.split("");e&&(i=n.shift());)e=e[u][i];return e&&0===n.length?(s=e[a].slice(0),void(r=r?o(r,s):s)):(r=[],!1)}),r?e.map(s(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),a=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new s(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),h=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?u(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=s(n),n.limiter=o(n),n.transport=n.transport?u(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function s(t){function e(t,e){return e.url=s(e.url,t),e}function n(t,e){return e.url=e.url.replace(o,encodeURIComponent(t)),e}function i(t,e){return e}var r,s,o;return r=t.prepare,s=t.replace,o=t.wildcard,r?r:r=s?e:t.wildcard?n:i}function o(t){function n(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var r,s,o;return r=t.limiter,s=t.rateLimitBy,o=t.rateLimitWait,r||(r=/^throttle$/i.test(s)?i(o):n(o)),r}function u(n){return function(i){function r(t){e.defer(function(){o.resolve(t)})}function s(t){e.defer(function(){o.reject(t)})}var o=t.Deferred();return n(i,r,s),o}}return function(n){var s,o;return s={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(s,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),o=n.sorter,n.sorter=o?function(t){return t.sort(o)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}(),l=function(){"use strict";function n(t){t=h(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new a(t.prefetch):null,this.index=new u({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),t.initialize!==!1&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){return t?n.reject():(r.add(e),r.prefetch.store(r.index.serialize()),void n.resolve())}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(s,function(e){return o.identify(t)===o.identify(e)})&&n.push(t)}),i&&i(n)}var s,o=this;return s=this.sorter(this.index.search(t)),n(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}();return l}),function(t,e){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?void 0:!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){return(i=n.call(null,r,t,e))?!1:void 0}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,0>=c?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var o,u;return u=e.mixin({},s,t),o={css:r(),classes:u,html:n(u),selectors:i(u)},{css:o.css,html:o.html,classes:o.classes,selectors:o.selectors,mixin:function(t){e.mixin(t,o)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var s={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(a),n=i?u(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(a);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,o;if(!this._callbacks)return this;for(t=t.split(a),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=s(n.sync,this,[e].concat(i)),o=s(n.async,this,[e].concat(i)),r()&&c(o);return this}function s(t,e,n){function i(){for(var i,r=0,s=t.length;!i&&s>r;r+=1)i=t[r].apply(e,n)===!1;return!i}return i}function o(){var t;return t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function u(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var a=/\s+/,c=o();return{onSync:n,onAsync:e,off:i,trigger:r}}(),s=function(t){"use strict";function n(t,n,i){for(var r,s=[],o=0,u=t.length;u>o;o++)s.push(e.escapeRegExChars(t[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function s(e){var n,i,s;return(n=u.exec(e.data))&&(s=t.createElement(r.tagName),r.className&&(s.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),s.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(s,i)),!!n}function o(t,e){for(var n,i=3,r=0;r<t.childNodes.length;r++)n=t.childNodes[r],n.nodeType===i?r+=e(n)?1:0:o(n,e)}var u;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],u=n(r.pattern,r.caseSensitive,r.wordsOnly),o(r.node,s))}}(window.document),o=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function s(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function o(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var u;return u={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=u[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!o(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!o(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=s(t,this.query),i=n?this.query.length!==t.length:!1,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,s=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){u[t.which||t.keyCode]||e.defer(e.bind(s._onInput,s,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),i=""!==t&&n&&!this.hasOverflow(),!i&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:document.selection?(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),u=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!u(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||c(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=o(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function o(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function u(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var a,c;return a={val:"tt-selectable-display",obj:"tt-selectable-object"},c=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(a.obj)?{val:n.data(a.val)||"",obj:n.data(a.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,o=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,s;s=o._injectQuery(n,e),i=t(o.templates.suggestion(s)).data(a.obj,e).data(a.val,o.displayFn(e)).addClass(o.classes.suggestion+" "+o.classes.selectable),r.appendChild(i[0])}),this.highlight&&s({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){o||(o=!0,t=(t||[]).slice(0,r.limit),u=t.length,r._overwrite(e,t),u<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!s&&u<r.limit&&(r.cancel=t.noop,u+=n.length,r._append(e,n.slice(0,r.limit-u)),r.async&&r.trigger("asyncReceived",e))}var r=this,s=!1,o=!1,u=0;this.cancel(),this.cancel=function(){s=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!o&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),a=function(){"use strict";function n(n,i){function r(e){var n=s.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(s.$node),new u(e,i)}var s=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),0>e?this.$node.scrollTop(i+e):n>r&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=-1>r?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?u.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),c=function(){"use strict";function t(){a.apply(this,[].slice.call(arguments,0))}var n=a.prototype;return e.mixin(t.prototype,a.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),h=function(){"use strict";function n(n,r){var s,o,u,a,c,h,l,f,d,p,g;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),s=i(this,"activate","open","_onFocused"),o=i(this,"deactivate","_onBlurred"),u=i(this,"isActive","isOpen","_onEnterKeyed"),a=i(this,"isActive","isOpen","_onTabKeyed"),c=i(this,"isActive","_onEscKeyed"),h=i(this,"isActive","open","_onUpKeyed"),l=i(this,"isActive","open","_onDownKeyed"),f=i(this,"isActive","isOpen","_onLeftKeyed"),d=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),g=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",s,this).onSync("blurred",o,this).onSync("enterKeyed",u,this).onSync("tabKeyed",a,this).onSync("escKeyed",c,this).onSync("upKeyed",h,this).onSync("downKeyed",l,this).onSync("leftKeyed",f,this).onSync("rightKeyed",d,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",g,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),
i=this.menu.$node||t("<div>"),n.on("blur.tt",function(t){var r,s,o;r=document.activeElement,s=i.is(r),o=i.has(r).length>0,e.isMsie()&&(s||o)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,s,u,a;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=o.normalizeQuery(i),s=e.escapeRegExChars(r),u=new RegExp("^(?:"+s+")(.+$)","i"),a=u.exec(n.val),a&&this.input.setHint(i+a[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return this.isActive()?!0:!this.isEnabled()||this.eventBus.before("active")?!1:(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return this.isActive()?this.eventBus.before("idle")?!1:(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0):!0},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return e&&!this.eventBus.before("select",e.obj)?(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0):!1},autocomplete:function(t){var e,n,i;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),i=n&&e!==n.val,i&&!this.eventBus.before("autocomplete",n.obj)?(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0):!1},moveCursor:function(t){var e,n,i,r,s;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,s=this._minLengthMet()&&this.menu.update(e),s||this.eventBus.before("cursorchange",r)?!1:(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(g.typeahead))&&n(e,i)})}function s(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(l(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function u(t,e){t.data(g.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(n){}return t}function l(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function f(t){var n,i;n=t.data(g.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(g.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(g.typeahead).removeData(g.www).removeData(g.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function d(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var p,g,m;p=t.fn.typeahead,g={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},m={initialize:function(r,l){function f(){var n,f,m,y,v,_,b,w,S,x,A;e.each(l,function(t){t.highlight=!!r.highlight}),n=t(this),f=t(p.html.wrapper),m=d(r.hint),y=d(r.menu),v=r.hint!==!1&&!m,_=r.menu!==!1&&!y,v&&(m=s(n,p)),_&&(y=t(p.html.menu).css(p.css.menu)),m&&m.val(""),n=u(n,p),(v||_)&&(f.css(p.css.wrapper),n.css(v?p.css.input:p.css.inputWithNoHint),n.wrap(f).parent().prepend(v?m:null).append(_?y:null)),A=_?c:a,b=new i({el:n}),w=new o({hint:m,input:n},p),S=new A({node:y,datasets:l},p),x=new h({input:w,menu:S,eventBus:b,minLength:r.minLength},p),n.data(g.www,p),n.data(g.typeahead,x)}var p;return l=e.isArray(l)?l:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(f)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){f(e),t.destroy()}),this}},t.fn.typeahead=function(t){return m[t]?m[t].apply(this,[].slice.call(arguments,1)):m.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()});

/* =========================================================
 * bootstrap-datepicker.js
 * Repo: https://github.com/uxsolutions/bootstrap-datepicker/
 * Demo: https://uxsolutions.github.io/bootstrap-datepicker/
 * Docs: https://bootstrap-datepicker.readthedocs.org/
 * =========================================================
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

(function(factory){
    if (typeof define === 'function' && define.amd) {
        define(['jquery'], factory);
    } else if (typeof exports === 'object') {
        factory(require('jquery'));
    } else {
        factory(jQuery);
    }
}(function($, undefined){
	function UTCDate(){
		return new Date(Date.UTC.apply(Date, arguments));
	}
	function UTCToday(){
		var today = new Date();
		return UTCDate(today.getFullYear(), today.getMonth(), today.getDate());
	}
	function isUTCEquals(date1, date2) {
		return (
			date1.getUTCFullYear() === date2.getUTCFullYear() &&
			date1.getUTCMonth() === date2.getUTCMonth() &&
			date1.getUTCDate() === date2.getUTCDate()
		);
	}
	function alias(method, deprecationMsg){
		return function(){
			if (deprecationMsg !== undefined) {
				$.fn.datepicker.deprecated(deprecationMsg);
			}

			return this[method].apply(this, arguments);
		};
	}
	function isValidDate(d) {
		return d && !isNaN(d.getTime());
	}

	var DateArray = (function(){
		var extras = {
			get: function(i){
				return this.slice(i)[0];
			},
			contains: function(d){
				// Array.indexOf is not cross-browser;
				// $.inArray doesn't work with Dates
				var val = d && d.valueOf();
				for (var i=0, l=this.length; i < l; i++)
          // Use date arithmetic to allow dates with different times to match
          if (0 <= this[i].valueOf() - val && this[i].valueOf() - val < 1000*60*60*24)
						return i;
				return -1;
			},
			remove: function(i){
				this.splice(i,1);
			},
			replace: function(new_array){
				if (!new_array)
					return;
				if (!$.isArray(new_array))
					new_array = [new_array];
				this.clear();
				this.push.apply(this, new_array);
			},
			clear: function(){
				this.length = 0;
			},
			copy: function(){
				var a = new DateArray();
				a.replace(this);
				return a;
			}
		};

		return function(){
			var a = [];
			a.push.apply(a, arguments);
			$.extend(a, extras);
			return a;
		};
	})();


	// Picker object

	var Datepicker = function(element, options){
		$.data(element, 'datepicker', this);

		this._events = [];
		this._secondaryEvents = [];

		this._process_options(options);

		this.dates = new DateArray();
		this.viewDate = this.o.defaultViewDate;
		this.focusDate = null;

		this.element = $(element);
		this.isInput = this.element.is('input');
		this.inputField = this.isInput ? this.element : this.element.find('input');
		this.component = this.element.hasClass('date') ? this.element.find('.add-on, .input-group-addon, .input-group-append, .input-group-prepend, .btn') : false;
		if (this.component && this.component.length === 0){
			this.component = false;
    }

		if (this.o.isInline === null){
			this.isInline = !this.component && !this.isInput;
		} else {
			this.isInline = this.o.isInline;
		}

		this.picker = $(DPGlobal.template);

		// Checking templates and inserting
		if (this._check_template(this.o.templates.leftArrow)) {
			this.picker.find('.prev').html(this.o.templates.leftArrow);
		}

		if (this._check_template(this.o.templates.rightArrow)) {
			this.picker.find('.next').html(this.o.templates.rightArrow);
		}

		this._buildEvents();
		this._attachEvents();

		if (this.isInline){
			this.picker.addClass('datepicker-inline').appendTo(this.element);
		}
		else {
			this.picker.addClass('datepicker-dropdown dropdown-menu');
		}

		if (this.o.rtl){
			this.picker.addClass('datepicker-rtl');
		}

		if (this.o.calendarWeeks) {
			this.picker.find('.datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear')
				.attr('colspan', function(i, val){
					return Number(val) + 1;
				});
		}

		this._process_options({
			startDate: this._o.startDate,
			endDate: this._o.endDate,
			daysOfWeekDisabled: this.o.daysOfWeekDisabled,
			daysOfWeekHighlighted: this.o.daysOfWeekHighlighted,
			datesDisabled: this.o.datesDisabled
		});

		this._allow_update = false;
		this.setViewMode(this.o.startView);
		this._allow_update = true;

		this.fillDow();
		this.fillMonths();

		this.update();

		if (this.isInline){
			this.show();
		}
	};

	Datepicker.prototype = {
		constructor: Datepicker,

		_resolveViewName: function(view){
			$.each(DPGlobal.viewModes, function(i, viewMode){
				if (view === i || $.inArray(view, viewMode.names) !== -1){
					view = i;
					return false;
				}
			});

			return view;
		},

		_resolveDaysOfWeek: function(daysOfWeek){
			if (!$.isArray(daysOfWeek))
				daysOfWeek = daysOfWeek.split(/[,\s]*/);
			return $.map(daysOfWeek, Number);
		},

		_check_template: function(tmp){
			try {
				// If empty
				if (tmp === undefined || tmp === "") {
					return false;
				}
				// If no html, everything ok
				if ((tmp.match(/[<>]/g) || []).length <= 0) {
					return true;
				}
				// Checking if html is fine
				var jDom = $(tmp);
				return jDom.length > 0;
			}
			catch (ex) {
				return false;
			}
		},

		_process_options: function(opts){
			// Store raw options for reference
			this._o = $.extend({}, this._o, opts);
			// Processed options
			var o = this.o = $.extend({}, this._o);

			// Check if "de-DE" style date is available, if not language should
			// fallback to 2 letter code eg "de"
			var lang = o.language;
			if (!dates[lang]){
				lang = lang.split('-')[0];
				if (!dates[lang])
					lang = defaults.language;
			}
			o.language = lang;

			// Retrieve view index from any aliases
			o.startView = this._resolveViewName(o.startView);
			o.minViewMode = this._resolveViewName(o.minViewMode);
			o.maxViewMode = this._resolveViewName(o.maxViewMode);

			// Check view is between min and max
			o.startView = Math.max(this.o.minViewMode, Math.min(this.o.maxViewMode, o.startView));

			// true, false, or Number > 0
			if (o.multidate !== true){
				o.multidate = Number(o.multidate) || false;
				if (o.multidate !== false)
					o.multidate = Math.max(0, o.multidate);
			}
			o.multidateSeparator = String(o.multidateSeparator);

			o.weekStart %= 7;
			o.weekEnd = (o.weekStart + 6) % 7;

			var format = DPGlobal.parseFormat(o.format);
			if (o.startDate !== -Infinity){
				if (!!o.startDate){
					if (o.startDate instanceof Date)
						o.startDate = this._local_to_utc(this._zero_time(o.startDate));
					else
						o.startDate = DPGlobal.parseDate(o.startDate, format, o.language, o.assumeNearbyYear);
				}
				else {
					o.startDate = -Infinity;
				}
			}
			if (o.endDate !== Infinity){
				if (!!o.endDate){
					if (o.endDate instanceof Date)
						o.endDate = this._local_to_utc(this._zero_time(o.endDate));
					else
						o.endDate = DPGlobal.parseDate(o.endDate, format, o.language, o.assumeNearbyYear);
				}
				else {
					o.endDate = Infinity;
				}
			}

			o.daysOfWeekDisabled = this._resolveDaysOfWeek(o.daysOfWeekDisabled||[]);
			o.daysOfWeekHighlighted = this._resolveDaysOfWeek(o.daysOfWeekHighlighted||[]);

			o.datesDisabled = o.datesDisabled||[];
			if (!$.isArray(o.datesDisabled)) {
				o.datesDisabled = o.datesDisabled.split(',');
			}
			o.datesDisabled = $.map(o.datesDisabled, function(d){
				return DPGlobal.parseDate(d, format, o.language, o.assumeNearbyYear);
			});

			var plc = String(o.orientation).toLowerCase().split(/\s+/g),
				_plc = o.orientation.toLowerCase();
			plc = $.grep(plc, function(word){
				return /^auto|left|right|top|bottom$/.test(word);
			});
			o.orientation = {x: 'auto', y: 'auto'};
			if (!_plc || _plc === 'auto')
				; // no action
			else if (plc.length === 1){
				switch (plc[0]){
					case 'top':
					case 'bottom':
						o.orientation.y = plc[0];
						break;
					case 'left':
					case 'right':
						o.orientation.x = plc[0];
						break;
				}
			}
			else {
				_plc = $.grep(plc, function(word){
					return /^left|right$/.test(word);
				});
				o.orientation.x = _plc[0] || 'auto';

				_plc = $.grep(plc, function(word){
					return /^top|bottom$/.test(word);
				});
				o.orientation.y = _plc[0] || 'auto';
			}
			if (o.defaultViewDate instanceof Date || typeof o.defaultViewDate === 'string') {
				o.defaultViewDate = DPGlobal.parseDate(o.defaultViewDate, format, o.language, o.assumeNearbyYear);
			} else if (o.defaultViewDate) {
				var year = o.defaultViewDate.year || new Date().getFullYear();
				var month = o.defaultViewDate.month || 0;
				var day = o.defaultViewDate.day || 1;
				o.defaultViewDate = UTCDate(year, month, day);
			} else {
				o.defaultViewDate = UTCToday();
			}
		},
		_applyEvents: function(evs){
			for (var i=0, el, ch, ev; i < evs.length; i++){
				el = evs[i][0];
				if (evs[i].length === 2){
					ch = undefined;
					ev = evs[i][1];
				} else if (evs[i].length === 3){
					ch = evs[i][1];
					ev = evs[i][2];
				}
				el.on(ev, ch);
			}
		},
		_unapplyEvents: function(evs){
			for (var i=0, el, ev, ch; i < evs.length; i++){
				el = evs[i][0];
				if (evs[i].length === 2){
					ch = undefined;
					ev = evs[i][1];
				} else if (evs[i].length === 3){
					ch = evs[i][1];
					ev = evs[i][2];
				}
				el.off(ev, ch);
			}
		},
		_buildEvents: function(){
            var events = {
                keyup: $.proxy(function(e){
                    if ($.inArray(e.keyCode, [27, 37, 39, 38, 40, 32, 13, 9]) === -1)
                        this.update();
                }, this),
                keydown: $.proxy(this.keydown, this),
                paste: $.proxy(this.paste, this)
            };

            if (this.o.showOnFocus === true) {
                events.focus = $.proxy(this.show, this);
            }

            if (this.isInput) { // single input
                this._events = [
                    [this.element, events]
                ];
            }
            // component: input + button
            else if (this.component && this.inputField.length) {
                this._events = [
                    // For components that are not readonly, allow keyboard nav
                    [this.inputField, events],
                    [this.component, {
                        click: $.proxy(this.show, this)
                    }]
                ];
            }
			else {
				this._events = [
					[this.element, {
						click: $.proxy(this.show, this),
						keydown: $.proxy(this.keydown, this)
					}]
				];
			}
			this._events.push(
				// Component: listen for blur on element descendants
				[this.element, '*', {
					blur: $.proxy(function(e){
						this._focused_from = e.target;
					}, this)
				}],
				// Input: listen for blur on element
				[this.element, {
					blur: $.proxy(function(e){
						this._focused_from = e.target;
					}, this)
				}]
			);

			if (this.o.immediateUpdates) {
				// Trigger input updates immediately on changed year/month
				this._events.push([this.element, {
					'changeYear changeMonth': $.proxy(function(e){
						this.update(e.date);
					}, this)
				}]);
			}

			this._secondaryEvents = [
				[this.picker, {
					click: $.proxy(this.click, this)
				}],
				[this.picker, '.prev, .next', {
					click: $.proxy(this.navArrowsClick, this)
				}],
				[this.picker, '.day:not(.disabled)', {
					click: $.proxy(this.dayCellClick, this)
				}],
				[$(window), {
					resize: $.proxy(this.place, this)
				}],
				[$(document), {
					'mousedown touchstart': $.proxy(function(e){
						// Clicked outside the datepicker, hide it
						if (!(
							this.element.is(e.target) ||
							this.element.find(e.target).length ||
							this.picker.is(e.target) ||
							this.picker.find(e.target).length ||
							this.isInline
						)){
							this.hide();
						}
					}, this)
				}]
			];
		},
		_attachEvents: function(){
			this._detachEvents();
			this._applyEvents(this._events);
		},
		_detachEvents: function(){
			this._unapplyEvents(this._events);
		},
		_attachSecondaryEvents: function(){
			this._detachSecondaryEvents();
			this._applyEvents(this._secondaryEvents);
		},
		_detachSecondaryEvents: function(){
			this._unapplyEvents(this._secondaryEvents);
		},
		_trigger: function(event, altdate){
			var date = altdate || this.dates.get(-1),
				local_date = this._utc_to_local(date);

			this.element.trigger({
				type: event,
				date: local_date,
				viewMode: this.viewMode,
				dates: $.map(this.dates, this._utc_to_local),
				format: $.proxy(function(ix, format){
					if (arguments.length === 0){
						ix = this.dates.length - 1;
						format = this.o.format;
					} else if (typeof ix === 'string'){
						format = ix;
						ix = this.dates.length - 1;
					}
					format = format || this.o.format;
					var date = this.dates.get(ix);
					return DPGlobal.formatDate(date, format, this.o.language);
				}, this)
			});
		},

		show: function(){
			if (this.inputField.is(':disabled') || (this.inputField.prop('readonly') && this.o.enableOnReadonly === false))
				return;
			if (!this.isInline)
				this.picker.appendTo(this.o.container);
			this.place();
			this.picker.show();
			this._attachSecondaryEvents();
			this._trigger('show');
			if ((window.navigator.msMaxTouchPoints || 'ontouchstart' in document) && this.o.disableTouchKeyboard) {
				$(this.element).blur();
			}
			return this;
		},

		hide: function(){
			if (this.isInline || !this.picker.is(':visible'))
				return this;
			this.focusDate = null;
			this.picker.hide().detach();
			this._detachSecondaryEvents();
			this.setViewMode(this.o.startView);

			if (this.o.forceParse && this.inputField.val())
				this.setValue();
			this._trigger('hide');
			return this;
		},

		destroy: function(){
			this.hide();
			this._detachEvents();
			this._detachSecondaryEvents();
			this.picker.remove();
			delete this.element.data().datepicker;
			if (!this.isInput){
				delete this.element.data().date;
			}
			return this;
		},

		paste: function(e){
			var dateString;
			if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.types
				&& $.inArray('text/plain', e.originalEvent.clipboardData.types) !== -1) {
				dateString = e.originalEvent.clipboardData.getData('text/plain');
			} else if (window.clipboardData) {
				dateString = window.clipboardData.getData('Text');
			} else {
				return;
			}
			this.setDate(dateString);
			this.update();
			e.preventDefault();
		},

		_utc_to_local: function(utc){
			if (!utc) {
				return utc;
			}

			var local = new Date(utc.getTime() + (utc.getTimezoneOffset() * 60000));

			if (local.getTimezoneOffset() !== utc.getTimezoneOffset()) {
				local = new Date(utc.getTime() + (local.getTimezoneOffset() * 60000));
			}

			return local;
		},
		_local_to_utc: function(local){
			return local && new Date(local.getTime() - (local.getTimezoneOffset()*60000));
		},
		_zero_time: function(local){
			return local && new Date(local.getFullYear(), local.getMonth(), local.getDate());
		},
		_zero_utc_time: function(utc){
			return utc && UTCDate(utc.getUTCFullYear(), utc.getUTCMonth(), utc.getUTCDate());
		},

		getDates: function(){
			return $.map(this.dates, this._utc_to_local);
		},

		getUTCDates: function(){
			return $.map(this.dates, function(d){
				return new Date(d);
			});
		},

		getDate: function(){
			return this._utc_to_local(this.getUTCDate());
		},

		getUTCDate: function(){
			var selected_date = this.dates.get(-1);
			if (selected_date !== undefined) {
				return new Date(selected_date);
			} else {
				return null;
			}
		},

		clearDates: function(){
			this.inputField.val('');
			this._trigger('changeDate');
			this.update();
			if (this.o.autoclose) {
				this.hide();
			}
		},

		setDates: function(){
			var args = $.isArray(arguments[0]) ? arguments[0] : arguments;
			this.update.apply(this, args);
			this._trigger('changeDate');
			this.setValue();
			return this;
		},

		setUTCDates: function(){
			var args = $.isArray(arguments[0]) ? arguments[0] : arguments;
			this.setDates.apply(this, $.map(args, this._utc_to_local));
			return this;
		},

		setDate: alias('setDates'),
		setUTCDate: alias('setUTCDates'),
		remove: alias('destroy', 'Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead'),

		setValue: function(){
			var formatted = this.getFormattedDate();
			this.inputField.val(formatted);
			return this;
		},

		getFormattedDate: function(format){
			if (format === undefined)
				format = this.o.format;

			var lang = this.o.language;
			return $.map(this.dates, function(d){
				return DPGlobal.formatDate(d, format, lang);
			}).join(this.o.multidateSeparator);
		},

		getStartDate: function(){
			return this.o.startDate;
		},

		setStartDate: function(startDate){
			this._process_options({startDate: startDate});
			this.update();
			this.updateNavArrows();
			return this;
		},

		getEndDate: function(){
			return this.o.endDate;
		},

		setEndDate: function(endDate){
			this._process_options({endDate: endDate});
			this.update();
			this.updateNavArrows();
			return this;
		},

		setDaysOfWeekDisabled: function(daysOfWeekDisabled){
			this._process_options({daysOfWeekDisabled: daysOfWeekDisabled});
			this.update();
			return this;
		},

		setDaysOfWeekHighlighted: function(daysOfWeekHighlighted){
			this._process_options({daysOfWeekHighlighted: daysOfWeekHighlighted});
			this.update();
			return this;
		},

		setDatesDisabled: function(datesDisabled){
			this._process_options({datesDisabled: datesDisabled});
			this.update();
			return this;
		},

		place: function(){
			if (this.isInline)
				return this;
			var calendarWidth = this.picker.outerWidth(),
				calendarHeight = this.picker.outerHeight(),
				visualPadding = 10,
				container = $(this.o.container),
				windowWidth = container.width(),
				scrollTop = this.o.container === 'body' ? $(document).scrollTop() : container.scrollTop(),
				appendOffset = container.offset();

			var parentsZindex = [0];
			this.element.parents().each(function(){
				var itemZIndex = $(this).css('z-index');
				if (itemZIndex !== 'auto' && Number(itemZIndex) !== 0) parentsZindex.push(Number(itemZIndex));
			});
			var zIndex = Math.max.apply(Math, parentsZindex) + this.o.zIndexOffset;
			var offset = this.component ? this.component.parent().offset() : this.element.offset();
			var height = this.component ? this.component.outerHeight(true) : this.element.outerHeight(false);
			var width = this.component ? this.component.outerWidth(true) : this.element.outerWidth(false);
			var left = offset.left - appendOffset.left;
			var top = offset.top - appendOffset.top;

			if (this.o.container !== 'body') {
				top += scrollTop;
			}

			this.picker.removeClass(
				'datepicker-orient-top datepicker-orient-bottom '+
				'datepicker-orient-right datepicker-orient-left'
			);

			if (this.o.orientation.x !== 'auto'){
				this.picker.addClass('datepicker-orient-' + this.o.orientation.x);
				if (this.o.orientation.x === 'right')
					left -= calendarWidth - width;
			}
			// auto x orientation is best-placement: if it crosses a window
			// edge, fudge it sideways
			else {
				if (offset.left < 0) {
					// component is outside the window on the left side. Move it into visible range
					this.picker.addClass('datepicker-orient-left');
					left -= offset.left - visualPadding;
				} else if (left + calendarWidth > windowWidth) {
					// the calendar passes the widow right edge. Align it to component right side
					this.picker.addClass('datepicker-orient-right');
					left += width - calendarWidth;
				} else {
					if (this.o.rtl) {
						// Default to right
						this.picker.addClass('datepicker-orient-right');
					} else {
						// Default to left
						this.picker.addClass('datepicker-orient-left');
					}
				}
			}

			// auto y orientation is best-situation: top or bottom, no fudging,
			// decision based on which shows more of the calendar
			var yorient = this.o.orientation.y,
				top_overflow;
			if (yorient === 'auto'){
				top_overflow = -scrollTop + top - calendarHeight;
				yorient = top_overflow < 0 ? 'bottom' : 'top';
			}

			this.picker.addClass('datepicker-orient-' + yorient);
			if (yorient === 'top')
				top -= calendarHeight + parseInt(this.picker.css('padding-top'));
			else
				top += height;

			if (this.o.rtl) {
				var right = windowWidth - (left + width);
				this.picker.css({
					top: top,
					right: right,
					zIndex: zIndex
				});
			} else {
				this.picker.css({
					top: top,
					left: left,
					zIndex: zIndex
				});
			}
			return this;
		},

		_allow_update: true,
		update: function(){
			if (!this._allow_update)
				return this;

			var oldDates = this.dates.copy(),
				dates = [],
				fromArgs = false;
			if (arguments.length){
				$.each(arguments, $.proxy(function(i, date){
					if (date instanceof Date)
						date = this._local_to_utc(date);
					dates.push(date);
				}, this));
				fromArgs = true;
			} else {
				dates = this.isInput
						? this.element.val()
						: this.element.data('date') || this.inputField.val();
				if (dates && this.o.multidate)
					dates = dates.split(this.o.multidateSeparator);
				else
					dates = [dates];
				delete this.element.data().date;
			}

			dates = $.map(dates, $.proxy(function(date){
				return DPGlobal.parseDate(date, this.o.format, this.o.language, this.o.assumeNearbyYear);
			}, this));
			dates = $.grep(dates, $.proxy(function(date){
				return (
					!this.dateWithinRange(date) ||
					!date
				);
			}, this), true);
			this.dates.replace(dates);

			if (this.o.updateViewDate) {
				if (this.dates.length)
					this.viewDate = new Date(this.dates.get(-1));
				else if (this.viewDate < this.o.startDate)
					this.viewDate = new Date(this.o.startDate);
				else if (this.viewDate > this.o.endDate)
					this.viewDate = new Date(this.o.endDate);
				else
					this.viewDate = this.o.defaultViewDate;
			}

			if (fromArgs){
				// setting date by clicking
				this.setValue();
				this.element.change();
			}
			else if (this.dates.length){
				// setting date by typing
				if (String(oldDates) !== String(this.dates) && fromArgs) {
					this._trigger('changeDate');
					this.element.change();
				}
			}
			if (!this.dates.length && oldDates.length) {
				this._trigger('clearDate');
				this.element.change();
			}

			this.fill();
			return this;
		},

		fillDow: function(){
      if (this.o.showWeekDays) {
			var dowCnt = this.o.weekStart,
				html = '<tr>';
			if (this.o.calendarWeeks){
				html += '<th class="cw">&#160;</th>';
			}
			while (dowCnt < this.o.weekStart + 7){
				html += '<th class="dow';
        if ($.inArray(dowCnt, this.o.daysOfWeekDisabled) !== -1)
          html += ' disabled';
        html += '">'+dates[this.o.language].daysMin[(dowCnt++)%7]+'</th>';
			}
			html += '</tr>';
			this.picker.find('.datepicker-days thead').append(html);
      }
		},

		fillMonths: function(){
      var localDate = this._utc_to_local(this.viewDate);
			var html = '';
			var focused;
			for (var i = 0; i < 12; i++){
				focused = localDate && localDate.getMonth() === i ? ' focused' : '';
				html += '<span class="month' + focused + '">' + dates[this.o.language].monthsShort[i] + '</span>';
			}
			this.picker.find('.datepicker-months td').html(html);
		},

		setRange: function(range){
			if (!range || !range.length)
				delete this.range;
			else
				this.range = $.map(range, function(d){
					return d.valueOf();
				});
			this.fill();
		},

		getClassNames: function(date){
			var cls = [],
				year = this.viewDate.getUTCFullYear(),
				month = this.viewDate.getUTCMonth(),
				today = UTCToday();
			if (date.getUTCFullYear() < year || (date.getUTCFullYear() === year && date.getUTCMonth() < month)){
				cls.push('old');
			} else if (date.getUTCFullYear() > year || (date.getUTCFullYear() === year && date.getUTCMonth() > month)){
				cls.push('new');
			}
			if (this.focusDate && date.valueOf() === this.focusDate.valueOf())
				cls.push('focused');
			// Compare internal UTC date with UTC today, not local today
			if (this.o.todayHighlight && isUTCEquals(date, today)) {
				cls.push('today');
			}
			if (this.dates.contains(date) !== -1)
				cls.push('active');
			if (!this.dateWithinRange(date)){
				cls.push('disabled');
			}
			if (this.dateIsDisabled(date)){
				cls.push('disabled', 'disabled-date');
			}
			if ($.inArray(date.getUTCDay(), this.o.daysOfWeekHighlighted) !== -1){
				cls.push('highlighted');
			}

			if (this.range){
				if (date > this.range[0] && date < this.range[this.range.length-1]){
					cls.push('range');
				}
				if ($.inArray(date.valueOf(), this.range) !== -1){
					cls.push('selected');
				}
				if (date.valueOf() === this.range[0]){
          cls.push('range-start');
        }
        if (date.valueOf() === this.range[this.range.length-1]){
          cls.push('range-end');
        }
			}
			return cls;
		},

		_fill_yearsView: function(selector, cssClass, factor, year, startYear, endYear, beforeFn){
			var html = '';
			var step = factor / 10;
			var view = this.picker.find(selector);
			var startVal = Math.floor(year / factor) * factor;
			var endVal = startVal + step * 9;
			var focusedVal = Math.floor(this.viewDate.getFullYear() / step) * step;
			var selected = $.map(this.dates, function(d){
				return Math.floor(d.getUTCFullYear() / step) * step;
			});

			var classes, tooltip, before;
			for (var currVal = startVal - step; currVal <= endVal + step; currVal += step) {
				classes = [cssClass];
				tooltip = null;

				if (currVal === startVal - step) {
					classes.push('old');
				} else if (currVal === endVal + step) {
					classes.push('new');
				}
				if ($.inArray(currVal, selected) !== -1) {
					classes.push('active');
				}
				if (currVal < startYear || currVal > endYear) {
					classes.push('disabled');
				}
				if (currVal === focusedVal) {
				  classes.push('focused');
        }

				if (beforeFn !== $.noop) {
					before = beforeFn(new Date(currVal, 0, 1));
					if (before === undefined) {
						before = {};
					} else if (typeof before === 'boolean') {
						before = {enabled: before};
					} else if (typeof before === 'string') {
						before = {classes: before};
					}
					if (before.enabled === false) {
						classes.push('disabled');
					}
					if (before.classes) {
						classes = classes.concat(before.classes.split(/\s+/));
					}
					if (before.tooltip) {
						tooltip = before.tooltip;
					}
				}

				html += '<span class="' + classes.join(' ') + '"' + (tooltip ? ' title="' + tooltip + '"' : '') + '>' + currVal + '</span>';
			}

			view.find('.datepicker-switch').text(startVal + '-' + endVal);
			view.find('td').html(html);
		},

		fill: function(){
			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth(),
				startYear = this.o.startDate !== -Infinity ? this.o.startDate.getUTCFullYear() : -Infinity,
				startMonth = this.o.startDate !== -Infinity ? this.o.startDate.getUTCMonth() : -Infinity,
				endYear = this.o.endDate !== Infinity ? this.o.endDate.getUTCFullYear() : Infinity,
				endMonth = this.o.endDate !== Infinity ? this.o.endDate.getUTCMonth() : Infinity,
				todaytxt = dates[this.o.language].today || dates['en'].today || '',
				cleartxt = dates[this.o.language].clear || dates['en'].clear || '',
        titleFormat = dates[this.o.language].titleFormat || dates['en'].titleFormat,
        todayDate = UTCToday(),
        titleBtnVisible = (this.o.todayBtn === true || this.o.todayBtn === 'linked') && todayDate >= this.o.startDate && todayDate <= this.o.endDate && !this.weekOfDateIsDisabled(todayDate),
				tooltip,
				before;
			if (isNaN(year) || isNaN(month))
				return;
			this.picker.find('.datepicker-days .datepicker-switch')
						.text(DPGlobal.formatDate(d, titleFormat, this.o.language));
			this.picker.find('tfoot .today')
						.text(todaytxt)
            .css('display', titleBtnVisible ? 'table-cell' : 'none');
			this.picker.find('tfoot .clear')
						.text(cleartxt)
						.css('display', this.o.clearBtn === true ? 'table-cell' : 'none');
			this.picker.find('thead .datepicker-title')
						.text(this.o.title)
						.css('display', typeof this.o.title === 'string' && this.o.title !== '' ? 'table-cell' : 'none');
			this.updateNavArrows();
			this.fillMonths();
			var prevMonth = UTCDate(year, month, 0),
				day = prevMonth.getUTCDate();
			prevMonth.setUTCDate(day - (prevMonth.getUTCDay() - this.o.weekStart + 7)%7);
			var nextMonth = new Date(prevMonth);
			if (prevMonth.getUTCFullYear() < 100){
        nextMonth.setUTCFullYear(prevMonth.getUTCFullYear());
      }
			nextMonth.setUTCDate(nextMonth.getUTCDate() + 42);
			nextMonth = nextMonth.valueOf();
			var html = [];
			var weekDay, clsName;
			while (prevMonth.valueOf() < nextMonth){
				weekDay = prevMonth.getUTCDay();
				if (weekDay === this.o.weekStart){
					html.push('<tr>');
					if (this.o.calendarWeeks){
						// ISO 8601: First week contains first thursday.
						// ISO also states week starts on Monday, but we can be more abstract here.
						var
							// Start of current week: based on weekstart/current date
							ws = new Date(+prevMonth + (this.o.weekStart - weekDay - 7) % 7 * 864e5),
							// Thursday of this week
							th = new Date(Number(ws) + (7 + 4 - ws.getUTCDay()) % 7 * 864e5),
							// First Thursday of year, year from thursday
							yth = new Date(Number(yth = UTCDate(th.getUTCFullYear(), 0, 1)) + (7 + 4 - yth.getUTCDay()) % 7 * 864e5),
							// Calendar week: ms between thursdays, div ms per day, div 7 days
							calWeek = (th - yth) / 864e5 / 7 + 1;
						html.push('<td class="cw">'+ calWeek +'</td>');
					}
				}
				clsName = this.getClassNames(prevMonth);
				clsName.push('day');

				var content = prevMonth.getUTCDate();

				if (this.o.beforeShowDay !== $.noop){
					before = this.o.beforeShowDay(this._utc_to_local(prevMonth));
					if (before === undefined)
						before = {};
					else if (typeof before === 'boolean')
						before = {enabled: before};
					else if (typeof before === 'string')
						before = {classes: before};
					if (before.enabled === false)
						clsName.push('disabled');
					if (before.classes)
						clsName = clsName.concat(before.classes.split(/\s+/));
					if (before.tooltip)
						tooltip = before.tooltip;
					if (before.content)
						content = before.content;
				}

				//Check if uniqueSort exists (supported by jquery >=1.12 and >=2.2)
				//Fallback to unique function for older jquery versions
				if ($.isFunction($.uniqueSort)) {
					clsName = $.uniqueSort(clsName);
				} else {
					clsName = $.unique(clsName);
				}

				html.push('<td class="'+clsName.join(' ')+'"' + (tooltip ? ' title="'+tooltip+'"' : '') + ' data-date="' + prevMonth.getTime().toString() + '">' + content + '</td>');
				tooltip = null;
				if (weekDay === this.o.weekEnd){
					html.push('</tr>');
				}
				prevMonth.setUTCDate(prevMonth.getUTCDate() + 1);
			}
			this.picker.find('.datepicker-days tbody').html(html.join(''));

			var monthsTitle = dates[this.o.language].monthsTitle || dates['en'].monthsTitle || 'Months';
			var months = this.picker.find('.datepicker-months')
						.find('.datepicker-switch')
							.text(this.o.maxViewMode < 2 ? monthsTitle : year)
							.end()
						.find('tbody span').removeClass('active');

			$.each(this.dates, function(i, d){
				if (d.getUTCFullYear() === year)
					months.eq(d.getUTCMonth()).addClass('active');
			});

			if (year < startYear || year > endYear){
				months.addClass('disabled');
			}
			if (year === startYear){
				months.slice(0, startMonth).addClass('disabled');
			}
			if (year === endYear){
				months.slice(endMonth+1).addClass('disabled');
			}

			if (this.o.beforeShowMonth !== $.noop){
				var that = this;
				$.each(months, function(i, month){
          var moDate = new Date(year, i, 1);
          var before = that.o.beforeShowMonth(moDate);
					if (before === undefined)
						before = {};
					else if (typeof before === 'boolean')
						before = {enabled: before};
					else if (typeof before === 'string')
						before = {classes: before};
					if (before.enabled === false && !$(month).hasClass('disabled'))
					    $(month).addClass('disabled');
					if (before.classes)
					    $(month).addClass(before.classes);
					if (before.tooltip)
					    $(month).prop('title', before.tooltip);
				});
			}

			// Generating decade/years picker
			this._fill_yearsView(
				'.datepicker-years',
				'year',
				10,
				year,
				startYear,
				endYear,
				this.o.beforeShowYear
			);

			// Generating century/decades picker
			this._fill_yearsView(
				'.datepicker-decades',
				'decade',
				100,
				year,
				startYear,
				endYear,
				this.o.beforeShowDecade
			);

			// Generating millennium/centuries picker
			this._fill_yearsView(
				'.datepicker-centuries',
				'century',
				1000,
				year,
				startYear,
				endYear,
				this.o.beforeShowCentury
			);
		},

		updateNavArrows: function(){
			if (!this._allow_update)
				return;

			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth(),
				startYear = this.o.startDate !== -Infinity ? this.o.startDate.getUTCFullYear() : -Infinity,
				startMonth = this.o.startDate !== -Infinity ? this.o.startDate.getUTCMonth() : -Infinity,
				endYear = this.o.endDate !== Infinity ? this.o.endDate.getUTCFullYear() : Infinity,
				endMonth = this.o.endDate !== Infinity ? this.o.endDate.getUTCMonth() : Infinity,
				prevIsDisabled,
				nextIsDisabled,
				factor = 1;
			switch (this.viewMode){
				case 4:
					factor *= 10;
					/* falls through */
				case 3:
					factor *= 10;
					/* falls through */
				case 2:
					factor *= 10;
					/* falls through */
				case 1:
					prevIsDisabled = Math.floor(year / factor) * factor <= startYear;
					nextIsDisabled = Math.floor(year / factor) * factor + factor > endYear;
					break;
				case 0:
					prevIsDisabled = year <= startYear && month <= startMonth;
					nextIsDisabled = year >= endYear && month >= endMonth;
					break;
			}

			this.picker.find('.prev').toggleClass('disabled', prevIsDisabled);
			this.picker.find('.next').toggleClass('disabled', nextIsDisabled);
		},

		click: function(e){
			e.preventDefault();
			e.stopPropagation();

			var target, dir, day, year, month;
			target = $(e.target);

			// Clicked on the switch
			if (target.hasClass('datepicker-switch') && this.viewMode !== this.o.maxViewMode){
				this.setViewMode(this.viewMode + 1);
			}

			// Clicked on today button
			if (target.hasClass('today') && !target.hasClass('day')){
				this.setViewMode(0);
				this._setDate(UTCToday(), this.o.todayBtn === 'linked' ? null : 'view');
			}

			// Clicked on clear button
			if (target.hasClass('clear')){
				this.clearDates();
			}

			if (!target.hasClass('disabled')){
				// Clicked on a month, year, decade, century
				if (target.hasClass('month')
						|| target.hasClass('year')
						|| target.hasClass('decade')
						|| target.hasClass('century')) {
					this.viewDate.setUTCDate(1);

					day = 1;
					if (this.viewMode === 1){
						month = target.parent().find('span').index(target);
						year = this.viewDate.getUTCFullYear();
						this.viewDate.setUTCMonth(month);
					} else {
						month = 0;
						year = Number(target.text());
						this.viewDate.setUTCFullYear(year);
					}

					this._trigger(DPGlobal.viewModes[this.viewMode - 1].e, this.viewDate);

					if (this.viewMode === this.o.minViewMode){
						this._setDate(UTCDate(year, month, day));
					} else {
						this.setViewMode(this.viewMode - 1);
						this.fill();
					}
				}
			}

			if (this.picker.is(':visible') && this._focused_from){
				this._focused_from.focus();
			}
			delete this._focused_from;
		},

		dayCellClick: function(e){
			var $target = $(e.currentTarget);
			var timestamp = $target.data('date');
			var date = new Date(timestamp);

			if (this.o.updateViewDate) {
				if (date.getUTCFullYear() !== this.viewDate.getUTCFullYear()) {
					this._trigger('changeYear', this.viewDate);
				}

				if (date.getUTCMonth() !== this.viewDate.getUTCMonth()) {
					this._trigger('changeMonth', this.viewDate);
				}
			}
			this._setDate(date);
		},

		// Clicked on prev or next
		navArrowsClick: function(e){
			var $target = $(e.currentTarget);
			var dir = $target.hasClass('prev') ? -1 : 1;
			if (this.viewMode !== 0){
				dir *= DPGlobal.viewModes[this.viewMode].navStep * 12;
			}
			this.viewDate = this.moveMonth(this.viewDate, dir);
			this._trigger(DPGlobal.viewModes[this.viewMode].e, this.viewDate);
			this.fill();
		},

		_toggle_multidate: function(date){
			var ix = this.dates.contains(date);
			if (!date){
				this.dates.clear();
			}

			if (ix !== -1){
				if (this.o.multidate === true || this.o.multidate > 1 || this.o.toggleActive){
					this.dates.remove(ix);
				}
			} else if (this.o.multidate === false) {
				this.dates.clear();
				this.dates.push(date);
			}
			else {
				this.dates.push(date);
			}

			if (typeof this.o.multidate === 'number')
				while (this.dates.length > this.o.multidate)
					this.dates.remove(0);
		},

		_setDate: function(date, which){
			if (!which || which === 'date')
				this._toggle_multidate(date && new Date(date));
			if ((!which && this.o.updateViewDate) || which === 'view')
				this.viewDate = date && new Date(date);

			this.fill();
			this.setValue();
			if (!which || which !== 'view') {
				this._trigger('changeDate');
			}
			this.inputField.trigger('change');
			if (this.o.autoclose && (!which || which === 'date')){
				this.hide();
			}
		},

		moveDay: function(date, dir){
			var newDate = new Date(date);
			newDate.setUTCDate(date.getUTCDate() + dir);

			return newDate;
		},

		moveWeek: function(date, dir){
			return this.moveDay(date, dir * 7);
		},

		moveMonth: function(date, dir){
			if (!isValidDate(date))
				return this.o.defaultViewDate;
			if (!dir)
				return date;
			var new_date = new Date(date.valueOf()),
				day = new_date.getUTCDate(),
				month = new_date.getUTCMonth(),
				mag = Math.abs(dir),
				new_month, test;
			dir = dir > 0 ? 1 : -1;
			if (mag === 1){
				test = dir === -1
					// If going back one month, make sure month is not current month
					// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)
					? function(){
						return new_date.getUTCMonth() === month;
					}
					// If going forward one month, make sure month is as expected
					// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)
					: function(){
						return new_date.getUTCMonth() !== new_month;
					};
				new_month = month + dir;
				new_date.setUTCMonth(new_month);
				// Dec -> Jan (12) or Jan -> Dec (-1) -- limit expected date to 0-11
				new_month = (new_month + 12) % 12;
			}
			else {
				// For magnitudes >1, move one month at a time...
				for (var i=0; i < mag; i++)
					// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...
					new_date = this.moveMonth(new_date, dir);
				// ...then reset the day, keeping it in the new month
				new_month = new_date.getUTCMonth();
				new_date.setUTCDate(day);
				test = function(){
					return new_month !== new_date.getUTCMonth();
				};
			}
			// Common date-resetting loop -- if date is beyond end of month, make it
			// end of month
			while (test()){
				new_date.setUTCDate(--day);
				new_date.setUTCMonth(new_month);
			}
			return new_date;
		},

		moveYear: function(date, dir){
			return this.moveMonth(date, dir*12);
		},

		moveAvailableDate: function(date, dir, fn){
			do {
				date = this[fn](date, dir);

				if (!this.dateWithinRange(date))
					return false;

				fn = 'moveDay';
			}
			while (this.dateIsDisabled(date));

			return date;
		},

		weekOfDateIsDisabled: function(date){
			return $.inArray(date.getUTCDay(), this.o.daysOfWeekDisabled) !== -1;
		},

		dateIsDisabled: function(date){
			return (
				this.weekOfDateIsDisabled(date) ||
				$.grep(this.o.datesDisabled, function(d){
					return isUTCEquals(date, d);
				}).length > 0
			);
		},

		dateWithinRange: function(date){
			return date >= this.o.startDate && date <= this.o.endDate;
		},

		keydown: function(e){
			if (!this.picker.is(':visible')){
				if (e.keyCode === 40 || e.keyCode === 27) { // allow down to re-show picker
					this.show();
					e.stopPropagation();
        }
				return;
			}
			var dateChanged = false,
				dir, newViewDate,
				focusDate = this.focusDate || this.viewDate;
			switch (e.keyCode){
				case 27: // escape
					if (this.focusDate){
						this.focusDate = null;
						this.viewDate = this.dates.get(-1) || this.viewDate;
						this.fill();
					}
					else
						this.hide();
					e.preventDefault();
					e.stopPropagation();
					break;
				case 37: // left
				case 38: // up
				case 39: // right
				case 40: // down
					if (!this.o.keyboardNavigation || this.o.daysOfWeekDisabled.length === 7)
						break;
					dir = e.keyCode === 37 || e.keyCode === 38 ? -1 : 1;
          if (this.viewMode === 0) {
  					if (e.ctrlKey){
  						newViewDate = this.moveAvailableDate(focusDate, dir, 'moveYear');

  						if (newViewDate)
  							this._trigger('changeYear', this.viewDate);
  					} else if (e.shiftKey){
  						newViewDate = this.moveAvailableDate(focusDate, dir, 'moveMonth');

  						if (newViewDate)
  							this._trigger('changeMonth', this.viewDate);
  					} else if (e.keyCode === 37 || e.keyCode === 39){
  						newViewDate = this.moveAvailableDate(focusDate, dir, 'moveDay');
  					} else if (!this.weekOfDateIsDisabled(focusDate)){
  						newViewDate = this.moveAvailableDate(focusDate, dir, 'moveWeek');
  					}
          } else if (this.viewMode === 1) {
            if (e.keyCode === 38 || e.keyCode === 40) {
              dir = dir * 4;
            }
            newViewDate = this.moveAvailableDate(focusDate, dir, 'moveMonth');
          } else if (this.viewMode === 2) {
            if (e.keyCode === 38 || e.keyCode === 40) {
              dir = dir * 4;
            }
            newViewDate = this.moveAvailableDate(focusDate, dir, 'moveYear');
          }
					if (newViewDate){
						this.focusDate = this.viewDate = newViewDate;
						this.setValue();
						this.fill();
						e.preventDefault();
					}
					break;
				case 13: // enter
					if (!this.o.forceParse)
						break;
					focusDate = this.focusDate || this.dates.get(-1) || this.viewDate;
					if (this.o.keyboardNavigation) {
						this._toggle_multidate(focusDate);
						dateChanged = true;
					}
					this.focusDate = null;
					this.viewDate = this.dates.get(-1) || this.viewDate;
					this.setValue();
					this.fill();
					if (this.picker.is(':visible')){
						e.preventDefault();
						e.stopPropagation();
						if (this.o.autoclose)
							this.hide();
					}
					break;
				case 9: // tab
					this.focusDate = null;
					this.viewDate = this.dates.get(-1) || this.viewDate;
					this.fill();
					this.hide();
					break;
			}
			if (dateChanged){
				if (this.dates.length)
					this._trigger('changeDate');
				else
					this._trigger('clearDate');
				this.inputField.trigger('change');
			}
		},

		setViewMode: function(viewMode){
			this.viewMode = viewMode;
			this.picker
				.children('div')
				.hide()
				.filter('.datepicker-' + DPGlobal.viewModes[this.viewMode].clsName)
					.show();
			this.updateNavArrows();
      this._trigger('changeViewMode', new Date(this.viewDate));
		}
	};

	var DateRangePicker = function(element, options){
		$.data(element, 'datepicker', this);
		this.element = $(element);
		this.inputs = $.map(options.inputs, function(i){
			return i.jquery ? i[0] : i;
		});
		delete options.inputs;

		this.keepEmptyValues = options.keepEmptyValues;
		delete options.keepEmptyValues;

		datepickerPlugin.call($(this.inputs), options)
			.on('changeDate', $.proxy(this.dateUpdated, this));

		this.pickers = $.map(this.inputs, function(i){
			return $.data(i, 'datepicker');
		});
		this.updateDates();
	};
	DateRangePicker.prototype = {
		updateDates: function(){
			this.dates = $.map(this.pickers, function(i){
				return i.getUTCDate();
			});
			this.updateRanges();
		},
		updateRanges: function(){
			var range = $.map(this.dates, function(d){
				return d.valueOf();
			});
			$.each(this.pickers, function(i, p){
				p.setRange(range);
			});
		},
		clearDates: function(){
			$.each(this.pickers, function(i, p){
				p.clearDates();
			});
		},
		dateUpdated: function(e){
			// `this.updating` is a workaround for preventing infinite recursion
			// between `changeDate` triggering and `setUTCDate` calling.  Until
			// there is a better mechanism.
			if (this.updating)
				return;
			this.updating = true;

			var dp = $.data(e.target, 'datepicker');

			if (dp === undefined) {
				return;
			}

			var new_date = dp.getUTCDate(),
				keep_empty_values = this.keepEmptyValues,
				i = $.inArray(e.target, this.inputs),
				j = i - 1,
				k = i + 1,
				l = this.inputs.length;
			if (i === -1)
				return;

			$.each(this.pickers, function(i, p){
				if (!p.getUTCDate() && (p === dp || !keep_empty_values))
					p.setUTCDate(new_date);
			});

			if (new_date < this.dates[j]){
				// Date being moved earlier/left
				while (j >= 0 && new_date < this.dates[j] && (this.pickers[j].element.val() || "").length > 0) {
					this.pickers[j--].setUTCDate(new_date);
				}
			} else if (new_date > this.dates[k]){
				// Date being moved later/right
				while (k < l && new_date > this.dates[k] && (this.pickers[k].element.val() || "").length > 0) {
					this.pickers[k++].setUTCDate(new_date);
				}
			}
			this.updateDates();

			delete this.updating;
		},
		destroy: function(){
			$.map(this.pickers, function(p){ p.destroy(); });
			$(this.inputs).off('changeDate', this.dateUpdated);
			delete this.element.data().datepicker;
		},
		remove: alias('destroy', 'Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead')
	};

	function opts_from_el(el, prefix){
		// Derive options from element data-attrs
		var data = $(el).data(),
			out = {}, inkey,
			replace = new RegExp('^' + prefix.toLowerCase() + '([A-Z])');
		prefix = new RegExp('^' + prefix.toLowerCase());
		function re_lower(_,a){
			return a.toLowerCase();
		}
		for (var key in data)
			if (prefix.test(key)){
				inkey = key.replace(replace, re_lower);
				out[inkey] = data[key];
			}
		return out;
	}

	function opts_from_locale(lang){
		// Derive options from locale plugins
		var out = {};
		// Check if "de-DE" style date is available, if not language should
		// fallback to 2 letter code eg "de"
		if (!dates[lang]){
			lang = lang.split('-')[0];
			if (!dates[lang])
				return;
		}
		var d = dates[lang];
		$.each(locale_opts, function(i,k){
			if (k in d)
				out[k] = d[k];
		});
		return out;
	}

	var old = $.fn.datepicker;
	var datepickerPlugin = function(option){
		var args = Array.apply(null, arguments);
		args.shift();
		var internal_return;
		this.each(function(){
			var $this = $(this),
				data = $this.data('datepicker'),
				options = typeof option === 'object' && option;
			if (!data){
				var elopts = opts_from_el(this, 'date'),
					// Preliminary otions
					xopts = $.extend({}, defaults, elopts, options),
					locopts = opts_from_locale(xopts.language),
					// Options priority: js args, data-attrs, locales, defaults
					opts = $.extend({}, defaults, locopts, elopts, options);
				if ($this.hasClass('input-daterange') || opts.inputs){
					$.extend(opts, {
						inputs: opts.inputs || $this.find('input').toArray()
					});
					data = new DateRangePicker(this, opts);
				}
				else {
					data = new Datepicker(this, opts);
				}
				$this.data('datepicker', data);
			}
			if (typeof option === 'string' && typeof data[option] === 'function'){
				internal_return = data[option].apply(data, args);
			}
		});

		if (
			internal_return === undefined ||
			internal_return instanceof Datepicker ||
			internal_return instanceof DateRangePicker
		)
			return this;

		if (this.length > 1)
			throw new Error('Using only allowed for the collection of a single element (' + option + ' function)');
		else
			return internal_return;
	};
	$.fn.datepicker = datepickerPlugin;

	var defaults = $.fn.datepicker.defaults = {
		assumeNearbyYear: false,
		autoclose: false,
		beforeShowDay: $.noop,
		beforeShowMonth: $.noop,
		beforeShowYear: $.noop,
		beforeShowDecade: $.noop,
		beforeShowCentury: $.noop,
		calendarWeeks: false,
		clearBtn: false,
		toggleActive: false,
		daysOfWeekDisabled: [],
		daysOfWeekHighlighted: [],
		datesDisabled: [],
		endDate: Infinity,
		forceParse: true,
		format: 'mm/dd/yyyy',
		isInline: null,
		keepEmptyValues: false,
		keyboardNavigation: true,
		language: 'en',
		minViewMode: 0,
		maxViewMode: 4,
		multidate: false,
		multidateSeparator: ',',
		orientation: "auto",
		rtl: false,
		startDate: -Infinity,
		startView: 0,
		todayBtn: false,
		todayHighlight: false,
		updateViewDate: true,
		weekStart: 0,
		disableTouchKeyboard: false,
		enableOnReadonly: true,
		showOnFocus: true,
		zIndexOffset: 10,
		container: 'body',
		immediateUpdates: false,
		title: '',
		templates: {
			leftArrow: '&#x00AB;',
			rightArrow: '&#x00BB;'
		},
    showWeekDays: true
	};
	var locale_opts = $.fn.datepicker.locale_opts = [
		'format',
		'rtl',
		'weekStart'
	];
	$.fn.datepicker.Constructor = Datepicker;
	var dates = $.fn.datepicker.dates = {
		en: {
			days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
			daysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
			daysMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
			months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
			monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
			today: "Today",
			clear: "Clear",
			titleFormat: "MM yyyy"
		}
	};

	var DPGlobal = {
		viewModes: [
			{
				names: ['days', 'month'],
				clsName: 'days',
				e: 'changeMonth'
			},
			{
				names: ['months', 'year'],
				clsName: 'months',
				e: 'changeYear',
				navStep: 1
			},
			{
				names: ['years', 'decade'],
				clsName: 'years',
				e: 'changeDecade',
				navStep: 10
			},
			{
				names: ['decades', 'century'],
				clsName: 'decades',
				e: 'changeCentury',
				navStep: 100
			},
			{
				names: ['centuries', 'millennium'],
				clsName: 'centuries',
				e: 'changeMillennium',
				navStep: 1000
			}
		],
		validParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g,
		nonpunctuation: /[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,
		parseFormat: function(format){
			if (typeof format.toValue === 'function' && typeof format.toDisplay === 'function')
                return format;
            // IE treats \0 as a string end in inputs (truncating the value),
			// so it's a bad format delimiter, anyway
			var separators = format.replace(this.validParts, '\0').split('\0'),
				parts = format.match(this.validParts);
			if (!separators || !separators.length || !parts || parts.length === 0){
				throw new Error("Invalid date format.");
			}
			return {separators: separators, parts: parts};
		},
		parseDate: function(date, format, language, assumeNearby){
			if (!date)
				return undefined;
			if (date instanceof Date)
				return date;
			if (typeof format === 'string')
				format = DPGlobal.parseFormat(format);
			if (format.toValue)
				return format.toValue(date, format, language);
			var fn_map = {
					d: 'moveDay',
					m: 'moveMonth',
					w: 'moveWeek',
					y: 'moveYear'
				},
				dateAliases = {
					yesterday: '-1d',
					today: '+0d',
					tomorrow: '+1d'
				},
				parts, part, dir, i, fn;
			if (date in dateAliases){
				date = dateAliases[date];
			}
			if (/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(date)){
				parts = date.match(/([\-+]\d+)([dmwy])/gi);
				date = new Date();
				for (i=0; i < parts.length; i++){
					part = parts[i].match(/([\-+]\d+)([dmwy])/i);
					dir = Number(part[1]);
					fn = fn_map[part[2].toLowerCase()];
					date = Datepicker.prototype[fn](date, dir);
				}
				return Datepicker.prototype._zero_utc_time(date);
			}

			parts = date && date.match(this.nonpunctuation) || [];

			function applyNearbyYear(year, threshold){
				if (threshold === true)
					threshold = 10;

				// if year is 2 digits or less, than the user most likely is trying to get a recent century
				if (year < 100){
					year += 2000;
					// if the new year is more than threshold years in advance, use last century
					if (year > ((new Date()).getFullYear()+threshold)){
						year -= 100;
					}
				}

				return year;
			}

			var parsed = {},
				setters_order = ['yyyy', 'yy', 'M', 'MM', 'm', 'mm', 'd', 'dd'],
				setters_map = {
					yyyy: function(d,v){
						return d.setUTCFullYear(assumeNearby ? applyNearbyYear(v, assumeNearby) : v);
					},
					m: function(d,v){
						if (isNaN(d))
							return d;
						v -= 1;
						while (v < 0) v += 12;
						v %= 12;
						d.setUTCMonth(v);
						while (d.getUTCMonth() !== v)
							d.setUTCDate(d.getUTCDate()-1);
						return d;
					},
					d: function(d,v){
						return d.setUTCDate(v);
					}
				},
				val, filtered;
			setters_map['yy'] = setters_map['yyyy'];
			setters_map['M'] = setters_map['MM'] = setters_map['mm'] = setters_map['m'];
			setters_map['dd'] = setters_map['d'];
			date = UTCToday();
			var fparts = format.parts.slice();
			// Remove noop parts
			if (parts.length !== fparts.length){
				fparts = $(fparts).filter(function(i,p){
					return $.inArray(p, setters_order) !== -1;
				}).toArray();
			}
			// Process remainder
			function match_part(){
				var m = this.slice(0, parts[i].length),
					p = parts[i].slice(0, m.length);
				return m.toLowerCase() === p.toLowerCase();
			}
			if (parts.length === fparts.length){
				var cnt;
				for (i=0, cnt = fparts.length; i < cnt; i++){
					val = parseInt(parts[i], 10);
					part = fparts[i];
					if (isNaN(val)){
						switch (part){
							case 'MM':
								filtered = $(dates[language].months).filter(match_part);
								val = $.inArray(filtered[0], dates[language].months) + 1;
								break;
							case 'M':
								filtered = $(dates[language].monthsShort).filter(match_part);
								val = $.inArray(filtered[0], dates[language].monthsShort) + 1;
								break;
						}
					}
					parsed[part] = val;
				}
				var _date, s;
				for (i=0; i < setters_order.length; i++){
					s = setters_order[i];
					if (s in parsed && !isNaN(parsed[s])){
						_date = new Date(date);
						setters_map[s](_date, parsed[s]);
						if (!isNaN(_date))
							date = _date;
					}
				}
			}
			return date;
		},
		formatDate: function(date, format, language){
			if (!date)
				return '';
			if (typeof format === 'string')
				format = DPGlobal.parseFormat(format);
			if (format.toDisplay)
                return format.toDisplay(date, format, language);
            var val = {
				d: date.getUTCDate(),
				D: dates[language].daysShort[date.getUTCDay()],
				DD: dates[language].days[date.getUTCDay()],
				m: date.getUTCMonth() + 1,
				M: dates[language].monthsShort[date.getUTCMonth()],
				MM: dates[language].months[date.getUTCMonth()],
				yy: date.getUTCFullYear().toString().substring(2),
				yyyy: date.getUTCFullYear()
			};
			val.dd = (val.d < 10 ? '0' : '') + val.d;
			val.mm = (val.m < 10 ? '0' : '') + val.m;
			date = [];
			var seps = $.extend([], format.separators);
			for (var i=0, cnt = format.parts.length; i <= cnt; i++){
				if (seps.length)
					date.push(seps.shift());
				date.push(val[format.parts[i]]);
			}
			return date.join('');
		},
		headTemplate: '<thead>'+
			              '<tr>'+
			                '<th colspan="7" class="datepicker-title"></th>'+
			              '</tr>'+
							'<tr>'+
								'<th class="prev">'+defaults.templates.leftArrow+'</th>'+
								'<th colspan="5" class="datepicker-switch"></th>'+
								'<th class="next">'+defaults.templates.rightArrow+'</th>'+
							'</tr>'+
						'</thead>',
		contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>',
		footTemplate: '<tfoot>'+
							'<tr>'+
								'<th colspan="7" class="today"></th>'+
							'</tr>'+
							'<tr>'+
								'<th colspan="7" class="clear"></th>'+
							'</tr>'+
						'</tfoot>'
	};
	DPGlobal.template = '<div class="datepicker">'+
							'<div class="datepicker-days">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									'<tbody></tbody>'+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-months">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-years">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-decades">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
							'<div class="datepicker-centuries">'+
								'<table class="table-condensed">'+
									DPGlobal.headTemplate+
									DPGlobal.contTemplate+
									DPGlobal.footTemplate+
								'</table>'+
							'</div>'+
						'</div>';

	$.fn.datepicker.DPGlobal = DPGlobal;


	/* DATEPICKER NO CONFLICT
	* =================== */

	$.fn.datepicker.noConflict = function(){
		$.fn.datepicker = old;
		return this;
	};

	/* DATEPICKER VERSION
	 * =================== */
	$.fn.datepicker.version = '1.9.0';

	$.fn.datepicker.deprecated = function(msg){
		var console = window.console;
		if (console && console.warn) {
			console.warn('DEPRECATED: ' + msg);
		}
	};


	/* DATEPICKER DATA-API
	* ================== */

	$(document).on(
		'focus.datepicker.data-api click.datepicker.data-api',
		'[data-provide="datepicker"]',
		function(e){
			var $this = $(this);
			if ($this.data('datepicker'))
				return;
			e.preventDefault();
			// component click requires us to explicitly show it
			datepickerPlugin.call($this, 'show');
		}
	);
	$(function(){
		datepickerPlugin.call($('[data-provide="datepicker-inline"]'));
	});

}));

/**!

 @license
 handlebars v4.7.6

Copyright (C) 2011-2019 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/
!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.Handlebars=b():a.Handlebars=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(){var a=r();return a.compile=function(b,c){return k.compile(b,c,a)},a.precompile=function(b,c){return k.precompile(b,c,a)},a.AST=i["default"],a.Compiler=k.Compiler,a.JavaScriptCompiler=m["default"],a.Parser=j.parser,a.parse=j.parse,a.parseWithoutProcessing=j.parseWithoutProcessing,a}var e=c(1)["default"];b.__esModule=!0;var f=c(2),g=e(f),h=c(45),i=e(h),j=c(46),k=c(51),l=c(52),m=e(l),n=c(49),o=e(n),p=c(44),q=e(p),r=g["default"].create,s=d();s.create=d,q["default"](s),s.Visitor=o["default"],s["default"]=s,b["default"]=s,a.exports=b["default"]},function(a,b){"use strict";b["default"]=function(a){return a&&a.__esModule?a:{"default":a}},b.__esModule=!0},function(a,b,c){"use strict";function d(){var a=new h.HandlebarsEnvironment;return n.extend(a,h),a.SafeString=j["default"],a.Exception=l["default"],a.Utils=n,a.escapeExpression=n.escapeExpression,a.VM=p,a.template=function(b){return p.template(b,a)},a}var e=c(3)["default"],f=c(1)["default"];b.__esModule=!0;var g=c(4),h=e(g),i=c(37),j=f(i),k=c(6),l=f(k),m=c(5),n=e(m),o=c(38),p=e(o),q=c(44),r=f(q),s=d();s.create=d,r["default"](s),s["default"]=s,b["default"]=s,a.exports=b["default"]},function(a,b){"use strict";b["default"]=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b},b.__esModule=!0},function(a,b,c){"use strict";function d(a,b,c){this.helpers=a||{},this.partials=b||{},this.decorators=c||{},i.registerDefaultHelpers(this),j.registerDefaultDecorators(this)}var e=c(1)["default"];b.__esModule=!0,b.HandlebarsEnvironment=d;var f=c(5),g=c(6),h=e(g),i=c(10),j=c(30),k=c(32),l=e(k),m=c(33),n="4.7.6";b.VERSION=n;var o=8;b.COMPILER_REVISION=o;var p=7;b.LAST_COMPATIBLE_COMPILER_REVISION=p;var q={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};b.REVISION_CHANGES=q;var r="[object Object]";d.prototype={constructor:d,logger:l["default"],log:l["default"].log,registerHelper:function(a,b){if(f.toString.call(a)===r){if(b)throw new h["default"]("Arg not supported with multiple helpers");f.extend(this.helpers,a)}else this.helpers[a]=b},unregisterHelper:function(a){delete this.helpers[a]},registerPartial:function(a,b){if(f.toString.call(a)===r)f.extend(this.partials,a);else{if("undefined"==typeof b)throw new h["default"]('Attempting to register a partial called "'+a+'" as undefined');this.partials[a]=b}},unregisterPartial:function(a){delete this.partials[a]},registerDecorator:function(a,b){if(f.toString.call(a)===r){if(b)throw new h["default"]("Arg not supported with multiple decorators");f.extend(this.decorators,a)}else this.decorators[a]=b},unregisterDecorator:function(a){delete this.decorators[a]},resetLoggedPropertyAccesses:function(){m.resetLoggedProperties()}};var s=l["default"].log;b.log=s,b.createFrame=f.createFrame,b.logger=l["default"]},function(a,b){"use strict";function c(a){return k[a]}function d(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],c)&&(a[c]=arguments[b][c]);return a}function e(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}function f(a){if("string"!=typeof a){if(a&&a.toHTML)return a.toHTML();if(null==a)return"";if(!a)return a+"";a=""+a}return m.test(a)?a.replace(l,c):a}function g(a){return!a&&0!==a||!(!p(a)||0!==a.length)}function h(a){var b=d({},a);return b._parent=a,b}function i(a,b){return a.path=b,a}function j(a,b){return(a?a+".":"")+b}b.__esModule=!0,b.extend=d,b.indexOf=e,b.escapeExpression=f,b.isEmpty=g,b.createFrame=h,b.blockParams=i,b.appendContextPath=j;var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},l=/[&<>"'`=]/g,m=/[&<>"'`=]/,n=Object.prototype.toString;b.toString=n;var o=function(a){return"function"==typeof a};o(/x/)&&(b.isFunction=o=function(a){return"function"==typeof a&&"[object Function]"===n.call(a)}),b.isFunction=o;var p=Array.isArray||function(a){return!(!a||"object"!=typeof a)&&"[object Array]"===n.call(a)};b.isArray=p},function(a,b,c){"use strict";function d(a,b){var c=b&&b.loc,g=void 0,h=void 0,i=void 0,j=void 0;c&&(g=c.start.line,h=c.end.line,i=c.start.column,j=c.end.column,a+=" - "+g+":"+i);for(var k=Error.prototype.constructor.call(this,a),l=0;l<f.length;l++)this[f[l]]=k[f[l]];Error.captureStackTrace&&Error.captureStackTrace(this,d);try{c&&(this.lineNumber=g,this.endLineNumber=h,e?(Object.defineProperty(this,"column",{value:i,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:j,enumerable:!0})):(this.column=i,this.endColumn=j))}catch(m){}}var e=c(7)["default"];b.__esModule=!0;var f=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];d.prototype=new Error,b["default"]=d,a.exports=b["default"]},function(a,b,c){a.exports={"default":c(8),__esModule:!0}},function(a,b,c){var d=c(9);a.exports=function(a,b,c){return d.setDesc(a,b,c)}},function(a,b){var c=Object;a.exports={create:c.create,getProto:c.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:c.getOwnPropertyDescriptor,setDesc:c.defineProperty,setDescs:c.defineProperties,getKeys:c.keys,getNames:c.getOwnPropertyNames,getSymbols:c.getOwnPropertySymbols,each:[].forEach}},function(a,b,c){"use strict";function d(a){h["default"](a),j["default"](a),l["default"](a),n["default"](a),p["default"](a),r["default"](a),t["default"](a)}function e(a,b,c){a.helpers[b]&&(a.hooks[b]=a.helpers[b],c||delete a.helpers[b])}var f=c(1)["default"];b.__esModule=!0,b.registerDefaultHelpers=d,b.moveHelperToHooks=e;var g=c(11),h=f(g),i=c(12),j=f(i),k=c(25),l=f(k),m=c(26),n=f(m),o=c(27),p=f(o),q=c(28),r=f(q),s=c(29),t=f(s)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b["default"]=function(a){a.registerHelper("blockHelperMissing",function(b,c){var e=c.inverse,f=c.fn;if(b===!0)return f(this);if(b===!1||null==b)return e(this);if(d.isArray(b))return b.length>0?(c.ids&&(c.ids=[c.name]),a.helpers.each(b,c)):e(this);if(c.data&&c.ids){var g=d.createFrame(c.data);g.contextPath=d.appendContextPath(c.data.contextPath,c.name),c={data:g}}return f(b,c)})},a.exports=b["default"]},function(a,b,c){(function(d){"use strict";var e=c(13)["default"],f=c(1)["default"];b.__esModule=!0;var g=c(5),h=c(6),i=f(h);b["default"]=function(a){a.registerHelper("each",function(a,b){function c(b,c,d){l&&(l.key=b,l.index=c,l.first=0===c,l.last=!!d,m&&(l.contextPath=m+b)),k+=f(a[b],{data:l,blockParams:g.blockParams([a[b],b],[m+b,null])})}if(!b)throw new i["default"]("Must pass iterator to #each");var f=b.fn,h=b.inverse,j=0,k="",l=void 0,m=void 0;if(b.data&&b.ids&&(m=g.appendContextPath(b.data.contextPath,b.ids[0])+"."),g.isFunction(a)&&(a=a.call(this)),b.data&&(l=g.createFrame(b.data)),a&&"object"==typeof a)if(g.isArray(a))for(var n=a.length;j<n;j++)j in a&&c(j,j,j===a.length-1);else if(d.Symbol&&a[d.Symbol.iterator]){for(var o=[],p=a[d.Symbol.iterator](),q=p.next();!q.done;q=p.next())o.push(q.value);a=o;for(var n=a.length;j<n;j++)c(j,j,j===a.length-1)}else!function(){var b=void 0;e(a).forEach(function(a){void 0!==b&&c(b,j-1),b=a,j++}),void 0!==b&&c(b,j-1,!0)}();return 0===j&&(k=h(this)),k})},a.exports=b["default"]}).call(b,function(){return this}())},function(a,b,c){a.exports={"default":c(14),__esModule:!0}},function(a,b,c){c(15),a.exports=c(21).Object.keys},function(a,b,c){var d=c(16);c(18)("keys",function(a){return function(b){return a(d(b))}})},function(a,b,c){var d=c(17);a.exports=function(a){return Object(d(a))}},function(a,b){a.exports=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a}},function(a,b,c){var d=c(19),e=c(21),f=c(24);a.exports=function(a,b){var c=(e.Object||{})[a]||Object[a],g={};g[a]=b(c),d(d.S+d.F*f(function(){c(1)}),"Object",g)}},function(a,b,c){var d=c(20),e=c(21),f=c(22),g="prototype",h=function(a,b,c){var i,j,k,l=a&h.F,m=a&h.G,n=a&h.S,o=a&h.P,p=a&h.B,q=a&h.W,r=m?e:e[b]||(e[b]={}),s=m?d:n?d[b]:(d[b]||{})[g];m&&(c=b);for(i in c)j=!l&&s&&i in s,j&&i in r||(k=j?s[i]:c[i],r[i]=m&&"function"!=typeof s[i]?c[i]:p&&j?f(k,d):q&&s[i]==k?function(a){var b=function(b){return this instanceof a?new a(b):a(b)};return b[g]=a[g],b}(k):o&&"function"==typeof k?f(Function.call,k):k,o&&((r[g]||(r[g]={}))[i]=k))};h.F=1,h.G=2,h.S=4,h.P=8,h.B=16,h.W=32,a.exports=h},function(a,b){var c=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=c)},function(a,b){var c=a.exports={version:"1.2.6"};"number"==typeof __e&&(__e=c)},function(a,b,c){var d=c(23);a.exports=function(a,b,c){if(d(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}}},function(a,b){a.exports=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a}},function(a,b){a.exports=function(a){try{return!!a()}catch(b){return!0}}},function(a,b,c){"use strict";var d=c(1)["default"];b.__esModule=!0;var e=c(6),f=d(e);b["default"]=function(a){a.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new f["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})},a.exports=b["default"]},function(a,b,c){"use strict";var d=c(1)["default"];b.__esModule=!0;var e=c(5),f=c(6),g=d(f);b["default"]=function(a){a.registerHelper("if",function(a,b){if(2!=arguments.length)throw new g["default"]("#if requires exactly one argument");return e.isFunction(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||e.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){if(2!=arguments.length)throw new g["default"]("#unless requires exactly one argument");return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})})},a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,b["default"]=function(a){a.registerHelper("log",function(){for(var b=[void 0],c=arguments[arguments.length-1],d=0;d<arguments.length-1;d++)b.push(arguments[d]);var e=1;null!=c.hash.level?e=c.hash.level:c.data&&null!=c.data.level&&(e=c.data.level),b[0]=e,a.log.apply(a,b)})},a.exports=b["default"]},function(a,b){"use strict";b.__esModule=!0,b["default"]=function(a){a.registerHelper("lookup",function(a,b,c){return a?c.lookupProperty(a,b):a})},a.exports=b["default"]},function(a,b,c){"use strict";var d=c(1)["default"];b.__esModule=!0;var e=c(5),f=c(6),g=d(f);b["default"]=function(a){a.registerHelper("with",function(a,b){if(2!=arguments.length)throw new g["default"]("#with requires exactly one argument");e.isFunction(a)&&(a=a.call(this));var c=b.fn;if(e.isEmpty(a))return b.inverse(this);var d=b.data;return b.data&&b.ids&&(d=e.createFrame(b.data),d.contextPath=e.appendContextPath(b.data.contextPath,b.ids[0])),c(a,{data:d,blockParams:e.blockParams([a],[d&&d.contextPath])})})},a.exports=b["default"]},function(a,b,c){"use strict";function d(a){g["default"](a)}var e=c(1)["default"];b.__esModule=!0,b.registerDefaultDecorators=d;var f=c(31),g=e(f)},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5);b["default"]=function(a){a.registerDecorator("inline",function(a,b,c,e){var f=a;return b.partials||(b.partials={},f=function(e,f){var g=c.partials;c.partials=d.extend({},g,b.partials);var h=a(e,f);return c.partials=g,h}),b.partials[e.args[0]]=e.fn,f})},a.exports=b["default"]},function(a,b,c){"use strict";b.__esModule=!0;var d=c(5),e={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(a){if("string"==typeof a){var b=d.indexOf(e.methodMap,a.toLowerCase());a=b>=0?b:parseInt(a,10)}return a},log:function(a){if(a=e.lookupLevel(a),"undefined"!=typeof console&&e.lookupLevel(e.level)<=a){var b=e.methodMap[a];console[b]||(b="log");for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];console[b].apply(console,d)}}};b["default"]=e,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){var b=i(null);b.constructor=!1,b.__defineGetter__=!1,b.__defineSetter__=!1,b.__lookupGetter__=!1;var c=i(null);return c.__proto__=!1,{properties:{whitelist:l.createNewLookupObject(c,a.allowedProtoProperties),defaultValue:a.allowProtoPropertiesByDefault},methods:{whitelist:l.createNewLookupObject(b,a.allowedProtoMethods),defaultValue:a.allowProtoMethodsByDefault}}}function e(a,b,c){return"function"==typeof a?f(b.methods,c):f(b.properties,c)}function f(a,b){return void 0!==a.whitelist[b]?a.whitelist[b]===!0:void 0!==a.defaultValue?a.defaultValue:(g(b),!1)}function g(a){o[a]!==!0&&(o[a]=!0,n.log("error",'Handlebars: Access has been denied to resolve the property "'+a+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}function h(){j(o).forEach(function(a){delete o[a]})}var i=c(34)["default"],j=c(13)["default"],k=c(3)["default"];b.__esModule=!0,b.createProtoAccessControl=d,b.resultIsAllowed=e,b.resetLoggedProperties=h;var l=c(36),m=c(32),n=k(m),o=i(null)},function(a,b,c){a.exports={"default":c(35),__esModule:!0}},function(a,b,c){var d=c(9);a.exports=function(a,b){return d.create(a,b)}},function(a,b,c){"use strict";function d(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return f.extend.apply(void 0,[e(null)].concat(b))}var e=c(34)["default"];b.__esModule=!0,b.createNewLookupObject=d;var f=c(5)},function(a,b){"use strict";function c(a){this.string=a}b.__esModule=!0,c.prototype.toString=c.prototype.toHTML=function(){return""+this.string},b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(a){var b=a&&a[0]||1,c=v.COMPILER_REVISION;if(!(b>=v.LAST_COMPATIBLE_COMPILER_REVISION&&b<=v.COMPILER_REVISION)){if(b<v.LAST_COMPATIBLE_COMPILER_REVISION){var d=v.REVISION_CHANGES[c],e=v.REVISION_CHANGES[b];throw new u["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new u["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){function c(c,d,e){e.hash&&(d=s.extend({},d,e.hash),e.ids&&(e.ids[0]=!0)),c=b.VM.resolvePartial.call(this,c,d,e);var f=s.extend({},e,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),g=b.VM.invokePartial.call(this,c,d,f);if(null==g&&b.compile&&(e.partials[e.name]=b.compile(c,a.compilerOptions,b),g=e.partials[e.name](d,f)),null!=g){if(e.indent){for(var h=g.split("\n"),i=0,j=h.length;i<j&&(h[i]||i+1!==j);i++)h[i]=e.indent+h[i];g=h.join("\n")}return g}throw new u["default"]("The partial "+e.name+" could not be compiled when running in runtime-only mode")}function d(b){function c(b){return""+a.main(g,b,g.helpers,g.partials,f,i,h)}var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],f=e.data;d._setup(e),!e.partial&&a.useData&&(f=j(b,f));var h=void 0,i=a.useBlockParams?[]:void 0;return a.useDepths&&(h=e.depths?b!=e.depths[0]?[b].concat(e.depths):e.depths:[b]),(c=k(a.main,c,g,e.depths||[],f,i))(b,e)}if(!b)throw new u["default"]("No environment passed to template");if(!a||!a.main)throw new u["default"]("Unknown template object: "+typeof a);a.main.decorator=a.main_d,b.VM.checkRevision(a.compiler);var e=a.compiler&&7===a.compiler[0],g={strict:function(a,b,c){if(!(a&&b in a))throw new u["default"]('"'+b+'" not defined in '+a,{loc:c});return a[b]},lookupProperty:function(a,b){var c=a[b];return null==c?c:Object.prototype.hasOwnProperty.call(a,b)?c:y.resultIsAllowed(c,g.protoAccessControl,b)?c:void 0},lookup:function(a,b){for(var c=a.length,d=0;d<c;d++){var e=a[d]&&g.lookupProperty(a[d],b);if(null!=e)return a[d][b]}},lambda:function(a,b){return"function"==typeof a?a.call(b):a},escapeExpression:s.escapeExpression,invokePartial:c,fn:function(b){var c=a[b];return c.decorator=a[b+"_d"],c},programs:[],program:function(a,b,c,d,e){var g=this.programs[a],h=this.fn(a);return b||e||d||c?g=f(this,a,h,b,c,d,e):g||(g=this.programs[a]=f(this,a,h)),g},data:function(a,b){for(;a&&b--;)a=a._parent;return a},mergeIfNeeded:function(a,b){var c=a||b;return a&&b&&a!==b&&(c=s.extend({},b,a)),c},nullContext:n({}),noop:b.VM.noop,compilerInfo:a.compiler};return d.isTop=!0,d._setup=function(c){if(c.partial)g.protoAccessControl=c.protoAccessControl,g.helpers=c.helpers,g.partials=c.partials,g.decorators=c.decorators,g.hooks=c.hooks;else{var d=s.extend({},b.helpers,c.helpers);l(d,g),g.helpers=d,a.usePartial&&(g.partials=g.mergeIfNeeded(c.partials,b.partials)),(a.usePartial||a.useDecorators)&&(g.decorators=s.extend({},b.decorators,c.decorators)),g.hooks={},g.protoAccessControl=y.createProtoAccessControl(c);var f=c.allowCallsToHelperMissing||e;w.moveHelperToHooks(g,"helperMissing",f),w.moveHelperToHooks(g,"blockHelperMissing",f)}},d._child=function(b,c,d,e){if(a.useBlockParams&&!d)throw new u["default"]("must pass block params");if(a.useDepths&&!e)throw new u["default"]("must pass parent depths");return f(g,b,a[b],c,0,d,e)},d}function f(a,b,c,d,e,f,g){function h(b){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=g;return!g||b==g[0]||b===a.nullContext&&null===g[0]||(h=[b].concat(g)),c(a,b,a.helpers,a.partials,e.data||d,f&&[e.blockParams].concat(f),h)}return h=k(c,h,a,g,d,f),h.program=b,h.depth=g?g.length:0,h.blockParams=e||0,h}function g(a,b,c){return a?a.call||c.name||(c.name=a,a=c.partials[a]):a="@partial-block"===c.name?c.data["partial-block"]:c.partials[c.name],a}function h(a,b,c){var d=c.data&&c.data["partial-block"];c.partial=!0,c.ids&&(c.data.contextPath=c.ids[0]||c.data.contextPath);var e=void 0;if(c.fn&&c.fn!==i&&!function(){c.data=v.createFrame(c.data);var a=c.fn;e=c.data["partial-block"]=function(b){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return c.data=v.createFrame(c.data),c.data["partial-block"]=d,a(b,c)},a.partials&&(c.partials=s.extend({},c.partials,a.partials))}(),void 0===a&&e&&(a=e),void 0===a)throw new u["default"]("The partial "+c.name+" could not be found");if(a instanceof Function)return a(b,c)}function i(){return""}function j(a,b){return b&&"root"in b||(b=b?v.createFrame(b):{},b.root=a),b}function k(a,b,c,d,e,f){if(a.decorator){var g={};b=a.decorator(b,g,c,d&&d[0],e,f,d),s.extend(b,g)}return b}function l(a,b){o(a).forEach(function(c){var d=a[c];a[c]=m(d,b)})}function m(a,b){var c=b.lookupProperty;return x.wrapHelper(a,function(a){return s.extend({lookupProperty:c},a)})}var n=c(39)["default"],o=c(13)["default"],p=c(3)["default"],q=c(1)["default"];b.__esModule=!0,b.checkRevision=d,b.template=e,b.wrapProgram=f,b.resolvePartial=g,b.invokePartial=h,b.noop=i;var r=c(5),s=p(r),t=c(6),u=q(t),v=c(4),w=c(10),x=c(43),y=c(33)},function(a,b,c){a.exports={"default":c(40),__esModule:!0}},function(a,b,c){c(41),a.exports=c(21).Object.seal},function(a,b,c){var d=c(42);c(18)("seal",function(a){return function(b){return a&&d(b)?a(b):b}})},function(a,b){a.exports=function(a){return"object"==typeof a?null!==a:"function"==typeof a}},function(a,b){"use strict";function c(a,b){if("function"!=typeof a)return a;var c=function(){var c=arguments[arguments.length-1];return arguments[arguments.length-1]=b(c),a.apply(this,arguments)};return c}b.__esModule=!0,b.wrapHelper=c},function(a,b){(function(c){"use strict";b.__esModule=!0,b["default"]=function(a){var b="undefined"!=typeof c?c:window,d=b.Handlebars;a.noConflict=function(){return b.Handlebars===a&&(b.Handlebars=d),a}},a.exports=b["default"]}).call(b,function(){return this}())},function(a,b){"use strict";b.__esModule=!0;var c={helpers:{helperExpression:function(a){return"SubExpression"===a.type||("MustacheStatement"===a.type||"BlockStatement"===a.type)&&!!(a.params&&a.params.length||a.hash)},scopedId:function(a){return/^\.|this\b/.test(a.original)},simpleId:function(a){return 1===a.parts.length&&!c.helpers.scopedId(a)&&!a.depth}}};b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(a,b){if("Program"===a.type)return a;i["default"].yy=o,o.locInfo=function(a){return new o.SourceLocation(b&&b.srcName,a)};var c=i["default"].parse(a);return c}function e(a,b){var c=d(a,b),e=new k["default"](b);return e.accept(c)}var f=c(1)["default"],g=c(3)["default"];b.__esModule=!0,b.parseWithoutProcessing=d,b.parse=e;var h=c(47),i=f(h),j=c(48),k=f(j),l=c(50),m=g(l),n=c(5);b.parser=i["default"];var o={};n.extend(o,m)},function(a,b){"use strict";b.__esModule=!0;var c=function(){function a(){this.yy={}}var b={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:return f[h-1];case 2:this.$=d.prepareProgram(f[h]);break;case 3:this.$=f[h];break;case 4:this.$=f[h];break;case 5:this.$=f[h];break;case 6:this.$=f[h];break;case 7:this.$=f[h];break;case 8:this.$=f[h];break;case 9:this.$={type:"CommentStatement",value:d.stripComment(f[h]),strip:d.stripFlags(f[h],f[h]),loc:d.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:f[h],value:f[h],loc:d.locInfo(this._$)};break;case 11:this.$=d.prepareRawBlock(f[h-2],f[h-1],f[h],this._$);break;case 12:this.$={path:f[h-3],params:f[h-2],hash:f[h-1]};break;case 13:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!1,this._$);break;case 14:this.$=d.prepareBlock(f[h-3],f[h-2],f[h-1],f[h],!0,this._$);break;case 15:this.$={open:f[h-5],path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 16:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 17:this.$={path:f[h-4],params:f[h-3],hash:f[h-2],blockParams:f[h-1],strip:d.stripFlags(f[h-5],f[h])};break;case 18:this.$={strip:d.stripFlags(f[h-1],f[h-1]),program:f[h]};break;case 19:var i=d.prepareBlock(f[h-2],f[h-1],f[h],f[h],!1,this._$),j=d.prepareProgram([i],f[h-1].loc);j.chained=!0,this.$={strip:f[h-2].strip,program:j,chain:!0};break;case 20:this.$=f[h];break;case 21:this.$={path:f[h-1],strip:d.stripFlags(f[h-2],f[h])};break;case 22:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 23:this.$=d.prepareMustache(f[h-3],f[h-2],f[h-1],f[h-4],d.stripFlags(f[h-4],f[h]),this._$);break;case 24:this.$={type:"PartialStatement",name:f[h-3],params:f[h-2],hash:f[h-1],indent:"",strip:d.stripFlags(f[h-4],f[h]),loc:d.locInfo(this._$)};break;case 25:this.$=d.preparePartialBlock(f[h-2],f[h-1],f[h],this._$);break;case 26:this.$={path:f[h-3],params:f[h-2],hash:f[h-1],strip:d.stripFlags(f[h-4],f[h])};break;case 27:this.$=f[h];break;case 28:this.$=f[h];break;case 29:this.$={type:"SubExpression",path:f[h-3],params:f[h-2],hash:f[h-1],loc:d.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:f[h],loc:d.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:d.id(f[h-2]),value:f[h],loc:d.locInfo(this._$)};break;case 32:this.$=d.id(f[h-1]);break;case 33:this.$=f[h];break;case 34:this.$=f[h];break;case 35:this.$={type:"StringLiteral",value:f[h],original:f[h],loc:d.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(f[h]),original:Number(f[h]),loc:d.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:"true"===f[h],original:"true"===f[h],loc:d.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:d.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:d.locInfo(this._$)};break;case 40:this.$=f[h];break;case 41:this.$=f[h];break;case 42:this.$=d.preparePath(!0,f[h],this._$);break;case 43:this.$=d.preparePath(!1,f[h],this._$);break;case 44:f[h-2].push({part:d.id(f[h]),original:f[h],separator:f[h-1]}),this.$=f[h-2];break;case 45:this.$=[{part:d.id(f[h]),original:f[h]}];break;case 46:this.$=[];break;case 47:f[h-1].push(f[h]);break;case 48:this.$=[];break;case 49:f[h-1].push(f[h]);break;case 50:this.$=[];break;case 51:f[h-1].push(f[h]);break;case 58:this.$=[];break;case 59:f[h-1].push(f[h]);break;case 64:this.$=[];break;case 65:f[h-1].push(f[h]);break;case 70:this.$=[];break;case 71:f[h-1].push(f[h]);break;case 78:this.$=[];break;case 79:f[h-1].push(f[h]);break;case 82:this.$=[];break;case 83:f[h-1].push(f[h]);break;case 86:this.$=[];break;case 87:f[h-1].push(f[h]);break;case 90:this.$=[];break;case 91:f[h-1].push(f[h]);break;case 94:this.$=[];break;case 95:f[h-1].push(f[h]);break;case 98:this.$=[f[h]];break;case 99:f[h-1].push(f[h]);break;case 100:this.$=[f[h]];break;case 101:f[h-1].push(f[h])}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],
72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(a,b){throw new Error(a)},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l);var m=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,o,p,q,r,s,t,u,v,w={};;){if(p=d[d.length-1],this.defaultActions[p]?q=this.defaultActions[p]:(null!==n&&"undefined"!=typeof n||(n=b()),q=g[p]&&g[p][n]),"undefined"==typeof q||!q.length||!q[0]){var x="";if(!k){v=[];for(s in g[p])this.terminals_[s]&&s>2&&v.push("'"+this.terminals_[s]+"'");x=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+v.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:l,expected:v})}}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+n);switch(q[0]){case 1:d.push(n),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(q[1]),n=null,o?(n=o,o=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(t=this.productions_[q[1]][1],w.$=e[e.length-t],w._$={first_line:f[f.length-(t||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(t||1)].first_column,last_column:f[f.length-1].last_column},m&&(w._$.range=[f[f.length-(t||1)].range[0],f[f.length-1].range[1]]),r=this.performAction.call(w,h,j,i,this.yy,q[1],e,f),"undefined"!=typeof r)return r;t&&(d=d.slice(0,-1*t*2),e=e.slice(0,-1*t),f=f.slice(0,-1*t)),d.push(this.productions_[q[1]][0]),e.push(w.$),f.push(w._$),u=g[d[d.length-2]][d[d.length-1]],d.push(u);break;case 3:return!0}}return!0}},c=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(c=this._input.match(this.rules[f[g]]),!c||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a?a:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substring(a,b.yyleng-c+a)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),"raw"===this.conditionStack[this.conditionStack.length-1]?15:(e(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(b.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return b.yytext=e(1,2).replace(/\\"/g,'"'),80;case 32:return b.yytext=e(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return b.yytext=b.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^\/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},a}();return b.lexer=c,a.prototype=b,b.Parser=a,new a}();b["default"]=c,a.exports=b["default"]},function(a,b,c){"use strict";function d(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.options=a}function e(a,b,c){void 0===b&&(b=a.length);var d=a[b-1],e=a[b-2];return d?"ContentStatement"===d.type?(e||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(d.original):void 0:c}function f(a,b,c){void 0===b&&(b=-1);var d=a[b+1],e=a[b+2];return d?"ContentStatement"===d.type?(e||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(d.original):void 0:c}function g(a,b,c){var d=a[null==b?0:b+1];if(d&&"ContentStatement"===d.type&&(c||!d.rightStripped)){var e=d.value;d.value=d.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),d.rightStripped=d.value!==e}}function h(a,b,c){var d=a[null==b?a.length-1:b-1];if(d&&"ContentStatement"===d.type&&(c||!d.leftStripped)){var e=d.value;return d.value=d.value.replace(c?/\s+$/:/[ \t]+$/,""),d.leftStripped=d.value!==e,d.leftStripped}}var i=c(1)["default"];b.__esModule=!0;var j=c(49),k=i(j);d.prototype=new k["default"],d.prototype.Program=function(a){var b=!this.options.ignoreStandalone,c=!this.isRootSeen;this.isRootSeen=!0;for(var d=a.body,i=0,j=d.length;i<j;i++){var k=d[i],l=this.accept(k);if(l){var m=e(d,i,c),n=f(d,i,c),o=l.openStandalone&&m,p=l.closeStandalone&&n,q=l.inlineStandalone&&m&&n;l.close&&g(d,i,!0),l.open&&h(d,i,!0),b&&q&&(g(d,i),h(d,i)&&"PartialStatement"===k.type&&(k.indent=/([ \t]+$)/.exec(d[i-1].original)[1])),b&&o&&(g((k.program||k.inverse).body),h(d,i)),b&&p&&(g(d,i),h((k.inverse||k.program).body))}}return a},d.prototype.BlockStatement=d.prototype.DecoratorBlock=d.prototype.PartialBlockStatement=function(a){this.accept(a.program),this.accept(a.inverse);var b=a.program||a.inverse,c=a.program&&a.inverse,d=c,i=c;if(c&&c.chained)for(d=c.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var j={open:a.openStrip.open,close:a.closeStrip.close,openStandalone:f(b.body),closeStandalone:e((d||b).body)};if(a.openStrip.close&&g(b.body,null,!0),c){var k=a.inverseStrip;k.open&&h(b.body,null,!0),k.close&&g(d.body,null,!0),a.closeStrip.open&&h(i.body,null,!0),!this.options.ignoreStandalone&&e(b.body)&&f(d.body)&&(h(b.body),g(d.body))}else a.closeStrip.open&&h(b.body,null,!0);return j},d.prototype.Decorator=d.prototype.MustacheStatement=function(a){return a.strip},d.prototype.PartialStatement=d.prototype.CommentStatement=function(a){var b=a.strip||{};return{inlineStandalone:!0,open:b.open,close:b.close}},b["default"]=d,a.exports=b["default"]},function(a,b,c){"use strict";function d(){this.parents=[]}function e(a){this.acceptRequired(a,"path"),this.acceptArray(a.params),this.acceptKey(a,"hash")}function f(a){e.call(this,a),this.acceptKey(a,"program"),this.acceptKey(a,"inverse")}function g(a){this.acceptRequired(a,"name"),this.acceptArray(a.params),this.acceptKey(a,"hash")}var h=c(1)["default"];b.__esModule=!0;var i=c(6),j=h(i);d.prototype={constructor:d,mutating:!1,acceptKey:function(a,b){var c=this.accept(a[b]);if(this.mutating){if(c&&!d.prototype[c.type])throw new j["default"]('Unexpected node type "'+c.type+'" found when accepting '+b+" on "+a.type);a[b]=c}},acceptRequired:function(a,b){if(this.acceptKey(a,b),!a[b])throw new j["default"](a.type+" requires "+b)},acceptArray:function(a){for(var b=0,c=a.length;b<c;b++)this.acceptKey(a,b),a[b]||(a.splice(b,1),b--,c--)},accept:function(a){if(a){if(!this[a.type])throw new j["default"]("Unknown type: "+a.type,a);this.current&&this.parents.unshift(this.current),this.current=a;var b=this[a.type](a);return this.current=this.parents.shift(),!this.mutating||b?b:b!==!1?a:void 0}},Program:function(a){this.acceptArray(a.body)},MustacheStatement:e,Decorator:e,BlockStatement:f,DecoratorBlock:f,PartialStatement:g,PartialBlockStatement:function(a){g.call(this,a),this.acceptKey(a,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:e,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(a){this.acceptArray(a.pairs)},HashPair:function(a){this.acceptRequired(a,"value")}},b["default"]=d,a.exports=b["default"]},function(a,b,c){"use strict";function d(a,b){if(b=b.path?b.path.original:b,a.path.original!==b){var c={loc:a.path.loc};throw new q["default"](a.path.original+" doesn't match "+b,c)}}function e(a,b){this.source=a,this.start={line:b.first_line,column:b.first_column},this.end={line:b.last_line,column:b.last_column}}function f(a){return/^\[.*\]$/.test(a)?a.substring(1,a.length-1):a}function g(a,b){return{open:"~"===a.charAt(2),close:"~"===b.charAt(b.length-3)}}function h(a){return a.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function i(a,b,c){c=this.locInfo(c);for(var d=a?"@":"",e=[],f=0,g=0,h=b.length;g<h;g++){var i=b[g].part,j=b[g].original!==i;if(d+=(b[g].separator||"")+i,j||".."!==i&&"."!==i&&"this"!==i)e.push(i);else{if(e.length>0)throw new q["default"]("Invalid path: "+d,{loc:c});".."===i&&f++}}return{type:"PathExpression",data:a,depth:f,parts:e,original:d,loc:c}}function j(a,b,c,d,e,f){var g=d.charAt(3)||d.charAt(2),h="{"!==g&&"&"!==g,i=/\*/.test(d);return{type:i?"Decorator":"MustacheStatement",path:a,params:b,hash:c,escaped:h,strip:e,loc:this.locInfo(f)}}function k(a,b,c,e){d(a,c),e=this.locInfo(e);var f={type:"Program",body:b,strip:{},loc:e};return{type:"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:f,openStrip:{},inverseStrip:{},closeStrip:{},loc:e}}function l(a,b,c,e,f,g){e&&e.path&&d(a,e);var h=/\*/.test(a.open);b.blockParams=a.blockParams;var i=void 0,j=void 0;if(c){if(h)throw new q["default"]("Unexpected inverse block on decorator",c);c.chain&&(c.program.body[0].closeStrip=e.strip),j=c.strip,i=c.program}return f&&(f=i,i=b,b=f),{type:h?"DecoratorBlock":"BlockStatement",path:a.path,params:a.params,hash:a.hash,program:b,inverse:i,openStrip:a.strip,inverseStrip:j,closeStrip:e&&e.strip,loc:this.locInfo(g)}}function m(a,b){if(!b&&a.length){var c=a[0].loc,d=a[a.length-1].loc;c&&d&&(b={source:c.source,start:{line:c.start.line,column:c.start.column},end:{line:d.end.line,column:d.end.column}})}return{type:"Program",body:a,strip:{},loc:b}}function n(a,b,c,e){return d(a,c),{type:"PartialBlockStatement",name:a.path,params:a.params,hash:a.hash,program:b,openStrip:a.strip,closeStrip:c&&c.strip,loc:this.locInfo(e)}}var o=c(1)["default"];b.__esModule=!0,b.SourceLocation=e,b.id=f,b.stripFlags=g,b.stripComment=h,b.preparePath=i,b.prepareMustache=j,b.prepareRawBlock=k,b.prepareBlock=l,b.prepareProgram=m,b.preparePartialBlock=n;var p=c(6),q=o(p)},function(a,b,c){"use strict";function d(){}function e(a,b,c){if(null==a||"string"!=typeof a&&"Program"!==a.type)throw new l["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var d=c.parse(a,b),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function f(a,b,c){function d(){var d=c.parse(a,b),e=(new c.Compiler).compile(d,b),f=(new c.JavaScriptCompiler).compile(e,b,void 0,!0);return c.template(f)}function e(a,b){return f||(f=d()),f.call(this,a,b)}if(void 0===b&&(b={}),null==a||"string"!=typeof a&&"Program"!==a.type)throw new l["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);b=m.extend({},b),"data"in b||(b.data=!0),b.compat&&(b.useDepths=!0);var f=void 0;return e._setup=function(a){return f||(f=d()),f._setup(a)},e._child=function(a,b,c,e){return f||(f=d()),f._child(a,b,c,e)},e}function g(a,b){if(a===b)return!0;if(m.isArray(a)&&m.isArray(b)&&a.length===b.length){for(var c=0;c<a.length;c++)if(!g(a[c],b[c]))return!1;return!0}}function h(a){if(!a.path.parts){var b=a.path;a.path={type:"PathExpression",data:!1,depth:0,parts:[b.original+""],original:b.original+"",loc:b.loc}}}var i=c(34)["default"],j=c(1)["default"];b.__esModule=!0,b.Compiler=d,b.precompile=e,b.compile=f;var k=c(6),l=j(k),m=c(5),n=c(45),o=j(n),p=[].slice;d.prototype={compiler:d,equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;c<b;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||!g(d.args,e.args))return!1}b=this.children.length;for(var c=0;c<b;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=b,this.stringParams=b.stringParams,this.trackIds=b.trackIds,b.blockParams=b.blockParams||[],b.knownHelpers=m.extend(i(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},b.knownHelpers),this.accept(a)},compileProgram:function(a){var b=new this.compiler,c=b.compile(a,this.options),d=this.guid++;return this.usePartial=this.usePartial||c.usePartial,this.children[d]=c,this.useDepths=this.useDepths||c.useDepths,d},accept:function(a){if(!this[a.type])throw new l["default"]("Unknown type: "+a.type,a);this.sourceNode.unshift(a);var b=this[a.type](a);return this.sourceNode.shift(),b},Program:function(a){this.options.blockParams.unshift(a.blockParams);for(var b=a.body,c=b.length,d=0;d<c;d++)this.accept(b[d]);return this.options.blockParams.shift(),this.isSimple=1===c,this.blockParams=a.blockParams?a.blockParams.length:0,this},BlockStatement:function(a){h(a);var b=a.program,c=a.inverse;b=b&&this.compileProgram(b),c=c&&this.compileProgram(c);var d=this.classifySexpr(a);"helper"===d?this.helperSexpr(a,b,c):"simple"===d?(this.simpleSexpr(a),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("blockValue",a.path.original)):(this.ambiguousSexpr(a,b,c),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(a){var b=a.program&&this.compileProgram(a.program),c=this.setupFullMustacheParams(a,b,void 0),d=a.path;this.useDecorators=!0,this.opcode("registerDecorator",c.length,d.original)},PartialStatement:function(a){this.usePartial=!0;var b=a.program;b&&(b=this.compileProgram(a.program));var c=a.params;if(c.length>1)throw new l["default"]("Unsupported number of partial arguments: "+c.length,a);c.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):c.push({type:"PathExpression",parts:[],depth:0}));var d=a.name.original,e="SubExpression"===a.name.type;e&&this.accept(a.name),this.setupFullMustacheParams(a,b,void 0,!0);var f=a.indent||"";this.options.preventIndent&&f&&(this.opcode("appendContent",f),f=""),this.opcode("invokePartial",e,d,f),this.opcode("append")},PartialBlockStatement:function(a){this.PartialStatement(a)},MustacheStatement:function(a){this.SubExpression(a),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(a){this.DecoratorBlock(a)},ContentStatement:function(a){a.value&&this.opcode("appendContent",a.value)},CommentStatement:function(){},SubExpression:function(a){h(a);var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ambiguousSexpr:function(a,b,c){var d=a.path,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),d.strict=!0,this.accept(d),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){var b=a.path;b.strict=!0,this.accept(b),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.path,f=e.parts[0];if(this.options.knownHelpers[f])this.opcode("invokeKnownHelper",d.length,f);else{if(this.options.knownHelpersOnly)throw new l["default"]("You specified knownHelpersOnly, but used the unknown helper "+f,a);e.strict=!0,e.falsy=!0,this.accept(e),this.opcode("invokeHelper",d.length,e.original,o["default"].helpers.simpleId(e))}},PathExpression:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0],c=o["default"].helpers.scopedId(a),d=!a.depth&&!c&&this.blockParamIndex(b);d?this.opcode("lookupBlockParam",d,a.parts):b?a.data?(this.options.data=!0,this.opcode("lookupData",a.depth,a.parts,a.strict)):this.opcode("lookupOnContext",a.parts,a.falsy,a.strict,c):this.opcode("pushContext")},StringLiteral:function(a){this.opcode("pushString",a.value)},NumberLiteral:function(a){this.opcode("pushLiteral",a.value)},BooleanLiteral:function(a){this.opcode("pushLiteral",a.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(a){var b=a.pairs,c=0,d=b.length;for(this.opcode("pushHash");c<d;c++)this.pushParam(b[c].value);for(;c--;)this.opcode("assignToHash",b[c].key);this.opcode("popHash")},opcode:function(a){this.opcodes.push({opcode:a,args:p.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(a){a&&(this.useDepths=!0)},classifySexpr:function(a){var b=o["default"].helpers.simpleId(a.path),c=b&&!!this.blockParamIndex(a.path.parts[0]),d=!c&&o["default"].helpers.helperExpression(a),e=!c&&(d||b);if(e&&!d){var f=a.path.parts[0],g=this.options;g.knownHelpers[f]?d=!0:g.knownHelpersOnly&&(e=!1)}return d?"helper":e?"ambiguous":"simple"},pushParams:function(a){for(var b=0,c=a.length;b<c;b++)this.pushParam(a[b])},pushParam:function(a){var b=null!=a.value?a.value:a.original||"";if(this.stringParams)b.replace&&(b=b.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),a.depth&&this.addDepth(a.depth),this.opcode("getContext",a.depth||0),this.opcode("pushStringParam",b,a.type),"SubExpression"===a.type&&this.accept(a);else{if(this.trackIds){var c=void 0;if(!a.parts||o["default"].helpers.scopedId(a)||a.depth||(c=this.blockParamIndex(a.parts[0])),c){var d=a.parts.slice(1).join(".");this.opcode("pushId","BlockParam",c,d)}else b=a.original||b,b.replace&&(b=b.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",a.type,b)}this.accept(a)}},setupFullMustacheParams:function(a,b,c,d){var e=a.params;return this.pushParams(e),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.accept(a.hash):this.opcode("emptyHash",d),e},blockParamIndex:function(a){for(var b=0,c=this.options.blockParams.length;b<c;b++){var d=this.options.blockParams[b],e=d&&m.indexOf(d,a);if(d&&e>=0)return[b,e]}}}},function(a,b,c){"use strict";function d(a){this.value=a}function e(){}function f(a,b,c,d){var e=b.popStack(),f=0,g=c.length;for(a&&g--;f<g;f++)e=b.nameLookup(e,c[f],d);return a?[b.aliasable("container.strict"),"(",e,", ",b.quotedString(c[f]),", ",JSON.stringify(b.source.currentLocation)," )"]:e}var g=c(13)["default"],h=c(1)["default"];b.__esModule=!0;var i=c(4),j=c(6),k=h(j),l=c(5),m=c(53),n=h(m);e.prototype={nameLookup:function(a,b){return this.internalNameLookup(a,b)},depthedLookup:function(a){return[this.aliasable("container.lookup"),'(depths, "',a,'")']},compilerInfo:function(){var a=i.COMPILER_REVISION,b=i.REVISION_CHANGES[a];return[a,b]},appendToBuffer:function(a,b,c){return l.isArray(a)||(a=[a]),a=this.source.wrap(a,b),this.environment.isSimple?["return ",a,";"]:c?["buffer += ",a,";"]:(a.appendToBuffer=!0,a)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(a,b){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",a,",",JSON.stringify(b),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(a,b,c,d){this.environment=a,this.options=b,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!d,this.name=this.environment.name,this.isChild=!!c,this.context=c||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(a,b),this.useDepths=this.useDepths||a.useDepths||a.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||a.useBlockParams;var e=a.opcodes,f=void 0,g=void 0,h=void 0,i=void 0;for(h=0,i=e.length;h<i;h++)f=e[h],this.source.currentLocation=f.loc,g=g||f.loc,this[f.opcode].apply(this,f.args);if(this.source.currentLocation=g,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new k["default"]("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),";\n"]),
this.decorators.push("return fn;"),d?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n"),this.decorators.push("}\n"),this.decorators=this.decorators.merge()));var j=this.createFunctionContext(d);if(this.isChild)return j;var l={compiler:this.compilerInfo(),main:j};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var m=this.context,n=m.programs,o=m.decorators;for(h=0,i=n.length;h<i;h++)n[h]&&(l[h]=n[h],o[h]&&(l[h+"_d"]=o[h],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),d?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),b.srcName?(l=l.toStringWithSourceMap({file:b.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new n["default"](this.options.srcName),this.decorators=new n["default"](this.options.srcName)},createFunctionContext:function(a){var b=this,c="",d=this.stackVars.concat(this.registers.list);d.length>0&&(c+=", "+d.join(", "));var e=0;g(this.aliases).forEach(function(a){var d=b.aliases[a];d.children&&d.referenceCount>1&&(c+=", alias"+ ++e+"="+a,d.children[0]="alias"+e)}),this.lookupPropertyFunctionIsUsed&&(c+=", "+this.lookupPropertyFunctionVarDeclaration());var f=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&f.push("blockParams"),this.useDepths&&f.push("depths");var h=this.mergeSource(c);return a?(f.push(h),Function.apply(this,f)):this.source.wrap(["function(",f.join(","),") {\n  ",h,"}"])},mergeSource:function(a){var b=this.environment.isSimple,c=!this.forceBuffer,d=void 0,e=void 0,f=void 0,g=void 0;return this.source.each(function(a){a.appendToBuffer?(f?a.prepend("  + "):f=a,g=a):(f&&(e?f.prepend("buffer += "):d=!0,g.add(";"),f=g=void 0),e=!0,b||(c=!1))}),c?f?(f.prepend("return "),g.add(";")):e||this.source.push('return "";'):(a+=", buffer = "+(d?"":this.initializeBuffer()),f?(f.prepend("return buffer + "),g.add(";")):this.source.push("return buffer;")),a&&this.source.prepend("var "+a.substring(2)+(d?"":";\n")),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return"\n      lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    }\n    ".trim()},blockValue:function(a){var b=this.aliasable("container.hooks.blockHelperMissing"),c=[this.contextName(0)];this.setupHelperArgs(a,0,c);var d=this.popStack();c.splice(1,0,d),this.push(this.source.functionCall(b,"call",c))},ambiguousBlockValue:function(){var a=this.aliasable("container.hooks.blockHelperMissing"),b=[this.contextName(0)];this.setupHelperArgs("",0,b,!0),this.flushInline();var c=this.topStack();b.splice(1,0,c),this.pushSource(["if (!",this.lastHelper,") { ",c," = ",this.source.functionCall(a,"call",b),"}"])},appendContent:function(a){this.pendingContent?a=this.pendingContent+a:this.pendingLocation=this.source.currentLocation,this.pendingContent=a},append:function(){if(this.isInline())this.replaceStack(function(a){return[" != null ? ",a,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var a=this.popStack();this.pushSource(["if (",a," != null) { ",this.appendToBuffer(a,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(a){this.lastContext=a},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(a,b,c,d){var e=0;d||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(a[e++])),this.resolvePath("context",a,e,b,c)},lookupBlockParam:function(a,b){this.useBlockParams=!0,this.push(["blockParams[",a[0],"][",a[1],"]"]),this.resolvePath("context",b,1)},lookupData:function(a,b,c){a?this.pushStackLiteral("container.data(data, "+a+")"):this.pushStackLiteral("data"),this.resolvePath("data",b,0,!0,c)},resolvePath:function(a,b,c,d,e){var g=this;if(this.options.strict||this.options.assumeObjects)return void this.push(f(this.options.strict&&e,this,b,a));for(var h=b.length;c<h;c++)this.replaceStack(function(e){var f=g.nameLookup(e,b[c],a);return d?[" && ",f]:[" != null ? ",f," : ",e]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(a,b){this.pushContext(),this.pushString(b),"SubExpression"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(a){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(a?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(a.ids)),this.stringParams&&(this.push(this.objectLiteral(a.contexts)),this.push(this.objectLiteral(a.types))),this.push(this.objectLiteral(a.values))},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},registerDecorator:function(a,b){var c=this.nameLookup("decorators",b,"decorator"),d=this.setupHelperArgs(b,a);this.decorators.push(["fn = ",this.decorators.functionCall(c,"",["fn","props","container",d])," || fn;"])},invokeHelper:function(a,b,c){var d=this.popStack(),e=this.setupHelper(a,b),f=[];c&&f.push(e.name),f.push(d),this.options.strict||f.push(this.aliasable("container.hooks.helperMissing"));var g=["(",this.itemsSeparatedBy(f,"||"),")"],h=this.source.functionCall(g,"call",e.callParams);this.push(h)},itemsSeparatedBy:function(a,b){var c=[];c.push(a[0]);for(var d=1;d<a.length;d++)c.push(b,a[d]);return c},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(this.source.functionCall(c.name,"call",c.callParams))},invokeAmbiguous:function(a,b){this.useRegister("helper");var c=this.popStack();this.emptyHash();var d=this.setupHelper(0,a,b),e=this.lastHelper=this.nameLookup("helpers",a,"helper"),f=["(","(helper = ",e," || ",c,")"];this.options.strict||(f[0]="(helper = ",f.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",f,d.paramsInit?["),(",d.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",d.callParams)," : helper))"])},invokePartial:function(a,b,c){var d=[],e=this.setupParams(b,1,d);a&&(b=this.popStack(),delete e.name),c&&(e.indent=JSON.stringify(c)),e.helpers="helpers",e.partials="partials",e.decorators="container.decorators",a?d.unshift(b):d.unshift(this.nameLookup("partials",b,"partial")),this.options.compat&&(e.depths="depths"),e=this.objectLiteral(e),d.push(e),this.push(this.source.functionCall("container.invokePartial","",d))},assignToHash:function(a){var b=this.popStack(),c=void 0,d=void 0,e=void 0;this.trackIds&&(e=this.popStack()),this.stringParams&&(d=this.popStack(),c=this.popStack());var f=this.hash;c&&(f.contexts[a]=c),d&&(f.types[a]=d),e&&(f.ids[a]=e),f.values[a]=b},pushId:function(a,b,c){"BlockParam"===a?this.pushStackLiteral("blockParams["+b[0]+"].path["+b[1]+"]"+(c?" + "+JSON.stringify("."+c):"")):"PathExpression"===a?this.pushString(b):"SubExpression"===a?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:e,compileChildren:function(a,b){for(var c=a.children,d=void 0,e=void 0,f=0,g=c.length;f<g;f++){d=c[f],e=new this.compiler;var h=this.matchExistingProgram(d);if(null==h){this.context.programs.push("");var i=this.context.programs.length;d.index=i,d.name="program"+i,this.context.programs[i]=e.compile(d,b,this.context,!this.precompile),this.context.decorators[i]=e.decorators,this.context.environments[i]=d,this.useDepths=this.useDepths||e.useDepths,this.useBlockParams=this.useBlockParams||e.useBlockParams,d.useDepths=this.useDepths,d.useBlockParams=this.useBlockParams}else d.index=h.index,d.name="program"+h.index,this.useDepths=this.useDepths||h.useDepths,this.useBlockParams=this.useBlockParams||h.useBlockParams}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;b<c;b++){var d=this.context.environments[b];if(d&&d.equals(a))return d}},programExpression:function(a){var b=this.environment.children[a],c=[b.index,"data",b.blockParams];return(this.useBlockParams||this.useDepths)&&c.push("blockParams"),this.useDepths&&c.push("depths"),"container.program("+c.join(", ")+")"},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},push:function(a){return a instanceof d||(a=this.source.wrap(a)),this.inlineStack.push(a),a},pushStackLiteral:function(a){this.push(new d(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),a&&this.source.push(a)},replaceStack:function(a){var b=["("],c=void 0,e=void 0,f=void 0;if(!this.isInline())throw new k["default"]("replaceStack on non-inline");var g=this.popStack(!0);if(g instanceof d)c=[g.value],b=["(",c],f=!0;else{e=!0;var h=this.incrStack();b=["((",this.push(h)," = ",g,")"],c=this.topStack()}var i=a.call(this,c);f||this.popStack(),e&&this.stackSlot--,this.push(b.concat(i,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;this.inlineStack=[];for(var b=0,c=a.length;b<c;b++){var e=a[b];if(e instanceof d)this.compileStack.push(e);else{var f=this.incrStack();this.pushSource([f," = ",e,";"]),this.compileStack.push(f)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),c=(b?this.inlineStack:this.compileStack).pop();if(!a&&c instanceof d)return c.value;if(!b){if(!this.stackSlot)throw new k["default"]("Invalid stack pop");this.stackSlot--}return c},topStack:function(){var a=this.isInline()?this.inlineStack:this.compileStack,b=a[a.length-1];return b instanceof d?b.value:b},contextName:function(a){return this.useDepths&&a?"depths["+a+"]":"depth"+a},quotedString:function(a){return this.source.quotedString(a)},objectLiteral:function(a){return this.source.objectLiteral(a)},aliasable:function(a){var b=this.aliases[a];return b?(b.referenceCount++,b):(b=this.aliases[a]=this.source.wrap(a),b.aliasable=!0,b.referenceCount=1,b)},setupHelper:function(a,b,c){var d=[],e=this.setupHelperArgs(b,a,d,c),f=this.nameLookup("helpers",b,"helper"),g=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:d,paramsInit:e,name:f,callParams:[g].concat(d)}},setupParams:function(a,b,c){var d={},e=[],f=[],g=[],h=!c,i=void 0;h&&(c=[]),d.name=this.quotedString(a),d.hash=this.popStack(),this.trackIds&&(d.hashIds=this.popStack()),this.stringParams&&(d.hashTypes=this.popStack(),d.hashContexts=this.popStack());var j=this.popStack(),k=this.popStack();(k||j)&&(d.fn=k||"container.noop",d.inverse=j||"container.noop");for(var l=b;l--;)i=this.popStack(),c[l]=i,this.trackIds&&(g[l]=this.popStack()),this.stringParams&&(f[l]=this.popStack(),e[l]=this.popStack());return h&&(d.args=this.source.generateArray(c)),this.trackIds&&(d.ids=this.source.generateArray(g)),this.stringParams&&(d.types=this.source.generateArray(f),d.contexts=this.source.generateArray(e)),this.options.data&&(d.data="data"),this.useBlockParams&&(d.blockParams="blockParams"),d},setupHelperArgs:function(a,b,c,d){var e=this.setupParams(a,b,c);return e.loc=JSON.stringify(this.source.currentLocation),e=this.objectLiteral(e),d?(this.useRegister("options"),c.push("options"),["options=",e]):c?(c.push(e),""):e}},function(){for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),b=e.RESERVED_WORDS={},c=0,d=a.length;c<d;c++)b[a[c]]=!0}(),e.isValidJavaScriptVariableName=function(a){return!e.RESERVED_WORDS[a]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a)},b["default"]=e,a.exports=b["default"]},function(a,b,c){"use strict";function d(a,b,c){if(g.isArray(a)){for(var d=[],e=0,f=a.length;e<f;e++)d.push(b.wrap(a[e],c));return d}return"boolean"==typeof a||"number"==typeof a?a+"":a}function e(a){this.srcFile=a,this.source=[]}var f=c(13)["default"];b.__esModule=!0;var g=c(5),h=void 0;try{}catch(i){}h||(h=function(a,b,c,d){this.src="",d&&this.add(d)},h.prototype={add:function(a){g.isArray(a)&&(a=a.join("")),this.src+=a},prepend:function(a){g.isArray(a)&&(a=a.join("")),this.src=a+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),e.prototype={isEmpty:function(){return!this.source.length},prepend:function(a,b){this.source.unshift(this.wrap(a,b))},push:function(a,b){this.source.push(this.wrap(a,b))},merge:function(){var a=this.empty();return this.each(function(b){a.add(["  ",b,"\n"])}),a},each:function(a){for(var b=0,c=this.source.length;b<c;b++)a(this.source[b])},empty:function(){var a=this.currentLocation||{start:{}};return new h(a.start.line,a.start.column,this.srcFile)},wrap:function(a){var b=arguments.length<=1||void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return a instanceof h?a:(a=d(a,this,b),new h(b.start.line,b.start.column,this.srcFile,a))},functionCall:function(a,b,c){return c=this.generateList(c),this.wrap([a,b?"."+b+"(":"(",c,")"])},quotedString:function(a){return'"'+(a+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(a){var b=this,c=[];f(a).forEach(function(e){var f=d(a[e],b);"undefined"!==f&&c.push([b.quotedString(e),":",f])});var e=this.generateList(c);return e.prepend("{"),e.add("}"),e},generateList:function(a){for(var b=this.empty(),c=0,e=a.length;c<e;c++)c&&b.add(","),b.add(d(a[c],this));return b},generateArray:function(a){var b=this.generateList(a);return b.prepend("["),b.add("]"),b}},b["default"]=e,a.exports=b["default"]}])});
<!--
// Store the date in a variable
var d = new Date()
var dateText = ""

// Get the current day and convert it to the name of the day
var dayValue = d.getDay()
if (dayValue == 0)
    dateText += "Sun."
else if (dayValue == 1)
    dateText += "Mon."
else if (dayValue == 2)
    dateText += "Tues."
else if (dayValue == 3)
    dateText += "Wed."
else if (dayValue == 4)
    dateText += "Thur."
else if (dayValue == 5)
    dateText += "Fri."
else if (dayValue == 6)
    dateText += "Sat."

// Get the current month and convert it to the name of the month
var monthValue = d.getMonth()
dateText += " "
if (monthValue == 0)
    dateText += "Jan."
if (monthValue == 1)
    dateText += "Feb."
if (monthValue == 2)
    dateText += "Mar."
if (monthValue == 3)
    dateText += "Apr."
if (monthValue == 4)
    dateText += "May"
if (monthValue == 5)
    dateText += "Jun."
if (monthValue == 6)
    dateText += "Jul."
if (monthValue == 7)
    dateText += "Aug."
if (monthValue == 8)
    dateText += "Sept."
if (monthValue == 9)
    dateText += "Oct."
if (monthValue == 10)
    dateText += "Nov."
if (monthValue == 11)
    dateText += "Dec."

// Get the current year; if it's before 2000, add 1900
if (d.getYear() < 2000)
    dateText += " " + d.getDate() + ", " + (1900 + d.getYear())
else
    dateText += " " + d.getDate() + ", " + (d.getYear())

// Get the current minutes
var minuteValue = d.getMinutes()
if (minuteValue < 10)
    minuteValue = "0" + minuteValue

// Get the current hours
var hourValue = d.getHours()

var greeting
var timeText

// Customize the greeting based on the current hours
if (hourValue < 12)
    {
    greeting = "Good morning!"
    timeText = " at " + hourValue + ":" + minuteValue + " AM"
    }
else if (hourValue == 12)
    {
    greeting = "Good afternoon!"
    timeText = " at " + hourValue + ":" + minuteValue + " PM"
    }
else if (hourValue < 17)
    {
    greeting = "Good afternoon!"
    timeText = " at " + (hourValue-12) + ":" + minuteValue + " PM"
    }
else
    {
    greeting = "Good evening!"
    timeText = " at " + (hourValue-12) + ":" + minuteValue + " PM"
    }
// ===================================================================
// Author: Matt Kruse <matt@mattkruse.com>
// WWW: http://www.mattkruse.com/
//
// NOTICE: You may use this code for any purpose, commercial or
// private, without any further permission from the author. You may
// remove this notice from your final code if you wish, however it is
// appreciated by the author if at least my web site address is kept.
//
// You may *NOT* re-distribute this code in any way except through its
// use. That means, you can include it in your product, or your web
// site, or any other form where the code is actually being used. You
// may not put the plain javascript up on your site for download or
// include it in your javascript libraries for download. Instead,
// put a link to my site on your page so users can get the latest
// version of the files. Thanks.
// ===================================================================

// ------------------------------------------------------------------
// These functions use the same 'format' strings as the
// java.text.SimpleDateFormat class, with minor exceptions.
// The format string consists of the following abbreviations:
//
// Field        | Full Form          | Short Form
// -------------+--------------------+-----------------------
// Year         | yyyy (4 digits)    | yy (2 digits), y (2 or 4 digits)
// Month        | MMM (name or abbr.)| MM (2 digits), M (1 or 2 digits)
// Day of Month | dd (2 digits)      | d (1 or 2 digits)
// Hour (1-12)  | hh (2 digits)      | h (1 or 2 digits)
// Hour (0-23)  | HH (2 digits)      | H (1 or 2 digits)
// Hour (0-11)  | KK (2 digits)      | K (1 or 2 digits)
// Hour (1-24)  | kk (2 digits)      | k (1 or 2 digits)
// Minute       | mm (2 digits)      | m (1 or 2 digits)
// Second       | ss (2 digits)      | s (1 or 2 digits)
// AM/PM        | a                  |
//
// NOTE THE DIFFERENCE BETWEEN MM and mm! Month=MM, not mm!
// Examples:
//  "MMM d, y" matches: January 01, 2000
//                      Dec 1, 1900
//                      Nov 20, 00
//  "M/d/yy"   matches: 01/20/00
//                      9/2/00
//  "MMM dd, yyyy hh:mm:ssa" matches: "January 01, 2000 12:30:45AM"
// ------------------------------------------------------------------

var MONTH_NAMES=new Array('January','February','March','April','May','June','July','August','September','October','November','December','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec');
function LZ(x) {return(x<0||x>9?"":"0")+x}

// ------------------------------------------------------------------
// isDate ( date_string, format_string )
// Returns true if date string matches format of format string and
// is a valid date. Else returns false.
// It is recommended that you trim whitespace around the value before
// passing it to this function, as whitespace is NOT ignored!
// ------------------------------------------------------------------
function isDate(val,format) {
	var date=getDateFromFormat(val,format);
	if (date==0) { return false; }
	return true;
	}

// -------------------------------------------------------------------
// compareDates(date1,date1format,date2,date2format)
//   Compare two date strings to see which is greater.
//   Returns:
//   1 if date1 is greater than date2
//   0 if date2 is greater than date1 of if they are the same
//  -1 if either of the dates is in an invalid format
// -------------------------------------------------------------------
function compareDates(date1,dateformat1,date2,dateformat2) {
	var d1=getDateFromFormat(date1,dateformat1);
	var d2=getDateFromFormat(date2,dateformat2);
	if (d1==0 || d2==0) {
		return -1;
		}
	else if (d1 > d2) {
		return 1;
		}
	return 0;
	}

// ------------------------------------------------------------------
// formatDate (date_object, format)
// Returns a date in the output format specified.
// The format string uses the same abbreviations as in getDateFromFormat()
// ------------------------------------------------------------------
function formatDate(date,format) {
	format=format+"";
	var result="";
	var i_format=0;
	var c="";
	var token="";
	var y=date.getYear()+"";
	var M=date.getMonth()+1;
	var d=date.getDate();
	var H=date.getHours();
	var m=date.getMinutes();
	var s=date.getSeconds();
	var yyyy,yy,MMM,MM,dd,hh,h,mm,ss,ampm,HH,H,KK,K,kk,k;
	// Convert real date parts into formatted versions
	var value=new Object();
	if (y.length < 4) {y=""+(y-0+1900);}
	value["y"]=""+y;
	value["yyyy"]=y;
	value["yy"]=y.substring(2,4);
	value["M"]=M;
	value["MM"]=LZ(M);
	value["MMM"]=MONTH_NAMES[M-1];
	value["d"]=d;
	value["dd"]=LZ(d);
	value["H"]=H;
	value["HH"]=LZ(H);
	if (H==0){value["h"]=12;}
	else if (H>12){value["h"]=H-12;}
	else {value["h"]=H;}
	value["hh"]=LZ(value["h"]);
	if (H>11){value["K"]=H-12;} else {value["K"]=H;}
	value["k"]=H+1;
	value["KK"]=LZ(value["K"]);
	value["kk"]=LZ(value["k"]);
	if (H > 11) { value["a"]="PM"; }
	else { value["a"]="AM"; }
	value["m"]=m;
	value["mm"]=LZ(m);
	value["s"]=s;
	value["ss"]=LZ(s);
	while (i_format < format.length) {
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
			}
		if (value[token] != null) { result=result + value[token]; }
		else { result=result + token; }
		}
	return result;
	}

// ------------------------------------------------------------------
// Utility functions for parsing in getDateFromFormat()
// ------------------------------------------------------------------
function _isInteger(val) {
	var digits="1234567890";
	for (var i=0; i < val.length; i++) {
		if (digits.indexOf(val.charAt(i))==-1) { return false; }
		}
	return true;
	}
function _getInt(str,i,minlength,maxlength) {
	for (var x=maxlength; x>=minlength; x--) {
		var token=str.substring(i,i+x);
		if (token.length < minlength) { return null; }
		if (_isInteger(token)) { return token; }
		}
	return null;
	}

// ------------------------------------------------------------------
// getDateFromFormat( date_string , format_string )
//
// This function takes a date string and a format string. It matches
// If the date string matches the format string, it returns the
// getTime() of the date. If it does not match, it returns 0.
// ------------------------------------------------------------------
function getDateFromFormat(val,format) {
	val=val+"";
	format=format+"";
	var i_val=0;
	var i_format=0;
	var c="";
	var token="";
	var token2="";
	var x,y;
	var now=new Date();
	var year=now.getYear();
	var month=now.getMonth()+1;
	var date=now.getDate();
	var hh=now.getHours();
	var mm=now.getMinutes();
	var ss=now.getSeconds();
	var ampm="";

	while (i_format < format.length) {
		// Get next token from format string
		c=format.charAt(i_format);
		token="";
		while ((format.charAt(i_format)==c) && (i_format < format.length)) {
			token += format.charAt(i_format++);
			}
		// Extract contents of value based on format token
		if (token=="yyyy" || token=="yy" || token=="y") {
			if (token=="yyyy") { x=4;y=4; }
			if (token=="yy")   { x=2;y=2; }
			if (token=="y")    { x=2;y=4; }
			year=_getInt(val,i_val,x,y);
			if (year==null) { return 0; }
			i_val += year.length;
			if (year.length==2) {
				if (year > 70) { year=1900+(year-0); }
				else { year=2000+(year-0); }
				}
			}
		else if (token=="MMM"){
			month=0;
			for (var i=0; i<MONTH_NAMES.length; i++) {
				var month_name=MONTH_NAMES[i];
				if (val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()) {
					month=i+1;
					if (month>12) { month -= 12; }
					i_val += month_name.length;
					break;
					}
				}
			if ((month < 1)||(month>12)){return 0;}
			}
		else if (token=="MM"||token=="M") {
			month=_getInt(val,i_val,token.length,2);
			if(month==null||(month<1)||(month>12)){return 0;}
			i_val+=month.length;}
		else if (token=="dd"||token=="d") {
			date=_getInt(val,i_val,token.length,2);
			if(date==null||(date<1)||(date>31)){return 0;}
			i_val+=date.length;}
		else if (token=="hh"||token=="h") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<1)||(hh>12)){return 0;}
			i_val+=hh.length;}
		else if (token=="HH"||token=="H") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<0)||(hh>23)){return 0;}
			i_val+=hh.length;}
		else if (token=="KK"||token=="K") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<0)||(hh>11)){return 0;}
			i_val+=hh.length;}
		else if (token=="kk"||token=="k") {
			hh=_getInt(val,i_val,token.length,2);
			if(hh==null||(hh<1)||(hh>24)){return 0;}
			i_val+=hh.length;hh--;}
		else if (token=="mm"||token=="m") {
			mm=_getInt(val,i_val,token.length,2);
			if(mm==null||(mm<0)||(mm>59)){return 0;}
			i_val+=mm.length;}
		else if (token=="ss"||token=="s") {
			ss=_getInt(val,i_val,token.length,2);
			if(ss==null||(ss<0)||(ss>59)){return 0;}
			i_val+=ss.length;}
		else if (token=="a") {
			if (val.substring(i_val,i_val+2).toLowerCase()=="am") {ampm="AM";}
			else if (val.substring(i_val,i_val+2).toLowerCase()=="pm") {ampm="PM";}
			else {return 0;}
			i_val+=2;}
		else {
			if (val.substring(i_val,i_val+token.length)!=token) {return 0;}
			else {i_val+=token.length;}
			}
		}
	// If there are any trailing characters left in the value, it doesn't match
	if (i_val != val.length) { return 0; }
	// Is date valid for month?
	if (month==2) {
		// Check for leap year
		if ( ( (year%4==0)&&(year%100 != 0) ) || (year%400==0) ) { // leap year
			if (date > 29){ return false; }
			}
		else { if (date > 28) { return false; } }
		}
	if ((month==4)||(month==6)||(month==9)||(month==11)) {
		if (date > 30) { return false; }
		}
	// Correct hours value
	if (hh<12 && ampm=="PM") { hh+=12; }
	else if (hh>11 && ampm=="AM") { hh-=12; }
	var newdate=new Date(year,month-1,date,hh,mm,ss);
	return newdate.getTime();
	}

//-->

//! moment.js
//! version : 2.13.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

;(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    global.moment = factory()
}(this, function () { 'use strict';

    var hookCallback;

    function utils_hooks__hooks () {
        return hookCallback.apply(null, arguments);
    }

    // This is done to register the method called with moment()
    // without creating circular dependencies.
    function setHookCallback (callback) {
        hookCallback = callback;
    }

    function isArray(input) {
        return input instanceof Array || Object.prototype.toString.call(input) === '[object Array]';
    }

    function isDate(input) {
        return input instanceof Date || Object.prototype.toString.call(input) === '[object Date]';
    }

    function map(arr, fn) {
        var res = [], i;
        for (i = 0; i < arr.length; ++i) {
            res.push(fn(arr[i], i));
        }
        return res;
    }

    function hasOwnProp(a, b) {
        return Object.prototype.hasOwnProperty.call(a, b);
    }

    function extend(a, b) {
        for (var i in b) {
            if (hasOwnProp(b, i)) {
                a[i] = b[i];
            }
        }

        if (hasOwnProp(b, 'toString')) {
            a.toString = b.toString;
        }

        if (hasOwnProp(b, 'valueOf')) {
            a.valueOf = b.valueOf;
        }

        return a;
    }

    function create_utc__createUTC (input, format, locale, strict) {
        return createLocalOrUTC(input, format, locale, strict, true).utc();
    }

    function defaultParsingFlags() {
        // We need to deep clone this object.
        return {
            empty           : false,
            unusedTokens    : [],
            unusedInput     : [],
            overflow        : -2,
            charsLeftOver   : 0,
            nullInput       : false,
            invalidMonth    : null,
            invalidFormat   : false,
            userInvalidated : false,
            iso             : false,
            parsedDateParts : [],
            meridiem        : null
        };
    }

    function getParsingFlags(m) {
        if (m._pf == null) {
            m._pf = defaultParsingFlags();
        }
        return m._pf;
    }

    var some;
    if (Array.prototype.some) {
        some = Array.prototype.some;
    } else {
        some = function (fun) {
            var t = Object(this);
            var len = t.length >>> 0;

            for (var i = 0; i < len; i++) {
                if (i in t && fun.call(this, t[i], i, t)) {
                    return true;
                }
            }

            return false;
        };
    }

    function valid__isValid(m) {
        if (m._isValid == null) {
            var flags = getParsingFlags(m);
            var parsedParts = some.call(flags.parsedDateParts, function (i) {
                return i != null;
            });
            m._isValid = !isNaN(m._d.getTime()) &&
                flags.overflow < 0 &&
                !flags.empty &&
                !flags.invalidMonth &&
                !flags.invalidWeekday &&
                !flags.nullInput &&
                !flags.invalidFormat &&
                !flags.userInvalidated &&
                (!flags.meridiem || (flags.meridiem && parsedParts));

            if (m._strict) {
                m._isValid = m._isValid &&
                    flags.charsLeftOver === 0 &&
                    flags.unusedTokens.length === 0 &&
                    flags.bigHour === undefined;
            }
        }
        return m._isValid;
    }

    function valid__createInvalid (flags) {
        var m = create_utc__createUTC(NaN);
        if (flags != null) {
            extend(getParsingFlags(m), flags);
        }
        else {
            getParsingFlags(m).userInvalidated = true;
        }

        return m;
    }

    function isUndefined(input) {
        return input === void 0;
    }

    // Plugins that add properties should also add the key here (null value),
    // so we can properly clone ourselves.
    var momentProperties = utils_hooks__hooks.momentProperties = [];

    function copyConfig(to, from) {
        var i, prop, val;

        if (!isUndefined(from._isAMomentObject)) {
            to._isAMomentObject = from._isAMomentObject;
        }
        if (!isUndefined(from._i)) {
            to._i = from._i;
        }
        if (!isUndefined(from._f)) {
            to._f = from._f;
        }
        if (!isUndefined(from._l)) {
            to._l = from._l;
        }
        if (!isUndefined(from._strict)) {
            to._strict = from._strict;
        }
        if (!isUndefined(from._tzm)) {
            to._tzm = from._tzm;
        }
        if (!isUndefined(from._isUTC)) {
            to._isUTC = from._isUTC;
        }
        if (!isUndefined(from._offset)) {
            to._offset = from._offset;
        }
        if (!isUndefined(from._pf)) {
            to._pf = getParsingFlags(from);
        }
        if (!isUndefined(from._locale)) {
            to._locale = from._locale;
        }

        if (momentProperties.length > 0) {
            for (i in momentProperties) {
                prop = momentProperties[i];
                val = from[prop];
                if (!isUndefined(val)) {
                    to[prop] = val;
                }
            }
        }

        return to;
    }

    var updateInProgress = false;

    // Moment prototype object
    function Moment(config) {
        copyConfig(this, config);
        this._d = new Date(config._d != null ? config._d.getTime() : NaN);
        // Prevent infinite loop in case updateOffset creates new moment
        // objects.
        if (updateInProgress === false) {
            updateInProgress = true;
            utils_hooks__hooks.updateOffset(this);
            updateInProgress = false;
        }
    }

    function isMoment (obj) {
        return obj instanceof Moment || (obj != null && obj._isAMomentObject != null);
    }

    function absFloor (number) {
        if (number < 0) {
            return Math.ceil(number);
        } else {
            return Math.floor(number);
        }
    }

    function toInt(argumentForCoercion) {
        var coercedNumber = +argumentForCoercion,
            value = 0;

        if (coercedNumber !== 0 && isFinite(coercedNumber)) {
            value = absFloor(coercedNumber);
        }

        return value;
    }

    // compare two arrays, return the number of differences
    function compareArrays(array1, array2, dontConvert) {
        var len = Math.min(array1.length, array2.length),
            lengthDiff = Math.abs(array1.length - array2.length),
            diffs = 0,
            i;
        for (i = 0; i < len; i++) {
            if ((dontConvert && array1[i] !== array2[i]) ||
                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))) {
                diffs++;
            }
        }
        return diffs + lengthDiff;
    }

    function warn(msg) {
        if (utils_hooks__hooks.suppressDeprecationWarnings === false &&
                (typeof console !==  'undefined') && console.warn) {
            console.warn('Deprecation warning: ' + msg);
        }
    }

    function deprecate(msg, fn) {
        var firstTime = true;

        return extend(function () {
            if (utils_hooks__hooks.deprecationHandler != null) {
                utils_hooks__hooks.deprecationHandler(null, msg);
            }
            if (firstTime) {
                warn(msg + '\nArguments: ' + Array.prototype.slice.call(arguments).join(', ') + '\n' + (new Error()).stack);
                firstTime = false;
            }
            return fn.apply(this, arguments);
        }, fn);
    }

    var deprecations = {};

    function deprecateSimple(name, msg) {
        if (utils_hooks__hooks.deprecationHandler != null) {
            utils_hooks__hooks.deprecationHandler(name, msg);
        }
        if (!deprecations[name]) {
            warn(msg);
            deprecations[name] = true;
        }
    }

    utils_hooks__hooks.suppressDeprecationWarnings = false;
    utils_hooks__hooks.deprecationHandler = null;

    function isFunction(input) {
        return input instanceof Function || Object.prototype.toString.call(input) === '[object Function]';
    }

    function isObject(input) {
        return Object.prototype.toString.call(input) === '[object Object]';
    }

    function locale_set__set (config) {
        var prop, i;
        for (i in config) {
            prop = config[i];
            if (isFunction(prop)) {
                this[i] = prop;
            } else {
                this['_' + i] = prop;
            }
        }
        this._config = config;
        // Lenient ordinal parsing accepts just a number in addition to
        // number + (possibly) stuff coming from _ordinalParseLenient.
        this._ordinalParseLenient = new RegExp(this._ordinalParse.source + '|' + (/\d{1,2}/).source);
    }

    function mergeConfigs(parentConfig, childConfig) {
        var res = extend({}, parentConfig), prop;
        for (prop in childConfig) {
            if (hasOwnProp(childConfig, prop)) {
                if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {
                    res[prop] = {};
                    extend(res[prop], parentConfig[prop]);
                    extend(res[prop], childConfig[prop]);
                } else if (childConfig[prop] != null) {
                    res[prop] = childConfig[prop];
                } else {
                    delete res[prop];
                }
            }
        }
        return res;
    }

    function Locale(config) {
        if (config != null) {
            this.set(config);
        }
    }

    var keys;

    if (Object.keys) {
        keys = Object.keys;
    } else {
        keys = function (obj) {
            var i, res = [];
            for (i in obj) {
                if (hasOwnProp(obj, i)) {
                    res.push(i);
                }
            }
            return res;
        };
    }

    // internal storage for locale config files
    var locales = {};
    var globalLocale;

    function normalizeLocale(key) {
        return key ? key.toLowerCase().replace('_', '-') : key;
    }

    // pick the locale from the array
    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each
    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root
    function chooseLocale(names) {
        var i = 0, j, next, locale, split;

        while (i < names.length) {
            split = normalizeLocale(names[i]).split('-');
            j = split.length;
            next = normalizeLocale(names[i + 1]);
            next = next ? next.split('-') : null;
            while (j > 0) {
                locale = loadLocale(split.slice(0, j).join('-'));
                if (locale) {
                    return locale;
                }
                if (next && next.length >= j && compareArrays(split, next, true) >= j - 1) {
                    //the next array item is better than a shallower substring of this one
                    break;
                }
                j--;
            }
            i++;
        }
        return null;
    }

    function loadLocale(name) {
        var oldLocale = null;
        // TODO: Find a better way to register and load all the locales in Node
        if (!locales[name] && (typeof module !== 'undefined') &&
                module && module.exports) {
            try {
                oldLocale = globalLocale._abbr;
                require('./locale/' + name);
                // because defineLocale currently also sets the global locale, we
                // want to undo that for lazy loaded locales
                locale_locales__getSetGlobalLocale(oldLocale);
            } catch (e) { }
        }
        return locales[name];
    }

    // This function will load locale and then set the global locale.  If
    // no arguments are passed in, it will simply return the current global
    // locale key.
    function locale_locales__getSetGlobalLocale (key, values) {
        var data;
        if (key) {
            if (isUndefined(values)) {
                data = locale_locales__getLocale(key);
            }
            else {
                data = defineLocale(key, values);
            }

            if (data) {
                // moment.duration._locale = moment._locale = data;
                globalLocale = data;
            }
        }

        return globalLocale._abbr;
    }

    function defineLocale (name, config) {
        if (config !== null) {
            config.abbr = name;
            if (locales[name] != null) {
                deprecateSimple('defineLocaleOverride',
                        'use moment.updateLocale(localeName, config) to change ' +
                        'an existing locale. moment.defineLocale(localeName, ' +
                        'config) should only be used for creating a new locale');
                config = mergeConfigs(locales[name]._config, config);
            } else if (config.parentLocale != null) {
                if (locales[config.parentLocale] != null) {
                    config = mergeConfigs(locales[config.parentLocale]._config, config);
                } else {
                    // treat as if there is no base config
                    deprecateSimple('parentLocaleUndefined',
                            'specified parentLocale is not defined yet');
                }
            }
            locales[name] = new Locale(config);

            // backwards compat for now: also set the locale
            locale_locales__getSetGlobalLocale(name);

            return locales[name];
        } else {
            // useful for testing
            delete locales[name];
            return null;
        }
    }

    function updateLocale(name, config) {
        if (config != null) {
            var locale;
            if (locales[name] != null) {
                config = mergeConfigs(locales[name]._config, config);
            }
            locale = new Locale(config);
            locale.parentLocale = locales[name];
            locales[name] = locale;

            // backwards compat for now: also set the locale
            locale_locales__getSetGlobalLocale(name);
        } else {
            // pass null for config to unupdate, useful for tests
            if (locales[name] != null) {
                if (locales[name].parentLocale != null) {
                    locales[name] = locales[name].parentLocale;
                } else if (locales[name] != null) {
                    delete locales[name];
                }
            }
        }
        return locales[name];
    }

    // returns locale data
    function locale_locales__getLocale (key) {
        var locale;

        if (key && key._locale && key._locale._abbr) {
            key = key._locale._abbr;
        }

        if (!key) {
            return globalLocale;
        }

        if (!isArray(key)) {
            //short-circuit everything else
            locale = loadLocale(key);
            if (locale) {
                return locale;
            }
            key = [key];
        }

        return chooseLocale(key);
    }

    function locale_locales__listLocales() {
        return keys(locales);
    }

    var aliases = {};

    function addUnitAlias (unit, shorthand) {
        var lowerCase = unit.toLowerCase();
        aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;
    }

    function normalizeUnits(units) {
        return typeof units === 'string' ? aliases[units] || aliases[units.toLowerCase()] : undefined;
    }

    function normalizeObjectUnits(inputObject) {
        var normalizedInput = {},
            normalizedProp,
            prop;

        for (prop in inputObject) {
            if (hasOwnProp(inputObject, prop)) {
                normalizedProp = normalizeUnits(prop);
                if (normalizedProp) {
                    normalizedInput[normalizedProp] = inputObject[prop];
                }
            }
        }

        return normalizedInput;
    }

    function makeGetSet (unit, keepTime) {
        return function (value) {
            if (value != null) {
                get_set__set(this, unit, value);
                utils_hooks__hooks.updateOffset(this, keepTime);
                return this;
            } else {
                return get_set__get(this, unit);
            }
        };
    }

    function get_set__get (mom, unit) {
        return mom.isValid() ?
            mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]() : NaN;
    }

    function get_set__set (mom, unit, value) {
        if (mom.isValid()) {
            mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);
        }
    }

    // MOMENTS

    function getSet (units, value) {
        var unit;
        if (typeof units === 'object') {
            for (unit in units) {
                this.set(unit, units[unit]);
            }
        } else {
            units = normalizeUnits(units);
            if (isFunction(this[units])) {
                return this[units](value);
            }
        }
        return this;
    }

    function zeroFill(number, targetLength, forceSign) {
        var absNumber = '' + Math.abs(number),
            zerosToFill = targetLength - absNumber.length,
            sign = number >= 0;
        return (sign ? (forceSign ? '+' : '') : '-') +
            Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) + absNumber;
    }

    var formattingTokens = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;

    var localFormattingTokens = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g;

    var formatFunctions = {};

    var formatTokenFunctions = {};

    // token:    'M'
    // padded:   ['MM', 2]
    // ordinal:  'Mo'
    // callback: function () { this.month() + 1 }
    function addFormatToken (token, padded, ordinal, callback) {
        var func = callback;
        if (typeof callback === 'string') {
            func = function () {
                return this[callback]();
            };
        }
        if (token) {
            formatTokenFunctions[token] = func;
        }
        if (padded) {
            formatTokenFunctions[padded[0]] = function () {
                return zeroFill(func.apply(this, arguments), padded[1], padded[2]);
            };
        }
        if (ordinal) {
            formatTokenFunctions[ordinal] = function () {
                return this.localeData().ordinal(func.apply(this, arguments), token);
            };
        }
    }

    function removeFormattingTokens(input) {
        if (input.match(/\[[\s\S]/)) {
            return input.replace(/^\[|\]$/g, '');
        }
        return input.replace(/\\/g, '');
    }

    function makeFormatFunction(format) {
        var array = format.match(formattingTokens), i, length;

        for (i = 0, length = array.length; i < length; i++) {
            if (formatTokenFunctions[array[i]]) {
                array[i] = formatTokenFunctions[array[i]];
            } else {
                array[i] = removeFormattingTokens(array[i]);
            }
        }

        return function (mom) {
            var output = '', i;
            for (i = 0; i < length; i++) {
                output += array[i] instanceof Function ? array[i].call(mom, format) : array[i];
            }
            return output;
        };
    }

    // format date using native date object
    function formatMoment(m, format) {
        if (!m.isValid()) {
            return m.localeData().invalidDate();
        }

        format = expandFormat(format, m.localeData());
        formatFunctions[format] = formatFunctions[format] || makeFormatFunction(format);

        return formatFunctions[format](m);
    }

    function expandFormat(format, locale) {
        var i = 5;

        function replaceLongDateFormatTokens(input) {
            return locale.longDateFormat(input) || input;
        }

        localFormattingTokens.lastIndex = 0;
        while (i >= 0 && localFormattingTokens.test(format)) {
            format = format.replace(localFormattingTokens, replaceLongDateFormatTokens);
            localFormattingTokens.lastIndex = 0;
            i -= 1;
        }

        return format;
    }

    var match1         = /\d/;            //       0 - 9
    var match2         = /\d\d/;          //      00 - 99
    var match3         = /\d{3}/;         //     000 - 999
    var match4         = /\d{4}/;         //    0000 - 9999
    var match6         = /[+-]?\d{6}/;    // -999999 - 999999
    var match1to2      = /\d\d?/;         //       0 - 99
    var match3to4      = /\d\d\d\d?/;     //     999 - 9999
    var match5to6      = /\d\d\d\d\d\d?/; //   99999 - 999999
    var match1to3      = /\d{1,3}/;       //       0 - 999
    var match1to4      = /\d{1,4}/;       //       0 - 9999
    var match1to6      = /[+-]?\d{1,6}/;  // -999999 - 999999

    var matchUnsigned  = /\d+/;           //       0 - inf
    var matchSigned    = /[+-]?\d+/;      //    -inf - inf

    var matchOffset    = /Z|[+-]\d\d:?\d\d/gi; // +00:00 -00:00 +0000 -0000 or Z
    var matchShortOffset = /Z|[+-]\d\d(?::?\d\d)?/gi; // +00 -00 +00:00 -00:00 +0000 -0000 or Z

    var matchTimestamp = /[+-]?\d+(\.\d{1,3})?/; // 123456789 123456789.123

    // any word (or two) characters or numbers including two/three word month in arabic.
    // includes scottish gaelic two word and hyphenated months
    var matchWord = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i;


    var regexes = {};

    function addRegexToken (token, regex, strictRegex) {
        regexes[token] = isFunction(regex) ? regex : function (isStrict, localeData) {
            return (isStrict && strictRegex) ? strictRegex : regex;
        };
    }

    function getParseRegexForToken (token, config) {
        if (!hasOwnProp(regexes, token)) {
            return new RegExp(unescapeFormat(token));
        }

        return regexes[token](config._strict, config._locale);
    }

    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript
    function unescapeFormat(s) {
        return regexEscape(s.replace('\\', '').replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (matched, p1, p2, p3, p4) {
            return p1 || p2 || p3 || p4;
        }));
    }

    function regexEscape(s) {
        return s.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&');
    }

    var tokens = {};

    function addParseToken (token, callback) {
        var i, func = callback;
        if (typeof token === 'string') {
            token = [token];
        }
        if (typeof callback === 'number') {
            func = function (input, array) {
                array[callback] = toInt(input);
            };
        }
        for (i = 0; i < token.length; i++) {
            tokens[token[i]] = func;
        }
    }

    function addWeekParseToken (token, callback) {
        addParseToken(token, function (input, array, config, token) {
            config._w = config._w || {};
            callback(input, config._w, config, token);
        });
    }

    function addTimeToArrayFromToken(token, input, config) {
        if (input != null && hasOwnProp(tokens, token)) {
            tokens[token](input, config._a, config, token);
        }
    }

    var YEAR = 0;
    var MONTH = 1;
    var DATE = 2;
    var HOUR = 3;
    var MINUTE = 4;
    var SECOND = 5;
    var MILLISECOND = 6;
    var WEEK = 7;
    var WEEKDAY = 8;

    var indexOf;

    if (Array.prototype.indexOf) {
        indexOf = Array.prototype.indexOf;
    } else {
        indexOf = function (o) {
            // I know
            var i;
            for (i = 0; i < this.length; ++i) {
                if (this[i] === o) {
                    return i;
                }
            }
            return -1;
        };
    }

    function daysInMonth(year, month) {
        return new Date(Date.UTC(year, month + 1, 0)).getUTCDate();
    }

    // FORMATTING

    addFormatToken('M', ['MM', 2], 'Mo', function () {
        return this.month() + 1;
    });

    addFormatToken('MMM', 0, 0, function (format) {
        return this.localeData().monthsShort(this, format);
    });

    addFormatToken('MMMM', 0, 0, function (format) {
        return this.localeData().months(this, format);
    });

    // ALIASES

    addUnitAlias('month', 'M');

    // PARSING

    addRegexToken('M',    match1to2);
    addRegexToken('MM',   match1to2, match2);
    addRegexToken('MMM',  function (isStrict, locale) {
        return locale.monthsShortRegex(isStrict);
    });
    addRegexToken('MMMM', function (isStrict, locale) {
        return locale.monthsRegex(isStrict);
    });

    addParseToken(['M', 'MM'], function (input, array) {
        array[MONTH] = toInt(input) - 1;
    });

    addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {
        var month = config._locale.monthsParse(input, token, config._strict);
        // if we didn't find a month name, mark the date as invalid.
        if (month != null) {
            array[MONTH] = month;
        } else {
            getParsingFlags(config).invalidMonth = input;
        }
    });

    // LOCALES

    var MONTHS_IN_FORMAT = /D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/;
    var defaultLocaleMonths = 'January_February_March_April_May_June_July_August_September_October_November_December'.split('_');
    function localeMonths (m, format) {
        return isArray(this._months) ? this._months[m.month()] :
            this._months[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
    }

    var defaultLocaleMonthsShort = 'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_');
    function localeMonthsShort (m, format) {
        return isArray(this._monthsShort) ? this._monthsShort[m.month()] :
            this._monthsShort[MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'][m.month()];
    }

    function units_month__handleStrictParse(monthName, format, strict) {
        var i, ii, mom, llc = monthName.toLocaleLowerCase();
        if (!this._monthsParse) {
            // this is not used
            this._monthsParse = [];
            this._longMonthsParse = [];
            this._shortMonthsParse = [];
            for (i = 0; i < 12; ++i) {
                mom = create_utc__createUTC([2000, i]);
                this._shortMonthsParse[i] = this.monthsShort(mom, '').toLocaleLowerCase();
                this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();
            }
        }

        if (strict) {
            if (format === 'MMM') {
                ii = indexOf.call(this._shortMonthsParse, llc);
                return ii !== -1 ? ii : null;
            } else {
                ii = indexOf.call(this._longMonthsParse, llc);
                return ii !== -1 ? ii : null;
            }
        } else {
            if (format === 'MMM') {
                ii = indexOf.call(this._shortMonthsParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._longMonthsParse, llc);
                return ii !== -1 ? ii : null;
            } else {
                ii = indexOf.call(this._longMonthsParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._shortMonthsParse, llc);
                return ii !== -1 ? ii : null;
            }
        }
    }

    function localeMonthsParse (monthName, format, strict) {
        var i, mom, regex;

        if (this._monthsParseExact) {
            return units_month__handleStrictParse.call(this, monthName, format, strict);
        }

        if (!this._monthsParse) {
            this._monthsParse = [];
            this._longMonthsParse = [];
            this._shortMonthsParse = [];
        }

        // TODO: add sorting
        // Sorting makes sure if one month (or abbr) is a prefix of another
        // see sorting in computeMonthsParse
        for (i = 0; i < 12; i++) {
            // make the regex if we don't have it already
            mom = create_utc__createUTC([2000, i]);
            if (strict && !this._longMonthsParse[i]) {
                this._longMonthsParse[i] = new RegExp('^' + this.months(mom, '').replace('.', '') + '$', 'i');
                this._shortMonthsParse[i] = new RegExp('^' + this.monthsShort(mom, '').replace('.', '') + '$', 'i');
            }
            if (!strict && !this._monthsParse[i]) {
                regex = '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');
                this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');
            }
            // test the regex
            if (strict && format === 'MMMM' && this._longMonthsParse[i].test(monthName)) {
                return i;
            } else if (strict && format === 'MMM' && this._shortMonthsParse[i].test(monthName)) {
                return i;
            } else if (!strict && this._monthsParse[i].test(monthName)) {
                return i;
            }
        }
    }

    // MOMENTS

    function setMonth (mom, value) {
        var dayOfMonth;

        if (!mom.isValid()) {
            // No op
            return mom;
        }

        if (typeof value === 'string') {
            if (/^\d+$/.test(value)) {
                value = toInt(value);
            } else {
                value = mom.localeData().monthsParse(value);
                // TODO: Another silent failure?
                if (typeof value !== 'number') {
                    return mom;
                }
            }
        }

        dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));
        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);
        return mom;
    }

    function getSetMonth (value) {
        if (value != null) {
            setMonth(this, value);
            utils_hooks__hooks.updateOffset(this, true);
            return this;
        } else {
            return get_set__get(this, 'Month');
        }
    }

    function getDaysInMonth () {
        return daysInMonth(this.year(), this.month());
    }

    var defaultMonthsShortRegex = matchWord;
    function monthsShortRegex (isStrict) {
        if (this._monthsParseExact) {
            if (!hasOwnProp(this, '_monthsRegex')) {
                computeMonthsParse.call(this);
            }
            if (isStrict) {
                return this._monthsShortStrictRegex;
            } else {
                return this._monthsShortRegex;
            }
        } else {
            return this._monthsShortStrictRegex && isStrict ?
                this._monthsShortStrictRegex : this._monthsShortRegex;
        }
    }

    var defaultMonthsRegex = matchWord;
    function monthsRegex (isStrict) {
        if (this._monthsParseExact) {
            if (!hasOwnProp(this, '_monthsRegex')) {
                computeMonthsParse.call(this);
            }
            if (isStrict) {
                return this._monthsStrictRegex;
            } else {
                return this._monthsRegex;
            }
        } else {
            return this._monthsStrictRegex && isStrict ?
                this._monthsStrictRegex : this._monthsRegex;
        }
    }

    function computeMonthsParse () {
        function cmpLenRev(a, b) {
            return b.length - a.length;
        }

        var shortPieces = [], longPieces = [], mixedPieces = [],
            i, mom;
        for (i = 0; i < 12; i++) {
            // make the regex if we don't have it already
            mom = create_utc__createUTC([2000, i]);
            shortPieces.push(this.monthsShort(mom, ''));
            longPieces.push(this.months(mom, ''));
            mixedPieces.push(this.months(mom, ''));
            mixedPieces.push(this.monthsShort(mom, ''));
        }
        // Sorting makes sure if one month (or abbr) is a prefix of another it
        // will match the longer piece.
        shortPieces.sort(cmpLenRev);
        longPieces.sort(cmpLenRev);
        mixedPieces.sort(cmpLenRev);
        for (i = 0; i < 12; i++) {
            shortPieces[i] = regexEscape(shortPieces[i]);
            longPieces[i] = regexEscape(longPieces[i]);
            mixedPieces[i] = regexEscape(mixedPieces[i]);
        }

        this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
        this._monthsShortRegex = this._monthsRegex;
        this._monthsStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
        this._monthsShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
    }

    function checkOverflow (m) {
        var overflow;
        var a = m._a;

        if (a && getParsingFlags(m).overflow === -2) {
            overflow =
                a[MONTH]       < 0 || a[MONTH]       > 11  ? MONTH :
                a[DATE]        < 1 || a[DATE]        > daysInMonth(a[YEAR], a[MONTH]) ? DATE :
                a[HOUR]        < 0 || a[HOUR]        > 24 || (a[HOUR] === 24 && (a[MINUTE] !== 0 || a[SECOND] !== 0 || a[MILLISECOND] !== 0)) ? HOUR :
                a[MINUTE]      < 0 || a[MINUTE]      > 59  ? MINUTE :
                a[SECOND]      < 0 || a[SECOND]      > 59  ? SECOND :
                a[MILLISECOND] < 0 || a[MILLISECOND] > 999 ? MILLISECOND :
                -1;

            if (getParsingFlags(m)._overflowDayOfYear && (overflow < YEAR || overflow > DATE)) {
                overflow = DATE;
            }
            if (getParsingFlags(m)._overflowWeeks && overflow === -1) {
                overflow = WEEK;
            }
            if (getParsingFlags(m)._overflowWeekday && overflow === -1) {
                overflow = WEEKDAY;
            }

            getParsingFlags(m).overflow = overflow;
        }

        return m;
    }

    // iso 8601 regex
    // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)
    var extendedIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/;
    var basicIsoRegex = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/;

    var tzRegex = /Z|[+-]\d\d(?::?\d\d)?/;

    var isoDates = [
        ['YYYYYY-MM-DD', /[+-]\d{6}-\d\d-\d\d/],
        ['YYYY-MM-DD', /\d{4}-\d\d-\d\d/],
        ['GGGG-[W]WW-E', /\d{4}-W\d\d-\d/],
        ['GGGG-[W]WW', /\d{4}-W\d\d/, false],
        ['YYYY-DDD', /\d{4}-\d{3}/],
        ['YYYY-MM', /\d{4}-\d\d/, false],
        ['YYYYYYMMDD', /[+-]\d{10}/],
        ['YYYYMMDD', /\d{8}/],
        // YYYYMM is NOT allowed by the standard
        ['GGGG[W]WWE', /\d{4}W\d{3}/],
        ['GGGG[W]WW', /\d{4}W\d{2}/, false],
        ['YYYYDDD', /\d{7}/]
    ];

    // iso time formats and regexes
    var isoTimes = [
        ['HH:mm:ss.SSSS', /\d\d:\d\d:\d\d\.\d+/],
        ['HH:mm:ss,SSSS', /\d\d:\d\d:\d\d,\d+/],
        ['HH:mm:ss', /\d\d:\d\d:\d\d/],
        ['HH:mm', /\d\d:\d\d/],
        ['HHmmss.SSSS', /\d\d\d\d\d\d\.\d+/],
        ['HHmmss,SSSS', /\d\d\d\d\d\d,\d+/],
        ['HHmmss', /\d\d\d\d\d\d/],
        ['HHmm', /\d\d\d\d/],
        ['HH', /\d\d/]
    ];

    var aspNetJsonRegex = /^\/?Date\((\-?\d+)/i;

    // date from iso format
    function configFromISO(config) {
        var i, l,
            string = config._i,
            match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),
            allowTime, dateFormat, timeFormat, tzFormat;

        if (match) {
            getParsingFlags(config).iso = true;

            for (i = 0, l = isoDates.length; i < l; i++) {
                if (isoDates[i][1].exec(match[1])) {
                    dateFormat = isoDates[i][0];
                    allowTime = isoDates[i][2] !== false;
                    break;
                }
            }
            if (dateFormat == null) {
                config._isValid = false;
                return;
            }
            if (match[3]) {
                for (i = 0, l = isoTimes.length; i < l; i++) {
                    if (isoTimes[i][1].exec(match[3])) {
                        // match[2] should be 'T' or space
                        timeFormat = (match[2] || ' ') + isoTimes[i][0];
                        break;
                    }
                }
                if (timeFormat == null) {
                    config._isValid = false;
                    return;
                }
            }
            if (!allowTime && timeFormat != null) {
                config._isValid = false;
                return;
            }
            if (match[4]) {
                if (tzRegex.exec(match[4])) {
                    tzFormat = 'Z';
                } else {
                    config._isValid = false;
                    return;
                }
            }
            config._f = dateFormat + (timeFormat || '') + (tzFormat || '');
            configFromStringAndFormat(config);
        } else {
            config._isValid = false;
        }
    }

    // date from iso format or fallback
    function configFromString(config) {
        var matched = aspNetJsonRegex.exec(config._i);

        if (matched !== null) {
            config._d = new Date(+matched[1]);
            return;
        }

        configFromISO(config);
        if (config._isValid === false) {
            delete config._isValid;
            utils_hooks__hooks.createFromInputFallback(config);
        }
    }

    utils_hooks__hooks.createFromInputFallback = deprecate(
        'moment construction falls back to js Date. This is ' +
        'discouraged and will be removed in upcoming major ' +
        'release. Please refer to ' +
        'https://github.com/moment/moment/issues/1407 for more info.',
        function (config) {
            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));
        }
    );

    function createDate (y, m, d, h, M, s, ms) {
        //can't just apply() to create a date:
        //http://stackoverflow.com/questions/181348/instantiating-a-javascript-object-by-calling-prototype-constructor-apply
        var date = new Date(y, m, d, h, M, s, ms);

        //the date constructor remaps years 0-99 to 1900-1999
        if (y < 100 && y >= 0 && isFinite(date.getFullYear())) {
            date.setFullYear(y);
        }
        return date;
    }

    function createUTCDate (y) {
        var date = new Date(Date.UTC.apply(null, arguments));

        //the Date.UTC function remaps years 0-99 to 1900-1999
        if (y < 100 && y >= 0 && isFinite(date.getUTCFullYear())) {
            date.setUTCFullYear(y);
        }
        return date;
    }

    // FORMATTING

    addFormatToken('Y', 0, 0, function () {
        var y = this.year();
        return y <= 9999 ? '' + y : '+' + y;
    });

    addFormatToken(0, ['YY', 2], 0, function () {
        return this.year() % 100;
    });

    addFormatToken(0, ['YYYY',   4],       0, 'year');
    addFormatToken(0, ['YYYYY',  5],       0, 'year');
    addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');

    // ALIASES

    addUnitAlias('year', 'y');

    // PARSING

    addRegexToken('Y',      matchSigned);
    addRegexToken('YY',     match1to2, match2);
    addRegexToken('YYYY',   match1to4, match4);
    addRegexToken('YYYYY',  match1to6, match6);
    addRegexToken('YYYYYY', match1to6, match6);

    addParseToken(['YYYYY', 'YYYYYY'], YEAR);
    addParseToken('YYYY', function (input, array) {
        array[YEAR] = input.length === 2 ? utils_hooks__hooks.parseTwoDigitYear(input) : toInt(input);
    });
    addParseToken('YY', function (input, array) {
        array[YEAR] = utils_hooks__hooks.parseTwoDigitYear(input);
    });
    addParseToken('Y', function (input, array) {
        array[YEAR] = parseInt(input, 10);
    });

    // HELPERS

    function daysInYear(year) {
        return isLeapYear(year) ? 366 : 365;
    }

    function isLeapYear(year) {
        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
    }

    // HOOKS

    utils_hooks__hooks.parseTwoDigitYear = function (input) {
        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);
    };

    // MOMENTS

    var getSetYear = makeGetSet('FullYear', true);

    function getIsLeapYear () {
        return isLeapYear(this.year());
    }

    // start-of-first-week - start-of-year
    function firstWeekOffset(year, dow, doy) {
        var // first-week day -- which january is always in the first week (4 for iso, 1 for other)
            fwd = 7 + dow - doy,
            // first-week day local weekday -- which local weekday is fwd
            fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;

        return -fwdlw + fwd - 1;
    }

    //http://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday
    function dayOfYearFromWeeks(year, week, weekday, dow, doy) {
        var localWeekday = (7 + weekday - dow) % 7,
            weekOffset = firstWeekOffset(year, dow, doy),
            dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,
            resYear, resDayOfYear;

        if (dayOfYear <= 0) {
            resYear = year - 1;
            resDayOfYear = daysInYear(resYear) + dayOfYear;
        } else if (dayOfYear > daysInYear(year)) {
            resYear = year + 1;
            resDayOfYear = dayOfYear - daysInYear(year);
        } else {
            resYear = year;
            resDayOfYear = dayOfYear;
        }

        return {
            year: resYear,
            dayOfYear: resDayOfYear
        };
    }

    function weekOfYear(mom, dow, doy) {
        var weekOffset = firstWeekOffset(mom.year(), dow, doy),
            week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,
            resWeek, resYear;

        if (week < 1) {
            resYear = mom.year() - 1;
            resWeek = week + weeksInYear(resYear, dow, doy);
        } else if (week > weeksInYear(mom.year(), dow, doy)) {
            resWeek = week - weeksInYear(mom.year(), dow, doy);
            resYear = mom.year() + 1;
        } else {
            resYear = mom.year();
            resWeek = week;
        }

        return {
            week: resWeek,
            year: resYear
        };
    }

    function weeksInYear(year, dow, doy) {
        var weekOffset = firstWeekOffset(year, dow, doy),
            weekOffsetNext = firstWeekOffset(year + 1, dow, doy);
        return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;
    }

    // Pick the first defined of two or three arguments.
    function defaults(a, b, c) {
        if (a != null) {
            return a;
        }
        if (b != null) {
            return b;
        }
        return c;
    }

    function currentDateArray(config) {
        // hooks is actually the exported moment object
        var nowValue = new Date(utils_hooks__hooks.now());
        if (config._useUTC) {
            return [nowValue.getUTCFullYear(), nowValue.getUTCMonth(), nowValue.getUTCDate()];
        }
        return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];
    }

    // convert an array to a date.
    // the array should mirror the parameters below
    // note: all values past the year are optional and will default to the lowest possible value.
    // [year, month, day , hour, minute, second, millisecond]
    function configFromArray (config) {
        var i, date, input = [], currentDate, yearToUse;

        if (config._d) {
            return;
        }

        currentDate = currentDateArray(config);

        //compute day of the year from weeks and weekdays
        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {
            dayOfYearFromWeekInfo(config);
        }

        //if the day of the year is set, figure out what it is
        if (config._dayOfYear) {
            yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);

            if (config._dayOfYear > daysInYear(yearToUse)) {
                getParsingFlags(config)._overflowDayOfYear = true;
            }

            date = createUTCDate(yearToUse, 0, config._dayOfYear);
            config._a[MONTH] = date.getUTCMonth();
            config._a[DATE] = date.getUTCDate();
        }

        // Default to current date.
        // * if no year, month, day of month are given, default to today
        // * if day of month is given, default month and year
        // * if month is given, default only year
        // * if year is given, don't default anything
        for (i = 0; i < 3 && config._a[i] == null; ++i) {
            config._a[i] = input[i] = currentDate[i];
        }

        // Zero out whatever was not defaulted, including time
        for (; i < 7; i++) {
            config._a[i] = input[i] = (config._a[i] == null) ? (i === 2 ? 1 : 0) : config._a[i];
        }

        // Check for 24:00:00.000
        if (config._a[HOUR] === 24 &&
                config._a[MINUTE] === 0 &&
                config._a[SECOND] === 0 &&
                config._a[MILLISECOND] === 0) {
            config._nextDay = true;
            config._a[HOUR] = 0;
        }

        config._d = (config._useUTC ? createUTCDate : createDate).apply(null, input);
        // Apply timezone offset from input. The actual utcOffset can be changed
        // with parseZone.
        if (config._tzm != null) {
            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);
        }

        if (config._nextDay) {
            config._a[HOUR] = 24;
        }
    }

    function dayOfYearFromWeekInfo(config) {
        var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow;

        w = config._w;
        if (w.GG != null || w.W != null || w.E != null) {
            dow = 1;
            doy = 4;

            // TODO: We need to take the current isoWeekYear, but that depends on
            // how we interpret now (local, utc, fixed offset). So create
            // a now version of current config (take local/utc/offset flags, and
            // create now).
            weekYear = defaults(w.GG, config._a[YEAR], weekOfYear(local__createLocal(), 1, 4).year);
            week = defaults(w.W, 1);
            weekday = defaults(w.E, 1);
            if (weekday < 1 || weekday > 7) {
                weekdayOverflow = true;
            }
        } else {
            dow = config._locale._week.dow;
            doy = config._locale._week.doy;

            weekYear = defaults(w.gg, config._a[YEAR], weekOfYear(local__createLocal(), dow, doy).year);
            week = defaults(w.w, 1);

            if (w.d != null) {
                // weekday -- low day numbers are considered next week
                weekday = w.d;
                if (weekday < 0 || weekday > 6) {
                    weekdayOverflow = true;
                }
            } else if (w.e != null) {
                // local weekday -- counting starts from begining of week
                weekday = w.e + dow;
                if (w.e < 0 || w.e > 6) {
                    weekdayOverflow = true;
                }
            } else {
                // default to begining of week
                weekday = dow;
            }
        }
        if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {
            getParsingFlags(config)._overflowWeeks = true;
        } else if (weekdayOverflow != null) {
            getParsingFlags(config)._overflowWeekday = true;
        } else {
            temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);
            config._a[YEAR] = temp.year;
            config._dayOfYear = temp.dayOfYear;
        }
    }

    // constant that refers to the ISO standard
    utils_hooks__hooks.ISO_8601 = function () {};

    // date from string and format string
    function configFromStringAndFormat(config) {
        // TODO: Move this to another part of the creation flow to prevent circular deps
        if (config._f === utils_hooks__hooks.ISO_8601) {
            configFromISO(config);
            return;
        }

        config._a = [];
        getParsingFlags(config).empty = true;

        // This array is used to make a Date, either with `new Date` or `Date.UTC`
        var string = '' + config._i,
            i, parsedInput, tokens, token, skipped,
            stringLength = string.length,
            totalParsedInputLength = 0;

        tokens = expandFormat(config._f, config._locale).match(formattingTokens) || [];

        for (i = 0; i < tokens.length; i++) {
            token = tokens[i];
            parsedInput = (string.match(getParseRegexForToken(token, config)) || [])[0];
            // console.log('token', token, 'parsedInput', parsedInput,
            //         'regex', getParseRegexForToken(token, config));
            if (parsedInput) {
                skipped = string.substr(0, string.indexOf(parsedInput));
                if (skipped.length > 0) {
                    getParsingFlags(config).unusedInput.push(skipped);
                }
                string = string.slice(string.indexOf(parsedInput) + parsedInput.length);
                totalParsedInputLength += parsedInput.length;
            }
            // don't parse if it's not a known token
            if (formatTokenFunctions[token]) {
                if (parsedInput) {
                    getParsingFlags(config).empty = false;
                }
                else {
                    getParsingFlags(config).unusedTokens.push(token);
                }
                addTimeToArrayFromToken(token, parsedInput, config);
            }
            else if (config._strict && !parsedInput) {
                getParsingFlags(config).unusedTokens.push(token);
            }
        }

        // add remaining unparsed input length to the string
        getParsingFlags(config).charsLeftOver = stringLength - totalParsedInputLength;
        if (string.length > 0) {
            getParsingFlags(config).unusedInput.push(string);
        }

        // clear _12h flag if hour is <= 12
        if (getParsingFlags(config).bigHour === true &&
                config._a[HOUR] <= 12 &&
                config._a[HOUR] > 0) {
            getParsingFlags(config).bigHour = undefined;
        }

        getParsingFlags(config).parsedDateParts = config._a.slice(0);
        getParsingFlags(config).meridiem = config._meridiem;
        // handle meridiem
        config._a[HOUR] = meridiemFixWrap(config._locale, config._a[HOUR], config._meridiem);

        configFromArray(config);
        checkOverflow(config);
    }


    function meridiemFixWrap (locale, hour, meridiem) {
        var isPm;

        if (meridiem == null) {
            // nothing to do
            return hour;
        }
        if (locale.meridiemHour != null) {
            return locale.meridiemHour(hour, meridiem);
        } else if (locale.isPM != null) {
            // Fallback
            isPm = locale.isPM(meridiem);
            if (isPm && hour < 12) {
                hour += 12;
            }
            if (!isPm && hour === 12) {
                hour = 0;
            }
            return hour;
        } else {
            // this is not supposed to happen
            return hour;
        }
    }

    // date from string and array of format strings
    function configFromStringAndArray(config) {
        var tempConfig,
            bestMoment,

            scoreToBeat,
            i,
            currentScore;

        if (config._f.length === 0) {
            getParsingFlags(config).invalidFormat = true;
            config._d = new Date(NaN);
            return;
        }

        for (i = 0; i < config._f.length; i++) {
            currentScore = 0;
            tempConfig = copyConfig({}, config);
            if (config._useUTC != null) {
                tempConfig._useUTC = config._useUTC;
            }
            tempConfig._f = config._f[i];
            configFromStringAndFormat(tempConfig);

            if (!valid__isValid(tempConfig)) {
                continue;
            }

            // if there is any input that was not parsed add a penalty for that format
            currentScore += getParsingFlags(tempConfig).charsLeftOver;

            //or tokens
            currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;

            getParsingFlags(tempConfig).score = currentScore;

            if (scoreToBeat == null || currentScore < scoreToBeat) {
                scoreToBeat = currentScore;
                bestMoment = tempConfig;
            }
        }

        extend(config, bestMoment || tempConfig);
    }

    function configFromObject(config) {
        if (config._d) {
            return;
        }

        var i = normalizeObjectUnits(config._i);
        config._a = map([i.year, i.month, i.day || i.date, i.hour, i.minute, i.second, i.millisecond], function (obj) {
            return obj && parseInt(obj, 10);
        });

        configFromArray(config);
    }

    function createFromConfig (config) {
        var res = new Moment(checkOverflow(prepareConfig(config)));
        if (res._nextDay) {
            // Adding is smart enough around DST
            res.add(1, 'd');
            res._nextDay = undefined;
        }

        return res;
    }

    function prepareConfig (config) {
        var input = config._i,
            format = config._f;

        config._locale = config._locale || locale_locales__getLocale(config._l);

        if (input === null || (format === undefined && input === '')) {
            return valid__createInvalid({nullInput: true});
        }

        if (typeof input === 'string') {
            config._i = input = config._locale.preparse(input);
        }

        if (isMoment(input)) {
            return new Moment(checkOverflow(input));
        } else if (isArray(format)) {
            configFromStringAndArray(config);
        } else if (format) {
            configFromStringAndFormat(config);
        } else if (isDate(input)) {
            config._d = input;
        } else {
            configFromInput(config);
        }

        if (!valid__isValid(config)) {
            config._d = null;
        }

        return config;
    }

    function configFromInput(config) {
        var input = config._i;
        if (input === undefined) {
            config._d = new Date(utils_hooks__hooks.now());
        } else if (isDate(input)) {
            config._d = new Date(input.valueOf());
        } else if (typeof input === 'string') {
            configFromString(config);
        } else if (isArray(input)) {
            config._a = map(input.slice(0), function (obj) {
                return parseInt(obj, 10);
            });
            configFromArray(config);
        } else if (typeof(input) === 'object') {
            configFromObject(config);
        } else if (typeof(input) === 'number') {
            // from milliseconds
            config._d = new Date(input);
        } else {
            utils_hooks__hooks.createFromInputFallback(config);
        }
    }

    function createLocalOrUTC (input, format, locale, strict, isUTC) {
        var c = {};

        if (typeof(locale) === 'boolean') {
            strict = locale;
            locale = undefined;
        }
        // object construction must be done this way.
        // https://github.com/moment/moment/issues/1423
        c._isAMomentObject = true;
        c._useUTC = c._isUTC = isUTC;
        c._l = locale;
        c._i = input;
        c._f = format;
        c._strict = strict;

        return createFromConfig(c);
    }

    function local__createLocal (input, format, locale, strict) {
        return createLocalOrUTC(input, format, locale, strict, false);
    }

    var prototypeMin = deprecate(
         'moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548',
         function () {
             var other = local__createLocal.apply(null, arguments);
             if (this.isValid() && other.isValid()) {
                 return other < this ? this : other;
             } else {
                 return valid__createInvalid();
             }
         }
     );

    var prototypeMax = deprecate(
        'moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548',
        function () {
            var other = local__createLocal.apply(null, arguments);
            if (this.isValid() && other.isValid()) {
                return other > this ? this : other;
            } else {
                return valid__createInvalid();
            }
        }
    );

    // Pick a moment m from moments so that m[fn](other) is true for all
    // other. This relies on the function fn to be transitive.
    //
    // moments should either be an array of moment objects or an array, whose
    // first element is an array of moment objects.
    function pickBy(fn, moments) {
        var res, i;
        if (moments.length === 1 && isArray(moments[0])) {
            moments = moments[0];
        }
        if (!moments.length) {
            return local__createLocal();
        }
        res = moments[0];
        for (i = 1; i < moments.length; ++i) {
            if (!moments[i].isValid() || moments[i][fn](res)) {
                res = moments[i];
            }
        }
        return res;
    }

    // TODO: Use [].sort instead?
    function min () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isBefore', args);
    }

    function max () {
        var args = [].slice.call(arguments, 0);

        return pickBy('isAfter', args);
    }

    var now = function () {
        return Date.now ? Date.now() : +(new Date());
    };

    function Duration (duration) {
        var normalizedInput = normalizeObjectUnits(duration),
            years = normalizedInput.year || 0,
            quarters = normalizedInput.quarter || 0,
            months = normalizedInput.month || 0,
            weeks = normalizedInput.week || 0,
            days = normalizedInput.day || 0,
            hours = normalizedInput.hour || 0,
            minutes = normalizedInput.minute || 0,
            seconds = normalizedInput.second || 0,
            milliseconds = normalizedInput.millisecond || 0;

        // representation for dateAddRemove
        this._milliseconds = +milliseconds +
            seconds * 1e3 + // 1000
            minutes * 6e4 + // 1000 * 60
            hours * 1000 * 60 * 60; //using 1000 * 60 * 60 instead of 36e5 to avoid floating point rounding errors https://github.com/moment/moment/issues/2978
        // Because of dateAddRemove treats 24 hours as different from a
        // day when working around DST, we need to store them separately
        this._days = +days +
            weeks * 7;
        // It is impossible translate months into days without knowing
        // which months you are are talking about, so we have to store
        // it separately.
        this._months = +months +
            quarters * 3 +
            years * 12;

        this._data = {};

        this._locale = locale_locales__getLocale();

        this._bubble();
    }

    function isDuration (obj) {
        return obj instanceof Duration;
    }

    // FORMATTING

    function offset (token, separator) {
        addFormatToken(token, 0, 0, function () {
            var offset = this.utcOffset();
            var sign = '+';
            if (offset < 0) {
                offset = -offset;
                sign = '-';
            }
            return sign + zeroFill(~~(offset / 60), 2) + separator + zeroFill(~~(offset) % 60, 2);
        });
    }

    offset('Z', ':');
    offset('ZZ', '');

    // PARSING

    addRegexToken('Z',  matchShortOffset);
    addRegexToken('ZZ', matchShortOffset);
    addParseToken(['Z', 'ZZ'], function (input, array, config) {
        config._useUTC = true;
        config._tzm = offsetFromString(matchShortOffset, input);
    });

    // HELPERS

    // timezone chunker
    // '+10:00' > ['10',  '00']
    // '-1530'  > ['-15', '30']
    var chunkOffset = /([\+\-]|\d\d)/gi;

    function offsetFromString(matcher, string) {
        var matches = ((string || '').match(matcher) || []);
        var chunk   = matches[matches.length - 1] || [];
        var parts   = (chunk + '').match(chunkOffset) || ['-', 0, 0];
        var minutes = +(parts[1] * 60) + toInt(parts[2]);

        return parts[0] === '+' ? minutes : -minutes;
    }

    // Return a moment from input, that is local/utc/zone equivalent to model.
    function cloneWithOffset(input, model) {
        var res, diff;
        if (model._isUTC) {
            res = model.clone();
            diff = (isMoment(input) || isDate(input) ? input.valueOf() : local__createLocal(input).valueOf()) - res.valueOf();
            // Use low-level api, because this fn is low-level api.
            res._d.setTime(res._d.valueOf() + diff);
            utils_hooks__hooks.updateOffset(res, false);
            return res;
        } else {
            return local__createLocal(input).local();
        }
    }

    function getDateOffset (m) {
        // On Firefox.24 Date#getTimezoneOffset returns a floating point.
        // https://github.com/moment/moment/pull/1871
        return -Math.round(m._d.getTimezoneOffset() / 15) * 15;
    }

    // HOOKS

    // This function will be called whenever a moment is mutated.
    // It is intended to keep the offset in sync with the timezone.
    utils_hooks__hooks.updateOffset = function () {};

    // MOMENTS

    // keepLocalTime = true means only change the timezone, without
    // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->
    // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset
    // +0200, so we adjust the time as needed, to be valid.
    //
    // Keeping the time actually adds/subtracts (one hour)
    // from the actual represented time. That is why we call updateOffset
    // a second time. In case it wants us to change the offset again
    // _changeInProgress == true case, then we have to adjust, because
    // there is no such time in the given timezone.
    function getSetOffset (input, keepLocalTime) {
        var offset = this._offset || 0,
            localAdjust;
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        if (input != null) {
            if (typeof input === 'string') {
                input = offsetFromString(matchShortOffset, input);
            } else if (Math.abs(input) < 16) {
                input = input * 60;
            }
            if (!this._isUTC && keepLocalTime) {
                localAdjust = getDateOffset(this);
            }
            this._offset = input;
            this._isUTC = true;
            if (localAdjust != null) {
                this.add(localAdjust, 'm');
            }
            if (offset !== input) {
                if (!keepLocalTime || this._changeInProgress) {
                    add_subtract__addSubtract(this, create__createDuration(input - offset, 'm'), 1, false);
                } else if (!this._changeInProgress) {
                    this._changeInProgress = true;
                    utils_hooks__hooks.updateOffset(this, true);
                    this._changeInProgress = null;
                }
            }
            return this;
        } else {
            return this._isUTC ? offset : getDateOffset(this);
        }
    }

    function getSetZone (input, keepLocalTime) {
        if (input != null) {
            if (typeof input !== 'string') {
                input = -input;
            }

            this.utcOffset(input, keepLocalTime);

            return this;
        } else {
            return -this.utcOffset();
        }
    }

    function setOffsetToUTC (keepLocalTime) {
        return this.utcOffset(0, keepLocalTime);
    }

    function setOffsetToLocal (keepLocalTime) {
        if (this._isUTC) {
            this.utcOffset(0, keepLocalTime);
            this._isUTC = false;

            if (keepLocalTime) {
                this.subtract(getDateOffset(this), 'm');
            }
        }
        return this;
    }

    function setOffsetToParsedOffset () {
        if (this._tzm) {
            this.utcOffset(this._tzm);
        } else if (typeof this._i === 'string') {
            this.utcOffset(offsetFromString(matchOffset, this._i));
        }
        return this;
    }

    function hasAlignedHourOffset (input) {
        if (!this.isValid()) {
            return false;
        }
        input = input ? local__createLocal(input).utcOffset() : 0;

        return (this.utcOffset() - input) % 60 === 0;
    }

    function isDaylightSavingTime () {
        return (
            this.utcOffset() > this.clone().month(0).utcOffset() ||
            this.utcOffset() > this.clone().month(5).utcOffset()
        );
    }

    function isDaylightSavingTimeShifted () {
        if (!isUndefined(this._isDSTShifted)) {
            return this._isDSTShifted;
        }

        var c = {};

        copyConfig(c, this);
        c = prepareConfig(c);

        if (c._a) {
            var other = c._isUTC ? create_utc__createUTC(c._a) : local__createLocal(c._a);
            this._isDSTShifted = this.isValid() &&
                compareArrays(c._a, other.toArray()) > 0;
        } else {
            this._isDSTShifted = false;
        }

        return this._isDSTShifted;
    }

    function isLocal () {
        return this.isValid() ? !this._isUTC : false;
    }

    function isUtcOffset () {
        return this.isValid() ? this._isUTC : false;
    }

    function isUtc () {
        return this.isValid() ? this._isUTC && this._offset === 0 : false;
    }

    // ASP.NET json date format regex
    var aspNetRegex = /^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/;

    // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html
    // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere
    // and further modified to allow for strings containing both week and day
    var isoRegex = /^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;

    function create__createDuration (input, key) {
        var duration = input,
            // matching against regexp is expensive, do it on demand
            match = null,
            sign,
            ret,
            diffRes;

        if (isDuration(input)) {
            duration = {
                ms : input._milliseconds,
                d  : input._days,
                M  : input._months
            };
        } else if (typeof input === 'number') {
            duration = {};
            if (key) {
                duration[key] = input;
            } else {
                duration.milliseconds = input;
            }
        } else if (!!(match = aspNetRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            duration = {
                y  : 0,
                d  : toInt(match[DATE])        * sign,
                h  : toInt(match[HOUR])        * sign,
                m  : toInt(match[MINUTE])      * sign,
                s  : toInt(match[SECOND])      * sign,
                ms : toInt(match[MILLISECOND]) * sign
            };
        } else if (!!(match = isoRegex.exec(input))) {
            sign = (match[1] === '-') ? -1 : 1;
            duration = {
                y : parseIso(match[2], sign),
                M : parseIso(match[3], sign),
                w : parseIso(match[4], sign),
                d : parseIso(match[5], sign),
                h : parseIso(match[6], sign),
                m : parseIso(match[7], sign),
                s : parseIso(match[8], sign)
            };
        } else if (duration == null) {// checks for null or undefined
            duration = {};
        } else if (typeof duration === 'object' && ('from' in duration || 'to' in duration)) {
            diffRes = momentsDifference(local__createLocal(duration.from), local__createLocal(duration.to));

            duration = {};
            duration.ms = diffRes.milliseconds;
            duration.M = diffRes.months;
        }

        ret = new Duration(duration);

        if (isDuration(input) && hasOwnProp(input, '_locale')) {
            ret._locale = input._locale;
        }

        return ret;
    }

    create__createDuration.fn = Duration.prototype;

    function parseIso (inp, sign) {
        // We'd normally use ~~inp for this, but unfortunately it also
        // converts floats to ints.
        // inp may be undefined, so careful calling replace on it.
        var res = inp && parseFloat(inp.replace(',', '.'));
        // apply sign while we're at it
        return (isNaN(res) ? 0 : res) * sign;
    }

    function positiveMomentsDifference(base, other) {
        var res = {milliseconds: 0, months: 0};

        res.months = other.month() - base.month() +
            (other.year() - base.year()) * 12;
        if (base.clone().add(res.months, 'M').isAfter(other)) {
            --res.months;
        }

        res.milliseconds = +other - +(base.clone().add(res.months, 'M'));

        return res;
    }

    function momentsDifference(base, other) {
        var res;
        if (!(base.isValid() && other.isValid())) {
            return {milliseconds: 0, months: 0};
        }

        other = cloneWithOffset(other, base);
        if (base.isBefore(other)) {
            res = positiveMomentsDifference(base, other);
        } else {
            res = positiveMomentsDifference(other, base);
            res.milliseconds = -res.milliseconds;
            res.months = -res.months;
        }

        return res;
    }

    function absRound (number) {
        if (number < 0) {
            return Math.round(-1 * number) * -1;
        } else {
            return Math.round(number);
        }
    }

    // TODO: remove 'name' arg after deprecation is removed
    function createAdder(direction, name) {
        return function (val, period) {
            var dur, tmp;
            //invert the arguments, but complain about it
            if (period !== null && !isNaN(+period)) {
                deprecateSimple(name, 'moment().' + name  + '(period, number) is deprecated. Please use moment().' + name + '(number, period).');
                tmp = val; val = period; period = tmp;
            }

            val = typeof val === 'string' ? +val : val;
            dur = create__createDuration(val, period);
            add_subtract__addSubtract(this, dur, direction);
            return this;
        };
    }

    function add_subtract__addSubtract (mom, duration, isAdding, updateOffset) {
        var milliseconds = duration._milliseconds,
            days = absRound(duration._days),
            months = absRound(duration._months);

        if (!mom.isValid()) {
            // No op
            return;
        }

        updateOffset = updateOffset == null ? true : updateOffset;

        if (milliseconds) {
            mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);
        }
        if (days) {
            get_set__set(mom, 'Date', get_set__get(mom, 'Date') + days * isAdding);
        }
        if (months) {
            setMonth(mom, get_set__get(mom, 'Month') + months * isAdding);
        }
        if (updateOffset) {
            utils_hooks__hooks.updateOffset(mom, days || months);
        }
    }

    var add_subtract__add      = createAdder(1, 'add');
    var add_subtract__subtract = createAdder(-1, 'subtract');

    function moment_calendar__calendar (time, formats) {
        // We want to compare the start of today, vs this.
        // Getting start-of-today depends on whether we're local/utc/offset or not.
        var now = time || local__createLocal(),
            sod = cloneWithOffset(now, this).startOf('day'),
            diff = this.diff(sod, 'days', true),
            format = diff < -6 ? 'sameElse' :
                diff < -1 ? 'lastWeek' :
                diff < 0 ? 'lastDay' :
                diff < 1 ? 'sameDay' :
                diff < 2 ? 'nextDay' :
                diff < 7 ? 'nextWeek' : 'sameElse';

        var output = formats && (isFunction(formats[format]) ? formats[format]() : formats[format]);

        return this.format(output || this.localeData().calendar(format, this, local__createLocal(now)));
    }

    function clone () {
        return new Moment(this);
    }

    function isAfter (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
        if (units === 'millisecond') {
            return this.valueOf() > localInput.valueOf();
        } else {
            return localInput.valueOf() < this.clone().startOf(units).valueOf();
        }
    }

    function isBefore (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input);
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(!isUndefined(units) ? units : 'millisecond');
        if (units === 'millisecond') {
            return this.valueOf() < localInput.valueOf();
        } else {
            return this.clone().endOf(units).valueOf() < localInput.valueOf();
        }
    }

    function isBetween (from, to, units, inclusivity) {
        inclusivity = inclusivity || '()';
        return (inclusivity[0] === '(' ? this.isAfter(from, units) : !this.isBefore(from, units)) &&
            (inclusivity[1] === ')' ? this.isBefore(to, units) : !this.isAfter(to, units));
    }

    function isSame (input, units) {
        var localInput = isMoment(input) ? input : local__createLocal(input),
            inputMs;
        if (!(this.isValid() && localInput.isValid())) {
            return false;
        }
        units = normalizeUnits(units || 'millisecond');
        if (units === 'millisecond') {
            return this.valueOf() === localInput.valueOf();
        } else {
            inputMs = localInput.valueOf();
            return this.clone().startOf(units).valueOf() <= inputMs && inputMs <= this.clone().endOf(units).valueOf();
        }
    }

    function isSameOrAfter (input, units) {
        return this.isSame(input, units) || this.isAfter(input,units);
    }

    function isSameOrBefore (input, units) {
        return this.isSame(input, units) || this.isBefore(input,units);
    }

    function diff (input, units, asFloat) {
        var that,
            zoneDelta,
            delta, output;

        if (!this.isValid()) {
            return NaN;
        }

        that = cloneWithOffset(input, this);

        if (!that.isValid()) {
            return NaN;
        }

        zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;

        units = normalizeUnits(units);

        if (units === 'year' || units === 'month' || units === 'quarter') {
            output = monthDiff(this, that);
            if (units === 'quarter') {
                output = output / 3;
            } else if (units === 'year') {
                output = output / 12;
            }
        } else {
            delta = this - that;
            output = units === 'second' ? delta / 1e3 : // 1000
                units === 'minute' ? delta / 6e4 : // 1000 * 60
                units === 'hour' ? delta / 36e5 : // 1000 * 60 * 60
                units === 'day' ? (delta - zoneDelta) / 864e5 : // 1000 * 60 * 60 * 24, negate dst
                units === 'week' ? (delta - zoneDelta) / 6048e5 : // 1000 * 60 * 60 * 24 * 7, negate dst
                delta;
        }
        return asFloat ? output : absFloor(output);
    }

    function monthDiff (a, b) {
        // difference in months
        var wholeMonthDiff = ((b.year() - a.year()) * 12) + (b.month() - a.month()),
            // b is in (anchor - 1 month, anchor + 1 month)
            anchor = a.clone().add(wholeMonthDiff, 'months'),
            anchor2, adjust;

        if (b - anchor < 0) {
            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor - anchor2);
        } else {
            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');
            // linear across the month
            adjust = (b - anchor) / (anchor2 - anchor);
        }

        //check for negative zero, return zero if negative zero
        return -(wholeMonthDiff + adjust) || 0;
    }

    utils_hooks__hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';
    utils_hooks__hooks.defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';

    function toString () {
        return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');
    }

    function moment_format__toISOString () {
        var m = this.clone().utc();
        if (0 < m.year() && m.year() <= 9999) {
            if (isFunction(Date.prototype.toISOString)) {
                // native implementation is ~50x faster, use it when we can
                return this.toDate().toISOString();
            } else {
                return formatMoment(m, 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
            }
        } else {
            return formatMoment(m, 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]');
        }
    }

    function format (inputString) {
        if (!inputString) {
            inputString = this.isUtc() ? utils_hooks__hooks.defaultFormatUtc : utils_hooks__hooks.defaultFormat;
        }
        var output = formatMoment(this, inputString);
        return this.localeData().postformat(output);
    }

    function from (time, withoutSuffix) {
        if (this.isValid() &&
                ((isMoment(time) && time.isValid()) ||
                 local__createLocal(time).isValid())) {
            return create__createDuration({to: this, from: time}).locale(this.locale()).humanize(!withoutSuffix);
        } else {
            return this.localeData().invalidDate();
        }
    }

    function fromNow (withoutSuffix) {
        return this.from(local__createLocal(), withoutSuffix);
    }

    function to (time, withoutSuffix) {
        if (this.isValid() &&
                ((isMoment(time) && time.isValid()) ||
                 local__createLocal(time).isValid())) {
            return create__createDuration({from: this, to: time}).locale(this.locale()).humanize(!withoutSuffix);
        } else {
            return this.localeData().invalidDate();
        }
    }

    function toNow (withoutSuffix) {
        return this.to(local__createLocal(), withoutSuffix);
    }

    // If passed a locale key, it will set the locale for this
    // instance.  Otherwise, it will return the locale configuration
    // variables for this instance.
    function locale (key) {
        var newLocaleData;

        if (key === undefined) {
            return this._locale._abbr;
        } else {
            newLocaleData = locale_locales__getLocale(key);
            if (newLocaleData != null) {
                this._locale = newLocaleData;
            }
            return this;
        }
    }

    var lang = deprecate(
        'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',
        function (key) {
            if (key === undefined) {
                return this.localeData();
            } else {
                return this.locale(key);
            }
        }
    );

    function localeData () {
        return this._locale;
    }

    function startOf (units) {
        units = normalizeUnits(units);
        // the following switch intentionally omits break keywords
        // to utilize falling through the cases.
        switch (units) {
        case 'year':
            this.month(0);
            /* falls through */
        case 'quarter':
        case 'month':
            this.date(1);
            /* falls through */
        case 'week':
        case 'isoWeek':
        case 'day':
        case 'date':
            this.hours(0);
            /* falls through */
        case 'hour':
            this.minutes(0);
            /* falls through */
        case 'minute':
            this.seconds(0);
            /* falls through */
        case 'second':
            this.milliseconds(0);
        }

        // weeks are a special case
        if (units === 'week') {
            this.weekday(0);
        }
        if (units === 'isoWeek') {
            this.isoWeekday(1);
        }

        // quarters are also special
        if (units === 'quarter') {
            this.month(Math.floor(this.month() / 3) * 3);
        }

        return this;
    }

    function endOf (units) {
        units = normalizeUnits(units);
        if (units === undefined || units === 'millisecond') {
            return this;
        }

        // 'date' is an alias for 'day', so it should be considered as such.
        if (units === 'date') {
            units = 'day';
        }

        return this.startOf(units).add(1, (units === 'isoWeek' ? 'week' : units)).subtract(1, 'ms');
    }

    function to_type__valueOf () {
        return this._d.valueOf() - ((this._offset || 0) * 60000);
    }

    function unix () {
        return Math.floor(this.valueOf() / 1000);
    }

    function toDate () {
        return this._offset ? new Date(this.valueOf()) : this._d;
    }

    function toArray () {
        var m = this;
        return [m.year(), m.month(), m.date(), m.hour(), m.minute(), m.second(), m.millisecond()];
    }

    function toObject () {
        var m = this;
        return {
            years: m.year(),
            months: m.month(),
            date: m.date(),
            hours: m.hours(),
            minutes: m.minutes(),
            seconds: m.seconds(),
            milliseconds: m.milliseconds()
        };
    }

    function toJSON () {
        // new Date(NaN).toJSON() === null
        return this.isValid() ? this.toISOString() : null;
    }

    function moment_valid__isValid () {
        return valid__isValid(this);
    }

    function parsingFlags () {
        return extend({}, getParsingFlags(this));
    }

    function invalidAt () {
        return getParsingFlags(this).overflow;
    }

    function creationData() {
        return {
            input: this._i,
            format: this._f,
            locale: this._locale,
            isUTC: this._isUTC,
            strict: this._strict
        };
    }

    // FORMATTING

    addFormatToken(0, ['gg', 2], 0, function () {
        return this.weekYear() % 100;
    });

    addFormatToken(0, ['GG', 2], 0, function () {
        return this.isoWeekYear() % 100;
    });

    function addWeekYearFormatToken (token, getter) {
        addFormatToken(0, [token, token.length], 0, getter);
    }

    addWeekYearFormatToken('gggg',     'weekYear');
    addWeekYearFormatToken('ggggg',    'weekYear');
    addWeekYearFormatToken('GGGG',  'isoWeekYear');
    addWeekYearFormatToken('GGGGG', 'isoWeekYear');

    // ALIASES

    addUnitAlias('weekYear', 'gg');
    addUnitAlias('isoWeekYear', 'GG');

    // PARSING

    addRegexToken('G',      matchSigned);
    addRegexToken('g',      matchSigned);
    addRegexToken('GG',     match1to2, match2);
    addRegexToken('gg',     match1to2, match2);
    addRegexToken('GGGG',   match1to4, match4);
    addRegexToken('gggg',   match1to4, match4);
    addRegexToken('GGGGG',  match1to6, match6);
    addRegexToken('ggggg',  match1to6, match6);

    addWeekParseToken(['gggg', 'ggggg', 'GGGG', 'GGGGG'], function (input, week, config, token) {
        week[token.substr(0, 2)] = toInt(input);
    });

    addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {
        week[token] = utils_hooks__hooks.parseTwoDigitYear(input);
    });

    // MOMENTS

    function getSetWeekYear (input) {
        return getSetWeekYearHelper.call(this,
                input,
                this.week(),
                this.weekday(),
                this.localeData()._week.dow,
                this.localeData()._week.doy);
    }

    function getSetISOWeekYear (input) {
        return getSetWeekYearHelper.call(this,
                input, this.isoWeek(), this.isoWeekday(), 1, 4);
    }

    function getISOWeeksInYear () {
        return weeksInYear(this.year(), 1, 4);
    }

    function getWeeksInYear () {
        var weekInfo = this.localeData()._week;
        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);
    }

    function getSetWeekYearHelper(input, week, weekday, dow, doy) {
        var weeksTarget;
        if (input == null) {
            return weekOfYear(this, dow, doy).year;
        } else {
            weeksTarget = weeksInYear(input, dow, doy);
            if (week > weeksTarget) {
                week = weeksTarget;
            }
            return setWeekAll.call(this, input, week, weekday, dow, doy);
        }
    }

    function setWeekAll(weekYear, week, weekday, dow, doy) {
        var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),
            date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);

        this.year(date.getUTCFullYear());
        this.month(date.getUTCMonth());
        this.date(date.getUTCDate());
        return this;
    }

    // FORMATTING

    addFormatToken('Q', 0, 'Qo', 'quarter');

    // ALIASES

    addUnitAlias('quarter', 'Q');

    // PARSING

    addRegexToken('Q', match1);
    addParseToken('Q', function (input, array) {
        array[MONTH] = (toInt(input) - 1) * 3;
    });

    // MOMENTS

    function getSetQuarter (input) {
        return input == null ? Math.ceil((this.month() + 1) / 3) : this.month((input - 1) * 3 + this.month() % 3);
    }

    // FORMATTING

    addFormatToken('w', ['ww', 2], 'wo', 'week');
    addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');

    // ALIASES

    addUnitAlias('week', 'w');
    addUnitAlias('isoWeek', 'W');

    // PARSING

    addRegexToken('w',  match1to2);
    addRegexToken('ww', match1to2, match2);
    addRegexToken('W',  match1to2);
    addRegexToken('WW', match1to2, match2);

    addWeekParseToken(['w', 'ww', 'W', 'WW'], function (input, week, config, token) {
        week[token.substr(0, 1)] = toInt(input);
    });

    // HELPERS

    // LOCALES

    function localeWeek (mom) {
        return weekOfYear(mom, this._week.dow, this._week.doy).week;
    }

    var defaultLocaleWeek = {
        dow : 0, // Sunday is the first day of the week.
        doy : 6  // The week that contains Jan 1st is the first week of the year.
    };

    function localeFirstDayOfWeek () {
        return this._week.dow;
    }

    function localeFirstDayOfYear () {
        return this._week.doy;
    }

    // MOMENTS

    function getSetWeek (input) {
        var week = this.localeData().week(this);
        return input == null ? week : this.add((input - week) * 7, 'd');
    }

    function getSetISOWeek (input) {
        var week = weekOfYear(this, 1, 4).week;
        return input == null ? week : this.add((input - week) * 7, 'd');
    }

    // FORMATTING

    addFormatToken('D', ['DD', 2], 'Do', 'date');

    // ALIASES

    addUnitAlias('date', 'D');

    // PARSING

    addRegexToken('D',  match1to2);
    addRegexToken('DD', match1to2, match2);
    addRegexToken('Do', function (isStrict, locale) {
        return isStrict ? locale._ordinalParse : locale._ordinalParseLenient;
    });

    addParseToken(['D', 'DD'], DATE);
    addParseToken('Do', function (input, array) {
        array[DATE] = toInt(input.match(match1to2)[0], 10);
    });

    // MOMENTS

    var getSetDayOfMonth = makeGetSet('Date', true);

    // FORMATTING

    addFormatToken('d', 0, 'do', 'day');

    addFormatToken('dd', 0, 0, function (format) {
        return this.localeData().weekdaysMin(this, format);
    });

    addFormatToken('ddd', 0, 0, function (format) {
        return this.localeData().weekdaysShort(this, format);
    });

    addFormatToken('dddd', 0, 0, function (format) {
        return this.localeData().weekdays(this, format);
    });

    addFormatToken('e', 0, 0, 'weekday');
    addFormatToken('E', 0, 0, 'isoWeekday');

    // ALIASES

    addUnitAlias('day', 'd');
    addUnitAlias('weekday', 'e');
    addUnitAlias('isoWeekday', 'E');

    // PARSING

    addRegexToken('d',    match1to2);
    addRegexToken('e',    match1to2);
    addRegexToken('E',    match1to2);
    addRegexToken('dd',   function (isStrict, locale) {
        return locale.weekdaysMinRegex(isStrict);
    });
    addRegexToken('ddd',   function (isStrict, locale) {
        return locale.weekdaysShortRegex(isStrict);
    });
    addRegexToken('dddd',   function (isStrict, locale) {
        return locale.weekdaysRegex(isStrict);
    });

    addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {
        var weekday = config._locale.weekdaysParse(input, token, config._strict);
        // if we didn't get a weekday name, mark the date as invalid
        if (weekday != null) {
            week.d = weekday;
        } else {
            getParsingFlags(config).invalidWeekday = input;
        }
    });

    addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {
        week[token] = toInt(input);
    });

    // HELPERS

    function parseWeekday(input, locale) {
        if (typeof input !== 'string') {
            return input;
        }

        if (!isNaN(input)) {
            return parseInt(input, 10);
        }

        input = locale.weekdaysParse(input);
        if (typeof input === 'number') {
            return input;
        }

        return null;
    }

    // LOCALES

    var defaultLocaleWeekdays = 'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_');
    function localeWeekdays (m, format) {
        return isArray(this._weekdays) ? this._weekdays[m.day()] :
            this._weekdays[this._weekdays.isFormat.test(format) ? 'format' : 'standalone'][m.day()];
    }

    var defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_');
    function localeWeekdaysShort (m) {
        return this._weekdaysShort[m.day()];
    }

    var defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_');
    function localeWeekdaysMin (m) {
        return this._weekdaysMin[m.day()];
    }

    function day_of_week__handleStrictParse(weekdayName, format, strict) {
        var i, ii, mom, llc = weekdayName.toLocaleLowerCase();
        if (!this._weekdaysParse) {
            this._weekdaysParse = [];
            this._shortWeekdaysParse = [];
            this._minWeekdaysParse = [];

            for (i = 0; i < 7; ++i) {
                mom = create_utc__createUTC([2000, 1]).day(i);
                this._minWeekdaysParse[i] = this.weekdaysMin(mom, '').toLocaleLowerCase();
                this._shortWeekdaysParse[i] = this.weekdaysShort(mom, '').toLocaleLowerCase();
                this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();
            }
        }

        if (strict) {
            if (format === 'dddd') {
                ii = indexOf.call(this._weekdaysParse, llc);
                return ii !== -1 ? ii : null;
            } else if (format === 'ddd') {
                ii = indexOf.call(this._shortWeekdaysParse, llc);
                return ii !== -1 ? ii : null;
            } else {
                ii = indexOf.call(this._minWeekdaysParse, llc);
                return ii !== -1 ? ii : null;
            }
        } else {
            if (format === 'dddd') {
                ii = indexOf.call(this._weekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._shortWeekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._minWeekdaysParse, llc);
                return ii !== -1 ? ii : null;
            } else if (format === 'ddd') {
                ii = indexOf.call(this._shortWeekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._weekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._minWeekdaysParse, llc);
                return ii !== -1 ? ii : null;
            } else {
                ii = indexOf.call(this._minWeekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._weekdaysParse, llc);
                if (ii !== -1) {
                    return ii;
                }
                ii = indexOf.call(this._shortWeekdaysParse, llc);
                return ii !== -1 ? ii : null;
            }
        }
    }

    function localeWeekdaysParse (weekdayName, format, strict) {
        var i, mom, regex;

        if (this._weekdaysParseExact) {
            return day_of_week__handleStrictParse.call(this, weekdayName, format, strict);
        }

        if (!this._weekdaysParse) {
            this._weekdaysParse = [];
            this._minWeekdaysParse = [];
            this._shortWeekdaysParse = [];
            this._fullWeekdaysParse = [];
        }

        for (i = 0; i < 7; i++) {
            // make the regex if we don't have it already

            mom = create_utc__createUTC([2000, 1]).day(i);
            if (strict && !this._fullWeekdaysParse[i]) {
                this._fullWeekdaysParse[i] = new RegExp('^' + this.weekdays(mom, '').replace('.', '\.?') + '$', 'i');
                this._shortWeekdaysParse[i] = new RegExp('^' + this.weekdaysShort(mom, '').replace('.', '\.?') + '$', 'i');
                this._minWeekdaysParse[i] = new RegExp('^' + this.weekdaysMin(mom, '').replace('.', '\.?') + '$', 'i');
            }
            if (!this._weekdaysParse[i]) {
                regex = '^' + this.weekdays(mom, '') + '|^' + this.weekdaysShort(mom, '') + '|^' + this.weekdaysMin(mom, '');
                this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');
            }
            // test the regex
            if (strict && format === 'dddd' && this._fullWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (strict && format === 'ddd' && this._shortWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (strict && format === 'dd' && this._minWeekdaysParse[i].test(weekdayName)) {
                return i;
            } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {
                return i;
            }
        }
    }

    // MOMENTS

    function getSetDayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
        if (input != null) {
            input = parseWeekday(input, this.localeData());
            return this.add(input - day, 'd');
        } else {
            return day;
        }
    }

    function getSetLocaleDayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;
        return input == null ? weekday : this.add(input - weekday, 'd');
    }

    function getSetISODayOfWeek (input) {
        if (!this.isValid()) {
            return input != null ? this : NaN;
        }
        // behaves the same as moment#day except
        // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)
        // as a setter, sunday should belong to the previous week.
        return input == null ? this.day() || 7 : this.day(this.day() % 7 ? input : input - 7);
    }

    var defaultWeekdaysRegex = matchWord;
    function weekdaysRegex (isStrict) {
        if (this._weekdaysParseExact) {
            if (!hasOwnProp(this, '_weekdaysRegex')) {
                computeWeekdaysParse.call(this);
            }
            if (isStrict) {
                return this._weekdaysStrictRegex;
            } else {
                return this._weekdaysRegex;
            }
        } else {
            return this._weekdaysStrictRegex && isStrict ?
                this._weekdaysStrictRegex : this._weekdaysRegex;
        }
    }

    var defaultWeekdaysShortRegex = matchWord;
    function weekdaysShortRegex (isStrict) {
        if (this._weekdaysParseExact) {
            if (!hasOwnProp(this, '_weekdaysRegex')) {
                computeWeekdaysParse.call(this);
            }
            if (isStrict) {
                return this._weekdaysShortStrictRegex;
            } else {
                return this._weekdaysShortRegex;
            }
        } else {
            return this._weekdaysShortStrictRegex && isStrict ?
                this._weekdaysShortStrictRegex : this._weekdaysShortRegex;
        }
    }

    var defaultWeekdaysMinRegex = matchWord;
    function weekdaysMinRegex (isStrict) {
        if (this._weekdaysParseExact) {
            if (!hasOwnProp(this, '_weekdaysRegex')) {
                computeWeekdaysParse.call(this);
            }
            if (isStrict) {
                return this._weekdaysMinStrictRegex;
            } else {
                return this._weekdaysMinRegex;
            }
        } else {
            return this._weekdaysMinStrictRegex && isStrict ?
                this._weekdaysMinStrictRegex : this._weekdaysMinRegex;
        }
    }


    function computeWeekdaysParse () {
        function cmpLenRev(a, b) {
            return b.length - a.length;
        }

        var minPieces = [], shortPieces = [], longPieces = [], mixedPieces = [],
            i, mom, minp, shortp, longp;
        for (i = 0; i < 7; i++) {
            // make the regex if we don't have it already
            mom = create_utc__createUTC([2000, 1]).day(i);
            minp = this.weekdaysMin(mom, '');
            shortp = this.weekdaysShort(mom, '');
            longp = this.weekdays(mom, '');
            minPieces.push(minp);
            shortPieces.push(shortp);
            longPieces.push(longp);
            mixedPieces.push(minp);
            mixedPieces.push(shortp);
            mixedPieces.push(longp);
        }
        // Sorting makes sure if one weekday (or abbr) is a prefix of another it
        // will match the longer piece.
        minPieces.sort(cmpLenRev);
        shortPieces.sort(cmpLenRev);
        longPieces.sort(cmpLenRev);
        mixedPieces.sort(cmpLenRev);
        for (i = 0; i < 7; i++) {
            shortPieces[i] = regexEscape(shortPieces[i]);
            longPieces[i] = regexEscape(longPieces[i]);
            mixedPieces[i] = regexEscape(mixedPieces[i]);
        }

        this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');
        this._weekdaysShortRegex = this._weekdaysRegex;
        this._weekdaysMinRegex = this._weekdaysRegex;

        this._weekdaysStrictRegex = new RegExp('^(' + longPieces.join('|') + ')', 'i');
        this._weekdaysShortStrictRegex = new RegExp('^(' + shortPieces.join('|') + ')', 'i');
        this._weekdaysMinStrictRegex = new RegExp('^(' + minPieces.join('|') + ')', 'i');
    }

    // FORMATTING

    addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');

    // ALIASES

    addUnitAlias('dayOfYear', 'DDD');

    // PARSING

    addRegexToken('DDD',  match1to3);
    addRegexToken('DDDD', match3);
    addParseToken(['DDD', 'DDDD'], function (input, array, config) {
        config._dayOfYear = toInt(input);
    });

    // HELPERS

    // MOMENTS

    function getSetDayOfYear (input) {
        var dayOfYear = Math.round((this.clone().startOf('day') - this.clone().startOf('year')) / 864e5) + 1;
        return input == null ? dayOfYear : this.add((input - dayOfYear), 'd');
    }

    // FORMATTING

    function hFormat() {
        return this.hours() % 12 || 12;
    }

    function kFormat() {
        return this.hours() || 24;
    }

    addFormatToken('H', ['HH', 2], 0, 'hour');
    addFormatToken('h', ['hh', 2], 0, hFormat);
    addFormatToken('k', ['kk', 2], 0, kFormat);

    addFormatToken('hmm', 0, 0, function () {
        return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);
    });

    addFormatToken('hmmss', 0, 0, function () {
        return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2) +
            zeroFill(this.seconds(), 2);
    });

    addFormatToken('Hmm', 0, 0, function () {
        return '' + this.hours() + zeroFill(this.minutes(), 2);
    });

    addFormatToken('Hmmss', 0, 0, function () {
        return '' + this.hours() + zeroFill(this.minutes(), 2) +
            zeroFill(this.seconds(), 2);
    });

    function meridiem (token, lowercase) {
        addFormatToken(token, 0, 0, function () {
            return this.localeData().meridiem(this.hours(), this.minutes(), lowercase);
        });
    }

    meridiem('a', true);
    meridiem('A', false);

    // ALIASES

    addUnitAlias('hour', 'h');

    // PARSING

    function matchMeridiem (isStrict, locale) {
        return locale._meridiemParse;
    }

    addRegexToken('a',  matchMeridiem);
    addRegexToken('A',  matchMeridiem);
    addRegexToken('H',  match1to2);
    addRegexToken('h',  match1to2);
    addRegexToken('HH', match1to2, match2);
    addRegexToken('hh', match1to2, match2);

    addRegexToken('hmm', match3to4);
    addRegexToken('hmmss', match5to6);
    addRegexToken('Hmm', match3to4);
    addRegexToken('Hmmss', match5to6);

    addParseToken(['H', 'HH'], HOUR);
    addParseToken(['a', 'A'], function (input, array, config) {
        config._isPm = config._locale.isPM(input);
        config._meridiem = input;
    });
    addParseToken(['h', 'hh'], function (input, array, config) {
        array[HOUR] = toInt(input);
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('hmm', function (input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('hmmss', function (input, array, config) {
        var pos1 = input.length - 4;
        var pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
        getParsingFlags(config).bigHour = true;
    });
    addParseToken('Hmm', function (input, array, config) {
        var pos = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos));
        array[MINUTE] = toInt(input.substr(pos));
    });
    addParseToken('Hmmss', function (input, array, config) {
        var pos1 = input.length - 4;
        var pos2 = input.length - 2;
        array[HOUR] = toInt(input.substr(0, pos1));
        array[MINUTE] = toInt(input.substr(pos1, 2));
        array[SECOND] = toInt(input.substr(pos2));
    });

    // LOCALES

    function localeIsPM (input) {
        // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays
        // Using charAt should be more compatible.
        return ((input + '').toLowerCase().charAt(0) === 'p');
    }

    var defaultLocaleMeridiemParse = /[ap]\.?m?\.?/i;
    function localeMeridiem (hours, minutes, isLower) {
        if (hours > 11) {
            return isLower ? 'pm' : 'PM';
        } else {
            return isLower ? 'am' : 'AM';
        }
    }


    // MOMENTS

    // Setting the hour should keep the time, because the user explicitly
    // specified which hour he wants. So trying to maintain the same hour (in
    // a new timezone) makes sense. Adding/subtracting hours does not follow
    // this rule.
    var getSetHour = makeGetSet('Hours', true);

    // FORMATTING

    addFormatToken('m', ['mm', 2], 0, 'minute');

    // ALIASES

    addUnitAlias('minute', 'm');

    // PARSING

    addRegexToken('m',  match1to2);
    addRegexToken('mm', match1to2, match2);
    addParseToken(['m', 'mm'], MINUTE);

    // MOMENTS

    var getSetMinute = makeGetSet('Minutes', false);

    // FORMATTING

    addFormatToken('s', ['ss', 2], 0, 'second');

    // ALIASES

    addUnitAlias('second', 's');

    // PARSING

    addRegexToken('s',  match1to2);
    addRegexToken('ss', match1to2, match2);
    addParseToken(['s', 'ss'], SECOND);

    // MOMENTS

    var getSetSecond = makeGetSet('Seconds', false);

    // FORMATTING

    addFormatToken('S', 0, 0, function () {
        return ~~(this.millisecond() / 100);
    });

    addFormatToken(0, ['SS', 2], 0, function () {
        return ~~(this.millisecond() / 10);
    });

    addFormatToken(0, ['SSS', 3], 0, 'millisecond');
    addFormatToken(0, ['SSSS', 4], 0, function () {
        return this.millisecond() * 10;
    });
    addFormatToken(0, ['SSSSS', 5], 0, function () {
        return this.millisecond() * 100;
    });
    addFormatToken(0, ['SSSSSS', 6], 0, function () {
        return this.millisecond() * 1000;
    });
    addFormatToken(0, ['SSSSSSS', 7], 0, function () {
        return this.millisecond() * 10000;
    });
    addFormatToken(0, ['SSSSSSSS', 8], 0, function () {
        return this.millisecond() * 100000;
    });
    addFormatToken(0, ['SSSSSSSSS', 9], 0, function () {
        return this.millisecond() * 1000000;
    });


    // ALIASES

    addUnitAlias('millisecond', 'ms');

    // PARSING

    addRegexToken('S',    match1to3, match1);
    addRegexToken('SS',   match1to3, match2);
    addRegexToken('SSS',  match1to3, match3);

    var token;
    for (token = 'SSSS'; token.length <= 9; token += 'S') {
        addRegexToken(token, matchUnsigned);
    }

    function parseMs(input, array) {
        array[MILLISECOND] = toInt(('0.' + input) * 1000);
    }

    for (token = 'S'; token.length <= 9; token += 'S') {
        addParseToken(token, parseMs);
    }
    // MOMENTS

    var getSetMillisecond = makeGetSet('Milliseconds', false);

    // FORMATTING

    addFormatToken('z',  0, 0, 'zoneAbbr');
    addFormatToken('zz', 0, 0, 'zoneName');

    // MOMENTS

    function getZoneAbbr () {
        return this._isUTC ? 'UTC' : '';
    }

    function getZoneName () {
        return this._isUTC ? 'Coordinated Universal Time' : '';
    }

    var momentPrototype__proto = Moment.prototype;

    momentPrototype__proto.add               = add_subtract__add;
    momentPrototype__proto.calendar          = moment_calendar__calendar;
    momentPrototype__proto.clone             = clone;
    momentPrototype__proto.diff              = diff;
    momentPrototype__proto.endOf             = endOf;
    momentPrototype__proto.format            = format;
    momentPrototype__proto.from              = from;
    momentPrototype__proto.fromNow           = fromNow;
    momentPrototype__proto.to                = to;
    momentPrototype__proto.toNow             = toNow;
    momentPrototype__proto.get               = getSet;
    momentPrototype__proto.invalidAt         = invalidAt;
    momentPrototype__proto.isAfter           = isAfter;
    momentPrototype__proto.isBefore          = isBefore;
    momentPrototype__proto.isBetween         = isBetween;
    momentPrototype__proto.isSame            = isSame;
    momentPrototype__proto.isSameOrAfter     = isSameOrAfter;
    momentPrototype__proto.isSameOrBefore    = isSameOrBefore;
    momentPrototype__proto.isValid           = moment_valid__isValid;
    momentPrototype__proto.lang              = lang;
    momentPrototype__proto.locale            = locale;
    momentPrototype__proto.localeData        = localeData;
    momentPrototype__proto.max               = prototypeMax;
    momentPrototype__proto.min               = prototypeMin;
    momentPrototype__proto.parsingFlags      = parsingFlags;
    momentPrototype__proto.set               = getSet;
    momentPrototype__proto.startOf           = startOf;
    momentPrototype__proto.subtract          = add_subtract__subtract;
    momentPrototype__proto.toArray           = toArray;
    momentPrototype__proto.toObject          = toObject;
    momentPrototype__proto.toDate            = toDate;
    momentPrototype__proto.toISOString       = moment_format__toISOString;
    momentPrototype__proto.toJSON            = toJSON;
    momentPrototype__proto.toString          = toString;
    momentPrototype__proto.unix              = unix;
    momentPrototype__proto.valueOf           = to_type__valueOf;
    momentPrototype__proto.creationData      = creationData;

    // Year
    momentPrototype__proto.year       = getSetYear;
    momentPrototype__proto.isLeapYear = getIsLeapYear;

    // Week Year
    momentPrototype__proto.weekYear    = getSetWeekYear;
    momentPrototype__proto.isoWeekYear = getSetISOWeekYear;

    // Quarter
    momentPrototype__proto.quarter = momentPrototype__proto.quarters = getSetQuarter;

    // Month
    momentPrototype__proto.month       = getSetMonth;
    momentPrototype__proto.daysInMonth = getDaysInMonth;

    // Week
    momentPrototype__proto.week           = momentPrototype__proto.weeks        = getSetWeek;
    momentPrototype__proto.isoWeek        = momentPrototype__proto.isoWeeks     = getSetISOWeek;
    momentPrototype__proto.weeksInYear    = getWeeksInYear;
    momentPrototype__proto.isoWeeksInYear = getISOWeeksInYear;

    // Day
    momentPrototype__proto.date       = getSetDayOfMonth;
    momentPrototype__proto.day        = momentPrototype__proto.days             = getSetDayOfWeek;
    momentPrototype__proto.weekday    = getSetLocaleDayOfWeek;
    momentPrototype__proto.isoWeekday = getSetISODayOfWeek;
    momentPrototype__proto.dayOfYear  = getSetDayOfYear;

    // Hour
    momentPrototype__proto.hour = momentPrototype__proto.hours = getSetHour;

    // Minute
    momentPrototype__proto.minute = momentPrototype__proto.minutes = getSetMinute;

    // Second
    momentPrototype__proto.second = momentPrototype__proto.seconds = getSetSecond;

    // Millisecond
    momentPrototype__proto.millisecond = momentPrototype__proto.milliseconds = getSetMillisecond;

    // Offset
    momentPrototype__proto.utcOffset            = getSetOffset;
    momentPrototype__proto.utc                  = setOffsetToUTC;
    momentPrototype__proto.local                = setOffsetToLocal;
    momentPrototype__proto.parseZone            = setOffsetToParsedOffset;
    momentPrototype__proto.hasAlignedHourOffset = hasAlignedHourOffset;
    momentPrototype__proto.isDST                = isDaylightSavingTime;
    momentPrototype__proto.isDSTShifted         = isDaylightSavingTimeShifted;
    momentPrototype__proto.isLocal              = isLocal;
    momentPrototype__proto.isUtcOffset          = isUtcOffset;
    momentPrototype__proto.isUtc                = isUtc;
    momentPrototype__proto.isUTC                = isUtc;

    // Timezone
    momentPrototype__proto.zoneAbbr = getZoneAbbr;
    momentPrototype__proto.zoneName = getZoneName;

    // Deprecations
    momentPrototype__proto.dates  = deprecate('dates accessor is deprecated. Use date instead.', getSetDayOfMonth);
    momentPrototype__proto.months = deprecate('months accessor is deprecated. Use month instead', getSetMonth);
    momentPrototype__proto.years  = deprecate('years accessor is deprecated. Use year instead', getSetYear);
    momentPrototype__proto.zone   = deprecate('moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779', getSetZone);

    var momentPrototype = momentPrototype__proto;

    function moment__createUnix (input) {
        return local__createLocal(input * 1000);
    }

    function moment__createInZone () {
        return local__createLocal.apply(null, arguments).parseZone();
    }

    var defaultCalendar = {
        sameDay : '[Today at] LT',
        nextDay : '[Tomorrow at] LT',
        nextWeek : 'dddd [at] LT',
        lastDay : '[Yesterday at] LT',
        lastWeek : '[Last] dddd [at] LT',
        sameElse : 'L'
    };

    function locale_calendar__calendar (key, mom, now) {
        var output = this._calendar[key];
        return isFunction(output) ? output.call(mom, now) : output;
    }

    var defaultLongDateFormat = {
        LTS  : 'h:mm:ss A',
        LT   : 'h:mm A',
        L    : 'MM/DD/YYYY',
        LL   : 'MMMM D, YYYY',
        LLL  : 'MMMM D, YYYY h:mm A',
        LLLL : 'dddd, MMMM D, YYYY h:mm A'
    };

    function longDateFormat (key) {
        var format = this._longDateFormat[key],
            formatUpper = this._longDateFormat[key.toUpperCase()];

        if (format || !formatUpper) {
            return format;
        }

        this._longDateFormat[key] = formatUpper.replace(/MMMM|MM|DD|dddd/g, function (val) {
            return val.slice(1);
        });

        return this._longDateFormat[key];
    }

    var defaultInvalidDate = 'Invalid date';

    function invalidDate () {
        return this._invalidDate;
    }

    var defaultOrdinal = '%d';
    var defaultOrdinalParse = /\d{1,2}/;

    function ordinal (number) {
        return this._ordinal.replace('%d', number);
    }

    function preParsePostFormat (string) {
        return string;
    }

    var defaultRelativeTime = {
        future : 'in %s',
        past   : '%s ago',
        s  : 'a few seconds',
        m  : 'a minute',
        mm : '%d minutes',
        h  : 'an hour',
        hh : '%d hours',
        d  : 'a day',
        dd : '%d days',
        M  : 'a month',
        MM : '%d months',
        y  : 'a year',
        yy : '%d years'
    };

    function relative__relativeTime (number, withoutSuffix, string, isFuture) {
        var output = this._relativeTime[string];
        return (isFunction(output)) ?
            output(number, withoutSuffix, string, isFuture) :
            output.replace(/%d/i, number);
    }

    function pastFuture (diff, output) {
        var format = this._relativeTime[diff > 0 ? 'future' : 'past'];
        return isFunction(format) ? format(output) : format.replace(/%s/i, output);
    }

    var prototype__proto = Locale.prototype;

    prototype__proto._calendar       = defaultCalendar;
    prototype__proto.calendar        = locale_calendar__calendar;
    prototype__proto._longDateFormat = defaultLongDateFormat;
    prototype__proto.longDateFormat  = longDateFormat;
    prototype__proto._invalidDate    = defaultInvalidDate;
    prototype__proto.invalidDate     = invalidDate;
    prototype__proto._ordinal        = defaultOrdinal;
    prototype__proto.ordinal         = ordinal;
    prototype__proto._ordinalParse   = defaultOrdinalParse;
    prototype__proto.preparse        = preParsePostFormat;
    prototype__proto.postformat      = preParsePostFormat;
    prototype__proto._relativeTime   = defaultRelativeTime;
    prototype__proto.relativeTime    = relative__relativeTime;
    prototype__proto.pastFuture      = pastFuture;
    prototype__proto.set             = locale_set__set;

    // Month
    prototype__proto.months            =        localeMonths;
    prototype__proto._months           = defaultLocaleMonths;
    prototype__proto.monthsShort       =        localeMonthsShort;
    prototype__proto._monthsShort      = defaultLocaleMonthsShort;
    prototype__proto.monthsParse       =        localeMonthsParse;
    prototype__proto._monthsRegex      = defaultMonthsRegex;
    prototype__proto.monthsRegex       = monthsRegex;
    prototype__proto._monthsShortRegex = defaultMonthsShortRegex;
    prototype__proto.monthsShortRegex  = monthsShortRegex;

    // Week
    prototype__proto.week = localeWeek;
    prototype__proto._week = defaultLocaleWeek;
    prototype__proto.firstDayOfYear = localeFirstDayOfYear;
    prototype__proto.firstDayOfWeek = localeFirstDayOfWeek;

    // Day of Week
    prototype__proto.weekdays       =        localeWeekdays;
    prototype__proto._weekdays      = defaultLocaleWeekdays;
    prototype__proto.weekdaysMin    =        localeWeekdaysMin;
    prototype__proto._weekdaysMin   = defaultLocaleWeekdaysMin;
    prototype__proto.weekdaysShort  =        localeWeekdaysShort;
    prototype__proto._weekdaysShort = defaultLocaleWeekdaysShort;
    prototype__proto.weekdaysParse  =        localeWeekdaysParse;

    prototype__proto._weekdaysRegex      = defaultWeekdaysRegex;
    prototype__proto.weekdaysRegex       =        weekdaysRegex;
    prototype__proto._weekdaysShortRegex = defaultWeekdaysShortRegex;
    prototype__proto.weekdaysShortRegex  =        weekdaysShortRegex;
    prototype__proto._weekdaysMinRegex   = defaultWeekdaysMinRegex;
    prototype__proto.weekdaysMinRegex    =        weekdaysMinRegex;

    // Hours
    prototype__proto.isPM = localeIsPM;
    prototype__proto._meridiemParse = defaultLocaleMeridiemParse;
    prototype__proto.meridiem = localeMeridiem;

    function lists__get (format, index, field, setter) {
        var locale = locale_locales__getLocale();
        var utc = create_utc__createUTC().set(setter, index);
        return locale[field](utc, format);
    }

    function listMonthsImpl (format, index, field) {
        if (typeof format === 'number') {
            index = format;
            format = undefined;
        }

        format = format || '';

        if (index != null) {
            return lists__get(format, index, field, 'month');
        }

        var i;
        var out = [];
        for (i = 0; i < 12; i++) {
            out[i] = lists__get(format, i, field, 'month');
        }
        return out;
    }

    // ()
    // (5)
    // (fmt, 5)
    // (fmt)
    // (true)
    // (true, 5)
    // (true, fmt, 5)
    // (true, fmt)
    function listWeekdaysImpl (localeSorted, format, index, field) {
        if (typeof localeSorted === 'boolean') {
            if (typeof format === 'number') {
                index = format;
                format = undefined;
            }

            format = format || '';
        } else {
            format = localeSorted;
            index = format;
            localeSorted = false;

            if (typeof format === 'number') {
                index = format;
                format = undefined;
            }

            format = format || '';
        }

        var locale = locale_locales__getLocale(),
            shift = localeSorted ? locale._week.dow : 0;

        if (index != null) {
            return lists__get(format, (index + shift) % 7, field, 'day');
        }

        var i;
        var out = [];
        for (i = 0; i < 7; i++) {
            out[i] = lists__get(format, (i + shift) % 7, field, 'day');
        }
        return out;
    }

    function lists__listMonths (format, index) {
        return listMonthsImpl(format, index, 'months');
    }

    function lists__listMonthsShort (format, index) {
        return listMonthsImpl(format, index, 'monthsShort');
    }

    function lists__listWeekdays (localeSorted, format, index) {
        return listWeekdaysImpl(localeSorted, format, index, 'weekdays');
    }

    function lists__listWeekdaysShort (localeSorted, format, index) {
        return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');
    }

    function lists__listWeekdaysMin (localeSorted, format, index) {
        return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');
    }

    locale_locales__getSetGlobalLocale('en', {
        ordinalParse: /\d{1,2}(th|st|nd|rd)/,
        ordinal : function (number) {
            var b = number % 10,
                output = (toInt(number % 100 / 10) === 1) ? 'th' :
                (b === 1) ? 'st' :
                (b === 2) ? 'nd' :
                (b === 3) ? 'rd' : 'th';
            return number + output;
        }
    });

    // Side effect imports
    utils_hooks__hooks.lang = deprecate('moment.lang is deprecated. Use moment.locale instead.', locale_locales__getSetGlobalLocale);
    utils_hooks__hooks.langData = deprecate('moment.langData is deprecated. Use moment.localeData instead.', locale_locales__getLocale);

    var mathAbs = Math.abs;

    function duration_abs__abs () {
        var data           = this._data;

        this._milliseconds = mathAbs(this._milliseconds);
        this._days         = mathAbs(this._days);
        this._months       = mathAbs(this._months);

        data.milliseconds  = mathAbs(data.milliseconds);
        data.seconds       = mathAbs(data.seconds);
        data.minutes       = mathAbs(data.minutes);
        data.hours         = mathAbs(data.hours);
        data.months        = mathAbs(data.months);
        data.years         = mathAbs(data.years);

        return this;
    }

    function duration_add_subtract__addSubtract (duration, input, value, direction) {
        var other = create__createDuration(input, value);

        duration._milliseconds += direction * other._milliseconds;
        duration._days         += direction * other._days;
        duration._months       += direction * other._months;

        return duration._bubble();
    }

    // supports only 2.0-style add(1, 's') or add(duration)
    function duration_add_subtract__add (input, value) {
        return duration_add_subtract__addSubtract(this, input, value, 1);
    }

    // supports only 2.0-style subtract(1, 's') or subtract(duration)
    function duration_add_subtract__subtract (input, value) {
        return duration_add_subtract__addSubtract(this, input, value, -1);
    }

    function absCeil (number) {
        if (number < 0) {
            return Math.floor(number);
        } else {
            return Math.ceil(number);
        }
    }

    function bubble () {
        var milliseconds = this._milliseconds;
        var days         = this._days;
        var months       = this._months;
        var data         = this._data;
        var seconds, minutes, hours, years, monthsFromDays;

        // if we have a mix of positive and negative values, bubble down first
        // check: https://github.com/moment/moment/issues/2166
        if (!((milliseconds >= 0 && days >= 0 && months >= 0) ||
                (milliseconds <= 0 && days <= 0 && months <= 0))) {
            milliseconds += absCeil(monthsToDays(months) + days) * 864e5;
            days = 0;
            months = 0;
        }

        // The following code bubbles up values, see the tests for
        // examples of what that means.
        data.milliseconds = milliseconds % 1000;

        seconds           = absFloor(milliseconds / 1000);
        data.seconds      = seconds % 60;

        minutes           = absFloor(seconds / 60);
        data.minutes      = minutes % 60;

        hours             = absFloor(minutes / 60);
        data.hours        = hours % 24;

        days += absFloor(hours / 24);

        // convert days to months
        monthsFromDays = absFloor(daysToMonths(days));
        months += monthsFromDays;
        days -= absCeil(monthsToDays(monthsFromDays));

        // 12 months -> 1 year
        years = absFloor(months / 12);
        months %= 12;

        data.days   = days;
        data.months = months;
        data.years  = years;

        return this;
    }

    function daysToMonths (days) {
        // 400 years have 146097 days (taking into account leap year rules)
        // 400 years have 12 months === 4800
        return days * 4800 / 146097;
    }

    function monthsToDays (months) {
        // the reverse of daysToMonths
        return months * 146097 / 4800;
    }

    function as (units) {
        var days;
        var months;
        var milliseconds = this._milliseconds;

        units = normalizeUnits(units);

        if (units === 'month' || units === 'year') {
            days   = this._days   + milliseconds / 864e5;
            months = this._months + daysToMonths(days);
            return units === 'month' ? months : months / 12;
        } else {
            // handle milliseconds separately because of floating point math errors (issue #1867)
            days = this._days + Math.round(monthsToDays(this._months));
            switch (units) {
                case 'week'   : return days / 7     + milliseconds / 6048e5;
                case 'day'    : return days         + milliseconds / 864e5;
                case 'hour'   : return days * 24    + milliseconds / 36e5;
                case 'minute' : return days * 1440  + milliseconds / 6e4;
                case 'second' : return days * 86400 + milliseconds / 1000;
                // Math.floor prevents floating point math errors here
                case 'millisecond': return Math.floor(days * 864e5) + milliseconds;
                default: throw new Error('Unknown unit ' + units);
            }
        }
    }

    // TODO: Use this.as('ms')?
    function duration_as__valueOf () {
        return (
            this._milliseconds +
            this._days * 864e5 +
            (this._months % 12) * 2592e6 +
            toInt(this._months / 12) * 31536e6
        );
    }

    function makeAs (alias) {
        return function () {
            return this.as(alias);
        };
    }

    var asMilliseconds = makeAs('ms');
    var asSeconds      = makeAs('s');
    var asMinutes      = makeAs('m');
    var asHours        = makeAs('h');
    var asDays         = makeAs('d');
    var asWeeks        = makeAs('w');
    var asMonths       = makeAs('M');
    var asYears        = makeAs('y');

    function duration_get__get (units) {
        units = normalizeUnits(units);
        return this[units + 's']();
    }

    function makeGetter(name) {
        return function () {
            return this._data[name];
        };
    }

    var milliseconds = makeGetter('milliseconds');
    var seconds      = makeGetter('seconds');
    var minutes      = makeGetter('minutes');
    var hours        = makeGetter('hours');
    var days         = makeGetter('days');
    var months       = makeGetter('months');
    var years        = makeGetter('years');

    function weeks () {
        return absFloor(this.days() / 7);
    }

    var round = Math.round;
    var thresholds = {
        s: 45,  // seconds to minute
        m: 45,  // minutes to hour
        h: 22,  // hours to day
        d: 26,  // days to month
        M: 11   // months to year
    };

    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize
    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {
        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);
    }

    function duration_humanize__relativeTime (posNegDuration, withoutSuffix, locale) {
        var duration = create__createDuration(posNegDuration).abs();
        var seconds  = round(duration.as('s'));
        var minutes  = round(duration.as('m'));
        var hours    = round(duration.as('h'));
        var days     = round(duration.as('d'));
        var months   = round(duration.as('M'));
        var years    = round(duration.as('y'));

        var a = seconds < thresholds.s && ['s', seconds]  ||
                minutes <= 1           && ['m']           ||
                minutes < thresholds.m && ['mm', minutes] ||
                hours   <= 1           && ['h']           ||
                hours   < thresholds.h && ['hh', hours]   ||
                days    <= 1           && ['d']           ||
                days    < thresholds.d && ['dd', days]    ||
                months  <= 1           && ['M']           ||
                months  < thresholds.M && ['MM', months]  ||
                years   <= 1           && ['y']           || ['yy', years];

        a[2] = withoutSuffix;
        a[3] = +posNegDuration > 0;
        a[4] = locale;
        return substituteTimeAgo.apply(null, a);
    }

    // This function allows you to set a threshold for relative time strings
    function duration_humanize__getSetRelativeTimeThreshold (threshold, limit) {
        if (thresholds[threshold] === undefined) {
            return false;
        }
        if (limit === undefined) {
            return thresholds[threshold];
        }
        thresholds[threshold] = limit;
        return true;
    }

    function humanize (withSuffix) {
        var locale = this.localeData();
        var output = duration_humanize__relativeTime(this, !withSuffix, locale);

        if (withSuffix) {
            output = locale.pastFuture(+this, output);
        }

        return locale.postformat(output);
    }

    var iso_string__abs = Math.abs;

    function iso_string__toISOString() {
        // for ISO strings we do not use the normal bubbling rules:
        //  * milliseconds bubble up until they become hours
        //  * days do not bubble at all
        //  * months bubble up until they become years
        // This is because there is no context-free conversion between hours and days
        // (think of clock changes)
        // and also not between days and months (28-31 days per month)
        var seconds = iso_string__abs(this._milliseconds) / 1000;
        var days         = iso_string__abs(this._days);
        var months       = iso_string__abs(this._months);
        var minutes, hours, years;

        // 3600 seconds -> 60 minutes -> 1 hour
        minutes           = absFloor(seconds / 60);
        hours             = absFloor(minutes / 60);
        seconds %= 60;
        minutes %= 60;

        // 12 months -> 1 year
        years  = absFloor(months / 12);
        months %= 12;


        // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js
        var Y = years;
        var M = months;
        var D = days;
        var h = hours;
        var m = minutes;
        var s = seconds;
        var total = this.asSeconds();

        if (!total) {
            // this is the same as C#'s (Noda) and python (isodate)...
            // but not other JS (goog.date)
            return 'P0D';
        }

        return (total < 0 ? '-' : '') +
            'P' +
            (Y ? Y + 'Y' : '') +
            (M ? M + 'M' : '') +
            (D ? D + 'D' : '') +
            ((h || m || s) ? 'T' : '') +
            (h ? h + 'H' : '') +
            (m ? m + 'M' : '') +
            (s ? s + 'S' : '');
    }

    var duration_prototype__proto = Duration.prototype;

    duration_prototype__proto.abs            = duration_abs__abs;
    duration_prototype__proto.add            = duration_add_subtract__add;
    duration_prototype__proto.subtract       = duration_add_subtract__subtract;
    duration_prototype__proto.as             = as;
    duration_prototype__proto.asMilliseconds = asMilliseconds;
    duration_prototype__proto.asSeconds      = asSeconds;
    duration_prototype__proto.asMinutes      = asMinutes;
    duration_prototype__proto.asHours        = asHours;
    duration_prototype__proto.asDays         = asDays;
    duration_prototype__proto.asWeeks        = asWeeks;
    duration_prototype__proto.asMonths       = asMonths;
    duration_prototype__proto.asYears        = asYears;
    duration_prototype__proto.valueOf        = duration_as__valueOf;
    duration_prototype__proto._bubble        = bubble;
    duration_prototype__proto.get            = duration_get__get;
    duration_prototype__proto.milliseconds   = milliseconds;
    duration_prototype__proto.seconds        = seconds;
    duration_prototype__proto.minutes        = minutes;
    duration_prototype__proto.hours          = hours;
    duration_prototype__proto.days           = days;
    duration_prototype__proto.weeks          = weeks;
    duration_prototype__proto.months         = months;
    duration_prototype__proto.years          = years;
    duration_prototype__proto.humanize       = humanize;
    duration_prototype__proto.toISOString    = iso_string__toISOString;
    duration_prototype__proto.toString       = iso_string__toISOString;
    duration_prototype__proto.toJSON         = iso_string__toISOString;
    duration_prototype__proto.locale         = locale;
    duration_prototype__proto.localeData     = localeData;

    // Deprecations
    duration_prototype__proto.toIsoString = deprecate('toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)', iso_string__toISOString);
    duration_prototype__proto.lang = lang;

    // Side effect imports

    // FORMATTING

    addFormatToken('X', 0, 0, 'unix');
    addFormatToken('x', 0, 0, 'valueOf');

    // PARSING

    addRegexToken('x', matchSigned);
    addRegexToken('X', matchTimestamp);
    addParseToken('X', function (input, array, config) {
        config._d = new Date(parseFloat(input, 10) * 1000);
    });
    addParseToken('x', function (input, array, config) {
        config._d = new Date(toInt(input));
    });

    // Side effect imports


    utils_hooks__hooks.version = '2.13.0';

    setHookCallback(local__createLocal);

    utils_hooks__hooks.fn                    = momentPrototype;
    utils_hooks__hooks.min                   = min;
    utils_hooks__hooks.max                   = max;
    utils_hooks__hooks.now                   = now;
    utils_hooks__hooks.utc                   = create_utc__createUTC;
    utils_hooks__hooks.unix                  = moment__createUnix;
    utils_hooks__hooks.months                = lists__listMonths;
    utils_hooks__hooks.isDate                = isDate;
    utils_hooks__hooks.locale                = locale_locales__getSetGlobalLocale;
    utils_hooks__hooks.invalid               = valid__createInvalid;
    utils_hooks__hooks.duration              = create__createDuration;
    utils_hooks__hooks.isMoment              = isMoment;
    utils_hooks__hooks.weekdays              = lists__listWeekdays;
    utils_hooks__hooks.parseZone             = moment__createInZone;
    utils_hooks__hooks.localeData            = locale_locales__getLocale;
    utils_hooks__hooks.isDuration            = isDuration;
    utils_hooks__hooks.monthsShort           = lists__listMonthsShort;
    utils_hooks__hooks.weekdaysMin           = lists__listWeekdaysMin;
    utils_hooks__hooks.defineLocale          = defineLocale;
    utils_hooks__hooks.updateLocale          = updateLocale;
    utils_hooks__hooks.locales               = locale_locales__listLocales;
    utils_hooks__hooks.weekdaysShort         = lists__listWeekdaysShort;
    utils_hooks__hooks.normalizeUnits        = normalizeUnits;
    utils_hooks__hooks.relativeTimeThreshold = duration_humanize__getSetRelativeTimeThreshold;
    utils_hooks__hooks.prototype             = momentPrototype;

    var _moment = utils_hooks__hooks;

    return _moment;

}));
/**
* @version: 2.1.25
* @author: Dan Grossman http://www.dangrossman.info/
* @copyright: Copyright (c) 2012-2017 Dan Grossman. All rights reserved.
* @license: Licensed under the MIT license. See http://www.opensource.org/licenses/mit-license.php
* @website: http://www.daterangepicker.com/
*/
// Follow the UMD template https://github.com/umdjs/umd/blob/master/templates/returnExportsGlobal.js
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Make globaly available as well
        define(['moment', 'jquery'], function (moment, jquery) {
            if (!jquery.fn) jquery.fn = {}; // webpack server rendering
            return (root.daterangepicker = factory(moment, jquery));
        });
    } else if (typeof module === 'object' && module.exports) {
        // Node / Browserify
        //isomorphic issue
        var jQuery = (typeof window != 'undefined') ? window.jQuery : undefined;
        if (!jQuery) {
            jQuery = require('jquery');
            if (!jQuery.fn) jQuery.fn = {};
        }
        var moment = (typeof window != 'undefined' && typeof window.moment != 'undefined') ? window.moment : require('moment');
        module.exports = factory(moment, jQuery);
    } else {
        // Browser globals
        root.daterangepicker = factory(root.moment, root.jQuery);
    }
}(this, function(moment, $) {
    var DateRangePicker = function(element, options, cb) {

        //default settings for options
        this.parentEl = 'body';
        this.element = $(element);
        this.startDate = moment().startOf('day');
        this.endDate = moment().endOf('day');
        this.minDate = false;
        this.maxDate = false;
        this.dateLimit = false;
        this.autoApply = false;
        this.singleDatePicker = false;
        this.showDropdowns = false;
        this.showWeekNumbers = false;
        this.showISOWeekNumbers = false;
        this.showCustomRangeLabel = true;
        this.timePicker = false;
        this.timePicker24Hour = false;
        this.timePickerIncrement = 1;
        this.timePickerSeconds = false;
        this.linkedCalendars = true;
        this.autoUpdateInput = true;
        this.alwaysShowCalendars = false;
        this.ranges = {};

        this.opens = 'right';
        if (this.element.hasClass('pull-right'))
            this.opens = 'left';

        this.drops = 'down';
        if (this.element.hasClass('dropup'))
            this.drops = 'up';

        this.buttonClasses = 'btn btn-sm';
        this.applyClass = 'btn-success';
        this.cancelClass = 'btn-default';

        this.locale = {
            direction: 'ltr',
            format: moment.localeData().longDateFormat('L'),
            separator: ' - ',
            applyLabel: 'Apply',
            cancelLabel: 'Cancel',
            weekLabel: 'W',
            customRangeLabel: 'Custom Range',
            daysOfWeek: moment.weekdaysMin(),
            monthNames: moment.monthsShort(),
            firstDay: moment.localeData().firstDayOfWeek()
        };

        this.callback = function() { };

        //some state information
        this.isShowing = false;
        this.leftCalendar = {};
        this.rightCalendar = {};

        //custom options from user
        if (typeof options !== 'object' || options === null)
            options = {};

        //allow setting options with data attributes
        //data-api options will be overwritten with custom javascript options
        options = $.extend(this.element.data(), options);

        //html template for the picker UI
        if (typeof options.template !== 'string' && !(options.template instanceof $))
            options.template = '<div class="daterangepicker dropdown-menu">' +
                '<div class="calendar left">' +
                    '<div class="daterangepicker_input">' +
                      '<input class="input-mini form-control" type="text" name="daterangepicker_start" value="" />' +
                      '<i class="fa fa-calendar glyphicon glyphicon-calendar"></i>' +
                      '<div class="calendar-time">' +
                        '<div></div>' +
                        '<i class="fa fa-clock-o glyphicon glyphicon-time"></i>' +
                      '</div>' +
                    '</div>' +
                    '<div class="calendar-table"></div>' +
                '</div>' +
                '<div class="calendar right">' +
                    '<div class="daterangepicker_input">' +
                      '<input class="input-mini form-control" type="text" name="daterangepicker_end" value="" />' +
                      '<i class="fa fa-calendar glyphicon glyphicon-calendar"></i>' +
                      '<div class="calendar-time">' +
                        '<div></div>' +
                        '<i class="fa fa-clock-o glyphicon glyphicon-time"></i>' +
                      '</div>' +
                    '</div>' +
                    '<div class="calendar-table"></div>' +
                '</div>' +
                '<div class="ranges">' +
                    '<div class="range_inputs">' +
                        '<button class="applyBtn" disabled="disabled" type="button"></button> ' +
                        '<button class="cancelBtn" type="button"></button>' +
                    '</div>' +
                '</div>' +
            '</div>';

        this.parentEl = (options.parentEl && $(options.parentEl).length) ? $(options.parentEl) : $(this.parentEl);
        this.container = $(options.template).appendTo(this.parentEl);

        //
        // handle all the possible options overriding defaults
        //

        if (typeof options.locale === 'object') {

            if (typeof options.locale.direction === 'string')
                this.locale.direction = options.locale.direction;

            if (typeof options.locale.format === 'string')
                this.locale.format = options.locale.format;

            if (typeof options.locale.separator === 'string')
                this.locale.separator = options.locale.separator;

            if (typeof options.locale.daysOfWeek === 'object')
                this.locale.daysOfWeek = options.locale.daysOfWeek.slice();

            if (typeof options.locale.monthNames === 'object')
              this.locale.monthNames = options.locale.monthNames.slice();

            if (typeof options.locale.firstDay === 'number')
              this.locale.firstDay = options.locale.firstDay;

            if (typeof options.locale.applyLabel === 'string')
              this.locale.applyLabel = options.locale.applyLabel;

            if (typeof options.locale.cancelLabel === 'string')
              this.locale.cancelLabel = options.locale.cancelLabel;

            if (typeof options.locale.weekLabel === 'string')
              this.locale.weekLabel = options.locale.weekLabel;

            if (typeof options.locale.customRangeLabel === 'string'){
                //Support unicode chars in the custom range name.
                var elem = document.createElement('textarea');
                elem.innerHTML = options.locale.customRangeLabel;
                var rangeHtml = elem.value;
                this.locale.customRangeLabel = rangeHtml;
            }
        }
        this.container.addClass(this.locale.direction);

        if (typeof options.startDate === 'string')
            this.startDate = moment(options.startDate, this.locale.format);

        if (typeof options.endDate === 'string')
            this.endDate = moment(options.endDate, this.locale.format);

        if (typeof options.minDate === 'string')
            this.minDate = moment(options.minDate, this.locale.format);

        if (typeof options.maxDate === 'string')
            this.maxDate = moment(options.maxDate, this.locale.format);

        if (typeof options.startDate === 'object')
            this.startDate = moment(options.startDate);

        if (typeof options.endDate === 'object')
            this.endDate = moment(options.endDate);

        if (typeof options.minDate === 'object')
            this.minDate = moment(options.minDate);

        if (typeof options.maxDate === 'object')
            this.maxDate = moment(options.maxDate);

        // sanity check for bad options
        if (this.minDate && this.startDate.isBefore(this.minDate))
            this.startDate = this.minDate.clone();

        // sanity check for bad options
        if (this.maxDate && this.endDate.isAfter(this.maxDate))
            this.endDate = this.maxDate.clone();

        if (typeof options.applyClass === 'string')
            this.applyClass = options.applyClass;

        if (typeof options.cancelClass === 'string')
            this.cancelClass = options.cancelClass;

        if (typeof options.dateLimit === 'object')
            this.dateLimit = options.dateLimit;

        if (typeof options.opens === 'string')
            this.opens = options.opens;

        if (typeof options.drops === 'string')
            this.drops = options.drops;

        if (typeof options.showWeekNumbers === 'boolean')
            this.showWeekNumbers = options.showWeekNumbers;

        if (typeof options.showISOWeekNumbers === 'boolean')
            this.showISOWeekNumbers = options.showISOWeekNumbers;

        if (typeof options.buttonClasses === 'string')
            this.buttonClasses = options.buttonClasses;

        if (typeof options.buttonClasses === 'object')
            this.buttonClasses = options.buttonClasses.join(' ');

        if (typeof options.showDropdowns === 'boolean')
            this.showDropdowns = options.showDropdowns;

        if (typeof options.showCustomRangeLabel === 'boolean')
            this.showCustomRangeLabel = options.showCustomRangeLabel;

        if (typeof options.singleDatePicker === 'boolean') {
            this.singleDatePicker = options.singleDatePicker;
            if (this.singleDatePicker)
                this.endDate = this.startDate.clone();
        }

        if (typeof options.timePicker === 'boolean')
            this.timePicker = options.timePicker;

        if (typeof options.timePickerSeconds === 'boolean')
            this.timePickerSeconds = options.timePickerSeconds;

        if (typeof options.timePickerIncrement === 'number')
            this.timePickerIncrement = options.timePickerIncrement;

        if (typeof options.timePicker24Hour === 'boolean')
            this.timePicker24Hour = options.timePicker24Hour;

        if (typeof options.autoApply === 'boolean')
            this.autoApply = options.autoApply;

        if (typeof options.autoUpdateInput === 'boolean')
            this.autoUpdateInput = options.autoUpdateInput;

        if (typeof options.linkedCalendars === 'boolean')
            this.linkedCalendars = options.linkedCalendars;

        if (typeof options.isInvalidDate === 'function')
            this.isInvalidDate = options.isInvalidDate;

        if (typeof options.isCustomDate === 'function')
            this.isCustomDate = options.isCustomDate;

        if (typeof options.alwaysShowCalendars === 'boolean')
            this.alwaysShowCalendars = options.alwaysShowCalendars;

        // update day names order to firstDay
        if (this.locale.firstDay != 0) {
            var iterator = this.locale.firstDay;
            while (iterator > 0) {
                this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift());
                iterator--;
            }
        }

        var start, end, range;

        //if no start/end dates set, check if an input element contains initial values
        if (typeof options.startDate === 'undefined' && typeof options.endDate === 'undefined') {
            if ($(this.element).is('input[type=text]')) {
                var val = $(this.element).val(),
                    split = val.split(this.locale.separator);

                start = end = null;

                if (split.length == 2) {
                    start = moment(split[0], this.locale.format);
                    end = moment(split[1], this.locale.format);
                } else if (this.singleDatePicker && val !== "") {
                    start = moment(val, this.locale.format);
                    end = moment(val, this.locale.format);
                }
                if (start !== null && end !== null) {
                    this.setStartDate(start);
                    this.setEndDate(end);
                }
            }
        }

        if (typeof options.ranges === 'object') {
            for (range in options.ranges) {

                if (typeof options.ranges[range][0] === 'string')
                    start = moment(options.ranges[range][0], this.locale.format);
                else
                    start = moment(options.ranges[range][0]);

                if (typeof options.ranges[range][1] === 'string')
                    end = moment(options.ranges[range][1], this.locale.format);
                else
                    end = moment(options.ranges[range][1]);

                // If the start or end date exceed those allowed by the minDate or dateLimit
                // options, shorten the range to the allowable period.
                if (this.minDate && start.isBefore(this.minDate))
                    start = this.minDate.clone();

                var maxDate = this.maxDate;
                if (this.dateLimit && maxDate && start.clone().add(this.dateLimit).isAfter(maxDate))
                    maxDate = start.clone().add(this.dateLimit);
                if (maxDate && end.isAfter(maxDate))
                    end = maxDate.clone();

                // If the end of the range is before the minimum or the start of the range is
                // after the maximum, don't display this range option at all.
                if ((this.minDate && end.isBefore(this.minDate, this.timepicker ? 'minute' : 'day')) 
                  || (maxDate && start.isAfter(maxDate, this.timepicker ? 'minute' : 'day')))
                    continue;

                //Support unicode chars in the range names.
                var elem = document.createElement('textarea');
                elem.innerHTML = range;
                var rangeHtml = elem.value;

                this.ranges[rangeHtml] = [start, end];
            }

            var list = '<ul>';
            for (range in this.ranges) {
                list += '<li data-range-key="' + range + '">' + range + '</li>';
            }
            if (this.showCustomRangeLabel) {
                list += '<li data-range-key="' + this.locale.customRangeLabel + '">' + this.locale.customRangeLabel + '</li>';
            }
            list += '</ul>';
            this.container.find('.ranges').prepend(list);
        }

        if (typeof cb === 'function') {
            this.callback = cb;
        }

        if (!this.timePicker) {
            this.startDate = this.startDate.startOf('day');
            this.endDate = this.endDate.endOf('day');
            this.container.find('.calendar-time').hide();
        }

        //can't be used together for now
        if (this.timePicker && this.autoApply)
            this.autoApply = false;

        if (this.autoApply && typeof options.ranges !== 'object') {
            this.container.find('.ranges').hide();
        } else if (this.autoApply) {
            this.container.find('.applyBtn, .cancelBtn').addClass('hide');
        }

        if (this.singleDatePicker) {
            this.container.addClass('single');
            this.container.find('.calendar.left').addClass('single');
            this.container.find('.calendar.left').show();
            this.container.find('.calendar.right').hide();
            this.container.find('.daterangepicker_input input, .daterangepicker_input > i').hide();
            if (this.timePicker) {
                this.container.find('.ranges ul').hide();
            } else {
                this.container.find('.ranges').hide();
            }
        }

        if ((typeof options.ranges === 'undefined' && !this.singleDatePicker) || this.alwaysShowCalendars) {
            this.container.addClass('show-calendar');
        }

        this.container.addClass('opens' + this.opens);

        //swap the position of the predefined ranges if opens right
        if (typeof options.ranges !== 'undefined' && this.opens == 'right') {
            this.container.find('.ranges').prependTo( this.container.find('.calendar.left').parent() );
        }

        //apply CSS classes and labels to buttons
        this.container.find('.applyBtn, .cancelBtn').addClass(this.buttonClasses);
        if (this.applyClass.length)
            this.container.find('.applyBtn').addClass(this.applyClass);
        if (this.cancelClass.length)
            this.container.find('.cancelBtn').addClass(this.cancelClass);
        this.container.find('.applyBtn').html(this.locale.applyLabel);
        this.container.find('.cancelBtn').html(this.locale.cancelLabel);

        //
        // event listeners
        //

        this.container.find('.calendar')
            .on('click.daterangepicker', '.prev', $.proxy(this.clickPrev, this))
            .on('click.daterangepicker', '.next', $.proxy(this.clickNext, this))
            .on('mousedown.daterangepicker', 'td.available', $.proxy(this.clickDate, this))
            .on('mouseenter.daterangepicker', 'td.available', $.proxy(this.hoverDate, this))
            .on('mouseleave.daterangepicker', 'td.available', $.proxy(this.updateFormInputs, this))
            .on('change.daterangepicker', 'select.yearselect', $.proxy(this.monthOrYearChanged, this))
            .on('change.daterangepicker', 'select.monthselect', $.proxy(this.monthOrYearChanged, this))
            .on('change.daterangepicker', 'select.hourselect,select.minuteselect,select.secondselect,select.ampmselect', $.proxy(this.timeChanged, this))
            .on('click.daterangepicker', '.daterangepicker_input input', $.proxy(this.showCalendars, this))
            .on('focus.daterangepicker', '.daterangepicker_input input', $.proxy(this.formInputsFocused, this))
            .on('blur.daterangepicker', '.daterangepicker_input input', $.proxy(this.formInputsBlurred, this))
            .on('change.daterangepicker', '.daterangepicker_input input', $.proxy(this.formInputsChanged, this));

        this.container.find('.ranges')
            .on('click.daterangepicker', 'button.applyBtn', $.proxy(this.clickApply, this))
            .on('click.daterangepicker', 'button.cancelBtn', $.proxy(this.clickCancel, this))
            .on('click.daterangepicker', 'li', $.proxy(this.clickRange, this))
            .on('mouseenter.daterangepicker', 'li', $.proxy(this.hoverRange, this))
            .on('mouseleave.daterangepicker', 'li', $.proxy(this.updateFormInputs, this));

        if (this.element.is('input') || this.element.is('button')) {
            this.element.on({
                'click.daterangepicker': $.proxy(this.show, this),
                'focus.daterangepicker': $.proxy(this.show, this),
                'keyup.daterangepicker': $.proxy(this.elementChanged, this),
                'keydown.daterangepicker': $.proxy(this.keydown, this)
            });
        } else {
            this.element.on('click.daterangepicker', $.proxy(this.toggle, this));
        }

        //
        // if attached to a text input, set the initial value
        //

        if (this.element.is('input') && !this.singleDatePicker && this.autoUpdateInput) {
            this.element.val(this.startDate.format(this.locale.format) + this.locale.separator + this.endDate.format(this.locale.format));
            this.element.trigger('change');
        } else if (this.element.is('input') && this.autoUpdateInput) {
            this.element.val(this.startDate.format(this.locale.format));
            this.element.trigger('change');
        }

    };

    DateRangePicker.prototype = {

        constructor: DateRangePicker,

        setStartDate: function(startDate) {
            if (typeof startDate === 'string')
                this.startDate = moment(startDate, this.locale.format);

            if (typeof startDate === 'object')
                this.startDate = moment(startDate);

            if (!this.timePicker)
                this.startDate = this.startDate.startOf('day');

            if (this.timePicker && this.timePickerIncrement)
                this.startDate.minute(Math.round(this.startDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);

            if (this.minDate && this.startDate.isBefore(this.minDate)) {
                this.startDate = this.minDate.clone();
                if (this.timePicker && this.timePickerIncrement)
                    this.startDate.minute(Math.round(this.startDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);
            }

            if (this.maxDate && this.startDate.isAfter(this.maxDate)) {
                this.startDate = this.maxDate.clone();
                if (this.timePicker && this.timePickerIncrement)
                    this.startDate.minute(Math.floor(this.startDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);
            }

            if (!this.isShowing)
                this.updateElement();

            this.updateMonthsInView();
        },

        setEndDate: function(endDate) {
            if (typeof endDate === 'string')
                this.endDate = moment(endDate, this.locale.format);

            if (typeof endDate === 'object')
                this.endDate = moment(endDate);

            if (!this.timePicker)
                this.endDate = this.endDate.endOf('day');

            if (this.timePicker && this.timePickerIncrement)
                this.endDate.minute(Math.round(this.endDate.minute() / this.timePickerIncrement) * this.timePickerIncrement);

            if (this.endDate.isBefore(this.startDate))
                this.endDate = this.startDate.clone();

            if (this.maxDate && this.endDate.isAfter(this.maxDate))
                this.endDate = this.maxDate.clone();

            if (this.dateLimit && this.startDate.clone().add(this.dateLimit).isBefore(this.endDate))
                this.endDate = this.startDate.clone().add(this.dateLimit);

            this.previousRightTime = this.endDate.clone();

            if (!this.isShowing)
                this.updateElement();

            this.updateMonthsInView();
        },

        isInvalidDate: function() {
            return false;
        },

        isCustomDate: function() {
            return false;
        },

        updateView: function() {
            if (this.timePicker) {
                this.renderTimePicker('left');
                this.renderTimePicker('right');
                if (!this.endDate) {
                    this.container.find('.right .calendar-time select').attr('disabled', 'disabled').addClass('disabled');
                } else {
                    this.container.find('.right .calendar-time select').removeAttr('disabled').removeClass('disabled');
                }
            }
            if (this.endDate) {
                this.container.find('input[name="daterangepicker_end"]').removeClass('active');
                this.container.find('input[name="daterangepicker_start"]').addClass('active');
            } else {
                this.container.find('input[name="daterangepicker_end"]').addClass('active');
                this.container.find('input[name="daterangepicker_start"]').removeClass('active');
            }
            this.updateMonthsInView();
            this.updateCalendars();
            this.updateFormInputs();
        },

        updateMonthsInView: function() {
            if (this.endDate) {

                //if both dates are visible already, do nothing
                if (!this.singleDatePicker && this.leftCalendar.month && this.rightCalendar.month &&
                    (this.startDate.format('YYYY-MM') == this.leftCalendar.month.format('YYYY-MM') || this.startDate.format('YYYY-MM') == this.rightCalendar.month.format('YYYY-MM'))
                    &&
                    (this.endDate.format('YYYY-MM') == this.leftCalendar.month.format('YYYY-MM') || this.endDate.format('YYYY-MM') == this.rightCalendar.month.format('YYYY-MM'))
                    ) {
                    return;
                }

                this.leftCalendar.month = this.startDate.clone().date(2);
                if (!this.linkedCalendars && (this.endDate.month() != this.startDate.month() || this.endDate.year() != this.startDate.year())) {
                    this.rightCalendar.month = this.endDate.clone().date(2);
                } else {
                    this.rightCalendar.month = this.startDate.clone().date(2).add(1, 'month');
                }

            } else {
                if (this.leftCalendar.month.format('YYYY-MM') != this.startDate.format('YYYY-MM') && this.rightCalendar.month.format('YYYY-MM') != this.startDate.format('YYYY-MM')) {
                    this.leftCalendar.month = this.startDate.clone().date(2);
                    this.rightCalendar.month = this.startDate.clone().date(2).add(1, 'month');
                }
            }
            if (this.maxDate && this.linkedCalendars && !this.singleDatePicker && this.rightCalendar.month > this.maxDate) {
              this.rightCalendar.month = this.maxDate.clone().date(2);
              this.leftCalendar.month = this.maxDate.clone().date(2).subtract(1, 'month');
            }
        },

        updateCalendars: function() {

            if (this.timePicker) {
                var hour, minute, second;
                if (this.endDate) {
                    hour = parseInt(this.container.find('.left .hourselect').val(), 10);
                    minute = parseInt(this.container.find('.left .minuteselect').val(), 10);
                    second = this.timePickerSeconds ? parseInt(this.container.find('.left .secondselect').val(), 10) : 0;
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.left .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                } else {
                    hour = parseInt(this.container.find('.right .hourselect').val(), 10);
                    minute = parseInt(this.container.find('.right .minuteselect').val(), 10);
                    second = this.timePickerSeconds ? parseInt(this.container.find('.right .secondselect').val(), 10) : 0;
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.right .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                }
                this.leftCalendar.month.hour(hour).minute(minute).second(second);
                this.rightCalendar.month.hour(hour).minute(minute).second(second);
            }

            this.renderCalendar('left');
            this.renderCalendar('right');

            //highlight any predefined range matching the current start and end dates
            this.container.find('.ranges li').removeClass('active');
            if (this.endDate == null) return;

            this.calculateChosenLabel();
        },

        renderCalendar: function(side) {

            //
            // Build the matrix of dates that will populate the calendar
            //

            var calendar = side == 'left' ? this.leftCalendar : this.rightCalendar;
            var month = calendar.month.month();
            var year = calendar.month.year();
            var hour = calendar.month.hour();
            var minute = calendar.month.minute();
            var second = calendar.month.second();
            var daysInMonth = moment([year, month]).daysInMonth();
            var firstDay = moment([year, month, 1]);
            var lastDay = moment([year, month, daysInMonth]);
            var lastMonth = moment(firstDay).subtract(1, 'month').month();
            var lastYear = moment(firstDay).subtract(1, 'month').year();
            var daysInLastMonth = moment([lastYear, lastMonth]).daysInMonth();
            var dayOfWeek = firstDay.day();

            //initialize a 6 rows x 7 columns array for the calendar
            var calendar = [];
            calendar.firstDay = firstDay;
            calendar.lastDay = lastDay;

            for (var i = 0; i < 6; i++) {
                calendar[i] = [];
            }

            //populate the calendar with date objects
            var startDay = daysInLastMonth - dayOfWeek + this.locale.firstDay + 1;
            if (startDay > daysInLastMonth)
                startDay -= 7;

            if (dayOfWeek == this.locale.firstDay)
                startDay = daysInLastMonth - 6;

            var curDate = moment([lastYear, lastMonth, startDay, 12, minute, second]);

            var col, row;
            for (var i = 0, col = 0, row = 0; i < 42; i++, col++, curDate = moment(curDate).add(24, 'hour')) {
                if (i > 0 && col % 7 === 0) {
                    col = 0;
                    row++;
                }
                calendar[row][col] = curDate.clone().hour(hour).minute(minute).second(second);
                curDate.hour(12);

                if (this.minDate && calendar[row][col].format('YYYY-MM-DD') == this.minDate.format('YYYY-MM-DD') && calendar[row][col].isBefore(this.minDate) && side == 'left') {
                    calendar[row][col] = this.minDate.clone();
                }

                if (this.maxDate && calendar[row][col].format('YYYY-MM-DD') == this.maxDate.format('YYYY-MM-DD') && calendar[row][col].isAfter(this.maxDate) && side == 'right') {
                    calendar[row][col] = this.maxDate.clone();
                }

            }

            //make the calendar object available to hoverDate/clickDate
            if (side == 'left') {
                this.leftCalendar.calendar = calendar;
            } else {
                this.rightCalendar.calendar = calendar;
            }

            //
            // Display the calendar
            //

            var minDate = side == 'left' ? this.minDate : this.startDate;
            var maxDate = this.maxDate;
            var selected = side == 'left' ? this.startDate : this.endDate;
            var arrow = this.locale.direction == 'ltr' ? {left: 'chevron-left', right: 'chevron-right'} : {left: 'chevron-right', right: 'chevron-left'};

            var html = '<table class="table-condensed">';
            html += '<thead>';
            html += '<tr>';

            // add empty cell for week number
            if (this.showWeekNumbers || this.showISOWeekNumbers)
                html += '<th></th>';

            if ((!minDate || minDate.isBefore(calendar.firstDay)) && (!this.linkedCalendars || side == 'left')) {
                html += '<th class="prev available"><i class="fa fa-' + arrow.left + ' glyphicon glyphicon-' + arrow.left + '"></i></th>';
            } else {
                html += '<th></th>';
            }

            var dateHtml = this.locale.monthNames[calendar[1][1].month()] + calendar[1][1].format(" YYYY");

            if (this.showDropdowns) {
                var currentMonth = calendar[1][1].month();
                var currentYear = calendar[1][1].year();
                var maxYear = (maxDate && maxDate.year()) || (currentYear + 5);
                var minYear = (minDate && minDate.year()) || (currentYear - 50);
                var inMinYear = currentYear == minYear;
                var inMaxYear = currentYear == maxYear;

                var monthHtml = '<select class="monthselect">';
                for (var m = 0; m < 12; m++) {
                    if ((!inMinYear || m >= minDate.month()) && (!inMaxYear || m <= maxDate.month())) {
                        monthHtml += "<option value='" + m + "'" +
                            (m === currentMonth ? " selected='selected'" : "") +
                            ">" + this.locale.monthNames[m] + "</option>";
                    } else {
                        monthHtml += "<option value='" + m + "'" +
                            (m === currentMonth ? " selected='selected'" : "") +
                            " disabled='disabled'>" + this.locale.monthNames[m] + "</option>";
                    }
                }
                monthHtml += "</select>";

                var yearHtml = '<select class="yearselect">';
                for (var y = minYear; y <= maxYear; y++) {
                    yearHtml += '<option value="' + y + '"' +
                        (y === currentYear ? ' selected="selected"' : '') +
                        '>' + y + '</option>';
                }
                yearHtml += '</select>';

                dateHtml = monthHtml + yearHtml;
            }

            html += '<th colspan="5" class="month">' + dateHtml + '</th>';
            if ((!maxDate || maxDate.isAfter(calendar.lastDay)) && (!this.linkedCalendars || side == 'right' || this.singleDatePicker)) {
                html += '<th class="next available"><i class="fa fa-' + arrow.right + ' glyphicon glyphicon-' + arrow.right + '"></i></th>';
            } else {
                html += '<th></th>';
            }

            html += '</tr>';
            html += '<tr>';

            // add week number label
            if (this.showWeekNumbers || this.showISOWeekNumbers)
                html += '<th class="week">' + this.locale.weekLabel + '</th>';

            $.each(this.locale.daysOfWeek, function(index, dayOfWeek) {
                html += '<th>' + dayOfWeek + '</th>';
            });

            html += '</tr>';
            html += '</thead>';
            html += '<tbody>';

            //adjust maxDate to reflect the dateLimit setting in order to
            //grey out end dates beyond the dateLimit
            if (this.endDate == null && this.dateLimit) {
                var maxLimit = this.startDate.clone().add(this.dateLimit).endOf('day');
                if (!maxDate || maxLimit.isBefore(maxDate)) {
                    maxDate = maxLimit;
                }
            }

            for (var row = 0; row < 6; row++) {
                html += '<tr>';

                // add week number
                if (this.showWeekNumbers)
                    html += '<td class="week">' + calendar[row][0].week() + '</td>';
                else if (this.showISOWeekNumbers)
                    html += '<td class="week">' + calendar[row][0].isoWeek() + '</td>';

                for (var col = 0; col < 7; col++) {

                    var classes = [];

                    //highlight today's date
                    if (calendar[row][col].isSame(new Date(), "day"))
                        classes.push('today');

                    //highlight weekends
                    if (calendar[row][col].isoWeekday() > 5)
                        classes.push('weekend');

                    //grey out the dates in other months displayed at beginning and end of this calendar
                    if (calendar[row][col].month() != calendar[1][1].month())
                        classes.push('off');

                    //don't allow selection of dates before the minimum date
                    if (this.minDate && calendar[row][col].isBefore(this.minDate, 'day'))
                        classes.push('off', 'disabled');

                    //don't allow selection of dates after the maximum date
                    if (maxDate && calendar[row][col].isAfter(maxDate, 'day'))
                        classes.push('off', 'disabled');

                    //don't allow selection of date if a custom function decides it's invalid
                    if (this.isInvalidDate(calendar[row][col]))
                        classes.push('off', 'disabled');

                    //highlight the currently selected start date
                    if (calendar[row][col].format('YYYY-MM-DD') == this.startDate.format('YYYY-MM-DD'))
                        classes.push('active', 'start-date');

                    //highlight the currently selected end date
                    if (this.endDate != null && calendar[row][col].format('YYYY-MM-DD') == this.endDate.format('YYYY-MM-DD'))
                        classes.push('active', 'end-date');

                    //highlight dates in-between the selected dates
                    if (this.endDate != null && calendar[row][col] > this.startDate && calendar[row][col] < this.endDate)
                        classes.push('in-range');

                    //apply custom classes for this date
                    var isCustom = this.isCustomDate(calendar[row][col]);
                    if (isCustom !== false) {
                        if (typeof isCustom === 'string')
                            classes.push(isCustom);
                        else
                            Array.prototype.push.apply(classes, isCustom);
                    }

                    var cname = '', disabled = false;
                    for (var i = 0; i < classes.length; i++) {
                        cname += classes[i] + ' ';
                        if (classes[i] == 'disabled')
                            disabled = true;
                    }
                    if (!disabled)
                        cname += 'available';

                    html += '<td class="' + cname.replace(/^\s+|\s+$/g, '') + '" data-title="' + 'r' + row + 'c' + col + '">' + calendar[row][col].date() + '</td>';

                }
                html += '</tr>';
            }

            html += '</tbody>';
            html += '</table>';

            this.container.find('.calendar.' + side + ' .calendar-table').html(html);

        },

        renderTimePicker: function(side) {

            // Don't bother updating the time picker if it's currently disabled
            // because an end date hasn't been clicked yet
            if (side == 'right' && !this.endDate) return;

            var html, selected, minDate, maxDate = this.maxDate;

            if (this.dateLimit && (!this.maxDate || this.startDate.clone().add(this.dateLimit).isAfter(this.maxDate)))
                maxDate = this.startDate.clone().add(this.dateLimit);

            if (side == 'left') {
                selected = this.startDate.clone();
                minDate = this.minDate;
            } else if (side == 'right') {
                selected = this.endDate.clone();
                minDate = this.startDate;

                //Preserve the time already selected
                var timeSelector = this.container.find('.calendar.right .calendar-time div');
                if (timeSelector.html() != '') {

                    selected.hour(timeSelector.find('.hourselect option:selected').val() || selected.hour());
                    selected.minute(timeSelector.find('.minuteselect option:selected').val() || selected.minute());
                    selected.second(timeSelector.find('.secondselect option:selected').val() || selected.second());

                    if (!this.timePicker24Hour) {
                        var ampm = timeSelector.find('.ampmselect option:selected').val();
                        if (ampm === 'PM' && selected.hour() < 12)
                            selected.hour(selected.hour() + 12);
                        if (ampm === 'AM' && selected.hour() === 12)
                            selected.hour(0);
                    }

                }

                if (selected.isBefore(this.startDate))
                    selected = this.startDate.clone();

                if (maxDate && selected.isAfter(maxDate))
                    selected = maxDate.clone();

            }

            //
            // hours
            //

            html = '<select class="hourselect">';

            var start = this.timePicker24Hour ? 0 : 1;
            var end = this.timePicker24Hour ? 23 : 12;

            for (var i = start; i <= end; i++) {
                var i_in_24 = i;
                if (!this.timePicker24Hour)
                    i_in_24 = selected.hour() >= 12 ? (i == 12 ? 12 : i + 12) : (i == 12 ? 0 : i);

                var time = selected.clone().hour(i_in_24);
                var disabled = false;
                if (minDate && time.minute(59).isBefore(minDate))
                    disabled = true;
                if (maxDate && time.minute(0).isAfter(maxDate))
                    disabled = true;

                if (i_in_24 == selected.hour() && !disabled) {
                    html += '<option value="' + i + '" selected="selected">' + i + '</option>';
                } else if (disabled) {
                    html += '<option value="' + i + '" disabled="disabled" class="disabled">' + i + '</option>';
                } else {
                    html += '<option value="' + i + '">' + i + '</option>';
                }
            }

            html += '</select> ';

            //
            // minutes
            //

            html += ': <select class="minuteselect">';

            for (var i = 0; i < 60; i += this.timePickerIncrement) {
                var padded = i < 10 ? '0' + i : i;
                var time = selected.clone().minute(i);

                var disabled = false;
                if (minDate && time.second(59).isBefore(minDate))
                    disabled = true;
                if (maxDate && time.second(0).isAfter(maxDate))
                    disabled = true;

                if (selected.minute() == i && !disabled) {
                    html += '<option value="' + i + '" selected="selected">' + padded + '</option>';
                } else if (disabled) {
                    html += '<option value="' + i + '" disabled="disabled" class="disabled">' + padded + '</option>';
                } else {
                    html += '<option value="' + i + '">' + padded + '</option>';
                }
            }

            html += '</select> ';

            //
            // seconds
            //

            if (this.timePickerSeconds) {
                html += ': <select class="secondselect">';

                for (var i = 0; i < 60; i++) {
                    var padded = i < 10 ? '0' + i : i;
                    var time = selected.clone().second(i);

                    var disabled = false;
                    if (minDate && time.isBefore(minDate))
                        disabled = true;
                    if (maxDate && time.isAfter(maxDate))
                        disabled = true;

                    if (selected.second() == i && !disabled) {
                        html += '<option value="' + i + '" selected="selected">' + padded + '</option>';
                    } else if (disabled) {
                        html += '<option value="' + i + '" disabled="disabled" class="disabled">' + padded + '</option>';
                    } else {
                        html += '<option value="' + i + '">' + padded + '</option>';
                    }
                }

                html += '</select> ';
            }

            //
            // AM/PM
            //

            if (!this.timePicker24Hour) {
                html += '<select class="ampmselect">';

                var am_html = '';
                var pm_html = '';

                if (minDate && selected.clone().hour(12).minute(0).second(0).isBefore(minDate))
                    am_html = ' disabled="disabled" class="disabled"';

                if (maxDate && selected.clone().hour(0).minute(0).second(0).isAfter(maxDate))
                    pm_html = ' disabled="disabled" class="disabled"';

                if (selected.hour() >= 12) {
                    html += '<option value="AM"' + am_html + '>AM</option><option value="PM" selected="selected"' + pm_html + '>PM</option>';
                } else {
                    html += '<option value="AM" selected="selected"' + am_html + '>AM</option><option value="PM"' + pm_html + '>PM</option>';
                }

                html += '</select>';
            }

            this.container.find('.calendar.' + side + ' .calendar-time div').html(html);

        },

        updateFormInputs: function() {

            //ignore mouse movements while an above-calendar text input has focus
            if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
                return;

            this.container.find('input[name=daterangepicker_start]').val(this.startDate.format(this.locale.format));
            if (this.endDate)
                this.container.find('input[name=daterangepicker_end]').val(this.endDate.format(this.locale.format));

            if (this.singleDatePicker || (this.endDate && (this.startDate.isBefore(this.endDate) || this.startDate.isSame(this.endDate)))) {
                this.container.find('button.applyBtn').removeAttr('disabled');
            } else {
                this.container.find('button.applyBtn').attr('disabled', 'disabled');
            }

        },

        move: function() {
            var parentOffset = { top: 0, left: 0 },
                containerTop;
            var parentRightEdge = $(window).width();
            if (!this.parentEl.is('body')) {
                parentOffset = {
                    top: this.parentEl.offset().top - this.parentEl.scrollTop(),
                    left: this.parentEl.offset().left - this.parentEl.scrollLeft()
                };
                parentRightEdge = this.parentEl[0].clientWidth + this.parentEl.offset().left;
            }

            if (this.drops == 'up')
                containerTop = this.element.offset().top - this.container.outerHeight() - parentOffset.top;
            else
                containerTop = this.element.offset().top + this.element.outerHeight() - parentOffset.top;
            this.container[this.drops == 'up' ? 'addClass' : 'removeClass']('dropup');

            if (this.opens == 'left') {
                this.container.css({
                    top: containerTop,
                    right: parentRightEdge - this.element.offset().left - this.element.outerWidth(),
                    left: 'auto'
                });
                if (this.container.offset().left < 0) {
                    this.container.css({
                        right: 'auto',
                        left: 9
                    });
                }
            } else if (this.opens == 'center') {
                this.container.css({
                    top: containerTop,
                    left: this.element.offset().left - parentOffset.left + this.element.outerWidth() / 2
                            - this.container.outerWidth() / 2,
                    right: 'auto'
                });
                if (this.container.offset().left < 0) {
                    this.container.css({
                        right: 'auto',
                        left: 9
                    });
                }
            } else {
                this.container.css({
                    top: containerTop,
                    left: this.element.offset().left - parentOffset.left,
                    right: 'auto'
                });
                if (this.container.offset().left + this.container.outerWidth() > $(window).width()) {
                    this.container.css({
                        left: 'auto',
                        right: 0
                    });
                }
            }
        },

        show: function(e) {
            if (this.isShowing) return;

            // Create a click proxy that is private to this instance of datepicker, for unbinding
            this._outsideClickProxy = $.proxy(function(e) { this.outsideClick(e); }, this);

            // Bind global datepicker mousedown for hiding and
            $(document)
              .on('mousedown.daterangepicker', this._outsideClickProxy)
              // also support mobile devices
              .on('touchend.daterangepicker', this._outsideClickProxy)
              // also explicitly play nice with Bootstrap dropdowns, which stopPropagation when clicking them
              .on('click.daterangepicker', '[data-toggle=dropdown]', this._outsideClickProxy)
              // and also close when focus changes to outside the picker (eg. tabbing between controls)
              .on('focusin.daterangepicker', this._outsideClickProxy);

            // Reposition the picker if the window is resized while it's open
            $(window).on('resize.daterangepicker', $.proxy(function(e) { this.move(e); }, this));

            this.oldStartDate = this.startDate.clone();
            this.oldEndDate = this.endDate.clone();
            this.previousRightTime = this.endDate.clone();

            this.updateView();
            this.container.show();
            this.move();
            this.element.trigger('show.daterangepicker', this);
            this.isShowing = true;
        },

        hide: function(e) {
            if (!this.isShowing) return;

            //incomplete date selection, revert to last values
            if (!this.endDate) {
                this.startDate = this.oldStartDate.clone();
                this.endDate = this.oldEndDate.clone();
            }

            //if a new date range was selected, invoke the user callback function
            if (!this.startDate.isSame(this.oldStartDate) || !this.endDate.isSame(this.oldEndDate))
                this.callback(this.startDate, this.endDate, this.chosenLabel);

            //if picker is attached to a text input, update it
            this.updateElement();

            $(document).off('.daterangepicker');
            $(window).off('.daterangepicker');
            this.container.hide();
            this.element.trigger('hide.daterangepicker', this);
            this.isShowing = false;
        },

        toggle: function(e) {
            if (this.isShowing) {
                this.hide();
            } else {
                this.show();
            }
        },

        outsideClick: function(e) {
            var target = $(e.target);
            // if the page is clicked anywhere except within the daterangerpicker/button
            // itself then call this.hide()
            if (
                // ie modal dialog fix
                e.type == "focusin" ||
                target.closest(this.element).length ||
                target.closest(this.container).length ||
                target.closest('.calendar-table').length
                ) return;
            this.hide();
            this.element.trigger('outsideClick.daterangepicker', this);
        },

        showCalendars: function() {
            this.container.addClass('show-calendar');
            this.move();
            this.element.trigger('showCalendar.daterangepicker', this);
        },

        hideCalendars: function() {
            this.container.removeClass('show-calendar');
            this.element.trigger('hideCalendar.daterangepicker', this);
        },

        hoverRange: function(e) {

            //ignore mouse movements while an above-calendar text input has focus
            if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
                return;

            var label = e.target.getAttribute('data-range-key');

            if (label == this.locale.customRangeLabel) {
                this.updateView();
            } else {
                var dates = this.ranges[label];
                this.container.find('input[name=daterangepicker_start]').val(dates[0].format(this.locale.format));
                this.container.find('input[name=daterangepicker_end]').val(dates[1].format(this.locale.format));
            }

        },

        clickRange: function(e) {
            var label = e.target.getAttribute('data-range-key');
            this.chosenLabel = label;
            if (label == this.locale.customRangeLabel) {
                this.showCalendars();
            } else {
                var dates = this.ranges[label];
                this.startDate = dates[0];
                this.endDate = dates[1];

                if (!this.timePicker) {
                    this.startDate.startOf('day');
                    this.endDate.endOf('day');
                }

                if (!this.alwaysShowCalendars)
                    this.hideCalendars();
                this.clickApply();
            }
        },

        clickPrev: function(e) {
            var cal = $(e.target).parents('.calendar');
            if (cal.hasClass('left')) {
                this.leftCalendar.month.subtract(1, 'month');
                if (this.linkedCalendars)
                    this.rightCalendar.month.subtract(1, 'month');
            } else {
                this.rightCalendar.month.subtract(1, 'month');
            }
            this.updateCalendars();
        },

        clickNext: function(e) {
            var cal = $(e.target).parents('.calendar');
            if (cal.hasClass('left')) {
                this.leftCalendar.month.add(1, 'month');
            } else {
                this.rightCalendar.month.add(1, 'month');
                if (this.linkedCalendars)
                    this.leftCalendar.month.add(1, 'month');
            }
            this.updateCalendars();
        },

        hoverDate: function(e) {

            //ignore mouse movements while an above-calendar text input has focus
            //if (this.container.find('input[name=daterangepicker_start]').is(":focus") || this.container.find('input[name=daterangepicker_end]').is(":focus"))
            //    return;

            //ignore dates that can't be selected
            if (!$(e.target).hasClass('available')) return;

            //have the text inputs above calendars reflect the date being hovered over
            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');
            var date = cal.hasClass('left') ? this.leftCalendar.calendar[row][col] : this.rightCalendar.calendar[row][col];

            if (this.endDate && !this.container.find('input[name=daterangepicker_start]').is(":focus")) {
                this.container.find('input[name=daterangepicker_start]').val(date.format(this.locale.format));
            } else if (!this.endDate && !this.container.find('input[name=daterangepicker_end]').is(":focus")) {
                this.container.find('input[name=daterangepicker_end]').val(date.format(this.locale.format));
            }

            //highlight the dates between the start date and the date being hovered as a potential end date
            var leftCalendar = this.leftCalendar;
            var rightCalendar = this.rightCalendar;
            var startDate = this.startDate;
            if (!this.endDate) {
                this.container.find('.calendar tbody td').each(function(index, el) {

                    //skip week numbers, only look at dates
                    if ($(el).hasClass('week')) return;

                    var title = $(el).attr('data-title');
                    var row = title.substr(1, 1);
                    var col = title.substr(3, 1);
                    var cal = $(el).parents('.calendar');
                    var dt = cal.hasClass('left') ? leftCalendar.calendar[row][col] : rightCalendar.calendar[row][col];

                    if ((dt.isAfter(startDate) && dt.isBefore(date)) || dt.isSame(date, 'day')) {
                        $(el).addClass('in-range');
                    } else {
                        $(el).removeClass('in-range');
                    }

                });
            }

        },

        clickDate: function(e) {

            if (!$(e.target).hasClass('available')) return;

            var title = $(e.target).attr('data-title');
            var row = title.substr(1, 1);
            var col = title.substr(3, 1);
            var cal = $(e.target).parents('.calendar');
            var date = cal.hasClass('left') ? this.leftCalendar.calendar[row][col] : this.rightCalendar.calendar[row][col];

            //
            // this function needs to do a few things:
            // * alternate between selecting a start and end date for the range,
            // * if the time picker is enabled, apply the hour/minute/second from the select boxes to the clicked date
            // * if autoapply is enabled, and an end date was chosen, apply the selection
            // * if single date picker mode, and time picker isn't enabled, apply the selection immediately
            // * if one of the inputs above the calendars was focused, cancel that manual input
            //

            if (this.endDate || date.isBefore(this.startDate, 'day')) { //picking start
                if (this.timePicker) {
                    var hour = parseInt(this.container.find('.left .hourselect').val(), 10);
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.left .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                    var minute = parseInt(this.container.find('.left .minuteselect').val(), 10);
                    var second = this.timePickerSeconds ? parseInt(this.container.find('.left .secondselect').val(), 10) : 0;
                    date = date.clone().hour(hour).minute(minute).second(second);
                }
                this.endDate = null;
                this.setStartDate(date.clone());
            } else if (!this.endDate && date.isBefore(this.startDate)) {
                //special case: clicking the same date for start/end,
                //but the time of the end date is before the start date
                this.setEndDate(this.startDate.clone());
            } else { // picking end
                if (this.timePicker) {
                    var hour = parseInt(this.container.find('.right .hourselect').val(), 10);
                    if (!this.timePicker24Hour) {
                        var ampm = this.container.find('.right .ampmselect').val();
                        if (ampm === 'PM' && hour < 12)
                            hour += 12;
                        if (ampm === 'AM' && hour === 12)
                            hour = 0;
                    }
                    var minute = parseInt(this.container.find('.right .minuteselect').val(), 10);
                    var second = this.timePickerSeconds ? parseInt(this.container.find('.right .secondselect').val(), 10) : 0;
                    date = date.clone().hour(hour).minute(minute).second(second);
                }
                this.setEndDate(date.clone());
                if (this.autoApply) {
                  this.calculateChosenLabel();
                  this.clickApply();
                }
            }

            if (this.singleDatePicker) {
                this.setEndDate(this.startDate);
                if (!this.timePicker)
                    this.clickApply();
            }

            this.updateView();

            //This is to cancel the blur event handler if the mouse was in one of the inputs
            e.stopPropagation();

        },

        calculateChosenLabel: function () {
            var customRange = true;
            var i = 0;
            for (var range in this.ranges) {
                if (this.timePicker) {
                    if (this.startDate.isSame(this.ranges[range][0]) && this.endDate.isSame(this.ranges[range][1])) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')').addClass('active').html();
                        break;
                    }
                } else {
                    //ignore times when comparing dates if time picker is not enabled
                    if (this.startDate.format('YYYY-MM-DD') == this.ranges[range][0].format('YYYY-MM-DD') && this.endDate.format('YYYY-MM-DD') == this.ranges[range][1].format('YYYY-MM-DD')) {
                        customRange = false;
                        this.chosenLabel = this.container.find('.ranges li:eq(' + i + ')').addClass('active').html();
                        break;
                    }
                }
                i++;
            }
            if (customRange) {
                if (this.showCustomRangeLabel) {
                    this.chosenLabel = this.container.find('.ranges li:last').addClass('active').html();
                } else {
                    this.chosenLabel = null;
                }
                this.showCalendars();
            }
        },

        clickApply: function(e) {
            this.hide();
            this.element.trigger('apply.daterangepicker', this);
        },

        clickCancel: function(e) {
            this.startDate = this.oldStartDate;
            this.endDate = this.oldEndDate;
            this.hide();
            this.element.trigger('cancel.daterangepicker', this);
        },

        monthOrYearChanged: function(e) {
            var isLeft = $(e.target).closest('.calendar').hasClass('left'),
                leftOrRight = isLeft ? 'left' : 'right',
                cal = this.container.find('.calendar.'+leftOrRight);

            // Month must be Number for new moment versions
            var month = parseInt(cal.find('.monthselect').val(), 10);
            var year = cal.find('.yearselect').val();

            if (!isLeft) {
                if (year < this.startDate.year() || (year == this.startDate.year() && month < this.startDate.month())) {
                    month = this.startDate.month();
                    year = this.startDate.year();
                }
            }

            if (this.minDate) {
                if (year < this.minDate.year() || (year == this.minDate.year() && month < this.minDate.month())) {
                    month = this.minDate.month();
                    year = this.minDate.year();
                }
            }

            if (this.maxDate) {
                if (year > this.maxDate.year() || (year == this.maxDate.year() && month > this.maxDate.month())) {
                    month = this.maxDate.month();
                    year = this.maxDate.year();
                }
            }

            if (isLeft) {
                this.leftCalendar.month.month(month).year(year);
                if (this.linkedCalendars)
                    this.rightCalendar.month = this.leftCalendar.month.clone().add(1, 'month');
            } else {
                this.rightCalendar.month.month(month).year(year);
                if (this.linkedCalendars)
                    this.leftCalendar.month = this.rightCalendar.month.clone().subtract(1, 'month');
            }
            this.updateCalendars();
        },

        timeChanged: function(e) {

            var cal = $(e.target).closest('.calendar'),
                isLeft = cal.hasClass('left');

            var hour = parseInt(cal.find('.hourselect').val(), 10);
            var minute = parseInt(cal.find('.minuteselect').val(), 10);
            var second = this.timePickerSeconds ? parseInt(cal.find('.secondselect').val(), 10) : 0;

            if (!this.timePicker24Hour) {
                var ampm = cal.find('.ampmselect').val();
                if (ampm === 'PM' && hour < 12)
                    hour += 12;
                if (ampm === 'AM' && hour === 12)
                    hour = 0;
            }

            if (isLeft) {
                var start = this.startDate.clone();
                start.hour(hour);
                start.minute(minute);
                start.second(second);
                this.setStartDate(start);
                if (this.singleDatePicker) {
                    this.endDate = this.startDate.clone();
                } else if (this.endDate && this.endDate.format('YYYY-MM-DD') == start.format('YYYY-MM-DD') && this.endDate.isBefore(start)) {
                    this.setEndDate(start.clone());
                }
            } else if (this.endDate) {
                var end = this.endDate.clone();
                end.hour(hour);
                end.minute(minute);
                end.second(second);
                this.setEndDate(end);
            }

            //update the calendars so all clickable dates reflect the new time component
            this.updateCalendars();

            //update the form inputs above the calendars with the new time
            this.updateFormInputs();

            //re-render the time pickers because changing one selection can affect what's enabled in another
            this.renderTimePicker('left');
            this.renderTimePicker('right');

        },

        formInputsChanged: function(e) {
            var isRight = $(e.target).closest('.calendar').hasClass('right');
            var start = moment(this.container.find('input[name="daterangepicker_start"]').val(), this.locale.format);
            var end = moment(this.container.find('input[name="daterangepicker_end"]').val(), this.locale.format);

            if (start.isValid() && end.isValid()) {

                if (isRight && end.isBefore(start))
                    start = end.clone();

                this.setStartDate(start);
                this.setEndDate(end);

                if (isRight) {
                    this.container.find('input[name="daterangepicker_start"]').val(this.startDate.format(this.locale.format));
                } else {
                    this.container.find('input[name="daterangepicker_end"]').val(this.endDate.format(this.locale.format));
                }

            }

            this.updateView();
        },

        formInputsFocused: function(e) {

            // Highlight the focused input
            this.container.find('input[name="daterangepicker_start"], input[name="daterangepicker_end"]').removeClass('active');
            $(e.target).addClass('active');

            // Set the state such that if the user goes back to using a mouse, 
            // the calendars are aware we're selecting the end of the range, not
            // the start. This allows someone to edit the end of a date range without
            // re-selecting the beginning, by clicking on the end date input then
            // using the calendar.
            var isRight = $(e.target).closest('.calendar').hasClass('right');
            if (isRight) {
                this.endDate = null;
                this.setStartDate(this.startDate.clone());
                this.updateView();
            }

        },

        formInputsBlurred: function(e) {

            // this function has one purpose right now: if you tab from the first
            // text input to the second in the UI, the endDate is nulled so that
            // you can click another, but if you tab out without clicking anything
            // or changing the input value, the old endDate should be retained

            if (!this.endDate) {
                var val = this.container.find('input[name="daterangepicker_end"]').val();
                var end = moment(val, this.locale.format);
                if (end.isValid()) {
                    this.setEndDate(end);
                    this.updateView();
                }
            }

        },

        elementChanged: function() {
            if (!this.element.is('input')) return;
            if (!this.element.val().length) return;
            if (this.element.val().length < this.locale.format.length) return;

            var dateString = this.element.val().split(this.locale.separator),
                start = null,
                end = null;

            if (dateString.length === 2) {
                start = moment(dateString[0], this.locale.format);
                end = moment(dateString[1], this.locale.format);
            }

            if (this.singleDatePicker || start === null || end === null) {
                start = moment(this.element.val(), this.locale.format);
                end = start;
            }

            if (!start.isValid() || !end.isValid()) return;

            this.setStartDate(start);
            this.setEndDate(end);
            this.updateView();
        },

        keydown: function(e) {
            //hide on tab or enter
            if ((e.keyCode === 9) || (e.keyCode === 13)) {
                this.hide();
            }
        },

        updateElement: function() {
            if (this.element.is('input') && !this.singleDatePicker && this.autoUpdateInput) {
                this.element.val(this.startDate.format(this.locale.format) + this.locale.separator + this.endDate.format(this.locale.format));
                this.element.trigger('change');
            } else if (this.element.is('input') && this.autoUpdateInput) {
                this.element.val(this.startDate.format(this.locale.format));
                this.element.trigger('change');
            }
        },

        remove: function() {
            this.container.remove();
            this.element.off('.daterangepicker');
            this.element.removeData();
        }

    };

    $.fn.daterangepicker = function(options, callback) {
        this.each(function() {
            var el = $(this);
            if (el.data('daterangepicker'))
                el.data('daterangepicker').remove();
            el.data('daterangepicker', new DateRangePicker(el, options, callback));
        });
        return this;
    };

    return DateRangePicker;

}));

/*! selectize.js - v0.12.4 | https://github.com/selectize/selectize.js | Apache License (v2) */
!function(a,b){"function"==typeof define&&define.amd?define("sifter",b):"object"==typeof exports?module.exports=b():a.Sifter=b()}(this,function(){var a=function(a,b){this.items=a,this.settings=b||{diacritics:!0}};a.prototype.tokenize=function(a){if(a=e(String(a||"").toLowerCase()),!a||!a.length)return[];var b,c,d,g,i=[],j=a.split(/ +/);for(b=0,c=j.length;b<c;b++){if(d=f(j[b]),this.settings.diacritics)for(g in h)h.hasOwnProperty(g)&&(d=d.replace(new RegExp(g,"g"),h[g]));i.push({string:j[b],regex:new RegExp(d,"i")})}return i},a.prototype.iterator=function(a,b){var c;c=g(a)?Array.prototype.forEach||function(a){for(var b=0,c=this.length;b<c;b++)a(this[b],b,this)}:function(a){for(var b in this)this.hasOwnProperty(b)&&a(this[b],b,this)},c.apply(a,[b])},a.prototype.getScoreFunction=function(a,b){var c,e,f,g,h;c=this,a=c.prepareSearch(a,b),f=a.tokens,e=a.options.fields,g=f.length,h=a.options.nesting;var i=function(a,b){var c,d;return a?(a=String(a||""),d=a.search(b.regex),d===-1?0:(c=b.string.length/a.length,0===d&&(c+=.5),c)):0},j=function(){var a=e.length;return a?1===a?function(a,b){return i(d(b,e[0],h),a)}:function(b,c){for(var f=0,g=0;f<a;f++)g+=i(d(c,e[f],h),b);return g/a}:function(){return 0}}();return g?1===g?function(a){return j(f[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,d=0;c<g;c++){if(b=j(f[c],a),b<=0)return 0;d+=b}return d/g}:function(a){for(var b=0,c=0;b<g;b++)c+=j(f[b],a);return c/g}:function(){return 0}},a.prototype.getSortFunction=function(a,c){var e,f,g,h,i,j,k,l,m,n,o;if(g=this,a=g.prepareSearch(a,c),o=!a.query&&c.sort_empty||c.sort,m=function(a,b){return"$score"===a?b.score:d(g.items[b.id],a,c.nesting)},i=[],o)for(e=0,f=o.length;e<f;e++)(a.query||"$score"!==o[e].field)&&i.push(o[e]);if(a.query){for(n=!0,e=0,f=i.length;e<f;e++)if("$score"===i[e].field){n=!1;break}n&&i.unshift({field:"$score",direction:"desc"})}else for(e=0,f=i.length;e<f;e++)if("$score"===i[e].field){i.splice(e,1);break}for(l=[],e=0,f=i.length;e<f;e++)l.push("desc"===i[e].direction?-1:1);return j=i.length,j?1===j?(h=i[0].field,k=l[0],function(a,c){return k*b(m(h,a),m(h,c))}):function(a,c){var d,e,f;for(d=0;d<j;d++)if(f=i[d].field,e=l[d]*b(m(f,a),m(f,c)))return e;return 0}:null},a.prototype.prepareSearch=function(a,b){if("object"==typeof a)return a;b=c({},b);var d=b.fields,e=b.sort,f=b.sort_empty;return d&&!g(d)&&(b.fields=[d]),e&&!g(e)&&(b.sort=[e]),f&&!g(f)&&(b.sort_empty=[f]),{options:b,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}},a.prototype.search=function(a,b){var c,d,e,f,g=this;return d=this.prepareSearch(a,b),b=d.options,a=d.query,f=b.score||g.getScoreFunction(d),a.length?g.iterator(g.items,function(a,e){c=f(a),(b.filter===!1||c>0)&&d.items.push({score:c,id:e})}):g.iterator(g.items,function(a,b){d.items.push({score:1,id:b})}),e=g.getSortFunction(d,b),e&&d.items.sort(e),d.total=d.items.length,"number"==typeof b.limit&&(d.items=d.items.slice(0,b.limit)),d};var b=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:a<b?-1:0:(a=i(String(a||"")),b=i(String(b||"")),a>b?1:b>a?-1:0)},c=function(a,b){var c,d,e,f;for(c=1,d=arguments.length;c<d;c++)if(f=arguments[c])for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e]);return a},d=function(a,b,c){if(a&&b){if(!c)return a[b];for(var d=b.split(".");d.length&&(a=a[d.shift()]););return a}},e=function(a){return(a+"").replace(/^\s+|\s+$|/g,"")},f=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},g=Array.isArray||"undefined"!=typeof $&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},h={a:"[a]",b:"[bB]",c:"[cCc]",d:"[dDd]",e:"[e]",f:"[f]",g:"[g]",h:"[h]",i:"[iiI]",j:"[j]",k:"[k]",l:"[l]",n:"[nNn]",o:"[o]",p:"[p]",q:"[qq]",r:"[r]",s:"[sSs]",t:"[t]",u:"[u]",v:"[v]",w:"[w]",x:"[x]",y:"[y]",z:"[z]"},i=function(){var a,b,c,d,e="",f={};for(c in h)if(h.hasOwnProperty(c))for(d=h[c].substring(2,h[c].length-1),e+=d,a=0,b=d.length;a<b;a++)f[d.charAt(a)]=c;var g=new RegExp("["+e+"]","g");return function(a){return a.replace(g,function(a){return f[a]}).toLowerCase()}}();return a}),function(a,b){"function"==typeof define&&define.amd?define("microplugin",b):"object"==typeof exports?module.exports=b():a.MicroPlugin=b()}(this,function(){var a={};a.mixin=function(a){a.plugins={},a.prototype.initializePlugins=function(a){var c,d,e,f=this,g=[];if(f.plugins={names:[],settings:{},requested:{},loaded:{}},b.isArray(a))for(c=0,d=a.length;c<d;c++)"string"==typeof a[c]?g.push(a[c]):(f.plugins.settings[a[c].name]=a[c].options,g.push(a[c].name));else if(a)for(e in a)a.hasOwnProperty(e)&&(f.plugins.settings[e]=a[e],g.push(e));for(;g.length;)f.require(g.shift())},a.prototype.loadPlugin=function(b){var c=this,d=c.plugins,e=a.plugins[b];if(!a.plugins.hasOwnProperty(b))throw new Error('Unable to find "'+b+'" plugin');d.requested[b]=!0,d.loaded[b]=e.fn.apply(c,[c.plugins.settings[b]||{}]),d.names.push(b)},a.prototype.require=function(a){var b=this,c=b.plugins;if(!b.plugins.loaded.hasOwnProperty(a)){if(c.requested[a])throw new Error('Plugin has circular dependency ("'+a+'")');b.loadPlugin(a)}return c.loaded[a]},a.define=function(b,c){a.plugins[b]={name:b,fn:c}}};var b={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return a}),function(a,b){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],b):"object"==typeof exports?module.exports=b(require("jquery"),require("sifter"),require("microplugin")):a.Selectize=b(a.jQuery,a.Sifter,a.MicroPlugin)}(this,function(a,b,c){"use strict";var d=function(a,b){if("string"!=typeof b||b.length){var c="string"==typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(e>=0&&a.data.length>0){var f=a.data.match(c),g=document.createElement("span");g.className="highlight";var h=a.splitText(e),i=(h.splitText(f[0].length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j]);return b};return a.each(function(){d(this)})}};a.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var a=this.parentNode;a.replaceChild(this.firstChild,this),a.normalize()}).end()};var e=function(){};e.prototype={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){var c=arguments.length;return 0===c?delete this._events:1===c?delete this._events[a]:(this._events=this._events||{},void(a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)))},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(a){for(var b=["on","off","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=e.prototype[b[c]]};var f=/Mac/.test(navigator.userAgent),g=65,h=13,i=27,j=37,k=38,l=80,m=39,n=40,o=78,p=8,q=46,r=16,s=f?91:17,t=f?18:17,u=9,v=1,w=2,x=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,y=function(a){return"undefined"!=typeof a},z=function(a){return"undefined"==typeof a||null===a?null:"boolean"==typeof a?a?"1":"0":a+""},A=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},B={};B.before=function(a,b,c){var d=a[b];a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)}},B.after=function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);return c.apply(a,arguments),b}};var C=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},D=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c),c=window.setTimeout(function(){a.apply(d,e)},b)}},E=function(a,b,c){var d,e=a.trigger,f={};a.trigger=function(){var c=arguments[0];return b.indexOf(c)===-1?e.apply(a,arguments):void(f[c]=arguments)},c.apply(a,[]),a.trigger=e;for(d in f)f.hasOwnProperty(d)&&e.apply(a,f[d])},F=function(a,b,c,d){a.on(b,c,function(b){for(var c=b.target;c&&c.parentNode!==a[0];)c=c.parentNode;return b.currentTarget=c,d.apply(this,[b])})},G=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length),b.start=c.text.length-d,b.length=d}return b},H=function(a,b,c){var d,e,f={};if(c)for(d=0,e=c.length;d<e;d++)f[c[d]]=a.css(c[d]);else f=a.css();b.css(f)},I=function(b,c){if(!b)return 0;var d=a("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(b).appendTo("body");H(c,d,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var e=d.width();return d.remove(),e},J=function(a){var b=null,c=function(c,d){var e,f,g,h,i,j,k,l;c=c||window.event||{},d=d||{},c.metaKey||c.altKey||(d.force||a.data("grow")!==!1)&&(e=a.val(),c.type&&"keydown"===c.type.toLowerCase()&&(f=c.keyCode,g=f>=97&&f<=122||f>=65&&f<=90||f>=48&&f<=57||32===f,f===q||f===p?(l=G(a[0]),l.length?e=e.substring(0,l.start)+e.substring(l.start+l.length):f===p&&l.start?e=e.substring(0,l.start-1)+e.substring(l.start+1):f===q&&"undefined"!=typeof l.start&&(e=e.substring(0,l.start)+e.substring(l.start+1))):g&&(j=c.shiftKey,k=String.fromCharCode(c.keyCode),k=j?k.toUpperCase():k.toLowerCase(),e+=k)),h=a.attr("placeholder"),!e&&h&&(e=h),i=I(e,a)+4,i!==b&&(b=i,a.width(i),a.triggerHandler("resize")))};a.on("keydown keyup update blur",c),c()},K=function(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML},L=function(a,b){b||(b={});var c="Selectize";console.error(c+": "+a),b.explanation&&(console.group&&console.group(),console.error(b.explanation),console.group&&console.groupEnd())},M=function(c,d){var e,f,g,h,i=this;h=c[0],h.selectize=i;var j=window.getComputedStyle&&window.getComputedStyle(h,null);if(g=j?j.getPropertyValue("direction"):h.currentStyle&&h.currentStyle.direction,g=g||c.parents("[dir]:first").attr("dir")||"",a.extend(i,{order:0,settings:d,$input:c,tabIndex:c.attr("tabindex")||"",tagType:"select"===h.tagName.toLowerCase()?v:w,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++M.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:c.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===d.loadThrottle?i.onSearchChange:D(i.onSearchChange,d.loadThrottle)}),i.sifter=new b(this.options,{diacritics:d.diacritics}),i.settings.options){for(e=0,f=i.settings.options.length;e<f;e++)i.registerOption(i.settings.options[e]);delete i.settings.options}if(i.settings.optgroups){for(e=0,f=i.settings.optgroups.length;e<f;e++)i.registerOptionGroup(i.settings.optgroups[e]);delete i.settings.optgroups}i.settings.mode=i.settings.mode||(1===i.settings.maxItems?"single":"multi"),"boolean"!=typeof i.settings.hideSelected&&(i.settings.hideSelected="multi"===i.settings.mode),i.initializePlugins(i.settings.plugins),i.setupCallbacks(),i.setupTemplates(),i.setup()};return e.mixin(M),"undefined"!=typeof c?c.mixin(M):L("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),a.extend(M.prototype,{setup:function(){var b,c,d,e,g,h,i,j,k,l,m=this,n=m.settings,o=m.eventNS,p=a(window),q=a(document),u=m.$input;if(i=m.settings.mode,j=u.attr("class")||"",b=a("<div>").addClass(n.wrapperClass).addClass(j).addClass(i),c=a("<div>").addClass(n.inputClass).addClass("items").appendTo(b),d=a('<input type="text" autocomplete="off" />').appendTo(c).attr("tabindex",u.is(":disabled")?"-1":m.tabIndex),h=a(n.dropdownParent||b),e=a("<div>").addClass(n.dropdownClass).addClass(i).hide().appendTo(h),g=a("<div>").addClass(n.dropdownContentClass).appendTo(e),(l=u.attr("id"))&&(d.attr("id",l+"-selectized"),a("label[for='"+l+"']").attr("for",l+"-selectized")),m.settings.copyClassesToDropdown&&e.addClass(j),b.css({width:u[0].style.width}),m.plugins.names.length&&(k="plugin-"+m.plugins.names.join(" plugin-"),b.addClass(k),e.addClass(k)),(null===n.maxItems||n.maxItems>1)&&m.tagType===v&&u.attr("multiple","multiple"),m.settings.placeholder&&d.attr("placeholder",n.placeholder),!m.settings.splitOn&&m.settings.delimiter){var w=m.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");m.settings.splitOn=new RegExp("\\s*"+w+"+\\s*")}u.attr("autocorrect")&&d.attr("autocorrect",u.attr("autocorrect")),u.attr("autocapitalize")&&d.attr("autocapitalize",u.attr("autocapitalize")),m.$wrapper=b,m.$control=c,m.$control_input=d,m.$dropdown=e,m.$dropdown_content=g,e.on("mouseenter","[data-selectable]",function(){return m.onOptionHover.apply(m,arguments)}),e.on("mousedown click","[data-selectable]",function(){return m.onOptionSelect.apply(m,arguments)}),F(c,"mousedown","*:not(input)",function(){return m.onItemSelect.apply(m,arguments)}),J(d),c.on({mousedown:function(){return m.onMouseDown.apply(m,arguments)},click:function(){return m.onClick.apply(m,arguments)}}),d.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return m.onKeyDown.apply(m,arguments)},keyup:function(){return m.onKeyUp.apply(m,arguments)},keypress:function(){return m.onKeyPress.apply(m,arguments)},resize:function(){m.positionDropdown.apply(m,[])},blur:function(){return m.onBlur.apply(m,arguments)},focus:function(){return m.ignoreBlur=!1,m.onFocus.apply(m,arguments)},paste:function(){return m.onPaste.apply(m,arguments)}}),q.on("keydown"+o,function(a){m.isCmdDown=a[f?"metaKey":"ctrlKey"],m.isCtrlDown=a[f?"altKey":"ctrlKey"],m.isShiftDown=a.shiftKey}),q.on("keyup"+o,function(a){a.keyCode===t&&(m.isCtrlDown=!1),a.keyCode===r&&(m.isShiftDown=!1),a.keyCode===s&&(m.isCmdDown=!1)}),q.on("mousedown"+o,function(a){if(m.isFocused){if(a.target===m.$dropdown[0]||a.target.parentNode===m.$dropdown[0])return!1;m.$control.has(a.target).length||a.target===m.$control[0]||m.blur(a.target)}}),p.on(["scroll"+o,"resize"+o].join(" "),function(){m.isOpen&&m.positionDropdown.apply(m,arguments)}),p.on("mousemove"+o,function(){m.ignoreHover=!1}),this.revertSettings={$children:u.children().detach(),tabindex:u.attr("tabindex")},u.attr("tabindex",-1).hide().after(m.$wrapper),a.isArray(n.items)&&(m.setValue(n.items),delete n.items),x&&u.on("invalid"+o,function(a){a.preventDefault(),m.isInvalid=!0,m.refreshState()}),m.updateOriginalInput(),m.refreshItems(),m.refreshState(),m.updatePlaceholder(),m.isSetup=!0,u.is(":disabled")&&m.disable(),m.on("change",this.onChange),u.data("selectize",m),u.addClass("selectized"),m.trigger("initialize"),n.preload===!0&&m.onSearchChange("")},setupTemplates:function(){var b=this,c=b.settings.labelField,d=b.settings.optgroupLabelField,e={optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+b(a[d])+"</div>"},option:function(a,b){return'<div class="option">'+b(a[c])+"</div>"},item:function(a,b){return'<div class="item">'+b(a[c])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}};b.settings.render=a.extend({},e,b.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)c.hasOwnProperty(a)&&(b=this.settings[c[a]],b&&this.on(a,b))},onClick:function(a){var b=this;b.isFocused||(b.focus(),a.preventDefault())},onMouseDown:function(b){var c=this,d=b.isDefaultPrevented();a(b.target);if(c.isFocused){if(b.target!==c.$control_input[0])return"single"===c.settings.mode?c.isOpen?c.close():c.open():d||c.setActiveItem(null),!1}else d||window.setTimeout(function(){c.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(b){var c=this;return c.isFull()||c.isInputHidden||c.isLocked?void b.preventDefault():void(c.settings.splitOn&&setTimeout(function(){var b=c.$control_input.val();if(b.match(c.settings.splitOn))for(var d=a.trim(b).split(c.settings.splitOn),e=0,f=d.length;e<f;e++)c.createItem(d[e])},0))},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);return this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter?(this.createItem(),a.preventDefault(),!1):void 0},onKeyDown:function(a){var b=(a.target===this.$control_input[0],this);if(b.isLocked)return void(a.keyCode!==u&&a.preventDefault());switch(a.keyCode){case g:if(b.isCmdDown)return void b.selectAll();break;case i:return void(b.isOpen&&(a.preventDefault(),a.stopPropagation(),b.close()));case o:if(!a.ctrlKey||a.altKey)break;case n:if(!b.isOpen&&b.hasOptions)b.open();else if(b.$activeOption){b.ignoreHover=!0;var c=b.getAdjacentOption(b.$activeOption,1);c.length&&b.setActiveOption(c,!0,!0)}return void a.preventDefault();case l:if(!a.ctrlKey||a.altKey)break;case k:if(b.$activeOption){b.ignoreHover=!0;var d=b.getAdjacentOption(b.$activeOption,-1);d.length&&b.setActiveOption(d,!0,!0)}return void a.preventDefault();case h:return void(b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),a.preventDefault()));case j:return void b.advanceSelection(-1,a);case m:return void b.advanceSelection(1,a);case u:return b.settings.selectOnTab&&b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),b.isFull()||a.preventDefault()),void(b.settings.create&&b.createItem()&&a.preventDefault());case p:case q:return void b.deleteSelection(a)}return!b.isFull()&&!b.isInputHidden||(f?a.metaKey:a.ctrlKey)?void 0:void a.preventDefault()},onKeyUp:function(a){var b=this;if(b.isLocked)return a&&a.preventDefault();var c=b.$control_input.val()||"";b.lastValue!==c&&(b.lastValue=c,b.onSearchChange(c),b.refreshOptions(),b.trigger("type",c))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&(b.loadedSearches.hasOwnProperty(a)||(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])})))},onFocus:function(a){var b=this,c=b.isFocused;return b.isDisabled?(b.blur(),a&&a.preventDefault(),!1):void(b.ignoreFocus||(b.isFocused=!0,"focus"===b.settings.preload&&b.onSearchChange(""),c||b.trigger("focus"),b.$activeItems.length||(b.showInput(),b.setActiveItem(null),b.refreshOptions(!!b.settings.openOnFocus)),b.refreshState()))},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus)){if(!c.ignoreBlur&&document.activeElement===c.$dropdown_content[0])return c.ignoreBlur=!0,void c.onFocus(a);var d=function(){c.close(),c.setTextboxValue(""),c.setActiveItem(null),c.setActiveOption(null),c.setCaret(c.items.length),c.refreshState(),b&&b.focus&&b.focus(),c.ignoreFocus=!1,c.trigger("blur")};c.ignoreFocus=!0,c.settings.create&&c.settings.createOnBlur?c.createItem(null,!1,d):d()}},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(b){var c,d,e=this;b.preventDefault&&(b.preventDefault(),b.stopPropagation()),d=a(b.currentTarget),d.hasClass("create")?e.createItem(null,function(){e.settings.closeAfterSelect&&e.close()}):(c=d.attr("data-value"),"undefined"!=typeof c&&(e.lastQuery=null,e.setTextboxValue(""),e.addItem(c),e.settings.closeAfterSelect?e.close():!e.settings.hideSelected&&b.type&&/mouse/.test(b.type)&&e.setActiveOption(e.getOption(c))))},onItemSelect:function(a){var b=this;b.isLocked||"multi"===b.settings.mode&&(a.preventDefault(),b.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++,a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0),a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden)),b.loading||c.removeClass(b.settings.loadingClass),b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input,c=b.val()!==a;c&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return this.tagType===v&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){var c=b?[]:["change"];E(this,c,function(){this.clear(b),this.addItems(a,b)})},setActiveItem:function(b,c){var d,e,f,g,h,i,j,k,l=this;if("single"!==l.settings.mode){if(b=a(b),!b.length)return a(l.$activeItems).removeClass("active"),l.$activeItems=[],void(l.isFocused&&l.showInput());if(d=c&&c.type.toLowerCase(),"mousedown"===d&&l.isShiftDown&&l.$activeItems.length){for(k=l.$control.children(".active:last"),g=Array.prototype.indexOf.apply(l.$control[0].childNodes,[k[0]]),h=Array.prototype.indexOf.apply(l.$control[0].childNodes,[b[0]]),g>h&&(j=g,g=h,h=j),e=g;e<=h;e++)i=l.$control[0].childNodes[e],l.$activeItems.indexOf(i)===-1&&(a(i).addClass("active"),l.$activeItems.push(i));c.preventDefault()}else"mousedown"===d&&l.isCtrlDown||"keydown"===d&&this.isShiftDown?b.hasClass("active")?(f=l.$activeItems.indexOf(b[0]),l.$activeItems.splice(f,1),b.removeClass("active")):l.$activeItems.push(b.addClass("active")[0]):(a(l.$activeItems).removeClass("active"),l.$activeItems=[b.addClass("active")[0]]);l.hideInput(),this.isFocused||l.focus()}},setActiveOption:function(b,c,d){var e,f,g,h,i,j=this;j.$activeOption&&j.$activeOption.removeClass("active"),j.$activeOption=null,b=a(b),b.length&&(j.$activeOption=b.addClass("active"),!c&&y(c)||(e=j.$dropdown_content.height(),f=j.$activeOption.outerHeight(!0),c=j.$dropdown_content.scrollTop()||0,g=j.$activeOption.offset().top-j.$dropdown_content.offset().top+c,h=g,i=g-e+f,g+f>e+c?j.$dropdown_content.stop().animate({scrollTop:i},d?j.settings.scrollDuration:0):g<c&&j.$dropdown_content.stop().animate({scrollTop:h},d?j.settings.scrollDuration:0)))},selectAll:function(){var a=this;"single"!==a.settings.mode&&(a.$activeItems=Array.prototype.slice.apply(a.$control.children(":not(input)").addClass("active")),a.$activeItems.length&&(a.hideInput(),a.close()),a.focus())},hideInput:function(){var a=this;a.setTextboxValue(""),a.$control_input.css({opacity:0,position:"absolute",left:a.rtl?1e4:-1e4}),a.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1,a.onFocus()},0))},blur:function(a){this.$control_input[0].blur(),this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;return"string"==typeof b&&(b=[{field:b}]),{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(b){var c,d,e,f=this,g=f.settings,h=this.getSearchOptions();if(g.score&&(e=f.settings.score.apply(this,[b]),"function"!=typeof e))throw new Error('Selectize "score" setting must be a function that returns a function');if(b!==f.lastQuery?(f.lastQuery=b,d=f.sifter.search(b,a.extend(h,{score:e})),f.currentResults=d):d=a.extend(!0,{},f.currentResults),g.hideSelected)for(c=d.items.length-1;c>=0;c--)f.items.indexOf(z(d.items[c].id))!==-1&&d.items.splice(c,1);return d},refreshOptions:function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;"undefined"==typeof b&&(b=!0);var t=this,u=a.trim(t.$control_input.val()),v=t.search(u),w=t.$dropdown_content,x=t.$activeOption&&z(t.$activeOption.attr("data-value"));for(g=v.items.length,"number"==typeof t.settings.maxOptions&&(g=Math.min(g,t.settings.maxOptions)),h={},i=[],c=0;c<g;c++)for(j=t.options[v.items[c].id],k=t.render("option",j),l=j[t.settings.optgroupField]||"",m=a.isArray(l)?l:[l],e=0,f=m&&m.length;e<f;e++)l=m[e],t.optgroups.hasOwnProperty(l)||(l=""),h.hasOwnProperty(l)||(h[l]=document.createDocumentFragment(),i.push(l)),h[l].appendChild(k);for(this.settings.lockOptgroupOrder&&i.sort(function(a,b){var c=t.optgroups[a].$order||0,d=t.optgroups[b].$order||0;return c-d}),n=document.createDocumentFragment(),c=0,g=i.length;c<g;c++)l=i[c],t.optgroups.hasOwnProperty(l)&&h[l].childNodes.length?(o=document.createDocumentFragment(),o.appendChild(t.render("optgroup_header",t.optgroups[l])),o.appendChild(h[l]),n.appendChild(t.render("optgroup",a.extend({},t.optgroups[l],{html:K(o),dom:o})))):n.appendChild(h[l]);if(w.html(n),t.settings.highlight&&v.query.length&&v.tokens.length)for(w.removeHighlight(),c=0,g=v.tokens.length;c<g;c++)d(w,v.tokens[c].regex);if(!t.settings.hideSelected)for(c=0,g=t.items.length;c<g;c++)t.getOption(t.items[c]).addClass("selected");p=t.canCreate(u),p&&(w.prepend(t.render("option_create",{input:u})),s=a(w[0].childNodes[0])),t.hasOptions=v.items.length>0||p,t.hasOptions?(v.items.length>0?(r=x&&t.getOption(x),r&&r.length?q=r:"single"===t.settings.mode&&t.items.length&&(q=t.getOption(t.items[0])),q&&q.length||(q=s&&!t.settings.addPrecedence?t.getAdjacentOption(s,1):w.find("[data-selectable]:first"))):q=s,t.setActiveOption(q),b&&!t.isOpen&&t.open()):(t.setActiveOption(null),b&&t.isOpen&&t.close())},addOption:function(b){var c,d,e,f=this;if(a.isArray(b))for(c=0,d=b.length;c<d;c++)f.addOption(b[c]);else(e=f.registerOption(b))&&(f.userOptions[e]=!0,f.lastQuery=null,f.trigger("option_add",e,b))},registerOption:function(a){var b=z(a[this.settings.valueField]);return"undefined"!=typeof b&&null!==b&&!this.options.hasOwnProperty(b)&&(a.$order=a.$order||++this.order,this.options[b]=a,b)},registerOptionGroup:function(a){var b=z(a[this.settings.optgroupValueField]);return!!b&&(a.$order=a.$order||++this.order,this.optgroups[b]=a,b)},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a,(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(b,c){var d,e,f,g,h,i,j,k=this;if(b=z(b),f=z(c[k.settings.valueField]),null!==b&&k.options.hasOwnProperty(b)){if("string"!=typeof f)throw new Error("Value must be set in option data");j=k.options[b].$order,f!==b&&(delete k.options[b],g=k.items.indexOf(b),g!==-1&&k.items.splice(g,1,f)),c.$order=c.$order||j,k.options[f]=c,h=k.renderCache.item,i=k.renderCache.option,h&&(delete h[b],delete h[f]),i&&(delete i[b],delete i[f]),k.items.indexOf(f)!==-1&&(d=k.getItem(b),e=a(k.render("item",c)),d.hasClass("active")&&e.addClass("active"),d.replaceWith(e)),k.lastQuery=null,k.isOpen&&k.refreshOptions(!1)}},removeOption:function(a,b){var c=this;a=z(a);var d=c.renderCache.item,e=c.renderCache.option;d&&delete d[a],e&&delete e[a],delete c.userOptions[a],delete c.options[a],c.lastQuery=null,c.trigger("option_remove",a),c.removeItem(a,b)},clearOptions:function(){var a=this;a.loadedSearches={},a.userOptions={},a.renderCache={},a.options=a.sifter.items={},a.lastQuery=null,a.trigger("option_clear"),a.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(b,c){var d=this.$dropdown.find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},getElementWithValue:function(b,c){if(b=z(b),"undefined"!=typeof b&&null!==b)for(var d=0,e=c.length;d<e;d++)if(c[d].getAttribute("data-value")===b)return a(c[d]);return a()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(b,c){for(var d=a.isArray(b)?b:[b],e=0,f=d.length;e<f;e++)this.isPending=e<f-1,this.addItem(d[e],c)},addItem:function(b,c){var d=c?[]:["change"];E(this,d,function(){var d,e,f,g,h,i=this,j=i.settings.mode;return b=z(b),i.items.indexOf(b)!==-1?void("single"===j&&i.close()):void(i.options.hasOwnProperty(b)&&("single"===j&&i.clear(c),"multi"===j&&i.isFull()||(d=a(i.render("item",i.options[b])),h=i.isFull(),i.items.splice(i.caretPos,0,b),i.insertAtCaret(d),(!i.isPending||!h&&i.isFull())&&i.refreshState(),i.isSetup&&(f=i.$dropdown_content.find("[data-selectable]"),i.isPending||(e=i.getOption(b),g=i.getAdjacentOption(e,1).attr("data-value"),i.refreshOptions(i.isFocused&&"single"!==j),g&&i.setActiveOption(i.getOption(g))),!f.length||i.isFull()?i.close():i.positionDropdown(),i.updatePlaceholder(),i.trigger("item_add",b,d),i.updateOriginalInput({silent:c})))))})},removeItem:function(b,c){var d,e,f,g=this;d=b instanceof a?b:g.getItem(b),b=z(d.attr("data-value")),e=g.items.indexOf(b),e!==-1&&(d.remove(),d.hasClass("active")&&(f=g.$activeItems.indexOf(d[0]),g.$activeItems.splice(f,1)),g.items.splice(e,1),g.lastQuery=null,!g.settings.persist&&g.userOptions.hasOwnProperty(b)&&g.removeOption(b,c),e<g.caretPos&&g.setCaret(g.caretPos-1),g.refreshState(),g.updatePlaceholder(),g.updateOriginalInput({silent:c}),g.positionDropdown(),g.trigger("item_remove",b,d))},createItem:function(b,c){var d=this,e=d.caretPos;b=b||a.trim(d.$control_input.val()||"");var f=arguments[arguments.length-1];if("function"!=typeof f&&(f=function(){}),"boolean"!=typeof c&&(c=!0),!d.canCreate(b))return f(),!1;d.lock();var g="function"==typeof d.settings.create?this.settings.create:function(a){var b={};return b[d.settings.labelField]=a,b[d.settings.valueField]=a,b},h=C(function(a){if(d.unlock(),!a||"object"!=typeof a)return f();var b=z(a[d.settings.valueField]);return"string"!=typeof b?f():(d.setTextboxValue(""),d.addOption(a),d.setCaret(e),d.addItem(b),d.refreshOptions(c&&"single"!==d.settings.mode),void f(a))}),i=g.apply(this,[b,h]);return"undefined"!=typeof i&&h(i),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var a=!this.items.length;this.isInvalid=a,this.$control_input.prop("required",a),this.$input.prop("required",!a)},refreshClasses:function(){var b=this,c=b.isFull(),d=b.isLocked;b.$wrapper.toggleClass("rtl",b.rtl),b.$control.toggleClass("focus",b.isFocused).toggleClass("disabled",b.isDisabled).toggleClass("required",b.isRequired).toggleClass("invalid",b.isInvalid).toggleClass("locked",d).toggleClass("full",c).toggleClass("not-full",!c).toggleClass("input-active",b.isFocused&&!b.isInputHidden).toggleClass("dropdown-active",b.isOpen).toggleClass("has-options",!a.isEmptyObject(b.options)).toggleClass("has-items",b.items.length>0),b.$control_input.data("grow",!c&&!d)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e,f=this;if(a=a||{},f.tagType===v){for(d=[],b=0,c=f.items.length;b<c;b++)e=f.options[f.items[b]][f.settings.labelField]||"",d.push('<option value="'+A(f.items[b])+'" selected="selected">'+A(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>'),
f.$input.html(d.join(""))}else f.$input.val(f.getValue()),f.$input.attr("value",f.$input.val());f.isSetup&&(a.silent||f.trigger("change",f.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder),a.triggerHandler("update",{force:!0})}},open:function(){var a=this;a.isLocked||a.isOpen||"multi"===a.settings.mode&&a.isFull()||(a.focus(),a.isOpen=!0,a.refreshState(),a.$dropdown.css({visibility:"hidden",display:"block"}),a.positionDropdown(),a.$dropdown.css({visibility:"visible"}),a.trigger("dropdown_open",a.$dropdown))},close:function(){var a=this,b=a.isOpen;"single"===a.settings.mode&&a.items.length&&(a.hideInput(),a.$control_input.blur()),a.isOpen=!1,a.$dropdown.hide(),a.setActiveOption(null),a.refreshState(),b&&a.trigger("dropdown_close",a.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0),this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){var b=this;b.items.length&&(b.$control.children(":not(input)").remove(),b.items=[],b.lastQuery=null,b.setCaret(0),b.setActiveItem(null),b.updatePlaceholder(),b.updateOriginalInput({silent:a}),b.refreshState(),b.showInput(),b.trigger("clear"))},insertAtCaret:function(b){var c=Math.min(this.caretPos,this.items.length);0===c?this.$control.prepend(b):a(this.$control[0].childNodes[c]).before(b),this.setCaret(c+1)},deleteSelection:function(b){var c,d,e,f,g,h,i,j,k,l=this;if(e=b&&b.keyCode===p?-1:1,f=G(l.$control_input[0]),l.$activeOption&&!l.settings.hideSelected&&(i=l.getAdjacentOption(l.$activeOption,-1).attr("data-value")),g=[],l.$activeItems.length){for(k=l.$control.children(".active:"+(e>0?"last":"first")),h=l.$control.children(":not(input)").index(k),e>0&&h++,c=0,d=l.$activeItems.length;c<d;c++)g.push(a(l.$activeItems[c]).attr("data-value"));b&&(b.preventDefault(),b.stopPropagation())}else(l.isFocused||"single"===l.settings.mode)&&l.items.length&&(e<0&&0===f.start&&0===f.length?g.push(l.items[l.caretPos-1]):e>0&&f.start===l.$control_input.val().length&&g.push(l.items[l.caretPos]));if(!g.length||"function"==typeof l.settings.onDelete&&l.settings.onDelete.apply(l,[g])===!1)return!1;for("undefined"!=typeof h&&l.setCaret(h);g.length;)l.removeItem(g.pop());return l.showInput(),l.positionDropdown(),l.refreshOptions(!0),i&&(j=l.getOption(i),j.length&&l.setActiveOption(j)),!0},advanceSelection:function(a,b){var c,d,e,f,g,h,i=this;0!==a&&(i.rtl&&(a*=-1),c=a>0?"last":"first",d=G(i.$control_input[0]),i.isFocused&&!i.isInputHidden?(f=i.$control_input.val().length,g=a<0?0===d.start&&0===d.length:d.start===f,g&&!f&&i.advanceCaret(a,b)):(h=i.$control.children(".active:"+c),h.length&&(e=i.$control.children(":not(input)").index(h),i.setActiveItem(null),i.setCaret(a>0?e+1:e))))},advanceCaret:function(a,b){var c,d,e=this;0!==a&&(c=a>0?"next":"prev",e.isShiftDown?(d=e.$control_input[c](),d.length&&(e.hideInput(),e.setActiveItem(d),b&&b.preventDefault())):e.setCaret(e.caretPos+a))},setCaret:function(b){var c=this;if(b="single"===c.settings.mode?c.items.length:Math.max(0,Math.min(c.items.length,b)),!c.isPending){var d,e,f,g;for(f=c.$control.children(":not(input)"),d=0,e=f.length;d<e;d++)g=a(f[d]).detach(),d<b?c.$control_input.before(g):c.$control.append(g)}c.caretPos=b},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var a=this;a.$input.prop("disabled",!0),a.$control_input.prop("disabled",!0).prop("tabindex",-1),a.isDisabled=!0,a.lock()},enable:function(){var a=this;a.$input.prop("disabled",!1),a.$control_input.prop("disabled",!1).prop("tabindex",a.tabIndex),a.isDisabled=!1,a.unlock()},destroy:function(){var b=this,c=b.eventNS,d=b.revertSettings;b.trigger("destroy"),b.off(),b.$wrapper.remove(),b.$dropdown.remove(),b.$input.html("").append(d.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:d.tabindex}).show(),b.$control_input.removeData("grow"),b.$input.removeData("selectize"),a(window).off(c),a(document).off(c),a(document.body).off(c),delete b.$input[0].selectize},render:function(b,c){var d,e,f="",g=!1,h=this;return"option"!==b&&"item"!==b||(d=z(c[h.settings.valueField]),g=!!d),g&&(y(h.renderCache[b])||(h.renderCache[b]={}),h.renderCache[b].hasOwnProperty(d))?h.renderCache[b][d]:(f=a(h.settings.render[b].apply(this,[c,A])),"option"===b||"option_create"===b?f.attr("data-selectable",""):"optgroup"===b&&(e=c[h.settings.optgroupValueField]||"",f.attr("data-group",e)),"option"!==b&&"item"!==b||f.attr("data-value",d||""),g&&(h.renderCache[b][d]=f[0]),f[0])},clearCache:function(a){var b=this;"undefined"==typeof a?b.renderCache={}:delete b.renderCache[a]},canCreate:function(a){var b=this;if(!b.settings.create)return!1;var c=b.settings.createFilter;return a.length&&("function"!=typeof c||c.apply(b,[a]))&&("string"!=typeof c||new RegExp(c).test(a))&&(!(c instanceof RegExp)||c.test(a))}}),M.count=0,M.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},a.fn.selectize=function(b){var c=a.fn.selectize.defaults,d=a.extend({},c,b),e=d.dataAttr,f=d.labelField,g=d.valueField,h=d.optgroupField,i=d.optgroupLabelField,j=d.optgroupValueField,k=function(b,c){var h,i,j,k,l=b.attr(e);if(l)for(c.options=JSON.parse(l),h=0,i=c.options.length;h<i;h++)c.items.push(c.options[h][g]);else{var m=a.trim(b.val()||"");if(!d.allowEmptyOption&&!m.length)return;for(j=m.split(d.delimiter),h=0,i=j.length;h<i;h++)k={},k[f]=j[h],k[g]=j[h],c.options.push(k);c.items=j}},l=function(b,c){var k,l,m,n,o=c.options,p={},q=function(a){var b=e&&a.attr(e);return"string"==typeof b&&b.length?JSON.parse(b):null},r=function(b,e){b=a(b);var i=z(b.val());if(i||d.allowEmptyOption)if(p.hasOwnProperty(i)){if(e){var j=p[i][h];j?a.isArray(j)?j.push(e):p[i][h]=[j,e]:p[i][h]=e}}else{var k=q(b)||{};k[f]=k[f]||b.text(),k[g]=k[g]||i,k[h]=k[h]||e,p[i]=k,o.push(k),b.is(":selected")&&c.items.push(i)}},s=function(b){var d,e,f,g,h;for(b=a(b),f=b.attr("label"),f&&(g=q(b)||{},g[i]=f,g[j]=f,c.optgroups.push(g)),h=a("option",b),d=0,e=h.length;d<e;d++)r(h[d],f)};for(c.maxItems=b.attr("multiple")?null:1,n=b.children(),k=0,l=n.length;k<l;k++)m=n[k].tagName.toLowerCase(),"optgroup"===m?s(n[k]):"option"===m&&r(n[k])};return this.each(function(){if(!this.selectize){var e,f=a(this),g=this.tagName.toLowerCase(),h=f.attr("placeholder")||f.attr("data-placeholder");h||d.allowEmptyOption||(h=f.children('option[value=""]').text());var i={placeholder:h,options:[],optgroups:[],items:[]};"select"===g?l(f,i):k(f,i),e=new M(f,a.extend(!0,{},c,i,b))}})},a.fn.selectize.defaults=M.defaults,a.fn.selectize.support={validity:x},M.define("drag_drop",function(b){if(!a.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var c=this;c.lock=function(){var a=c.lock;return function(){var b=c.$control.data("sortable");return b&&b.disable(),a.apply(c,arguments)}}(),c.unlock=function(){var a=c.unlock;return function(){var b=c.$control.data("sortable");return b&&b.enable(),a.apply(c,arguments)}}(),c.setup=function(){var b=c.setup;return function(){b.apply(this,arguments);var d=c.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:c.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width")),d.css({overflow:"visible"})},stop:function(){d.css({overflow:"hidden"});var b=c.$activeItems?c.$activeItems.slice():null,e=[];d.children("[data-value]").each(function(){e.push(a(this).attr("data-value"))}),c.setValue(e),c.setActiveItem(b)}})}}()}}),M.define("dropdown_header",function(b){var c=this;b=a.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},b),c.setup=function(){var d=c.setup;return function(){d.apply(c,arguments),c.$dropdown_header=a(b.html(b)),c.$dropdown.prepend(c.$dropdown_header)}}()}),M.define("optgroup_columns",function(b){var c=this;b=a.extend({equalizeWidth:!0,equalizeHeight:!0},b),this.getAdjacentOption=function(b,c){var d=b.closest("[data-group]").find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},this.onKeyDown=function(){var a=c.onKeyDown;return function(b){var d,e,f,g;return!this.isOpen||b.keyCode!==j&&b.keyCode!==m?a.apply(this,arguments):(c.ignoreHover=!0,g=this.$activeOption.closest("[data-group]"),d=g.find("[data-selectable]").index(this.$activeOption),g=b.keyCode===j?g.prev("[data-group]"):g.next("[data-group]"),f=g.find("[data-selectable]"),e=f.eq(Math.min(f.length-1,d)),void(e.length&&this.setActiveOption(e)))}}();var d=function(){var a,b=d.width,c=document;return"undefined"==typeof b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,c.body.appendChild(a),b=d.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a)),b},e=function(){var e,f,g,h,i,j,k;if(k=a("[data-group]",c.$dropdown_content),f=k.length,f&&c.$dropdown_content.width()){if(b.equalizeHeight){for(g=0,e=0;e<f;e++)g=Math.max(g,k.eq(e).height());k.css({height:g})}b.equalizeWidth&&(j=c.$dropdown_content.innerWidth()-d(),h=Math.round(j/f),k.css({width:h}),f>1&&(i=j-h*(f-1),k.eq(f-1).css({width:i})))}};(b.equalizeHeight||b.equalizeWidth)&&(B.after(this,"positionDropdown",e),B.after(this,"refreshOptions",e))}),M.define("remove_button",function(b){b=a.extend({label:"&times;",title:"Remove",className:"remove",append:!0},b);var c=function(b,c){c.className="remove-single";var d=b,e='<a href="javascript:void(0)" class="'+c.className+'" tabindex="-1" title="'+A(c.title)+'">'+c.label+"</a>",f=function(a,b){return a+b};b.setup=function(){var g=d.setup;return function(){if(c.append){var h=a(d.$input.context).attr("id"),i=(a("#"+h),d.settings.render.item);d.settings.render.item=function(a){return f(i.apply(b,arguments),e)}}g.apply(b,arguments),b.$control.on("click","."+c.className,function(a){a.preventDefault(),d.isLocked||d.clear()})}}()},d=function(b,c){var d=b,e='<a href="javascript:void(0)" class="'+c.className+'" tabindex="-1" title="'+A(c.title)+'">'+c.label+"</a>",f=function(a,b){var c=a.search(/(<\/[^>]+>\s*)$/);return a.substring(0,c)+b+a.substring(c)};b.setup=function(){var g=d.setup;return function(){if(c.append){var h=d.settings.render.item;d.settings.render.item=function(a){return f(h.apply(b,arguments),e)}}g.apply(b,arguments),b.$control.on("click","."+c.className,function(b){if(b.preventDefault(),!d.isLocked){var c=a(b.currentTarget).parent();d.setActiveItem(c),d.deleteSelection()&&d.setCaret(d.items.length)}})}}()};return"single"===this.settings.mode?void c(this,b):void d(this,b)}),M.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]},this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d,e;return b.keyCode===p&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,d>=0&&d<this.items.length)?(e=this.options[this.items[d]],this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[e])),this.refreshOptions(!0)),void b.preventDefault()):c.apply(this,arguments)}}()}),M});
/*
 * debouncedresize: special jQuery event that happens once after a window resize
 *
 * latest version and complete README available on Github:
 * https://github.com/louisremi/jquery-smartresize
 *
 * Copyright 2012 @louis_remi
 * Licensed under the MIT license.
 *
 * This saved you an hour of work? 
 * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
 */
(function($) {

var $event = $.event,
	$special,
	resizeTimeout;

$special = $event.special.debouncedresize = {
	setup: function() {
		$( this ).on( "resize", $special.handler );
	},
	teardown: function() {
		$( this ).off( "resize", $special.handler );
	},
	handler: function( event, execAsap ) {
		// Save the context
		var context = this,
			args = arguments,
			dispatch = function() {
				// set correct event type
				event.type = "debouncedresize";
				$event.dispatch.apply( context, args );
			};

		if ( resizeTimeout ) {
			clearTimeout( resizeTimeout );
		}

		execAsap ?
			dispatch() :
			resizeTimeout = setTimeout( dispatch, $special.threshold );
	},
	threshold: 150
};

})($CQ);
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */

window.matchMedia = window.matchMedia || (function( doc, undefined ) {

  "use strict";

  var bool,
      docElem = doc.documentElement,
      refNode = docElem.firstElementChild || docElem.firstChild,
      // fakeBody required for <FF4 when executed in <head>
      fakeBody = doc.createElement( "body" ),
      div = doc.createElement( "div" );

  div.id = "mq-test-1";
  div.style.cssText = "position:absolute;top:-100em";
  fakeBody.style.background = "none";
  fakeBody.appendChild(div);

  return function(q){

    div.innerHTML = "&shy;<style media=\"" + q + "\"> #mq-test-1 { width: 42px; }</style>";

    docElem.insertBefore( fakeBody, refNode );
    bool = div.offsetWidth === 42;
    docElem.removeChild( fakeBody );

    return {
      matches: bool,
      media: q
    };

  };

}( document ));
/*
 * Adobe Systems Incorporated
 * Modified: October 30th, 2012
 *
 * Picturefill - Responsive Images that work today. (and mimic the proposed Picture element with divs).
 * Author: Scott Jehl, Filament Group, 2012 | License: MIT/GPLv2
 */

(function ($, w) {

    // Enable strict mode
    "use strict";

    w.picturefill = function (context) {
        var undefined;
        if (context === undefined) {
            context = $("body");
        }

        $("div[data-picture]", context).each(function () {
            var currentPicture = this;
            var matches = [];
            $("div[data-media]", currentPicture).each(function () {
                var media = $(this).attr("data-media");
                if (!media || ( w.matchMedia && w.matchMedia(media).matches )) {
                    matches.push(this);
                }
            });

            var $picImg = $("img", currentPicture).first();

            if (matches.length) {
                if ($picImg.size() === 0) {
                    var $currentPicture = $(currentPicture);
                    $picImg = $("<img />").attr("alt", $currentPicture.attr("data-alt")).appendTo($currentPicture);
                }
                $picImg.attr("src", matches.pop().getAttribute("data-src"));
            } else {
                $picImg.remove();
            }
        });
    };

    // Run on debounced resize and domready
    $(function () {
        w.picturefill();
    });

    $(w).on("debouncedresize", function () {
        w.picturefill();
    });

}($CQ, this));
!function(i){"use strict";"function"==typeof define&&define.amd?define(["jquery"],i):"undefined"!=typeof exports?module.exports=i(require("jquery")):i(jQuery)}(function(i){"use strict";var e=window.Slick||{};(e=function(){var e=0;return function(t,o){var s,n=this;n.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:i(t),appendDots:i(t),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return i('<button type="button" />').text(t+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},n.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},i.extend(n,n.initials),n.activeBreakpoint=null,n.animType=null,n.animProp=null,n.breakpoints=[],n.breakpointSettings=[],n.cssTransitions=!1,n.focussed=!1,n.interrupted=!1,n.hidden="hidden",n.paused=!0,n.positionProp=null,n.respondTo=null,n.rowCount=1,n.shouldClick=!0,n.$slider=i(t),n.$slidesCache=null,n.transformType=null,n.transitionType=null,n.visibilityChange="visibilitychange",n.windowWidth=0,n.windowTimer=null,s=i(t).data("slick")||{},n.options=i.extend({},n.defaults,o,s),n.currentSlide=n.options.initialSlide,n.originalSettings=n.options,void 0!==document.mozHidden?(n.hidden="mozHidden",n.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(n.hidden="webkitHidden",n.visibilityChange="webkitvisibilitychange"),n.autoPlay=i.proxy(n.autoPlay,n),n.autoPlayClear=i.proxy(n.autoPlayClear,n),n.autoPlayIterator=i.proxy(n.autoPlayIterator,n),n.changeSlide=i.proxy(n.changeSlide,n),n.clickHandler=i.proxy(n.clickHandler,n),n.selectHandler=i.proxy(n.selectHandler,n),n.setPosition=i.proxy(n.setPosition,n),n.swipeHandler=i.proxy(n.swipeHandler,n),n.dragHandler=i.proxy(n.dragHandler,n),n.keyHandler=i.proxy(n.keyHandler,n),n.instanceUid=e++,n.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,n.registerBreakpoints(),n.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},e.prototype.addSlide=e.prototype.slickAdd=function(e,t,o){var s=this;if("boolean"==typeof t)o=t,t=null;else if(t<0||t>=s.slideCount)return!1;s.unload(),"number"==typeof t?0===t&&0===s.$slides.length?i(e).appendTo(s.$slideTrack):o?i(e).insertBefore(s.$slides.eq(t)):i(e).insertAfter(s.$slides.eq(t)):!0===o?i(e).prependTo(s.$slideTrack):i(e).appendTo(s.$slideTrack),s.$slides=s.$slideTrack.children(this.options.slide),s.$slideTrack.children(this.options.slide).detach(),s.$slideTrack.append(s.$slides),s.$slides.each(function(e,t){i(t).attr("data-slick-index",e)}),s.$slidesCache=s.$slides,s.reinit()},e.prototype.animateHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.animate({height:e},i.options.speed)}},e.prototype.animateSlide=function(e,t){var o={},s=this;s.animateHeight(),!0===s.options.rtl&&!1===s.options.vertical&&(e=-e),!1===s.transformsEnabled?!1===s.options.vertical?s.$slideTrack.animate({left:e},s.options.speed,s.options.easing,t):s.$slideTrack.animate({top:e},s.options.speed,s.options.easing,t):!1===s.cssTransitions?(!0===s.options.rtl&&(s.currentLeft=-s.currentLeft),i({animStart:s.currentLeft}).animate({animStart:e},{duration:s.options.speed,easing:s.options.easing,step:function(i){i=Math.ceil(i),!1===s.options.vertical?(o[s.animType]="translate("+i+"px, 0px)",s.$slideTrack.css(o)):(o[s.animType]="translate(0px,"+i+"px)",s.$slideTrack.css(o))},complete:function(){t&&t.call()}})):(s.applyTransition(),e=Math.ceil(e),!1===s.options.vertical?o[s.animType]="translate3d("+e+"px, 0px, 0px)":o[s.animType]="translate3d(0px,"+e+"px, 0px)",s.$slideTrack.css(o),t&&setTimeout(function(){s.disableTransition(),t.call()},s.options.speed))},e.prototype.getNavTarget=function(){var e=this,t=e.options.asNavFor;return t&&null!==t&&(t=i(t).not(e.$slider)),t},e.prototype.asNavFor=function(e){var t=this.getNavTarget();null!==t&&"object"==typeof t&&t.each(function(){var t=i(this).slick("getSlick");t.unslicked||t.slideHandler(e,!0)})},e.prototype.applyTransition=function(i){var e=this,t={};!1===e.options.fade?t[e.transitionType]=e.transformType+" "+e.options.speed+"ms "+e.options.cssEase:t[e.transitionType]="opacity "+e.options.speed+"ms "+e.options.cssEase,!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.autoPlay=function(){var i=this;i.autoPlayClear(),i.slideCount>i.options.slidesToShow&&(i.autoPlayTimer=setInterval(i.autoPlayIterator,i.options.autoplaySpeed))},e.prototype.autoPlayClear=function(){var i=this;i.autoPlayTimer&&clearInterval(i.autoPlayTimer)},e.prototype.autoPlayIterator=function(){var i=this,e=i.currentSlide+i.options.slidesToScroll;i.paused||i.interrupted||i.focussed||(!1===i.options.infinite&&(1===i.direction&&i.currentSlide+1===i.slideCount-1?i.direction=0:0===i.direction&&(e=i.currentSlide-i.options.slidesToScroll,i.currentSlide-1==0&&(i.direction=1))),i.slideHandler(e))},e.prototype.buildArrows=function(){var e=this;!0===e.options.arrows&&(e.$prevArrow=i(e.options.prevArrow).addClass("slick-arrow"),e.$nextArrow=i(e.options.nextArrow).addClass("slick-arrow"),e.slideCount>e.options.slidesToShow?(e.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.prependTo(e.options.appendArrows),e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.appendTo(e.options.appendArrows),!0!==e.options.infinite&&e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):e.$prevArrow.add(e.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},e.prototype.buildDots=function(){var e,t,o=this;if(!0===o.options.dots){for(o.$slider.addClass("slick-dotted"),t=i("<ul />").addClass(o.options.dotsClass),e=0;e<=o.getDotCount();e+=1)t.append(i("<li />").append(o.options.customPaging.call(this,o,e)));o.$dots=t.appendTo(o.options.appendDots),o.$dots.find("li").first().addClass("slick-active")}},e.prototype.buildOut=function(){var e=this;e.$slides=e.$slider.children(e.options.slide+":not(.slick-cloned)").addClass("slick-slide"),e.slideCount=e.$slides.length,e.$slides.each(function(e,t){i(t).attr("data-slick-index",e).data("originalStyling",i(t).attr("style")||"")}),e.$slider.addClass("slick-slider"),e.$slideTrack=0===e.slideCount?i('<div class="slick-track"/>').appendTo(e.$slider):e.$slides.wrapAll('<div class="slick-track"/>').parent(),e.$list=e.$slideTrack.wrap('<div class="slick-list"/>').parent(),e.$slideTrack.css("opacity",0),!0!==e.options.centerMode&&!0!==e.options.swipeToSlide||(e.options.slidesToScroll=1),i("img[data-lazy]",e.$slider).not("[src]").addClass("slick-loading"),e.setupInfinite(),e.buildArrows(),e.buildDots(),e.updateDots(),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),!0===e.options.draggable&&e.$list.addClass("draggable")},e.prototype.buildRows=function(){var i,e,t,o,s,n,r,l=this;if(o=document.createDocumentFragment(),n=l.$slider.children(),l.options.rows>1){for(r=l.options.slidesPerRow*l.options.rows,s=Math.ceil(n.length/r),i=0;i<s;i++){var d=document.createElement("div");for(e=0;e<l.options.rows;e++){var a=document.createElement("div");for(t=0;t<l.options.slidesPerRow;t++){var c=i*r+(e*l.options.slidesPerRow+t);n.get(c)&&a.appendChild(n.get(c))}d.appendChild(a)}o.appendChild(d)}l.$slider.empty().append(o),l.$slider.children().children().children().css({width:100/l.options.slidesPerRow+"%",display:"inline-block"})}},e.prototype.checkResponsive=function(e,t){var o,s,n,r=this,l=!1,d=r.$slider.width(),a=window.innerWidth||i(window).width();if("window"===r.respondTo?n=a:"slider"===r.respondTo?n=d:"min"===r.respondTo&&(n=Math.min(a,d)),r.options.responsive&&r.options.responsive.length&&null!==r.options.responsive){s=null;for(o in r.breakpoints)r.breakpoints.hasOwnProperty(o)&&(!1===r.originalSettings.mobileFirst?n<r.breakpoints[o]&&(s=r.breakpoints[o]):n>r.breakpoints[o]&&(s=r.breakpoints[o]));null!==s?null!==r.activeBreakpoint?(s!==r.activeBreakpoint||t)&&(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):null!==r.activeBreakpoint&&(r.activeBreakpoint=null,r.options=r.originalSettings,!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e),l=s),e||!1===l||r.$slider.trigger("breakpoint",[r,l])}},e.prototype.changeSlide=function(e,t){var o,s,n,r=this,l=i(e.currentTarget);switch(l.is("a")&&e.preventDefault(),l.is("li")||(l=l.closest("li")),n=r.slideCount%r.options.slidesToScroll!=0,o=n?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,e.data.message){case"previous":s=0===o?r.options.slidesToScroll:r.options.slidesToShow-o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-s,!1,t);break;case"next":s=0===o?r.options.slidesToScroll:o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+s,!1,t);break;case"index":var d=0===e.data.index?0:e.data.index||l.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(d),!1,t),l.children().trigger("focus");break;default:return}},e.prototype.checkNavigable=function(i){var e,t;if(e=this.getNavigableIndexes(),t=0,i>e[e.length-1])i=e[e.length-1];else for(var o in e){if(i<e[o]){i=t;break}t=e[o]}return i},e.prototype.cleanUpEvents=function(){var e=this;e.options.dots&&null!==e.$dots&&(i("li",e.$dots).off("click.slick",e.changeSlide).off("mouseenter.slick",i.proxy(e.interrupt,e,!0)).off("mouseleave.slick",i.proxy(e.interrupt,e,!1)),!0===e.options.accessibility&&e.$dots.off("keydown.slick",e.keyHandler)),e.$slider.off("focus.slick blur.slick"),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow&&e.$prevArrow.off("click.slick",e.changeSlide),e.$nextArrow&&e.$nextArrow.off("click.slick",e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow&&e.$prevArrow.off("keydown.slick",e.keyHandler),e.$nextArrow&&e.$nextArrow.off("keydown.slick",e.keyHandler))),e.$list.off("touchstart.slick mousedown.slick",e.swipeHandler),e.$list.off("touchmove.slick mousemove.slick",e.swipeHandler),e.$list.off("touchend.slick mouseup.slick",e.swipeHandler),e.$list.off("touchcancel.slick mouseleave.slick",e.swipeHandler),e.$list.off("click.slick",e.clickHandler),i(document).off(e.visibilityChange,e.visibility),e.cleanUpSlideEvents(),!0===e.options.accessibility&&e.$list.off("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().off("click.slick",e.selectHandler),i(window).off("orientationchange.slick.slick-"+e.instanceUid,e.orientationChange),i(window).off("resize.slick.slick-"+e.instanceUid,e.resize),i("[draggable!=true]",e.$slideTrack).off("dragstart",e.preventDefault),i(window).off("load.slick.slick-"+e.instanceUid,e.setPosition)},e.prototype.cleanUpSlideEvents=function(){var e=this;e.$list.off("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.off("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.cleanUpRows=function(){var i,e=this;e.options.rows>1&&((i=e.$slides.children().children()).removeAttr("style"),e.$slider.empty().append(i))},e.prototype.clickHandler=function(i){!1===this.shouldClick&&(i.stopImmediatePropagation(),i.stopPropagation(),i.preventDefault())},e.prototype.destroy=function(e){var t=this;t.autoPlayClear(),t.touchObject={},t.cleanUpEvents(),i(".slick-cloned",t.$slider).detach(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.$prevArrow.length&&(t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove()),t.$nextArrow&&t.$nextArrow.length&&(t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove()),t.$slides&&(t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){i(this).attr("style",i(this).data("originalStyling"))}),t.$slideTrack.children(this.options.slide).detach(),t.$slideTrack.detach(),t.$list.detach(),t.$slider.append(t.$slides)),t.cleanUpRows(),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$slider.removeClass("slick-dotted"),t.unslicked=!0,e||t.$slider.trigger("destroy",[t])},e.prototype.disableTransition=function(i){var e=this,t={};t[e.transitionType]="",!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.fadeSlide=function(i,e){var t=this;!1===t.cssTransitions?(t.$slides.eq(i).css({zIndex:t.options.zIndex}),t.$slides.eq(i).animate({opacity:1},t.options.speed,t.options.easing,e)):(t.applyTransition(i),t.$slides.eq(i).css({opacity:1,zIndex:t.options.zIndex}),e&&setTimeout(function(){t.disableTransition(i),e.call()},t.options.speed))},e.prototype.fadeSlideOut=function(i){var e=this;!1===e.cssTransitions?e.$slides.eq(i).animate({opacity:0,zIndex:e.options.zIndex-2},e.options.speed,e.options.easing):(e.applyTransition(i),e.$slides.eq(i).css({opacity:0,zIndex:e.options.zIndex-2}))},e.prototype.filterSlides=e.prototype.slickFilter=function(i){var e=this;null!==i&&(e.$slidesCache=e.$slides,e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.filter(i).appendTo(e.$slideTrack),e.reinit())},e.prototype.focusHandler=function(){var e=this;e.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(t){t.stopImmediatePropagation();var o=i(this);setTimeout(function(){e.options.pauseOnFocus&&(e.focussed=o.is(":focus"),e.autoPlay())},0)})},e.prototype.getCurrent=e.prototype.slickCurrentSlide=function(){return this.currentSlide},e.prototype.getDotCount=function(){var i=this,e=0,t=0,o=0;if(!0===i.options.infinite)if(i.slideCount<=i.options.slidesToShow)++o;else for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else if(!0===i.options.centerMode)o=i.slideCount;else if(i.options.asNavFor)for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else o=1+Math.ceil((i.slideCount-i.options.slidesToShow)/i.options.slidesToScroll);return o-1},e.prototype.getLeft=function(i){var e,t,o,s,n=this,r=0;return n.slideOffset=0,t=n.$slides.first().outerHeight(!0),!0===n.options.infinite?(n.slideCount>n.options.slidesToShow&&(n.slideOffset=n.slideWidth*n.options.slidesToShow*-1,s=-1,!0===n.options.vertical&&!0===n.options.centerMode&&(2===n.options.slidesToShow?s=-1.5:1===n.options.slidesToShow&&(s=-2)),r=t*n.options.slidesToShow*s),n.slideCount%n.options.slidesToScroll!=0&&i+n.options.slidesToScroll>n.slideCount&&n.slideCount>n.options.slidesToShow&&(i>n.slideCount?(n.slideOffset=(n.options.slidesToShow-(i-n.slideCount))*n.slideWidth*-1,r=(n.options.slidesToShow-(i-n.slideCount))*t*-1):(n.slideOffset=n.slideCount%n.options.slidesToScroll*n.slideWidth*-1,r=n.slideCount%n.options.slidesToScroll*t*-1))):i+n.options.slidesToShow>n.slideCount&&(n.slideOffset=(i+n.options.slidesToShow-n.slideCount)*n.slideWidth,r=(i+n.options.slidesToShow-n.slideCount)*t),n.slideCount<=n.options.slidesToShow&&(n.slideOffset=0,r=0),!0===n.options.centerMode&&n.slideCount<=n.options.slidesToShow?n.slideOffset=n.slideWidth*Math.floor(n.options.slidesToShow)/2-n.slideWidth*n.slideCount/2:!0===n.options.centerMode&&!0===n.options.infinite?n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)-n.slideWidth:!0===n.options.centerMode&&(n.slideOffset=0,n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)),e=!1===n.options.vertical?i*n.slideWidth*-1+n.slideOffset:i*t*-1+r,!0===n.options.variableWidth&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,!0===n.options.centerMode&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow+1),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,e+=(n.$list.width()-o.outerWidth())/2)),e},e.prototype.getOption=e.prototype.slickGetOption=function(i){return this.options[i]},e.prototype.getNavigableIndexes=function(){var i,e=this,t=0,o=0,s=[];for(!1===e.options.infinite?i=e.slideCount:(t=-1*e.options.slidesToScroll,o=-1*e.options.slidesToScroll,i=2*e.slideCount);t<i;)s.push(t),t=o+e.options.slidesToScroll,o+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;return s},e.prototype.getSlick=function(){return this},e.prototype.getSlideCount=function(){var e,t,o=this;return t=!0===o.options.centerMode?o.slideWidth*Math.floor(o.options.slidesToShow/2):0,!0===o.options.swipeToSlide?(o.$slideTrack.find(".slick-slide").each(function(s,n){if(n.offsetLeft-t+i(n).outerWidth()/2>-1*o.swipeLeft)return e=n,!1}),Math.abs(i(e).attr("data-slick-index")-o.currentSlide)||1):o.options.slidesToScroll},e.prototype.goTo=e.prototype.slickGoTo=function(i,e){this.changeSlide({data:{message:"index",index:parseInt(i)}},e)},e.prototype.init=function(e){var t=this;i(t.$slider).hasClass("slick-initialized")||(i(t.$slider).addClass("slick-initialized"),t.buildRows(),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots(),t.checkResponsive(!0),t.focusHandler()),e&&t.$slider.trigger("init",[t]),!0===t.options.accessibility&&t.initADA(),t.options.autoplay&&(t.paused=!1,t.autoPlay())},e.prototype.initADA=function(){var e=this,t=Math.ceil(e.slideCount/e.options.slidesToShow),o=e.getNavigableIndexes().filter(function(i){return i>=0&&i<e.slideCount});e.$slides.add(e.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==e.$dots&&(e.$slides.not(e.$slideTrack.find(".slick-cloned")).each(function(t){var s=o.indexOf(t);i(this).attr({role:"tabpanel",id:"slick-slide"+e.instanceUid+t,tabindex:-1}),-1!==s&&i(this).attr({"aria-describedby":"slick-slide-control"+e.instanceUid+s})}),e.$dots.attr("role","tablist").find("li").each(function(s){var n=o[s];i(this).attr({role:"presentation"}),i(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+e.instanceUid+s,"aria-controls":"slick-slide"+e.instanceUid+n,"aria-label":s+1+" of "+t,"aria-selected":null,tabindex:"-1"})}).eq(e.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var s=e.currentSlide,n=s+e.options.slidesToShow;s<n;s++)e.$slides.eq(s).attr("tabindex",0);e.activateADA()},e.prototype.initArrowEvents=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},i.changeSlide),i.$nextArrow.off("click.slick").on("click.slick",{message:"next"},i.changeSlide),!0===i.options.accessibility&&(i.$prevArrow.on("keydown.slick",i.keyHandler),i.$nextArrow.on("keydown.slick",i.keyHandler)))},e.prototype.initDotEvents=function(){var e=this;!0===e.options.dots&&(i("li",e.$dots).on("click.slick",{message:"index"},e.changeSlide),!0===e.options.accessibility&&e.$dots.on("keydown.slick",e.keyHandler)),!0===e.options.dots&&!0===e.options.pauseOnDotsHover&&i("li",e.$dots).on("mouseenter.slick",i.proxy(e.interrupt,e,!0)).on("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.initSlideEvents=function(){var e=this;e.options.pauseOnHover&&(e.$list.on("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.on("mouseleave.slick",i.proxy(e.interrupt,e,!1)))},e.prototype.initializeEvents=function(){var e=this;e.initArrowEvents(),e.initDotEvents(),e.initSlideEvents(),e.$list.on("touchstart.slick mousedown.slick",{action:"start"},e.swipeHandler),e.$list.on("touchmove.slick mousemove.slick",{action:"move"},e.swipeHandler),e.$list.on("touchend.slick mouseup.slick",{action:"end"},e.swipeHandler),e.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},e.swipeHandler),e.$list.on("click.slick",e.clickHandler),i(document).on(e.visibilityChange,i.proxy(e.visibility,e)),!0===e.options.accessibility&&e.$list.on("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),i(window).on("orientationchange.slick.slick-"+e.instanceUid,i.proxy(e.orientationChange,e)),i(window).on("resize.slick.slick-"+e.instanceUid,i.proxy(e.resize,e)),i("[draggable!=true]",e.$slideTrack).on("dragstart",e.preventDefault),i(window).on("load.slick.slick-"+e.instanceUid,e.setPosition),i(e.setPosition)},e.prototype.initUI=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.show(),i.$nextArrow.show()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.show()},e.prototype.keyHandler=function(i){var e=this;i.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===i.keyCode&&!0===e.options.accessibility?e.changeSlide({data:{message:!0===e.options.rtl?"next":"previous"}}):39===i.keyCode&&!0===e.options.accessibility&&e.changeSlide({data:{message:!0===e.options.rtl?"previous":"next"}}))},e.prototype.lazyLoad=function(){function e(e){i("img[data-lazy]",e).each(function(){var e=i(this),t=i(this).attr("data-lazy"),o=i(this).attr("data-srcset"),s=i(this).attr("data-sizes")||n.$slider.attr("data-sizes"),r=document.createElement("img");r.onload=function(){e.animate({opacity:0},100,function(){o&&(e.attr("srcset",o),s&&e.attr("sizes",s)),e.attr("src",t).animate({opacity:1},200,function(){e.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),n.$slider.trigger("lazyLoaded",[n,e,t])})},r.onerror=function(){e.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),n.$slider.trigger("lazyLoadError",[n,e,t])},r.src=t})}var t,o,s,n=this;if(!0===n.options.centerMode?!0===n.options.infinite?s=(o=n.currentSlide+(n.options.slidesToShow/2+1))+n.options.slidesToShow+2:(o=Math.max(0,n.currentSlide-(n.options.slidesToShow/2+1)),s=n.options.slidesToShow/2+1+2+n.currentSlide):(o=n.options.infinite?n.options.slidesToShow+n.currentSlide:n.currentSlide,s=Math.ceil(o+n.options.slidesToShow),!0===n.options.fade&&(o>0&&o--,s<=n.slideCount&&s++)),t=n.$slider.find(".slick-slide").slice(o,s),"anticipated"===n.options.lazyLoad)for(var r=o-1,l=s,d=n.$slider.find(".slick-slide"),a=0;a<n.options.slidesToScroll;a++)r<0&&(r=n.slideCount-1),t=(t=t.add(d.eq(r))).add(d.eq(l)),r--,l++;e(t),n.slideCount<=n.options.slidesToShow?e(n.$slider.find(".slick-slide")):n.currentSlide>=n.slideCount-n.options.slidesToShow?e(n.$slider.find(".slick-cloned").slice(0,n.options.slidesToShow)):0===n.currentSlide&&e(n.$slider.find(".slick-cloned").slice(-1*n.options.slidesToShow))},e.prototype.loadSlider=function(){var i=this;i.setPosition(),i.$slideTrack.css({opacity:1}),i.$slider.removeClass("slick-loading"),i.initUI(),"progressive"===i.options.lazyLoad&&i.progressiveLazyLoad()},e.prototype.next=e.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},e.prototype.orientationChange=function(){var i=this;i.checkResponsive(),i.setPosition()},e.prototype.pause=e.prototype.slickPause=function(){var i=this;i.autoPlayClear(),i.paused=!0},e.prototype.play=e.prototype.slickPlay=function(){var i=this;i.autoPlay(),i.options.autoplay=!0,i.paused=!1,i.focussed=!1,i.interrupted=!1},e.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.slideCount>t.options.slidesToShow&&t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&(t.initADA(),t.options.focusOnChange&&i(t.$slides.get(t.currentSlide)).attr("tabindex",0).focus()))},e.prototype.prev=e.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},e.prototype.preventDefault=function(i){i.preventDefault()},e.prototype.progressiveLazyLoad=function(e){e=e||1;var t,o,s,n,r,l=this,d=i("img[data-lazy]",l.$slider);d.length?(t=d.first(),o=t.attr("data-lazy"),s=t.attr("data-srcset"),n=t.attr("data-sizes")||l.$slider.attr("data-sizes"),(r=document.createElement("img")).onload=function(){s&&(t.attr("srcset",s),n&&t.attr("sizes",n)),t.attr("src",o).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),!0===l.options.adaptiveHeight&&l.setPosition(),l.$slider.trigger("lazyLoaded",[l,t,o]),l.progressiveLazyLoad()},r.onerror=function(){e<3?setTimeout(function(){l.progressiveLazyLoad(e+1)},500):(t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),l.$slider.trigger("lazyLoadError",[l,t,o]),l.progressiveLazyLoad())},r.src=o):l.$slider.trigger("allImagesLoaded",[l])},e.prototype.refresh=function(e){var t,o,s=this;o=s.slideCount-s.options.slidesToShow,!s.options.infinite&&s.currentSlide>o&&(s.currentSlide=o),s.slideCount<=s.options.slidesToShow&&(s.currentSlide=0),t=s.currentSlide,s.destroy(!0),i.extend(s,s.initials,{currentSlide:t}),s.init(),e||s.changeSlide({data:{message:"index",index:t}},!1)},e.prototype.registerBreakpoints=function(){var e,t,o,s=this,n=s.options.responsive||null;if("array"===i.type(n)&&n.length){s.respondTo=s.options.respondTo||"window";for(e in n)if(o=s.breakpoints.length-1,n.hasOwnProperty(e)){for(t=n[e].breakpoint;o>=0;)s.breakpoints[o]&&s.breakpoints[o]===t&&s.breakpoints.splice(o,1),o--;s.breakpoints.push(t),s.breakpointSettings[t]=n[e].settings}s.breakpoints.sort(function(i,e){return s.options.mobileFirst?i-e:e-i})}},e.prototype.reinit=function(){var e=this;e.$slides=e.$slideTrack.children(e.options.slide).addClass("slick-slide"),e.slideCount=e.$slides.length,e.currentSlide>=e.slideCount&&0!==e.currentSlide&&(e.currentSlide=e.currentSlide-e.options.slidesToScroll),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),e.registerBreakpoints(),e.setProps(),e.setupInfinite(),e.buildArrows(),e.updateArrows(),e.initArrowEvents(),e.buildDots(),e.updateDots(),e.initDotEvents(),e.cleanUpSlideEvents(),e.initSlideEvents(),e.checkResponsive(!1,!0),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),e.setPosition(),e.focusHandler(),e.paused=!e.options.autoplay,e.autoPlay(),e.$slider.trigger("reInit",[e])},e.prototype.resize=function(){var e=this;i(window).width()!==e.windowWidth&&(clearTimeout(e.windowDelay),e.windowDelay=window.setTimeout(function(){e.windowWidth=i(window).width(),e.checkResponsive(),e.unslicked||e.setPosition()},50))},e.prototype.removeSlide=e.prototype.slickRemove=function(i,e,t){var o=this;if(i="boolean"==typeof i?!0===(e=i)?0:o.slideCount-1:!0===e?--i:i,o.slideCount<1||i<0||i>o.slideCount-1)return!1;o.unload(),!0===t?o.$slideTrack.children().remove():o.$slideTrack.children(this.options.slide).eq(i).remove(),o.$slides=o.$slideTrack.children(this.options.slide),o.$slideTrack.children(this.options.slide).detach(),o.$slideTrack.append(o.$slides),o.$slidesCache=o.$slides,o.reinit()},e.prototype.setCSS=function(i){var e,t,o=this,s={};!0===o.options.rtl&&(i=-i),e="left"==o.positionProp?Math.ceil(i)+"px":"0px",t="top"==o.positionProp?Math.ceil(i)+"px":"0px",s[o.positionProp]=i,!1===o.transformsEnabled?o.$slideTrack.css(s):(s={},!1===o.cssTransitions?(s[o.animType]="translate("+e+", "+t+")",o.$slideTrack.css(s)):(s[o.animType]="translate3d("+e+", "+t+", 0px)",o.$slideTrack.css(s)))},e.prototype.setDimensions=function(){var i=this;!1===i.options.vertical?!0===i.options.centerMode&&i.$list.css({padding:"0px "+i.options.centerPadding}):(i.$list.height(i.$slides.first().outerHeight(!0)*i.options.slidesToShow),!0===i.options.centerMode&&i.$list.css({padding:i.options.centerPadding+" 0px"})),i.listWidth=i.$list.width(),i.listHeight=i.$list.height(),!1===i.options.vertical&&!1===i.options.variableWidth?(i.slideWidth=Math.ceil(i.listWidth/i.options.slidesToShow),i.$slideTrack.width(Math.ceil(i.slideWidth*i.$slideTrack.children(".slick-slide").length))):!0===i.options.variableWidth?i.$slideTrack.width(5e3*i.slideCount):(i.slideWidth=Math.ceil(i.listWidth),i.$slideTrack.height(Math.ceil(i.$slides.first().outerHeight(!0)*i.$slideTrack.children(".slick-slide").length)));var e=i.$slides.first().outerWidth(!0)-i.$slides.first().width();!1===i.options.variableWidth&&i.$slideTrack.children(".slick-slide").width(i.slideWidth-e)},e.prototype.setFade=function(){var e,t=this;t.$slides.each(function(o,s){e=t.slideWidth*o*-1,!0===t.options.rtl?i(s).css({position:"relative",right:e,top:0,zIndex:t.options.zIndex-2,opacity:0}):i(s).css({position:"relative",left:e,top:0,zIndex:t.options.zIndex-2,opacity:0})}),t.$slides.eq(t.currentSlide).css({zIndex:t.options.zIndex-1,opacity:1})},e.prototype.setHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.css("height",e)}},e.prototype.setOption=e.prototype.slickSetOption=function(){var e,t,o,s,n,r=this,l=!1;if("object"===i.type(arguments[0])?(o=arguments[0],l=arguments[1],n="multiple"):"string"===i.type(arguments[0])&&(o=arguments[0],s=arguments[1],l=arguments[2],"responsive"===arguments[0]&&"array"===i.type(arguments[1])?n="responsive":void 0!==arguments[1]&&(n="single")),"single"===n)r.options[o]=s;else if("multiple"===n)i.each(o,function(i,e){r.options[i]=e});else if("responsive"===n)for(t in s)if("array"!==i.type(r.options.responsive))r.options.responsive=[s[t]];else{for(e=r.options.responsive.length-1;e>=0;)r.options.responsive[e].breakpoint===s[t].breakpoint&&r.options.responsive.splice(e,1),e--;r.options.responsive.push(s[t])}l&&(r.unload(),r.reinit())},e.prototype.setPosition=function(){var i=this;i.setDimensions(),i.setHeight(),!1===i.options.fade?i.setCSS(i.getLeft(i.currentSlide)):i.setFade(),i.$slider.trigger("setPosition",[i])},e.prototype.setProps=function(){var i=this,e=document.body.style;i.positionProp=!0===i.options.vertical?"top":"left","top"===i.positionProp?i.$slider.addClass("slick-vertical"):i.$slider.removeClass("slick-vertical"),void 0===e.WebkitTransition&&void 0===e.MozTransition&&void 0===e.msTransition||!0===i.options.useCSS&&(i.cssTransitions=!0),i.options.fade&&("number"==typeof i.options.zIndex?i.options.zIndex<3&&(i.options.zIndex=3):i.options.zIndex=i.defaults.zIndex),void 0!==e.OTransform&&(i.animType="OTransform",i.transformType="-o-transform",i.transitionType="OTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.MozTransform&&(i.animType="MozTransform",i.transformType="-moz-transform",i.transitionType="MozTransition",void 0===e.perspectiveProperty&&void 0===e.MozPerspective&&(i.animType=!1)),void 0!==e.webkitTransform&&(i.animType="webkitTransform",i.transformType="-webkit-transform",i.transitionType="webkitTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.msTransform&&(i.animType="msTransform",i.transformType="-ms-transform",i.transitionType="msTransition",void 0===e.msTransform&&(i.animType=!1)),void 0!==e.transform&&!1!==i.animType&&(i.animType="transform",i.transformType="transform",i.transitionType="transition"),i.transformsEnabled=i.options.useTransform&&null!==i.animType&&!1!==i.animType},e.prototype.setSlideClasses=function(i){var e,t,o,s,n=this;if(t=n.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),n.$slides.eq(i).addClass("slick-current"),!0===n.options.centerMode){var r=n.options.slidesToShow%2==0?1:0;e=Math.floor(n.options.slidesToShow/2),!0===n.options.infinite&&(i>=e&&i<=n.slideCount-1-e?n.$slides.slice(i-e+r,i+e+1).addClass("slick-active").attr("aria-hidden","false"):(o=n.options.slidesToShow+i,t.slice(o-e+1+r,o+e+2).addClass("slick-active").attr("aria-hidden","false")),0===i?t.eq(t.length-1-n.options.slidesToShow).addClass("slick-center"):i===n.slideCount-1&&t.eq(n.options.slidesToShow).addClass("slick-center")),n.$slides.eq(i).addClass("slick-center")}else i>=0&&i<=n.slideCount-n.options.slidesToShow?n.$slides.slice(i,i+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):t.length<=n.options.slidesToShow?t.addClass("slick-active").attr("aria-hidden","false"):(s=n.slideCount%n.options.slidesToShow,o=!0===n.options.infinite?n.options.slidesToShow+i:i,n.options.slidesToShow==n.options.slidesToScroll&&n.slideCount-i<n.options.slidesToShow?t.slice(o-(n.options.slidesToShow-s),o+s).addClass("slick-active").attr("aria-hidden","false"):t.slice(o,o+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==n.options.lazyLoad&&"anticipated"!==n.options.lazyLoad||n.lazyLoad()},e.prototype.setupInfinite=function(){var e,t,o,s=this;if(!0===s.options.fade&&(s.options.centerMode=!1),!0===s.options.infinite&&!1===s.options.fade&&(t=null,s.slideCount>s.options.slidesToShow)){for(o=!0===s.options.centerMode?s.options.slidesToShow+1:s.options.slidesToShow,e=s.slideCount;e>s.slideCount-o;e-=1)t=e-1,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t-s.slideCount).prependTo(s.$slideTrack).addClass("slick-cloned");for(e=0;e<o+s.slideCount;e+=1)t=e,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t+s.slideCount).appendTo(s.$slideTrack).addClass("slick-cloned");s.$slideTrack.find(".slick-cloned").find("[id]").each(function(){i(this).attr("id","")})}},e.prototype.interrupt=function(i){var e=this;i||e.autoPlay(),e.interrupted=i},e.prototype.selectHandler=function(e){var t=this,o=i(e.target).is(".slick-slide")?i(e.target):i(e.target).parents(".slick-slide"),s=parseInt(o.attr("data-slick-index"));s||(s=0),t.slideCount<=t.options.slidesToShow?t.slideHandler(s,!1,!0):t.slideHandler(s)},e.prototype.slideHandler=function(i,e,t){var o,s,n,r,l,d=null,a=this;if(e=e||!1,!(!0===a.animating&&!0===a.options.waitForAnimate||!0===a.options.fade&&a.currentSlide===i))if(!1===e&&a.asNavFor(i),o=i,d=a.getLeft(o),r=a.getLeft(a.currentSlide),a.currentLeft=null===a.swipeLeft?r:a.swipeLeft,!1===a.options.infinite&&!1===a.options.centerMode&&(i<0||i>a.getDotCount()*a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else if(!1===a.options.infinite&&!0===a.options.centerMode&&(i<0||i>a.slideCount-a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else{if(a.options.autoplay&&clearInterval(a.autoPlayTimer),s=o<0?a.slideCount%a.options.slidesToScroll!=0?a.slideCount-a.slideCount%a.options.slidesToScroll:a.slideCount+o:o>=a.slideCount?a.slideCount%a.options.slidesToScroll!=0?0:o-a.slideCount:o,a.animating=!0,a.$slider.trigger("beforeChange",[a,a.currentSlide,s]),n=a.currentSlide,a.currentSlide=s,a.setSlideClasses(a.currentSlide),a.options.asNavFor&&(l=(l=a.getNavTarget()).slick("getSlick")).slideCount<=l.options.slidesToShow&&l.setSlideClasses(a.currentSlide),a.updateDots(),a.updateArrows(),!0===a.options.fade)return!0!==t?(a.fadeSlideOut(n),a.fadeSlide(s,function(){a.postSlide(s)})):a.postSlide(s),void a.animateHeight();!0!==t?a.animateSlide(d,function(){a.postSlide(s)}):a.postSlide(s)}},e.prototype.startLoad=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.hide(),i.$nextArrow.hide()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.hide(),i.$slider.addClass("slick-loading")},e.prototype.swipeDirection=function(){var i,e,t,o,s=this;return i=s.touchObject.startX-s.touchObject.curX,e=s.touchObject.startY-s.touchObject.curY,t=Math.atan2(e,i),(o=Math.round(180*t/Math.PI))<0&&(o=360-Math.abs(o)),o<=45&&o>=0?!1===s.options.rtl?"left":"right":o<=360&&o>=315?!1===s.options.rtl?"left":"right":o>=135&&o<=225?!1===s.options.rtl?"right":"left":!0===s.options.verticalSwiping?o>=35&&o<=135?"down":"up":"vertical"},e.prototype.swipeEnd=function(i){var e,t,o=this;if(o.dragging=!1,o.swiping=!1,o.scrolling)return o.scrolling=!1,!1;if(o.interrupted=!1,o.shouldClick=!(o.touchObject.swipeLength>10),void 0===o.touchObject.curX)return!1;if(!0===o.touchObject.edgeHit&&o.$slider.trigger("edge",[o,o.swipeDirection()]),o.touchObject.swipeLength>=o.touchObject.minSwipe){switch(t=o.swipeDirection()){case"left":case"down":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide+o.getSlideCount()):o.currentSlide+o.getSlideCount(),o.currentDirection=0;break;case"right":case"up":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide-o.getSlideCount()):o.currentSlide-o.getSlideCount(),o.currentDirection=1}"vertical"!=t&&(o.slideHandler(e),o.touchObject={},o.$slider.trigger("swipe",[o,t]))}else o.touchObject.startX!==o.touchObject.curX&&(o.slideHandler(o.currentSlide),o.touchObject={})},e.prototype.swipeHandler=function(i){var e=this;if(!(!1===e.options.swipe||"ontouchend"in document&&!1===e.options.swipe||!1===e.options.draggable&&-1!==i.type.indexOf("mouse")))switch(e.touchObject.fingerCount=i.originalEvent&&void 0!==i.originalEvent.touches?i.originalEvent.touches.length:1,e.touchObject.minSwipe=e.listWidth/e.options.touchThreshold,!0===e.options.verticalSwiping&&(e.touchObject.minSwipe=e.listHeight/e.options.touchThreshold),i.data.action){case"start":e.swipeStart(i);break;case"move":e.swipeMove(i);break;case"end":e.swipeEnd(i)}},e.prototype.swipeMove=function(i){var e,t,o,s,n,r,l=this;return n=void 0!==i.originalEvent?i.originalEvent.touches:null,!(!l.dragging||l.scrolling||n&&1!==n.length)&&(e=l.getLeft(l.currentSlide),l.touchObject.curX=void 0!==n?n[0].pageX:i.clientX,l.touchObject.curY=void 0!==n?n[0].pageY:i.clientY,l.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(l.touchObject.curX-l.touchObject.startX,2))),r=Math.round(Math.sqrt(Math.pow(l.touchObject.curY-l.touchObject.startY,2))),!l.options.verticalSwiping&&!l.swiping&&r>4?(l.scrolling=!0,!1):(!0===l.options.verticalSwiping&&(l.touchObject.swipeLength=r),t=l.swipeDirection(),void 0!==i.originalEvent&&l.touchObject.swipeLength>4&&(l.swiping=!0,i.preventDefault()),s=(!1===l.options.rtl?1:-1)*(l.touchObject.curX>l.touchObject.startX?1:-1),!0===l.options.verticalSwiping&&(s=l.touchObject.curY>l.touchObject.startY?1:-1),o=l.touchObject.swipeLength,l.touchObject.edgeHit=!1,!1===l.options.infinite&&(0===l.currentSlide&&"right"===t||l.currentSlide>=l.getDotCount()&&"left"===t)&&(o=l.touchObject.swipeLength*l.options.edgeFriction,l.touchObject.edgeHit=!0),!1===l.options.vertical?l.swipeLeft=e+o*s:l.swipeLeft=e+o*(l.$list.height()/l.listWidth)*s,!0===l.options.verticalSwiping&&(l.swipeLeft=e+o*s),!0!==l.options.fade&&!1!==l.options.touchMove&&(!0===l.animating?(l.swipeLeft=null,!1):void l.setCSS(l.swipeLeft))))},e.prototype.swipeStart=function(i){var e,t=this;if(t.interrupted=!0,1!==t.touchObject.fingerCount||t.slideCount<=t.options.slidesToShow)return t.touchObject={},!1;void 0!==i.originalEvent&&void 0!==i.originalEvent.touches&&(e=i.originalEvent.touches[0]),t.touchObject.startX=t.touchObject.curX=void 0!==e?e.pageX:i.clientX,t.touchObject.startY=t.touchObject.curY=void 0!==e?e.pageY:i.clientY,t.dragging=!0},e.prototype.unfilterSlides=e.prototype.slickUnfilter=function(){var i=this;null!==i.$slidesCache&&(i.unload(),i.$slideTrack.children(this.options.slide).detach(),i.$slidesCache.appendTo(i.$slideTrack),i.reinit())},e.prototype.unload=function(){var e=this;i(".slick-cloned",e.$slider).remove(),e.$dots&&e.$dots.remove(),e.$prevArrow&&e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.remove(),e.$nextArrow&&e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.remove(),e.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},e.prototype.unslick=function(i){var e=this;e.$slider.trigger("unslick",[e,i]),e.destroy()},e.prototype.updateArrows=function(){var i=this;Math.floor(i.options.slidesToShow/2),!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&!i.options.infinite&&(i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===i.currentSlide?(i.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-i.options.slidesToShow&&!1===i.options.centerMode?(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-1&&!0===i.options.centerMode&&(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},e.prototype.updateDots=function(){var i=this;null!==i.$dots&&(i.$dots.find("li").removeClass("slick-active").end(),i.$dots.find("li").eq(Math.floor(i.currentSlide/i.options.slidesToScroll)).addClass("slick-active"))},e.prototype.visibility=function(){var i=this;i.options.autoplay&&(document[i.hidden]?i.interrupted=!0:i.interrupted=!1)},i.fn.slick=function(){var i,t,o=this,s=arguments[0],n=Array.prototype.slice.call(arguments,1),r=o.length;for(i=0;i<r;i++)if("object"==typeof s||void 0===s?o[i].slick=new e(o[i],s):t=o[i].slick[s].apply(o[i].slick,n),void 0!==t)return t;return o}});

/*
* jquery-match-height 0.7.2 by @liabru
* http://brm.io/jquery-match-height/
* License MIT
*/
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e=-1,o=-1,n=function(t){return parseFloat(t)||0},a=function(e){var o=1,a=t(e),i=null,r=[];return a.each(function(){var e=t(this),a=e.offset().top-n(e.css("margin-top")),s=r.length>0?r[r.length-1]:null;null===s?r.push(e):Math.floor(Math.abs(i-a))<=o?r[r.length-1]=s.add(e):r.push(e),i=a}),r},i=function(e){var o={
byRow:!0,property:"height",target:null,remove:!1};return"object"==typeof e?t.extend(o,e):("boolean"==typeof e?o.byRow=e:"remove"===e&&(o.remove=!0),o)},r=t.fn.matchHeight=function(e){var o=i(e);if(o.remove){var n=this;return this.css(o.property,""),t.each(r._groups,function(t,e){e.elements=e.elements.not(n)}),this}return this.length<=1&&!o.target?this:(r._groups.push({elements:this,options:o}),r._apply(this,o),this)};r.version="0.7.2",r._groups=[],r._throttle=80,r._maintainScroll=!1,r._beforeUpdate=null,
r._afterUpdate=null,r._rows=a,r._parse=n,r._parseOptions=i,r._apply=function(e,o){var s=i(o),h=t(e),l=[h],c=t(window).scrollTop(),p=t("html").outerHeight(!0),u=h.parents().filter(":hidden");return u.each(function(){var e=t(this);e.data("style-cache",e.attr("style"))}),u.css("display","block"),s.byRow&&!s.target&&(h.each(function(){var e=t(this),o=e.css("display");"inline-block"!==o&&"flex"!==o&&"inline-flex"!==o&&(o="block"),e.data("style-cache",e.attr("style")),e.css({display:o,"padding-top":"0",
"padding-bottom":"0","margin-top":"0","margin-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px",overflow:"hidden"})}),l=a(h),h.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||"")})),t.each(l,function(e,o){var a=t(o),i=0;if(s.target)i=s.target.outerHeight(!1);else{if(s.byRow&&a.length<=1)return void a.css(s.property,"");a.each(function(){var e=t(this),o=e.attr("style"),n=e.css("display");"inline-block"!==n&&"flex"!==n&&"inline-flex"!==n&&(n="block");var a={
display:n};a[s.property]="",e.css(a),e.outerHeight(!1)>i&&(i=e.outerHeight(!1)),o?e.attr("style",o):e.css("display","")})}a.each(function(){var e=t(this),o=0;s.target&&e.is(s.target)||("border-box"!==e.css("box-sizing")&&(o+=n(e.css("border-top-width"))+n(e.css("border-bottom-width")),o+=n(e.css("padding-top"))+n(e.css("padding-bottom"))),e.css(s.property,i-o+"px"))})}),u.each(function(){var e=t(this);e.attr("style",e.data("style-cache")||null)}),r._maintainScroll&&t(window).scrollTop(c/p*t("html").outerHeight(!0)),
this},r._applyDataApi=function(){var e={};t("[data-match-height], [data-mh]").each(function(){var o=t(this),n=o.attr("data-mh")||o.attr("data-match-height");n in e?e[n]=e[n].add(o):e[n]=o}),t.each(e,function(){this.matchHeight(!0)})};var s=function(e){r._beforeUpdate&&r._beforeUpdate(e,r._groups),t.each(r._groups,function(){r._apply(this.elements,this.options)}),r._afterUpdate&&r._afterUpdate(e,r._groups)};r._update=function(n,a){if(a&&"resize"===a.type){var i=t(window).width();if(i===e)return;e=i;
}n?o===-1&&(o=setTimeout(function(){s(a),o=-1},r._throttle)):s(a)},t(r._applyDataApi);var h=t.fn.on?"on":"bind";t(window)[h]("load",function(t){r._update(!1,t)}),t(window)[h]("resize orientationchange",function(t){r._update(!0,t)})});
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */
;(function (factory) {
	var registeredInModuleLoader;
	if (typeof define === 'function' && define.amd) {
		define(factory);
		registeredInModuleLoader = true;
	}
	if (typeof exports === 'object') {
		module.exports = factory();
		registeredInModuleLoader = true;
	}
	if (!registeredInModuleLoader) {
		var OldCookies = window.Cookies;
		var api = window.Cookies = factory();
		api.noConflict = function () {
			window.Cookies = OldCookies;
			return api;
		};
	}
}(function () {
	function extend () {
		var i = 0;
		var result = {};
		for (; i < arguments.length; i++) {
			var attributes = arguments[ i ];
			for (var key in attributes) {
				result[key] = attributes[key];
			}
		}
		return result;
	}

	function decode (s) {
		return s.replace(/(%[0-9A-Z]{2})+/g, decodeURIComponent);
	}

	function init (converter) {
		function api() {}

		function set (key, value, attributes) {
			if (typeof document === 'undefined') {
				return;
			}

			attributes = extend({
				path: '/'
			}, api.defaults, attributes);

			if (typeof attributes.expires === 'number') {
				attributes.expires = new Date(new Date() * 1 + attributes.expires * 864e+5);
			}

			// We're using "expires" because "max-age" is not supported by IE
			attributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';

			try {
				var result = JSON.stringify(value);
				if (/^[\{\[]/.test(result)) {
					value = result;
				}
			} catch (e) {}

			value = converter.write ?
				converter.write(value, key) :
				encodeURIComponent(String(value))
					.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);

			key = encodeURIComponent(String(key))
				.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent)
				.replace(/[\(\)]/g, escape);

			var stringifiedAttributes = '';
			for (var attributeName in attributes) {
				if (!attributes[attributeName]) {
					continue;
				}
				stringifiedAttributes += '; ' + attributeName;
				if (attributes[attributeName] === true) {
					continue;
				}

				// Considers RFC 6265 section 5.2:
				// ...
				// 3.  If the remaining unparsed-attributes contains a %x3B (";")
				//     character:
				// Consume the characters of the unparsed-attributes up to,
				// not including, the first %x3B (";") character.
				// ...
				stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];
			}

			return (document.cookie = key + '=' + value + stringifiedAttributes);
		}

		function get (key, json) {
			if (typeof document === 'undefined') {
				return;
			}

			var jar = {};
			// To prevent the for loop in the first place assign an empty array
			// in case there are no cookies at all.
			var cookies = document.cookie ? document.cookie.split('; ') : [];
			var i = 0;

			for (; i < cookies.length; i++) {
				var parts = cookies[i].split('=');
				var cookie = parts.slice(1).join('=');

				if (!json && cookie.charAt(0) === '"') {
					cookie = cookie.slice(1, -1);
				}

				try {
					var name = decode(parts[0]);
					cookie = (converter.read || converter)(cookie, name) ||
						decode(cookie);

					if (json) {
						try {
							cookie = JSON.parse(cookie);
						} catch (e) {}
					}

					jar[name] = cookie;

					if (key === name) {
						break;
					}
				} catch (e) {}
			}

			return key ? jar[key] : jar;
		}

		api.set = set;
		api.get = function (key) {
			return get(key, false /* read as raw */);
		};
		api.getJSON = function (key) {
			return get(key, true /* read as json */);
		};
		api.remove = function (key, attributes) {
			set(key, '', extend(attributes, {
				expires: -1
			}));
		};

		api.defaults = {};

		api.withConverter = init;

		return api;
	}

	return init(function () {});
}));

function getUserProfileServiceURL(){
	var currentURI = window.location.pathname;
	if(currentURI && ((currentURI.lastIndexOf("/us/en/secure", 0) === 0) || (currentURI.lastIndexOf("/content/ddpa/us/en/secure", 0) === 0))){
		return '/conf/ddpa/paths/secure/userProfileData.json';
	}else{
		return '/conf/ddpa/paths/userProfileData.json';
	}
}



function getI18nValue(label, defaultValue){

	if(typeof Granite !== 'undefined' && typeof Granite.I18n !== 'undefined' ){
		return Granite.I18n.get(label);
	}

	return defaultValue;
}

// Common ajax call for get request
var ajaxParams_default = {
	'url': null,
	'requestType': "GET",
	'dataType': 'json',
  'data': {},
	'beforeSendCallbackFunction': null,
  'successCallbackFunction': null,
  'completeCallbackFunction': null,
  'errorCallBackFunction': null,
  'className':''
};

var ajaxCall = function(ajaxParams) {
	let url = ajaxParams['url'];
	let requestType = ajaxParams['requestType'];
  let dataType = ajaxParams['dataType'];
    let contentType = ajaxParams['contentType'];
  let data = ajaxParams['data'];
  let className = ajaxParams['className'];
  let beforeSendCallbackFunction = ajaxParams['beforeSendCallbackFunction'];
  let successCallbackFunction = ajaxParams['successCallbackFunction'];
  let completeCallbackFunction = ajaxParams['completeCallbackFunction'];
  let errorCallBackFunction = ajaxParams['errorCallBackFunction'];
	var ajaxResponse = null;

$.ajax({
        url: url,
        crossDomain: true,
        type: requestType,
		contentType: contentType ? contentType : "application/json",
        dataType: dataType,
		data: data ? data : '',
				beforeSend: function(jqXHR, settings) {
          if (typeof beforeSendCallbackFunction === "function") {
          	beforeSendCallbackFunction();
          }
        },
        success: function(data, textStatus, jqXHR) {
					if (typeof successCallbackFunction === "function") {
          	successCallbackFunction(data,className);
          }
        },
				// success: successFunction,
        error: function(jqXHR, textStatus, errorThrown) {
        	if (typeof errorCallBackFunction === "function") {
            errorCallBackFunction(errorThrown);
          }
        },
        complete: function(jqXHR, textStatus) {
          if (typeof completeCallbackFunction === "function") {
            completeCallbackFunction();
          }
        }
    });
};

// Function to check if local storage is valid
function localStorageisValid(){
	if(localStorage && typeof localStorage == "object"){
		return true;
	}else{
		return false;
	}
}

var openWithPost = function(url, title, data) {
  $("#"+title+"").remove();
  var form = document.createElement("form");
  form.action = url;
  form.method = "POST";
  form.target = "_blank";
  //form.enctype = "multipart/form-data";
  form.contenttype = "application/json; charset=UTF-8";

  if (data) {

    //for ( var key in data) {
        var input = document.createElement('input');
        input.type = 'hidden';
        input.name = 'dentistResult';
        input.value = JSON.stringify(data);
        form.appendChild(input);
    //}
  }
  form.style.display = 'none';
  document.body.appendChild(form);
  form.submit();
};

// Create, read and remove cookies
var docCookies = {
  getItem: function (sKey) {
    if (!sKey) { return null; }
    return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=\\s*([^;]*).*$)|^.*$"), "$1")) || null;
  },
  setItem: function (sKey, sValue, vEnd, sPath, sDomain, bSecure) {
    if (!sKey || /^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)) { return false; }
    var sExpires = "";
    if (vEnd) {
      switch (vEnd.constructor) {
        case Number:
          sExpires = vEnd === Infinity ? "; expires=Fri, 31 Dec 9999 23:59:59 GMT" : "; max-age=" + vEnd;
          /*
          Note: Despite officially defined in RFC 6265, the use of `max-age` is not compatible with any
          version of Internet Explorer, Edge and some mobile browsers. Therefore passing a number to
          the end parameter might not work as expected. A possible solution might be to convert the the
          relative time to an absolute time. For instance, replacing the previous line with:
          */
          /*
          sExpires = vEnd === Infinity ? "; expires=Fri, 31 Dec 9999 23:59:59 GMT" : "; expires=" + (new Date(vEnd * 1e3 + Date.now())).toUTCString();
          */
          break;
        case String:
          sExpires = "; expires=" + vEnd;
          break;
        case Date:
          sExpires = "; expires=" + vEnd.toUTCString();
          break;
      }
    }
    document.cookie = encodeURIComponent(sKey) + "=" + encodeURIComponent(sValue) + sExpires + (sDomain ? "; domain=" + sDomain : "") + (sPath ? "; path=" + sPath : "") + (bSecure ? "; secure" : "");
    return true;
  },
  removeItem: function (sKey, sPath, sDomain) {
    if (!this.hasItem(sKey)) { return false; }
    document.cookie = encodeURIComponent(sKey) + "=; expires=Thu, 01 Jan 1970 00:00:00 GMT" + (sDomain ? "; domain=" + sDomain : "") + (sPath ? "; path=" + sPath : "");
    return true;
  },
  hasItem: function (sKey) {
    if (!sKey || /^(?:expires|max\-age|path|domain|secure)$/i.test(sKey)) { return false; }
    return (new RegExp("(?:^|;\\s*)" + encodeURIComponent(sKey).replace(/[\-\.\+\*]/g, "\\$&") + "\\s*\\=")).test(document.cookie);
  },
  keys: function () {
    var aKeys = document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g, "").split(/\s*(?:\=[^;]*)?;\s*/);
    for (var nLen = aKeys.length, nIdx = 0; nIdx < nLen; nIdx++) { aKeys[nIdx] = decodeURIComponent(aKeys[nIdx]); }
    return aKeys;
  }
};
/* This is for string matching of typeahed dropdowns */
var substringMatcher = function(strs) {
    return function findMatches(q, cb) {
      var matches;
      matches = [];
	  let stringPattern = new RegExp('^' + q, 'i');
      $.each(strs, function(i, str) {
        if (stringPattern.test(str)) {
          matches.push(str);
        }
      });
      cb(matches);
    };
};
var substringMatcherStates = function(states) {
    return function findMatches(q, cb) {
      var matches;
      matches = [];
	  let stringPattern = new RegExp( q, 'i');
      $.each(states, function(i, state ) {
              if (stringPattern.test(state.stateAbbreviation) || stringPattern.test(state.stateName)) {
                matches.push(  state.stateName);
              }
            });

      cb(matches);
    };
};
function isValidZipCode(zipcode){
	var pattern = new RegExp("^[0-9]{5}$");
	return pattern.test(zipcode);	
}

function isObject(arg){
	return typeof arg == "object" ? true : false;
}
function isString(arg){
	return typeof arg == "string" ? true : false;
}
function isNumber(arg){
	return typeof arg == "number" ? true : false;
}
function isBoolean(arg){
    return typeof arg == "boolean" ? true : false;
}
function textNotEmpty(arg){
    return (arg && arg.length > 0) ? true : false;
}
function windowSize() {
    return $(window).width();
}

$(function(){
	$(".columnctrl .row").each(function(){
		if($(this).hasClass('no-border')){
			$(this).removeClass('no-border').parent().addClass('no-border');
		}	
	});	

    $(".banner_trio_container_cards_card").click(function(){
        window.location = $(this).find("a").attr("href");
  		return false;
    });

});

// NB This function sorts the arrays before it checks the contents
// NB This function has only been tested on arrays of numbers and strings, which have a natural sort order
function arraysMatch(a, b) {
    if (a === b) return true;
    if (!a || !b) return false;
    if (a.length !== b.length) return false;

    // By default, sort() doesn't handle numbers well, but we don't care once the two arrays are sorted in the same manner
    // We only need to check the length of one array (as we know the sizes match by this point)
    if(a.length > 1) {
  	    a.sort();
  	    b.sort();
    }

    for (var i = 0; i < a.length; ++i) {
        if (a[i] !== b[i]) return false;
    }

    return true;
}

var costEstPrivateErrorMsg = getI18nValue('costEstPrivateErrorMsg', "Dentist not in network");
var costEstPPOCheaperWarningMsg = getI18nValue('costEstPPOCheaperWarningMsg', "A cheaper dentist may be available in PPO network");
var costEstProductUnsupportedErrorMsg = getI18nValue('costEstProductUnsupported', "Plan not supported");
var memberCompanyState, subscriberProdCode, dentistProdCode, costEstPhaseIIIPlan, selectedDentistCEIII, isInit = true,
    changePrompt = true;
$(function () {

  let loginInvalid = $("#loginErrorStatus").data('invalid');
  let loginAccountLocked = $("#loginErrorStatus").data('locked');
  let loginAccountLockedWarning = $("#loginErrorStatus").data('locked-warning');

  if (loginAccountLocked) {
    $(".account-locked").addClass('visible');
    $(".account-warning, .login-invalid").remove();
  } else if (loginAccountLockedWarning) {
    $(".account-warning").addClass('visible');
    $(".account-locked, .login-invalid").remove();
  } else if (loginInvalid) {
    $(".login-invalid").addClass('visible');
    $(".account-warning, .account-locked").remove();
  } else {
    $(".account-warning, .account-locked").remove();
  }

  let userInfoParams = $.extend({}, ajaxParams_default);
  userInfoParams['url'] = getUserProfileServiceURL();
  userInfoParams['successCallbackFunction'] = updatePostLogin;
  userInfoParams['errorCallBackFunction'] = profileAjaxFailed;
  ajaxCall(userInfoParams);

  $(".sign-out").on('click', function () {
    if (localStorageisValid()) {
      var hideReminder = localStorage.getItem("hideReminder");
      localStorage.clear();
      localStorage.setItem("hideReminder", hideReminder);
    }
    let logoutParams = $.extend({}, ajaxParams_default);
    logoutParams['requestType'] = 'POST';
    logoutParams['url'] = $(this).data('logout-aem').length > 0 ? $(this).data('logout-aem') + "?tm="
        + getTimeInMilliSecs() : '';
    logoutParams['beforeSendCallbackFunction'] = logoutSuccess;
    logoutParams['successCallbackFunction'] = logoutSuccess;
    logoutParams['errorCallBackFunction'] = logoutFailure;
    ajaxCall(logoutParams);

  });

  $('.username, .password').keyup(function (e) {
    if (e.which == 13) {
      $('.login-btn').trigger('click');
    }
  });

  $(".login-btn").on('click', function () {
    $("#loginform").submit();
  });

  /* Drop down functionality for RFP and Inquiry Page */
  ddpa.rfpPage = $('.proposalform').length > 0 ? true : false;
  ddpa.inquiryPage = $('.inquiryform').length > 0 ? true : false;

  if (ddpa.rfpPage || ddpa.inquiryPage) {
    $(".user-login-details .dropdown-toggle .caret.ddpa-caret-up").css("bottom", "14px");
    $(".user-login-details .dropdown-toggle").on("click", function () {
      $(this).parent().find(".dropdown-menu").toggle();
      $(this).find('span').toggle();
    });
  }

});

function updatePostLogin(data, className) {
  //Updating userProfile data in header and login components
  updateProfileData(data, className);
  //Updating user state data in subscriber links and subscriber overview components
  if ($('.subscriber-overview').length > 0 || $('.subscriber-links').length > 0) {
    updateUserState(data, className);
  }

}

function updateProfileData(data, className) {
  subscriberProdCode = data.productCode; //  get product code
  let userIsLoggedIn = false,
      fullname = '', firstName = '', userClass;
  if (typeof data != 'undefined' && data && typeof data == 'object') {
    if (data && data.authorizableId && data.authorizableId != 'anonymous') {
      userIsLoggedIn = true;
      fullname = (data.givenName != null) ? data.givenName + " " + data.familyName : "";
      firstName = (data.givenName != null) ? (data.givenName).toLowerCase() : "";
      memberCompanyState = data.state;
      if (firstName.indexOf(" ") != -1) {
        var index = firstName.indexOf(" ");
        firstName = firstName.substring(0, index);
      }
      if (data.userClass && data.userClass != '') {
        userClass = data.userClass;
      }

    }
  }

  $('.costestimator, .costestimator-section').each(function () {
    var wrap = $(this);
    var dentistShowFlag = $('input[name="estimatorType"]', wrap).val() ? $('input[name="estimatorType"]', wrap).val()
        : 'empty';
    if (dentistShowFlag) {
      if (userIsLoggedIn && ['01', '20', '25', '26'].indexOf(subscriberProdCode) >= 0) {
        $("[id$='ceType']", wrap).val("private");
      } else {
        wrap.find(".dentistLastName").hide();
      }
    }

  });

  // AB-549 : Medicare Advantage Dentist Directory Upgrade
  updateDentistSearch(data.productCode);
  if (userIsLoggedIn) {
    // AB-370
    $('.mobile-user-login-details-wrap').show();
    $(".topnavwithdropdown div.user-signout").each(function () {
      if ($(this).attr("id") == "ignore-user-login") {
        $(this).show();
      } else {
        $(this).hide();
      }
    });
    $('.topnavwithdropdown .user-login-details').each(function () {
      if ($(this).attr("id") == "ignore-user-login") {
        $(this).parent().hide();
      } else {
        $(this).parent().show();
      }
    });

    $('.mobile-wrapper .quick-nav .user-login-details-wrap').hide();
    // AB-549: Delete pre login message once user loggedin
    $(".dentist-search-message").remove();
    $(".dentist-search-desc").prop("style", "padding-bottom:32px");

    // AB-680: Delete pre login message from Cost Estimator widget
    $("#ceLoginLink").remove();

    subscriberProdCode = data.productCode; //  get product code
    /**Show hide appropriate sections of login component*/
    modifyLoginComponent(userClass);

    // AB-560 - Default claims form to subscribers logged in state
    $("#claimsDownloadInputState").val(data.state);

    if (firstName != null && firstName.length > 0) {
      $('.welcome-user .user-name').text(firstName);
    } else {
      fullname = fullname.toLowerCase();
      $('.welcome-user .user-name').text(fullname);
    }
    // AB-542 - Show cost estimator in dashboard only for 01,20,25&26
    if (document.URL.indexOf("/us/en/secure") > -1) {
      $('.costestimator-component-container').show();
    }
    /* Mobile view of login*/
    $('.mobile-nav-content .mob-user-logged-out').hide();
    if ($(".signin-link-component").attr("id") != "ignore-user-login") {
      $(".signin-link-component").addClass('user-logged');
      updateLoginDetails(fullname, firstName, userClass, memberCompanyState);
    }

    if (dentistProdCode) {
      dentistProdCode = dentistProdCode.split(",");

      $('.cePrivateErrorMsg').html('');

      // Subscriber has PPO + PPOPremier
      if (subscriberProdCode === '25' || subscriberProdCode === '26' ) {
        // if Dentist is  Premier only, they might get cheaper from PPO
        if (((dentistProdCode.indexOf("01") != -1) || (dentistProdCode.indexOf("1") != -1)) &&
            (dentistProdCode.indexOf("20") == -1) ){
          $('.cePrivateErrorMsg').html(costEstPPOCheaperWarningMsg);  // warn that they might get cheaper from PPO dentist
        }
      }
      // else subscriber is not ppoPlusPremier
      else if (dentistProdCode.indexOf(subscriberProdCode) == -1) {
          $('.cePrivateErrorMsg').html(costEstPrivateErrorMsg);
      }
    }

    if(["01", "20", "25", "26"].indexOf(subscriberProdCode) < 0 ){
      $('.cePrivateErrorMsg').html(costEstProductUnsupportedErrorMsg);
    }

    $('.topnavwithdropdown .user-not-logged-in').each(function () {
      if ($(this).attr("id") == "ignore-user-login") {
        $(this).show();
        $(this).parent().show();
      } else {
        $(this).hide();
        $(this).parent().hide();
      }
    });
  } else {
    if ($(".user-not-logged-in").attr("id") != "ignore-user-login") {
      $('.user-not-logged-in').show();
    }
    $('.login-component .create-account').show();
    $('.plans-wrapper').show();
    $('.mobile-nav-content .mob-user-logged-in').hide();
    //$(".signin-link-component").show();
    //AB -370
    $('.mobile-user-login-details-wrap').hide();
    $('.topnavwithdropdown .user-login-details-wrap').hide();
    $('.topnavwithdropdown .user-not-logged-in').show();
  }
  //AB-370
  $('.topnavwithdropdown .plans-wrapper').show();

  getStateListJson();
  let memberLocatorParams = $.extend({}, ajaxParams_default);
  memberLocatorParams['url'] = textNotEmpty(stateListJsonPath) ? stateListJsonPath
      : '/content/ddpa/us/en/data/plandata/_jcr_content.plans.json';
  memberLocatorParams['successCallbackFunction'] = getPlanDataJsonResult;
  //memberLocatorParams['errorCallBackFunction'] = memberLocatorAjaxFailed;
  ajaxCall(memberLocatorParams);
}

function getPlanDataJsonResult(data, className) {
  planDataResult = data;

  for (var i = 0; i < data.stateDetails.length; i++) {
    if (data.stateDetails[i].stateAbbreviation === memberCompanyState) {
      console.log("plan state abbrv ::: " + data.stateDetails[i].stateAbbreviation);
      console.log("useCostEstPhaseIII :::: " + data.stateDetails[i].useCostEstPhaseIII);
      costEstPhaseIIIPlan = data.stateDetails[i].useCostEstPhaseIII;
      if (costEstPhaseIIIPlan === "true") {
        selectedDentistCEIII = true;
      }
    }
  }
  console.log("costEstPhaseIIIPlan::: " + costEstPhaseIIIPlan);

}

function modifyLoginComponent(userClass) {
  var userTypeWithDDPA = userClassWithDDPA(userClass);
  if (userTypeWithDDPA) {
    enableLoginComponentUserLinks(userTypeWithDDPA);
    $('.header .' + userTypeWithDDPA).show();
    $('.mobile-user-login-details-wrap .' + userTypeWithDDPA).show();
  } else {
    enableLoginComponentUserLinks(userClass);
    $('.header .' + userClass).show();
    $('.mobile-user-login-details-wrap .' + userClass).show();
  }

  $('.login-component .create-account').hide();
  $('.plans-wrapper').hide();
}

// AB-549 Medicare Advantage Dentist Directory Upgrade
function updateDentistSearch(productCode) {
  if (productCode == "60") {
    $(".participation-dropdown-container[id$='general']").remove();
    $(".participation-dropdown-wrapper[id$='general']").remove();
    $(".participation-dropdown-container[id$='medadv']").show();
    $(".participation-dropdown-wrapper[id$='medadv']").show();
  } else {
    $(".participation-dropdown-container[id$='general']").show();
    $(".participation-dropdown-wrapper[id$='general']").show();
    $(".participation-dropdown-container[id$='medadv']").remove();
    $(".participation-dropdown-wrapper[id$='medadv']").remove();
  }
}

function enableLoginComponentUserLinks(userClass) {
  if (userClass && $('.login-component .' + userClass) && $('.login-component .' + userClass).length === 0) {
    $('.login-component .' + userClass).hide();
    $('.login-component ').hide();
  } else {
    $('.user-logged-in').show();
    $('.user-logged-in .' + userClass).show();
    $('.user-logged-in .sign-out-link').show();
  }
}

function userClassWithDDPA(userClass) {
  if ("subscriber" === userClass.toLowerCase()) {
    return "ddpaSubscriber";
  } else if ("provider" === userClass.toLowerCase()) {
    return "ddpaProvider";
  }
  return;
}

function profileAjaxFailed() {
}

function updateLoginDetails(fullname, firstName, userClass, state) {
  // if WA member change edit profile and change password links to confirmation page.
  if ("WA" === state && "subscriber" === userClass) {

    if (window.location.hostname.indexOf("stage") > -1) {
      $(".user-login-details .change-password").attr("href",
          "https://uat.deltadentalwa.com/private/patient/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://uat.deltadentalwa.com/private/patient/my-account?s=ddpa");
    } else {
      $(".user-login-details .change-password").attr("href",
          "https://www.deltadentalwa.com/private/patient/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://www.deltadentalwa.com/private/patient/my-account?s=ddpa");
    }
  }
  if ("NJ" === state && "subscriber" === userClass) {

    if (window.location.hostname.indexOf("stage") > -1) {
      $(".user-login-details .change-password").attr("href",
          "https://uat.deltadentalnj.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://uat.deltadentalnj.com/private/member/my-account?s=ddpa");
    } else {
      $(".user-login-details .change-password").attr("href",
          "https://www.deltadentalnj.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://www.deltadentalnj.com/private/member/my-account?s=ddpa");
    }
  }
  if ("CT" === state && "subscriber" === userClass) {

    if (window.location.hostname.indexOf("stage") > -1) {
      $(".user-login-details .change-password").attr("href",
          "https://uat.deltadentalct.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://uat.deltadentalct.com/private/member/my-account?s=ddpa");
    } else {
      $(".user-login-details .change-password").attr("href",
          "https://www.deltadentalct.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://www.deltadentalct.com/private/member/my-account?s=ddpa");
    }
  }
  if ("MA" === state && "subscriber" === userClass) {
      $(".user-login-details .change-password").attr("href",
          "https://connectsso-test.deltadentalma.com/iam/im/ddmaself/ui7/index.jsp?task.tag=DDMAForgottenPasswordReset&task.RedirectURL=[https://connectsso-test.deltadentalma.com/member/index.html]");
      $(".user-login-details .edit-profile").attr("href",
          "https://deltadentalma.com/members/login");
  }
  if ("MA" === state && "provider" === userClass) {

    if (window.location.hostname.indexOf("stage") > -1) {
      $(".user-login-details .change-password").attr("href",
          "https://connectsso-test.deltadentalma.com/iam/im/ddmaself/ui7/index.jsp?task.tag=DDMAForgottenPasswordReset&task.RedirectURL=[http://connectsso-test.deltadentalma.com/affwebservices/public/saml2sso?SPID=aldera]");
      $(".user-login-details .edit-profile").attr("href",
          "https://connectsso-test.deltadentalma.com/iam/im/ddmaself/ui7/index.jsp?task.tag=DDMAForgottenPasswordReset&task.RedirectURL=[http://connectsso-test.deltadentalma.com/affwebservices/public/saml2sso?SPID=aldera]");
    }else{
      $(".user-login-details .change-password").attr("href",
          "https://production.deltadental.auth0.com/samlp/u0ef7ekDG84W5VgAG1gnXdemtTsfuCEC?connection=Radiant-Logic-Production");
      $(".user-login-details .edit-profile").attr("href",
          "https://production.deltadental.auth0.com/samlp/u0ef7ekDG84W5VgAG1gnXdemtTsfuCEC?connection=Radiant-Logic-Production");
    }
  }
  if(("WC" === state || "CL" === state || "NS" === state || "NL" === state || "NN" === state) && "subscriber" === userClass){
    if(window.location.hostname.indexOf("stage") > -1){
      $(".user-login-details .change-password").attr("href",
          "https://uat.deltadentalcoversme.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://uat.deltadentalcoversme.com/private/member/my-account?s=ddpa");
    } else {
      $(".user-login-details .change-password").attr("href",
          "https://my.deltadentalcoversme.com/private/member/my-account/manage-password-and-security/manage-password?s=ddpa");
      $(".user-login-details .edit-profile").attr("href",
          "https://my.deltadentalcoversme.com/private/member/my-account?s=ddpa");
    }
  }

  $(".user-login-details .login-user-name").text(fullname);
  $('.mobile-nav-content .my-account span.user-name').text(fullname);
  //AB-370 - commenting below line
  $(".user-login-details").show();

  //AB-370
  $(".topnavwithdropdown .user-login-details .login-user-name").text('Hello, ' + fullname);

}

function logoutFailure() {
  /*Logout error */
}

function logoutSuccess(data, className) {
  var pathToRedirect = $(".sign-out").data('logout-url');
  if (pathToRedirect != null && pathToRedirect.length > 0) {
    window.open(pathToRedirect, '_self');
  }
}

function getTimeInMilliSecs() {
  var date = new Date();
  var timeInMilliSecs = date.getTime();
  return timeInMilliSecs;
}



var focusAddition = '.close_panel, .nav-list .drop';
var focusElements = 'a[href]:not([disabled]):not(.inactive-btn), button:not([disabled]):not(.inactive-btn), input:not([disabled]):not(.inactive-btn), select:not([disabled]):not(.usa-select), textarea:not([disabled]), iframe, ' + focusAddition;
var KEYCODE_TAB = 9;
let TREATMENTS_LIST_STORAGE_KEY = "treatmentSet";

$(document).ready(() => {
    /**
     * Remove body.stickyAdjust when header is hidden.
     * This is done to optimize display for the mobile-app.
     */
    var observer = new MutationObserver(headerDisplayTrigger);

    observer.observe(document.getElementsByClassName('headerIPar')[0], {
        attributes: true,
        attributeFilter: ['style'],
    });

    function headerDisplayTrigger(mutations) {
        var newDisplay = mutations[0].target.style.display;

        if (newDisplay === "none") {
            document.body.classList.remove('stickyAdjust');
        } else {
            if (!document.body.classList.contains('stickyAdjust')) {
                document.body.classList.add('stickyAdjust');
            }
        }
    }
});


$(document).ready(function () {
    var doc = document.documentElement;
    doc.setAttribute('data-useragent', navigator.userAgent);

    var containerWidth = $('.herobanner').closest('.col-lg-12').width();
    if (!containerWidth) {
        containerWidth = $('.herobanner').parent().width();
    }

    $(window).resize(function () {
        /* Set hero banner for full width */
        containerWidth = $('.herobanner').closest('.col-lg-12').width();
        if (!containerWidth) {
            containerWidth = $('.herobanner').parent().width();
        }
        if ($(".mobile-nav-content-wrapper").css("display") == "none" || typeof ($(".mobile-nav-content-wrapper").css("display")) == 'undefined') {
            $(".overlay").hide();
        } else {
            $(".overlay").show();
        }
        if ($(window).width() < 990) {
            $(".secondary-navlogo").show();
        }
        if ($(window).width() > 767) {
            $(".nav-list, .category-tabs").show();
            $(".toggle-nav").addClass("glyphicon-menu-up").removeClass("glyphicon-menu-down");
            $(".mobile-nav-content-wrapper").slideUp();
            if ($('.category-arrow').hasClass('glyphicon-triangle-top')) {
                $('.category-arrow').addClass('glyphicon-triangle-bottom').removeClass('glyphicon-triangle-top');
            }
            if (window.matchMedia('(min-width: 991px)').matches && $('.secondary-navbar').length) {
                if ($(window).scrollTop() > $('.secondary-navbar').offset().top) {
                    $('.secondary-navlogo').show();
                } else {
                    $('.secondary-navlogo').hide();
                }
            }
        } else {
            $(".toggle-nav").addClass("glyphicon-menu-down").removeClass("glyphicon-menu-up");
            $(".secondary-navlogo").show();
            $(".category-tabs").hide();
            if ($('.category-arrow').hasClass('glyphicon-triangle-top')) {
                $('.category-arrow').addClass('glyphicon-triangle-bottom').removeClass('glyphicon-triangle-top');
            }
        }
    });

    $(".toggle-search").click(function () {
        $(this).find('span').toggleClass('glyphicon-remove');
        $(".mobile-nav-content-wrapper").slideUp();
        $(".mobile-search-bar").slideToggle();
    });

    $(".toggle-hamburger").click(function () {
        $(".mobile-search-bar").slideUp();
        $(".mobile-nav-content-wrapper").slideToggle('fast', hideOverlay);
    });

    $(".overlay").click(function () {
        $(".toggle-hamburger").trigger('click');
    });

    $('.submit-btn, .redirect-link').on('click', function (e) {
        if ($(this).hasClass('inactive-btn')) {
            e.preventDefault();
            return false;
        }
    });

    var browserURL = window.location.href;

    if (!browserURL.lastIndexOf('/', browserURL.length - 1) === browserURL.length - 1) {
        if (sessionStorage.getItem("userSelectedMenu")) {
            sessionStorage.removeItem("userSelectedMenu");
        }
    }

    var getSelectedMenu = "";
    if (sessionStorage.getItem("userSelectedMenu")) {
        getSelectedMenu = sessionStorage.getItem("userSelectedMenu");
    } else {
        if (!browserURL.lastIndexOf('/', browserURL.length - 1) === browserURL.length - 1) {
            $('.audience-list li a').each(function (i) {
                if ($(this).attr("target-list") != "audience-list") {
                    var menuUrl = $(this).attr("href");
                    menuUrl = menuUrl.replace(".html", "");
                    if (browserURL.indexOf(menuUrl) > -1) {
                        getSelectedMenu = $(this).attr("target-list");
                    }
                }
            });
        }
    }

    /* Show menu on load */
    showSubmenu(getSelectedMenu);

    if (!getSelectedMenu || getSelectedMenu === '') {
        $('.find-dental-dropdown-content p.description, .mobile-finddentallink').hide();
        $('.find-dental-dropdown-content p.description.selected-homepage, .mobile-finddentallink.selected-homepage, .find-dental-dropdown-content.post-details p.description').show();
    }

    $(".audience-list li a").on("click", function (e) {
        if ($(this).attr('data-audiencechangetext').trim() != "") {
            e.preventDefault();
            var attributVal = $(this).attr('target-list');
            var parentListItem = $(this).closest(".audience-list >li");
            sessionStorage.setItem("userSelectedMenu", parentListItem.children('a').attr('target-list'));
            if (parentListItem.children("a[target-list='" + attributVal + "']").attr('href')) {
                location.href = parentListItem.children("a[target-list='" + attributVal + "']").attr('href');
            }
            parentListItem.children("a[target-list='" + attributVal + "']").add($(".audience-list li")).hide();
            $("." + attributVal).fadeIn();
            $("." + attributVal + " li").add(parentListItem).show();
        } else {
            sessionStorage.removeItem("userSelectedMenu");
        }
    });


    var displayMenu = $(".current-nav-page a").attr("target-list");
    $(".find-dental-dropdown-content p.description, .mobile-content-list li.mobile-finddentallink").hide();
    if (displayMenu) {
        $(".find-dental-dropdown-content p.description." + displayMenu).show();
        $(".mobile-content-list li.current-nav-page, .mobile-content-list li." + displayMenu + " a").show();
    } else {
        $('.find-dental-dropdown-content p.description, .mobile-finddentallink').hide();
        $('.find-dental-dropdown-content p.description.selected-homepage, .mobile-finddentallink.selected-homepage, .find-dental-dropdown-content.post-details p.description').show();
    }


    $(".selected-audience-list li a").on("click", function () {
        var attributVal = $(this).attr('target-list');
        var parentListItem = $(this).closest(".audience-list >li").find("a");
        var parentElement = $(this).closest(".selected-audience-list").hasClass('selected-expanded');
        if (parentElement) {
            $('.header-member-company-default').hide();
            $('.header-member-company-variation').show();
        } else {
            $('.header-member-company-variation').hide();
            $('.header-member-company-default').show();
        }
        $(".selected-audience-list").hide();
        $("." + attributVal).fadeIn();
        parentListItem.show();
        $("." + getSelectedMenu + "-submenu, .selected-audience-mobilemenu ul:first-child").show();
    });


    /* Search Implementation */
    var searchResultsPageURL = $("#search-results-page").val();
    var searchTerm = "";
    $(".btn-search").on("click", function () {
        searchTerm = $(".search-query").val();
        executeSearchQuery(searchResultsPageURL, searchTerm);
    });

    $(".search-query").on("keypress", function (e) {
        if (e.which == 13 || e.which == 9) {
            searchTerm = $(this).val();
            executeSearchQuery(searchResultsPageURL, searchTerm);
        }
    });

    $(".mobile-btn-search").on("click", function () {
        searchTerm = $(".mobile-search-query").val();
        executeSearchQuery(searchResultsPageURL, searchTerm);
    });

    $(".mobile-search-query").on("keypress", function (e) {
        if (e.which == 13 || e.which == 9) {
            searchTerm = $(this).val();
            executeSearchQuery(searchResultsPageURL, searchTerm);
        }
    });

    categorySelectorMobile();
    checkDependentLogin();

    $('[data-addtosection]').each(function () {
        var elem = $(this);

        elem.parents('.section').first().addClass(elem.attr('data-addtosection'));

        elem.removeAttr('data-addtosection');
    });

    var langHeader = $('.lang-select');

    if (langHeader.length) {

        var grinUrl = window.location.href;
        var langid = document.getElementsByClassName("lang-select")[0].children[1].id;
        var langloc = '/' + langid + '/';
        var langTest = grinUrl.includes(langloc);
        var langdom = 'li#' + langid;
        var newGrinUrl;

        if (langTest == true) {
            $(langdom).addClass('active');
            $('li#en').removeClass('active');
            $(langdom).children().attr('href', grinUrl);
            newGrinUrl = grinUrl.replace(langloc, '/');
            $('li#en').children().attr('href', newGrinUrl);


        } else {
            $('li#en').addClass('active');
            $(langdom).removeClass('active');
            $('li#en').children().attr('href', grinUrl);
            if (grinUrl.includes(".com/grin/")) {
                newGrinUrl = grinUrl.replace('.com/grin/', '.com/grin' + langloc);
            } else {
                newGrinUrl = grinUrl.replace('.com/', '.com' + langloc);
            }
            $(langdom).children().attr('href', newGrinUrl);

        }

    }
});

function checkDependentLogin() {
    var checkDependentLoginParams = $.extend({}, ajaxParams_default);
    checkDependentLoginParams.url = '/conf/ddpa/paths/checkDependentLogin.json';
    checkDependentLoginParams.successCallbackFunction = callHandleDependent;
    checkDependentLoginParams.errorCallBackFunction = null;
    checkDependentLoginParams.className = 'is-dependent';
    ajaxCall(checkDependentLoginParams);
}

function callHandleDependent(data)  {
    handleDependent(data, 0, 6);
}

function handleDependent(data, attempt, maxAttempts) {
    let claimDependentForm = $("#claim-dependent-details");
    let benefitsDependentForm = $("#benefit-dependent-details");

    if ((claimDependentForm && benefitsDependentForm) || attempt >= maxAttempts) {
        if (data.isDependent) {
            claimDependentForm.empty();
            benefitsDependentForm.empty();
        }
        return;
    }
    setTimeout(() => {
        handleDependent(data, attempt++, maxAttempts)
    }, 500);
}

fixNavbar = function (secondaryNavTop) {
    var isScrolling = $(window).scrollTop() > secondaryNavTop;
    if (isScrolling) {
        $(".move-down").hide();
        $('.secondary-navbar').addClass('sticky-navbar');
        if (windowSize() > 991) {
            $('.secondary-navlogo').show();
        }
    } else {
        $('.secondary-navbar').removeClass('sticky-navbar');
        if (windowSize() > 991) {
            $('.secondary-navlogo, .mobile-search-bar').hide();

            $('.toggle-search span').removeClass('glyphicon-remove');
        } else {
            $('.secondary-navlogo').show();
        }
    }

    if ($('.notification-bar').length && $('.notification-bar').hasClass('inView')) {
        $('.secondary-navbar').css("margin-top", isScrolling ? $('.notification-bar').outerHeight() : 0);
    }
};

/* * 
 * showSubmenu
 * Show sub menu on load
 */
var showSubmenu = function (previousSelectedMenu) {
    var selectedMenu = previousSelectedMenu;
    var href = document.location.href;
    var lastPathSegment = href.substr(href.lastIndexOf('/') + 1);
    $(".selected-audience-menu ul, .selected-audience-mobilemenu ul").hide();
    if ((selectedMenu === "") || (location.href === location.origin + "/") || (lastPathSegment === 'homepage.html')) {
        $(".selected-audience-list, .links-list").hide();
        $(".audience-list > li, .signin-link-component, .header-member-company-default").show();
        $('.find-dental-dropdown-content p.description, .mobile-finddentallink').hide();
        $('.find-dental-dropdown-content p.description bold selected-homepage, .mobile-finddentallink.selected-homepage, .find-dental-dropdown-content.post-details p.description').show();
        if ($('.header-member-company-variation').hasClass('selected-homepage-general')) {
            $('.header-member-company-variation').hide();
            $('.header-member-company-default').show();
        } else {
            $('.header-member-company-default').hide();
            $('.header-member-company-variation').show();
        }
    } else {
        $(".audience-list > li").hide();
        $("." + selectedMenu + "-submenu, .links-list").show();
        $("." + selectedMenu).closest("li").show().addClass('current-nav-page');
        $("." + selectedMenu).closest("li").children("a").hide();
        if ($(".current-nav-page > a").data('signin')) {
            if (!$('.signin-link-component').hasClass('user-logged')) {
                $('.signin-link-component').show();
            } else {
                $('.signin-link-component').hide();
            }
        } else {
            $('.signin-link-component').hide();
        }
        if ($('.current-nav-page > ul').hasClass('selected-expanded') || !$('.current-nav-page').is(':visible')) {
            $('.header-member-company-default').hide();
            $('.header-member-company-variation').show();
        } else {
            $('.header-member-company-default').show();
            $('.header-member-company-variation').hide();
        }
    }
    $(document).on('click', '.logo a, .secondary-navlogo a', function () {
        sessionStorage.removeItem("userSelectedMenu");
    });
};

/* Email validation */
var validateEmail = function (emailId) {
    var pattern = /\s*\w+@[^\.]+\.[^\.]+(\.[^\.])*\s*/;
    if (!pattern.test(emailId)) {
        return false;
    }
    return true;
};

/* Remove the spaces from the entered and generated code */
var removeSpaces = function (string) {
    return string.split(' ').join('');
};

/* Category selector tab functionality */
var categorySelectorMobile = function () {
    $('.category-selected-tab-mobile').on('click', function () {
        toggleCategoryTabMobile();
    });
    $('.category-tabs li').on('click', function () {
        $('.category-title-selected').html($(this).children("a").text());
        toggleCategoryTabMobile();
    });
};


function executeSearchQuery(searchResultsPageURL, searchTerm) {
    window.open(searchResultsPageURL + "/?s=" + searchTerm, "_self");
}

function toggleCategoryTabMobile() {
    if ($(window).width() < 767) {
        $('.nav-tabs').toggle();
        $('.category-arrow').toggleClass('glyphicon-triangle-bottom glyphicon-triangle-top');
    }
}

var hideOverlay = function () {
    if ($(".overlay").css("display") == "none") {
        $(".overlay").show();
        $('body').css("position", "fixed");
    } else {
        $(".overlay").hide();
        $('body').css("position", "");
    }
};

window.onload = function (e) {
/* Get initial top offset of the secondary navigation */
    var secondaryNavTop = 75;
    if ($('.secondary-navbar').length > 0) {
        secondaryNavTop = $('.secondary-navbar').offset().top;
    }
    fixNavbar(secondaryNavTop);
    $(window).scroll(function () {
        fixNavbar(secondaryNavTop);
    });
};

$(document).ready(function () {
    $('.section > .new').each(function () {
        var elem = $(this);
        if (!elem.children().length) elem.parent().remove();
    });

    $('.coverimageforplayer').on('click', function () {
        var element = $(this);
        var videoSRC = element.attr('data-videoSRC');
        var iframe = '<div class="videoWrapper"><iframe src="' + videoSRC + '" frameborder="0" allowfullscreen class="video-player"></iframe></div>';
        element.html(iframe);
    });
    matchBtnWidth();
    $(window).on({'load': matchBtnWidth, 'resize': matchBtnWidth});
});

/**
 * Buttons inside an "equal height" row will force matching widths
 */
function matchBtnWidth() {
    $('#content-component-wrapper > div').each(function () {
        var elem = $(this),
            btns = elem.find('a[class*="btn"], button[class*="btn"], input[class*="btn"], .button-component'),
            maxW = 0;

        btns
            .each(function () {
                var elm = $(this).css('width', 'auto'),
                    elmW = Math.ceil(elm[0].getBoundingClientRect().width);

                if (elmW > maxW) maxW = elmW;
            })
            .outerWidth(maxW);
    });
}
$(document).ready(function() {
// Claims Forms download

     var validateClaimState = false;
     var claimsRedirectionURL ='';

});
/*  AB-560:Default claims form to subscribers logged in state
Uncomment below code to download claim forms for all the states
// drop down creation
function claimFormDropdownLocator(data,className){

    let states = [];
    let jsonRes = data;
    let statesAbbr = [];

    if(jsonRes && jsonRes.stateDetails.length > 0 && typeof jsonRes == "object"){
 		$.each(jsonRes.stateDetails,function(key,state){
        	states.push(state.stateName);
			statesAbbr.push(state.stateAbbreviation);
   		});

    }
    // Bind the type ahead function using plugin
	if($('.claimDownloadInput').length > 0){

    $('.claimDownloadInput').each(function(){
       var currentElem = $(this);

		   $(this).typeahead({
				hint: false,
				highlight: true,
				minLength: 1
			},
			{
				name: 'states',
				source: substringMatcher(states)
			}).on('keyup', function(e){
          var keyCode = e.keyCode || e.which;
          var totalSuggestions = $(this).parent().find('.tt-dataset-states .tt-suggestion').length;
          if(totalSuggestions == 1){
                   if(keyCode == 13 || keyCode == 9){
                        $(this).parent().find('.tt-dataset-states .tt-suggestion').first().addClass('tt-cursor').click();
                        $(this).typeahead('close');
                   }
          }
			});

			$(this).bind('typeahead:select', function(ev, selectedState) {

				 $.each(jsonRes.stateDetails,function(key,state){
                   if(selectedState == state.stateName){
                       var claimDownloadInputValue = state.stateAbbreviation;
                       let claimsDownloadParams = $.extend({}, ajaxParams_default);
               		     claimsDownloadParams['url'] = '/conf/ddpa/paths/claimsForms.json?selectedState='+claimDownloadInputValue;
                       claimsDownloadParams['successCallbackFunction'] = getClaimsDownloadForm;
                       claimsDownloadParams['errorCallBackFunction'] = claimsDownloadFail;
                       claimsDownloadParams['dataType'] = "text";
                       ajaxCall(claimsDownloadParams);

                       $('.validatestate').addClass('hide');
                   }
               });
			 });

       });

 }
$('.download-claims-btn').on('click',function(){
		 validateClaimState= false;

        $.each(jsonRes.stateDetails,function(key,state){
            if($('#claimsDownloadInput').val() == state.stateName){
            			 validateClaimState= true;

                 $('.validatestate').addClass('hide');
                if($('#claimsDownloadInput').val().length>0 && claimsRedirectionURL.length>0){
                        window.open(claimsRedirectionURL, '_blank');
              }


            }
        });
        if(!validateClaimState){
            $('.validatestate').removeClass('hide');
            $('.validateavailablestate').addClass('hide');

        }

      });




}
function getClaimsDownloadForm(claimsData) {
    if(claimsData.length > 0 ) {
  		claimsRedirectionURL = claimsData;
        $('.validateavailablestate').addClass('hide');
    }
    else {
        claimsRedirectionURL = '';

         $('.validateavailablestate').removeClass('hide');
         $('.validatestate').addClass('hide');
    }
}

function claimsDownloadFail() {

}

*/

// AB-560:Default claims form to subscribers logged in state
function claimFormDropdownLocator() {
	$('.download-claims-btn').on('click',function(){
	    let claimsDownloadParams = $.extend({}, ajaxParams_default);
	    claimsDownloadParams['url'] = '/conf/ddpa/paths/claimsForms.json?selectedState='+$("#claimsDownloadInputState").val();
	    claimsDownloadParams['successCallbackFunction'] = getClaimsDownloadForm;
	    claimsDownloadParams['errorCallBackFunction'] = claimsDownloadFail;
	    claimsDownloadParams['dataType'] = "text";
	    ajaxCall(claimsDownloadParams);
	});
}

function getClaimsDownloadForm(claimsData) {
    if(claimsData.length > 0 ) {
  		claimsRedirectionURL = claimsData;
        if($('#claimsDownloadInput').val().length>0 && getClaimsDownloadForm.length>0){
       	 window.open(claimsRedirectionURL, '_blank');
    	}
    }
}

function claimsDownloadFail() {
}

$(document).ready(function() {

    // scroll content on selecting category tab ( where all tabs are shown)
    $(".category-scroll-tab").on('click', function() {
      let targetTabContent = $(this).attr('href');
      let scrollTabPos;
      if(windowSize() > 990) {
        scrollTabPos = $(targetTabContent).offset().top - 100
      } else if(windowSize() > 767 && windowSize() < 991) {
        scrollTabPos = $(targetTabContent).offset().top - 80
      } else {
        scrollTabPos = $(targetTabContent).offset().top - 380
      }
      $('html, body').animate({
        scrollTop: scrollTabPos
      }, 1500);
    });

    var anchor =  window.location.hash.slice(1);
    var activeTab = $("ul.category-tabs > li > a[href='#"  + anchor + "']");
    activeTab && activeTab.click();


    //detect hash change
    $(window).bind('hashchange', function (e) {
        var anchor =  window.location.hash.slice(1);
        var activeTab = $("ul.category-tabs > li > a[href='#"  + anchor + "']");
        activeTab && activeTab.click();
     });


    // single tab shown only
    $("ul.category-tabs > li").on('click', function(e) {
       let targetTabContent = $(this).find('a').attr('href');
       $(this).parent('ul.category-tabs').find('li.active').removeClass('active');
       $(this).addClass('active');
       $(targetTabContent).parent('.tab-content').find('.tab-pane.active').removeClass('active').removeClass('in').fadeOut();
       $(targetTabContent).addClass('active').addClass('in').fadeIn();

      // if you directly assign the url, then bad things happen. Use this indirect trick.
       if(window.history.pushState) {
           window.history.pushState(null, null,  targetTabContent);
       }
       else {
           window.location.hash =  targetTabContent;
       }
       return false;
     });


});


var bneQueryString = '';
var claimsQueryString = '';

var claimsNumber = getI18nValue('claimsNumber', "Claim Number");
var claimsDateOfService = getI18nValue('claimsDateOfService', "Date of Service");
var claimsStatus = getI18nValue('claimsStatus', "Status");
var claimsDatePaid = getI18nValue('claimsDatePaid', "Date Paid");
var claimsAmountSubmitted = getI18nValue('claimsAmountSubmitted', "Amount Submitted");
var claimsAmountPaid = getI18nValue('claimsAmountPaid', "Amount Paid");
var claimsView = getI18nValue('claimsView', "View");

var claimsGroupName = getI18nValue('claimsGroupName', "Group Name");
var claimsGroupFirstName = getI18nValue('claimsGroupFirstName', "First Name");
var claimsGroupLastName = getI18nValue('claimsGroupLastName', "Last Name");

var benefitsGroupName = getI18nValue('benefitsGroupName', "Group Name");
var benefitsGroupFirstName = getI18nValue('benefitsGroupFirstName', "First Name");
var benefitsGroupLastName = getI18nValue('benefitsGroupLastName', "Last Name");

let timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;

$(function () {

    $("#bne-false").prop("checked", true);
    $("#claims-false").prop("checked", true);
    var start = moment().subtract(3, 'month').format('MM/DD/YYYY');
    var end = moment().format('MM/DD/YYYY');
    var claimdate = moment().subtract(18, 'month').format('MM/DD/YYYY');
    claimdate = claimdate + ".";
    $('.date-range-info').append(claimdate);

    $('input[name="daterange"]').daterangepicker({

        startDate: start,
        endDate: end,
        minDate: claimdate,
        maxDate: end
    });

    $('input[name="birthdate"]').daterangepicker({
        singleDatePicker: true,
        locale: {
            format: 'MM/DD/YYYY',
            cancelLabel: 'Clear'
        },
        autoUpdateInput: false
    });
    $('input[name="birthdate"]').on('apply.daterangepicker', function (ev, picker) {
        $(this).val(picker.startDate.format('MM/DD/YYYY'));
    });

    $('input[name="birthdate"]').on('cancel.daterangepicker', function (ev, picker) {
        $(this).val('');
    });
    $('input[name="daterange"]').on('apply.daterangepicker', function (ev, picker) {
        $(this).val(picker.startDate.format('MM/DD/YYYY') + ' - ' + picker.endDate.format('MM/DD/YYYY'));
    });

    $('input[name="daterange"]').on('cancel.daterangepicker', function (ev, picker) {
        //$(this).val('');
    });

    $('input[type="radio"].bneCheck').click(function () {
        if ($('input[name="bneCheck"]:checked').val() == "true") {
            $('.show-extra').removeClass('hide');
            $('.required-bnestatement').removeClass('hide');
        } else {
            $('.show-extra').addClass('hide');
            $('.dependentfirstname').val("");
            $('.dependentlastname').val("");
            $('.dependentdob').val("");
            $('.required-bnestatement').addClass('hide');
        }
    });

    $('input[type="radio"].claimCheck').click(function () {
        if ($('input[name="claimCheck"]:checked').val() == "true") {
            $('.show-extra-claim').removeClass('hide');
            $('.required-claimstatement').removeClass('hide');
        } else {
            $('.show-extra-claim').addClass('hide');
            $('.claimdependentfirstname').val("");
            $('.claimdependentlastname').val("");
            $('.claimdependentdob').val("");
            $('.required-claimstatement').addClass('hide');
        }
    });

    $(".print-bne-result").on("click", function () {
        var bnePrintPage = $(this).data("printpage");
        if (bnePrintPage.length > 0) {
            window.open(bnePrintPage, "_self");
        }

    });
    $(".print-claims-result").on("click", function () {
        var claimsPrintPage = $(this).data("printpage");
        if (claimsPrintPage.length > 0) {
            window.open(claimsPrintPage, "_self");
        }
    });

    $(document).on('click', '.retrieve-benefits-button', function (e) {
        e.preventDefault();
        var validateFlagCapture = false;
        if ($('input[name="bneCheck"]:checked').val() == "true") {
            validateFlagCapture = validatebne();
        }
        if (!validateFlagCapture) {
            var bneDashboardParams = '';
            let dependentFlag = $('input[type="radio"].dependent-flag:checked').val() && $('input[type="radio"].dependent-flag:checked').val().length > 0 ? $('input[type="radio"].dependent-flag:checked').val() + '##' : 'empty##';
            let dependentFirstName = $('.dependentfirstname').val() && $('.dependentfirstname').val().length > 0 ? $('.dependentfirstname').val() + '##' : 'empty##';
            let dependentLastName = $('.dependentlastname').val() && $('.dependentlastname').val().length > 0 ? $('.dependentlastname').val() + '##' : 'empty##';
            let dependentDateOfBirth = $('.dependentdob').val() && $('.dependentdob').val().length > 0 ? $('.dependentdob').val() + '##' : 'empty##';
            bneDashboardParams = dependentFlag + dependentFirstName + dependentLastName + dependentDateOfBirth;
            localStorage.setItem('bneDashboardParams', bneDashboardParams);


            window.open(bneURL, "_self");
        }

    });

    $(document).on('click', '.retrieve-claims-btn', function (e) {
        e.preventDefault();
        var validateFlagCapture = false;
        if ($('input[name="claimCheck"]:checked').val() == "true") {
            validateFlagCapture = validateClaims();
        }
        if (!validateFlagCapture) {
            var claimsDashboardParams = '';
            let dependentFlag = $('input[type="radio"].claimCheck:checked').val() && $('input[type="radio"].claimCheck:checked').val().length > 0 ? $('input[type="radio"].claimCheck:checked').val() + '##' : 'empty##';
            let dependentFirstName = $('.claimdependentfirstname').val() && $('.claimdependentfirstname').val().length > 0 ? $('.claimdependentfirstname').val() + '##' : 'empty##';
            let dependentLastName = $('.claimdependentlastname').val() && $('.claimdependentlastname').val().length > 0 ? $('.claimdependentlastname').val() + '##' : 'empty##';
            let dependentDateOfBirth = $('.claimdependentdob').val() && $('.claimdependentdob').val().length > 0 ? $('.claimdependentdob').val() + '##' : 'empty##';
            let dateOfInquiry = $('input[name="daterange"]').val();
            let index = dateOfInquiry.indexOf("-");
            let beginDateOfInquiry = dateOfInquiry.substr(0, index).trim() + '##';
            let endDateOfInquiry = dateOfInquiry.substr(index + 1).trim() + '##';
            let claimNumber = 'empty';
            claimsDashboardParams = dependentFlag + dependentFirstName + dependentLastName + dependentDateOfBirth + beginDateOfInquiry + endDateOfInquiry;

            localStorage.setItem('claimsDashboardParams', claimsDashboardParams);
            localStorage.setItem('claimnumber', claimNumber);

            console.log("In function for clicking .retrieve-claims-btn. groupName = " + localStorage.getItem('groupName') + ", subscriberKey = " + localStorage.getItem("subscriberKey"));

            if ($(".claims-print-container ").length > 0 && localStorageisValid() && localStorage.getItem("claimnumber") != null) {
                console.log("Have a claim #");
                let claimsParams = $.extend({}, ajaxParams_default);
                claimsParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&claimNumber=' + localStorage.getItem("claimnumber") +
                    '&groupName=' + encodeURIComponent(localStorage.getItem("groupName")) + '&subscriberKey=' + localStorage.getItem("subscriberkey")
                    + '&timeZone=' + timeZone + claimsQueryStringOnLoad;
                claimsParams['successCallbackFunction'] = loadClaimsData;

                claimsParams['errorCallBackFunction'] = loadClaimsData;
                ajaxCall(claimsParams);
            } else if (localStorage.getItem("groupName") != null || localStorage.getItem("subscriberkey") != null) {
                console.log("Have a groupName " + localStorage.getItem("groupName"));
                console.log("Have a subscriberKey " + localStorage.getItem("subscriberkey"));
                console.log("Here's rest of query " + localStorage.getItem("claimsQueryString"));
                let claimsParams = $.extend({}, ajaxParams_default);
                claimsParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&groupName=' + encodeURIComponent(localStorage.getItem("groupName")) +
                    '&subscriberKey=' + localStorage.getItem("subscriberkey") + '&timeZone=' + timeZone + localStorage.getItem("claimsQueryString");
                claimsParams['successCallbackFunction'] = loadClaimsData;

                claimsParams['errorCallBackFunction'] = loadClaimsData;
                ajaxCall(claimsParams);
            }

            window.open(claimsURL, "_self");
        }

    });

    $(document).on('click', '.claims-activity-container .claim-details .view-claim', function () {
        var claimsDashboardParams = '';
        let dependentFlag = 'false##';
        let dependentFirstName = 'empty##';
        let dependentLastName = 'empty##';
        let dependentDateOfBirth = 'empty##';
        let dateOfInquiry = $('input[name="daterange"]').val();
        let index = dateOfInquiry.indexOf("-");
        let beginDateOfInquiry = dateOfInquiry.substr(0, index).trim() + '##';
        let endDateOfInquiry = dateOfInquiry.substr(index + 1).trim() + '##';
        let claimNumber = $(this).data('claimnumber');
        claimsDashboardParams = dependentFlag + dependentFirstName + dependentLastName + dependentDateOfBirth + beginDateOfInquiry + endDateOfInquiry;
        localStorage.setItem('claimsDashboardParams', claimsDashboardParams);
        localStorage.setItem('claimnumber', claimNumber);
    });

    $(document).on('click', '.claims-activity-container .claim-details .view-group-claims', function () {
        var claimsDashboardParams = '';
        let dependentFlag = 'false##';
        let dependentFirstName = 'empty##';
        let dependentLastName = 'empty##';
        let dependentDateOfBirth = 'empty##';
        let dateOfInquiry = $('input[name="daterange"]').val();
        let index = dateOfInquiry.indexOf("-");
        let beginDateOfInquiry = dateOfInquiry.substr(0, index).trim() + '##';
        let endDateOfInquiry = dateOfInquiry.substr(index + 1).trim() + '##';
        let claimNumber = 'empty';
        let groupName = $(this).data('groupname');
        let subscriberKey = $(this).data('subscriberkey');
        claimsDashboardParams = dependentFlag + dependentFirstName + dependentLastName + dependentDateOfBirth + beginDateOfInquiry + endDateOfInquiry;
        localStorage.setItem('claimsDashboardParams', claimsDashboardParams);
        localStorage.setItem('claimnumber', claimNumber);
    });

    var bneDashboardParams = "",
        bneDashboardParamsArray = [],
        bneQueryStringOnLoad = '';
    if ($(".bne-container").length > 0 || $(".bne-print-container").length > 0) {
        if (localStorageisValid()) {
            bneDashboardParams = localStorage.getItem("bneDashboardParams");

            if (bneDashboardParams && bneDashboardParams.length > 0 && bneDashboardParams.indexOf('##') != -1) {
                bneDashboardParamsArray = bneDashboardParams.split('##');
                if (bneDashboardParamsArray[0].length > 0 && bneDashboardParamsArray[0] != 'empty') {
                    bneQueryStringOnLoad = "&dependentFlag=" + bneDashboardParamsArray[0];
                }
                if (bneDashboardParamsArray[1].length > 0 && bneDashboardParamsArray[1] != 'empty') {
                    bneQueryStringOnLoad = bneQueryStringOnLoad + "&dependentFirstName=" + bneDashboardParamsArray[1];
                }
                if (bneDashboardParamsArray[2].length > 0 && bneDashboardParamsArray[2] != 'empty') {
                    bneQueryStringOnLoad = bneQueryStringOnLoad + "&dependentLastName=" + bneDashboardParamsArray[2];
                }
                if (bneDashboardParamsArray[3].length > 0 && bneDashboardParamsArray[3] != 'empty') {
                    bneQueryStringOnLoad = bneQueryStringOnLoad + "&dependentDateOfBirth=" + bneDashboardParamsArray[3];
                }
            }
        }

        let bneClaimParams = $.extend({}, ajaxParams_default);
        if (localStorage.getItem("bneGroupName") != null || localStorage.getItem("subscriberbenefitskey") != null) {
            console.log("have benefits groupName :: " + localStorage.getItem("bneGroupName"))
            console.log("have benefits subscriberKey :: " + localStorage.getItem("subscriberbenefitskey"))
            bneClaimParams['url'] = '/conf/ddpa/paths/secure/benefitsrest.json?responseTypeIndicator=HTML&groupName=' + encodeURIComponent(localStorage.getItem("bneGroupName")) +
                '&subscriberKey=' + localStorage.getItem("subscriberbenefitskey") + '&timeZone=' + timeZone + bneQueryStringOnLoad;
        } else {
            bneClaimParams['url'] = '/conf/ddpa/paths/secure/benefitsrest.json?responseTypeIndicator=HTML' + '&timeZone=' + timeZone + bneQueryStringOnLoad;
        }
        bneClaimParams['successCallbackFunction'] = loadBNEdata;
        bneClaimParams['errorCallBackFunction'] = loadBNEdata;
        ajaxCall(bneClaimParams);
    }
    bneQueryString = bneQueryStringOnLoad;

    // Ajax Call on Page load if Claims container exists

    var claimsDashboardParams = "",
        claimsDashboardParamsArray = [],
        claimsQueryStringOnLoad = '';
    if ($(".my-claims").length > 0 || $(".claims-print-container ").length > 0) {

        if (localStorageisValid()) {
            claimsDashboardParams = localStorage.getItem("claimsDashboardParams");

            if (claimsDashboardParams && claimsDashboardParams.length > 0 && claimsDashboardParams.indexOf('##') != -1) {
                claimsDashboardParamsArray = claimsDashboardParams.split('##');
                if (claimsDashboardParamsArray[0].length > 0 && claimsDashboardParamsArray[0] != 'empty') {
                    claimsQueryStringOnLoad = "&dependentFlag=" + claimsDashboardParamsArray[0];
                }
                if (claimsDashboardParamsArray[1].length > 0 && claimsDashboardParamsArray[1] != 'empty') {
                    claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentFirstName=" + claimsDashboardParamsArray[1];
                }
                if (claimsDashboardParamsArray[2].length > 0 && claimsDashboardParamsArray[2] != 'empty') {
                    claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentLastName=" + claimsDashboardParamsArray[2];
                }
                if (claimsDashboardParamsArray[3].length > 0 && claimsDashboardParamsArray[3] != 'empty') {
                    claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentDateOfBirth=" + claimsDashboardParamsArray[3];
                }
                if (claimsDashboardParamsArray[4].length > 0 && claimsDashboardParamsArray[4] != 'empty') {
                    claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&beginDateOfInquiry=" + claimsDashboardParamsArray[4];
                }
                if (claimsDashboardParamsArray[5].length > 0 && claimsDashboardParamsArray[5] != 'empty') {
                    claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&endDateOfInquiry=" + claimsDashboardParamsArray[5];
                }
            }
            if ((localStorage.getItem("groupName") != null && localStorage.getItem("groupName").length > 0)
                || (localStorage.getItem("subscriberkey") != null && localStorage.getItem("subscriberkey").length > 0)) {
                claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&groupName=" + encodeURIComponent(localStorage.getItem("groupName")) + "&subscriberKey=" + localStorage.getItem("subscriberkey");
            }
        }

        claimsQueryString = claimsQueryStringOnLoad;

        let claimsParams = $.extend({}, ajaxParams_default);

        claimsParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=XML' + '&timeZone=' + timeZone + claimsQueryStringOnLoad;
        claimsParams['successCallbackFunction'] = loadClaimsData;
        if ($(".claims-print-container ").length > 0 && localStorageisValid() && localStorage.getItem("claimnumber") != null) {
            if ((localStorage.getItem("groupName") != null && !claimsQueryStringOnLoad.includes("groupName"))
                || localStorage.getItem("subscriberkey") != null && !claimsQueryStringOnLoad.includes("subscriberKey")) {
                claimsParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&claimNumber=' + localStorage.getItem("claimnumber") +
                    '&groupName=' + encodeURIComponent(localStorage.getItem("groupName")) + '&subscriberKey=' + localStorage.getItem("subscriberkey")  + '&timeZone=' + timeZone + claimsQueryStringOnLoad;
            } else {
                claimsParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&claimNumber=' + localStorage.getItem("claimnumber") + '&timeZone=' + timeZone + claimsQueryStringOnLoad;
            }
            claimsParams['successCallbackFunction'] = updateClaimData;
        }
        claimsParams['errorCallBackFunction'] = updateClaimData;
        ajaxCall(claimsParams);

    }

    if ($(".benefits-overview").length > 0) {
        let bneOverviewParams = $.extend({}, ajaxParams_default);
        bneOverviewParams['url'] = '/conf/ddpa/paths/secure/benefitsrest.json?responseTypeIndicator=XML' + '&timeZone=' + timeZone;
        bneOverviewParams['successCallbackFunction'] = loadBNEOverviewData;
        bneOverviewParams['errorCallBackFunction'] = loadBNEOverviewData;
        ajaxCall(bneOverviewParams);
    }

    if ($(".claims-activity-container").length > 0) {
        let claimsActivityParams = $.extend({}, ajaxParams_default);
        claimsActivityParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=XML&beginDateOfInquiry=' + start + '&endDateOfInquiry=' + end + '&timeZone=' + timeZone;
        claimsActivityParams['successCallbackFunction'] = loadClaimsActivityData;
        claimsActivityParams['errorCallBackFunction'] = loadClaimsActivityData;
        ajaxCall(claimsActivityParams);
    }

    $(document).on('click', '.claims-container .claim-details .view-claim', function () {
        var claimNumber = $(this).data('claimnumber');
        htmlAjaxCall(claimNumber);
    });


    $(document).on('click', '.claims-container .claim-details .view-group-claims', function () {
        var groupName = $(this).data('groupname');
        var subscriberKey = $(this).data('subscriberkey');
        console.log('In click function');
        htmlAjaxCallGroupClaimsUpdate(groupName, subscriberKey);
        //htmlAjaxCallGroupClaims(groupName, subscriberKey);
    });

    $(document).on('click', '.claims-activity-container .claim-details .view-group-claims', function () {
        var groupName = $(this).data('groupname');
        var subscriberKey = $(this).data('subscriberkey');
        console.log('In click function');
        htmlAjaxCallGroupClaims(groupName, subscriberKey);
    });

    $(document).on('click', '.bne-overview-container .bne-details .view-group-bne', function () {
        var groupName = $(this).data('groupname');
        var subscriberKey = $(this).data('subscriberkey');
        console.log('In click function');
        htmlAjaxCallGroupBenefits(groupName, subscriberKey);
    });

    $('.claim-response-details').hide();

});

function getClaimsQueryString() {
    var claimsQueryStringOnLoad = '';
    var claimsDashboardParams = localStorage.getItem("claimsDashboardParams");
    if (claimsDashboardParams && claimsDashboardParams.length > 0 && claimsDashboardParams.indexOf('##') != -1) {
        claimsDashboardParamsArray = claimsDashboardParams.split('##');
        if (claimsDashboardParamsArray[0].length > 0 && claimsDashboardParamsArray[0] != 'empty') {
            claimsQueryStringOnLoad = "&dependentFlag=" + claimsDashboardParamsArray[0];
        }
        if (claimsDashboardParamsArray[1].length > 0 && claimsDashboardParamsArray[1] != 'empty') {
            claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentFirstName=" + claimsDashboardParamsArray[1];
        }
        if (claimsDashboardParamsArray[2].length > 0 && claimsDashboardParamsArray[2] != 'empty') {
            claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentLastName=" + claimsDashboardParamsArray[2];
        }
        if (claimsDashboardParamsArray[3].length > 0 && claimsDashboardParamsArray[3] != 'empty') {
            claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&dependentDateOfBirth=" + claimsDashboardParamsArray[3];
        }
        if (claimsDashboardParamsArray[4].length > 0 && claimsDashboardParamsArray[4] != 'empty') {
            claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&beginDateOfInquiry=" + claimsDashboardParamsArray[4];
        }
        if (claimsDashboardParamsArray[5].length > 0 && claimsDashboardParamsArray[5] != 'empty') {
            claimsQueryStringOnLoad = claimsQueryStringOnLoad + "&endDateOfInquiry=" + claimsDashboardParamsArray[5];
        }
    }
    return claimsQueryStringOnLoad
}

function htmlAjaxCall(claimNumber) {
    let claimsQueryString = getClaimsQueryString();
    let claimDetailParams = $.extend({}, ajaxParams_default);
    if ((localStorageisValid() && localStorage.getItem("groupName") != null && localStorage.getItem("groupName") != '' && !claimsQueryString.includes("groupName"))
        || (localStorageisValid() && localStorage.getItem("subscriberkey") != null && localStorage.getItem("subscriberkey") != 'empty' && !claimsQueryString.includes("subscriberKey"))) {
        var groupName = localStorage.getItem("groupName");
        var subscriberKey = localStorage.getItem('subscriberkey');
        claimDetailParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&claimNumber=' + claimNumber + '&groupName=' + encodeURIComponent(groupName) + '&subscriberKey=' + subscriberKey + '&timeZone=' + timeZone + claimsQueryString;
    } else {
        claimDetailParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&claimNumber=' + claimNumber + '&timeZone=' + timeZone + claimsQueryString;
    }
    claimDetailParams['successCallbackFunction'] = updateClaimData;
    claimDetailParams['errorCallBackFunction'] = updateClaimData;
    ajaxCall(claimDetailParams);
    if (localStorageisValid()) {
        localStorage.setItem("claimnumber", claimNumber);
    }
}

function htmlAjaxCallClaim(claimNumber) {
    let claimsQueryString = getClaimsQueryString();
    let claimDetailParams = $.extend({}, ajaxParams_default);
    claimDetailParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=XML&claimNumber=' + claimNumber + '&timeZone=' + timeZone + claimsQueryString;
    claimDetailParams['successCallbackFunction'] = loadClaimsActivityData;
    claimDetailParams['errorCallBackFunction'] = loadClaimsActivityData;
    ajaxCall(claimDetailParams);
    if (localStorageisValid()) {
        localStorage.setItem("claimnumber", claimNumber);
    }
}

function htmlAjaxCallGroupClaimsUpdate(groupName, subscriberKey) {
    let claimsQueryString = getClaimsQueryString();
    console.log('In click htmlAjaxCallGroupClaimsUpdate call for group claims with groupName = ' + groupName + ', and subscriberKey = ' + subscriberKey + ' and timeZone = ' + timeZone);
    //localStorage.setItem("claimsQueryString", claimsQueryString);
    let claimDetailParams = $.extend({}, ajaxParams_default);
    claimDetailParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=HTML&groupName=' + encodeURIComponent(groupName) + '&subscriberKey=' + subscriberKey + '&timeZone=' + timeZone + claimsQueryString;
    claimDetailParams['successCallbackFunction'] = updateClaimData;
    claimDetailParams['errorCallBackFunction'] = updateClaimData;
    ajaxCall(claimDetailParams);
    if (localStorageisValid()) {
        localStorage.setItem("subscriberKey", subscriberKey);
        localStorage.setItem("groupName", groupName);
    }
}

function htmlAjaxCallGroupClaims(groupName, subscriberKey) {
    let claimsQueryString = getClaimsQueryString();
    console.log('In click htmlAjaxCallGroupClaims call for group claims with groupName = ' + groupName + ', and subscriberKey = ' + subscriberKey + ' and timeZone = ' + timeZone + ' and claimsQueryString = ' + claimsQueryString);
    $("div.claims-activity-container > p.validRed").remove();
    $(".dashclaims-loading-circle").show();
    let claimDetailParams = $.extend({}, ajaxParams_default);
    claimDetailParams['url'] = '/conf/ddpa/paths/secure/claimsrest.json?responseTypeIndicator=XML&groupName=' + encodeURIComponent(groupName) + '&subscriberKey=' + subscriberKey + '&timeZone=' + timeZone + claimsQueryString;
    claimDetailParams['successCallbackFunction'] = loadClaimsActivityData;
    claimDetailParams['errorCallBackFunction'] = loadClaimsActivityData;
    ajaxCall(claimDetailParams);
    if (localStorageisValid()) {
        localStorage.setItem("subscriberkey", subscriberKey);
        localStorage.setItem("groupName", groupName);
    }
}

function htmlAjaxCallGroupBenefits(groupName, subscriberKey) {
    console.log('In click htmlAjaxCallGroupBenefits call for group benefits with groupName = ' + groupName + ', and subscriberKey = ' + subscriberKey + ' and timeZone = ' + timeZone + ' and bneQueryString = ' + bneQueryString);
    $("div.bne-overview-container > p.validRed").remove();
    $(".dashbne-loading-circle").show();
    let bneDetailParams = $.extend({}, ajaxParams_default);
    bneDetailParams['url'] = '/conf/ddpa/paths/secure/benefitsrest.json?responseTypeIndicator=XML&groupName=' + encodeURIComponent(groupName) + '&subscriberKey=' + subscriberKey + '&timeZone=' + timeZone + bneQueryString;
    bneDetailParams['successCallbackFunction'] = loadBNEOverviewData;
    bneDetailParams['errorCallBackFunction'] = loadBNEOverviewData;
    ajaxCall(bneDetailParams);
    if (localStorageisValid()) {
        localStorage.setItem("subscriberbenefitskey", subscriberKey);
        localStorage.setItem("bneGroupName", groupName);
    }
}

function loadBNEdata(data, className) {
    var bneResponse = data;
    if (isObject(bneResponse)) {
        $('.bne-loading-circle').hide();
        $('.bne-title').removeClass('hide');
        let errorCode = bneResponse.BNEResult.errorCode;
        let bneHTMLObj = "";
        if (errorCode == '0') {
            bneHTMLObj = bneResponse.BNEResult.htmlResult;
        } else {
            $('.print-bne-result').hide();
            bneHTMLObj = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.</p>";
            var bneDetailError = "Benefits Detail Error: " + errorCode + "-" + bneResponse.BNEResult.errorMessage + "-" + bneResponse.BNEResult.supplementalMessage;

        }
        let bneHTML = $('<div/>').html(bneHTMLObj).html();
        $('.bne-container').append(bneHTML).show();
        $(".bne-print-container").append(bneHTML);
    }
}

function loadBNEOverviewData(data, className) {
    let bneJson = data;
    let errorCode = bneJson.BNEResult.errorCode;
    $(".dashbne-loading-circle").hide();
    if (errorCode == '0') {
        $('[id^="groupBNEDetailElement"]').remove();
        if (isObject(bneJson.BNEResult) && isObject(bneJson.BNEResult.groupList) && bneJson.BNEResult.groupList.length > 0) {
            console.log('In benefits group list');
            var allGroups = bneJson.BNEResult.groupList;
            $.each(allGroups, function (index, group) {
                var bneDiv = "<p><div id='groupBNEDetailElement" + index + "' class='bne-details'><p class='bold'><a id='bneId" + index + "' href='javascript:void(0);' class='green-link view-group-bne' data-subscriberkey='" + group.subscriberKey + "' data-groupname='" + group.subscriberGroupName + "'>" + group.subscriberGroupName + "</a></p><p>" + group.subscriberFirstName + "</p><p>" + group.subscriberLastName + "</p></div>";
                $('.bne-overview-container').append(bneDiv);
            });
            $('.bne-overview-container .benefits-group-message').removeClass('hide');
            $('.bne-overview-container .benefits-group-heading').removeClass('hide');
        } else if (isObject(bneJson.BNEResult) && isObject(bneJson.BNEResult.eligibilityBenefitInformation) && isObject(bneJson.BNEResult.eligibilityBenefitInformation.benefitInformation)) {
            console.log("In benefits eligibility list")
            $('.bne-overview-container .benefits-group-message').hide();
            $('.bne-overview-container .benefits-group-heading').hide();
            var benefitInfo = bneJson.BNEResult.eligibilityBenefitInformation.benefitInformation;

            if (isObject(benefitInfo.benefitClass) && benefitInfo.benefitClass.length > 0) {
                console.log("have benefit information");
                $.each(benefitInfo.benefitClass, function (index, benefitClass) {
                    console.log("looping through benefits");
                    if (benefitClass.benClassCode == '35') {
                        console.log("found code 35");
                        loadProgressBarValues(benefitClass);
                        return false;
                    }
                });
            }
        }

    } else {
        var bneDiv = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.</p>";
        var bneDashboardError = "Benefits Dashboard Error: " + errorCode + "-" + bneJson.BNEResult.errorMessage + "-" + bneJson.BNEResult.supplementalMessage;
        //console.log(bneDashboardError);
        $('.bne-overview-container').append(bneDiv);
    }

}

function loadProgressBarValues(benefitClass) {

    var annualDeductible = '',
        annualDeductibleRemaining = '',
        deductibleFamilyFlag = false,
        displayDeductibleBar = false,
        annualMaximum = '',
        annualMaximumRemaining = '',
        maximumFamilyFlag = false,
        displayMaximumBar = false;

    if (isObject(benefitClass.maximumDeductible) && isObject(benefitClass.balances)) {

        if (isString(benefitClass.maximumDeductible.familyAnnualDeductible) && isString(benefitClass.balances.familyAnnualRemainingDeductible) &&
            (benefitClass.maximumDeductible.familyAnnualDeductible != "$0")) {
            displayDeductibleBar = true;
            deductibleFamilyFlag = true;
            annualDeductible = benefitClass.maximumDeductible.familyAnnualDeductible;
            annualDeductibleRemaining = benefitClass.balances.familyAnnualRemainingDeductible;

        } else if (isString(benefitClass.maximumDeductible.individualAnnualDeductible) && isString(benefitClass.balances.individualAnnualRemainingDeductible) &&
            (benefitClass.maximumDeductible.individualAnnualDeductible != "$0")) {
            displayDeductibleBar = true;
            deductibleFamilyFlag = false;
            annualDeductible = benefitClass.maximumDeductible.individualAnnualDeductible;
            annualDeductibleRemaining = benefitClass.balances.individualAnnualRemainingDeductible;
        }

        if (isString(benefitClass.maximumDeductible.familyAnnualMaximum) && isString(benefitClass.balances.familyAnnualRemainingMaximum) &&
            (benefitClass.maximumDeductible.familyAnnualMaximum != "$0")) {
            displayMaximumBar = true;
            maximumFamilyFlag = true;
            annualMaximum = benefitClass.maximumDeductible.familyAnnualMaximum;
            annualMaximumRemaining = benefitClass.balances.familyAnnualRemainingMaximum;

        } else if (isString(benefitClass.maximumDeductible.individualAnnualMaximum) && isString(benefitClass.balances.individualAnnualRemainingMaximum) &&
            (benefitClass.maximumDeductible.individualAnnualMaximum != "$0")) {
            displayMaximumBar = true;
            maximumFamilyFlag = false;
            annualMaximum = benefitClass.maximumDeductible.individualAnnualMaximum;
            annualMaximumRemaining = benefitClass.balances.individualAnnualRemainingMaximum;
        }


    }

    if (displayDeductibleBar) {

        if (deductibleFamilyFlag) {
            $('.deduct-title').append(' - Family');
        } else {
            $('.deduct-title').append(' - Individual');
        }

        $('.ded-max-amount').text(annualDeductible);
        $('.ded-bal-amount').text(annualDeductibleRemaining);

        annualDeductible = annualDeductible.replace(/\$|\,/g, '');
        annualDeductibleRemaining = annualDeductibleRemaining.replace(/\$|\,/g, '');

        var annualDedPercentage = (100 * (annualDeductible - annualDeductibleRemaining) / annualDeductible).toFixed();
        var annualDedLeftPercentage = (100 - annualDedPercentage).toFixed();

        $(".deductable-bar-spent").data("percentage", annualDedPercentage);
        $(".deductable-bar-left").data("percentage", annualDedLeftPercentage);

        $('.benefits-overview .annual-deduction').removeClass('hide');

    }

    if (displayMaximumBar) {

        if (maximumFamilyFlag) {
            $('.pocket-title').append(' - Family');
        } else {
            $('.pocket-title').append(' - Individual');
        }

        $('.out-max-amount').text(annualMaximum);
        $('.out-bal-amount').text(annualMaximumRemaining);

        annualMaximum = annualMaximum.replace(/\$|\,/g, '');
        annualMaximumRemaining = annualMaximumRemaining.replace(/\$|\,/g, '');

        var annualMaxPercentage = (100 * (annualMaximum - annualMaximumRemaining) / annualMaximum).toFixed();
        var annualMaxLeftPercentage = (100 - annualMaxPercentage).toFixed();

        $(".outofpacket-spent").data("percentage", annualMaxPercentage);
        $(".outofpacket-left").data("percentage", annualMaxLeftPercentage);

        $('.benefits-overview .out-of-pocket').removeClass('hide');

    }

    $(".progress-indicator").each(function () {
        var spentPercentage = $(this).find('.amount-spent').data('percentage');
        var leftPercentage = $(this).find('.amount-left').data('percentage');
        $(this).find('.amount-spent').css('width', spentPercentage + '%');
        $(this).find('.amount-left').css('width', leftPercentage + '%');
    });

}

function loadClaimsData(data, className) {
    console.log("In loadClaimsData");
    console.log(data);
    var claimsJson = data;
    let errorCode = claimsJson.ClaimStatusResult.errorCode;
    $('.claims-loading-circle').hide();
    $('.claims-detail-title').removeClass('hide');
    if (errorCode == '0') {
        if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.groupList) && textNotEmpty(claimsJson.ClaimStatusResult.groupList)) {
            console.log('In group list');
            var allGroups = claimsJson.ClaimStatusResult.groupList;
            $.each(allGroups, function (index, group) {
                var claimDiv = "<div class='claim-details'><div><p class='claims-groups-heading bold col-xs-6 hidden-sm hidden-md hidden-lg'>" + claimsGroupName + "</p><p class='bold col-xs-6'><a id='claimId" + index + "' href='javascript:void(0);' class='green-link view-group-claims' data-subscriberkey='" + group.subscriberKey + "' data-groupname='" + group.subscriberGroupName + "'>" + group.subscriberGroupName + "</a></p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsGroupFirstName + "</p><p class='col-xs-6'>" + group.subscriberFirstName + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsGroupLastName + "</p><p class='col-xs-6'>" + group.subscriberLastName + "</p></div>";
                $('.claims-container').append(claimDiv);
            });
            $('.claims-container .claims-groups-heading').removeClass('hide');
            $('.claims-container .group-message').removeClass('hide');
            $('.claims-container .claims-heading').hide();
        } else if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.claimList) && textNotEmpty(claimsJson.ClaimStatusResult.claimList)) {
            console.log('multiple - loadClaimsData');
            var allClaims = claimsJson.ClaimStatusResult.claimList;
            $.each(allClaims, function (index, claim) {

                var claimDatePaidFormatted;
                if (typeof claim.datePaid !== 'undefined' && claim.datePaid != null) {
                    var claimDatePaidMoment = moment(claim.datePaid);
                    claimDatePaidFormatted = claimDatePaidMoment.isValid() ? claimDatePaidMoment.format("ll") : "";
                } else {
                    claimDatePaidFormatted = "";
                }
                if (typeof claim.amountPaid == 'undefined' || claim.amountPaid == null) {
                    claim.amountPaid = "";
                }

                var claimDiv = "<div class='claim-details'><div><p class='claim-heading bold col-xs-6 hidden-sm hidden-md hidden-lg'>" + claimsNumber + "</p><p class='bold col-xs-6'>" + claim.claimNumber + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsDateOfService + "</p><p class='col-xs-6'>" + moment(claim.firstDOS).format('ll') + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsStatus + "</p><p class='col-xs-6'>" + claim.claimStatus + "</p></div>" +
                    "<div><p class='claim-heading bold col-xs-6 hidden-sm hidden-md hidden-lg'>" + claimsDatePaid + "</p><p class='col-xs-6'>" + claimDatePaidFormatted + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsAmountSubmitted + "</p><p class='col-xs-6'>" + claim.amountSubmitted + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsAmountPaid + "</p><p class='col-xs-6'>" + claim.amountPaid + "</p></div>" +
                    "<div><p class='col-xs-6 viewclaimlink'><a id='claimId" + index + "' href='javascript:void(0);' class='green-link view-claim' data-claimnumber='" + claim.claimNumber + "'>" + claimsView + "</a></p></div>";
                $('.claims-container').append(claimDiv);
            });
            $('.claims-container .claims-heading').removeClass('hide');
            $('.claims-container .claims-heading').show();
            $('.claims-container .group-message').hide();
            $('.claims-container .claims-groups-heading').hide();
        } else if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.claimInformation.subscriberInformation.patientInformation.claim)) {
            console.log("single claim - loadClaimsData");
            var index = 1;
            var singleClaim = claimsJson.ClaimStatusResult.claimInformation.subscriberInformation.patientInformation.claim;

            if (isNumber(singleClaim.claimNumber) || isString(singleClaim.claimNumber)) {

                var claimDatePaidFormatted;
                if (typeof singleClaim.datePaid !== 'undefined' && singleClaim.datePaid != null) {
                    var claimDatePaidMoment = moment(singleClaim.datePaid);
                    claimDatePaidFormatted = claimDatePaidMoment.isValid() ? claimDatePaidMoment.format("ll") : "";
                } else {
                    claimDatePaidFormatted = "";
                }
                if (typeof singleClaim.amountPaid == 'undefined' || singleClaim.amountPaid == null) {
                    singleClaim.amountPaid = "";
                }
                var claimDiv = "<div class='claim-details'><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsNumber + "</p><p class='bold col-xs-6'>" + singleClaim.claimNumber + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsDateOfService + "</p><p class='col-xs-6'>" + moment(singleClaim.firstDOS).format('ll') + "</p></div><div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsStatus + "</p><p class='col-xs-6'>" + singleClaim.claimStatus + "</p></div>" +
                    "<div><p class='claim-heading col-xs-6 bold hidden-sm hidden-md hidden-lg'>" + claimsDatePaid + "</p><p class='col-xs-6'>" + claimDatePaidFormatted + "</p></div><div><p class='claim-heading bold col-xs-6 hidden-sm hidden-md hidden-lg'>" + claimsAmountSubmitted + "</p><p class='col-xs-6'>" + singleClaim.amountSubmitted + "</p></div><div><p class='claim-heading bold col-xs-6 hidden-sm hidden-md hidden-lg'>" + claimsAmountPaid + "</p><p class='col-xs-6'>" + singleClaim.amountPaid + "</p></div>" +
                    "<div><p class='col-xs-6 viewclaimlink'><a id='claimId" + index + "' href='javascript:void(0);' class='green-link view-claim' data-claimnumber='" + singleClaim.claimNumber + "'>" + claimsView + "</a></p></div>";
                $('.claims-container').append(claimDiv);
                $('.claims-container .claims-heading').removeClass('hide');
                $('.claims-container .claims-heading').show();
                $('.claims-container .group-message').hide();
                $('.claims-container .claims-groups-heading').hide();
            } else if (isString(claimsJson.ClaimStatusResult.claimInformation.messageText)) {
                $('.claims-heading').hide();
                $('.claims-groups-heading').hide();
                $('.group-message').hide();
                var claimDiv = "<p class='validRed'>" + claimsJson.ClaimStatusResult.claimInformation.messageText + "</p>";
                $('.claims-container').append(claimDiv);
            }

        }

        // Make ajax call to get the content of the claim if claim number exists in local storage
        if (localStorageisValid() && localStorage.getItem("claimnumber") != null && localStorage.getItem("claimnumber") != 'empty') {
            htmlAjaxCall(localStorage.getItem("claimnumber"));
        }

    } else {
        $('.claims-heading').hide();
        $('.claims-groups-heading').hide();
        $('.group-message').hide();

        var claimDiv;
        if (claimsJson.ClaimStatusResult.hasOwnProperty("errorCode")) {
            if (errorCode.indexOf("NC")>=0) {
                claimDiv = "<p class='validRed'>No claims found for search criteria entered.</p>";
            }
            else {
                claimDiv = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.  Error Code ("+ claimsJson.ClaimStatusResult.errorCode + ").</p>";
            }
        }
        else {
            claimDiv = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.</p>";
        }
        $('.claims-container').append(claimDiv);

        var claimsDetailError = "Claims Detail Error (Table): " + errorCode + "-" + claimsJson.ClaimStatusResult.errorMessage + "-" + claimsJson.ClaimStatusResult.supplementalMessage;
        //  console.log(claimsDetailError);
    }

    // end

}

function loadClaimsActivityData(data, className) {
    var claimsJson = data;
    let errorCode = claimsJson.ClaimStatusResult.errorCode;
    $('.dashclaims-loading-circle').hide();
    if (errorCode == '0') {
        $('[id^="groupDetailElement"]').remove();
        if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.groupList) && claimsJson.ClaimStatusResult.groupList.length > 0) {
            console.log('In group list');
            var allGroups = claimsJson.ClaimStatusResult.groupList;
            $.each(allGroups, function (index, group) {
                //var claimDiv = "<p><div class='claim-details'><p class='bold'><a id='claimId"+index+"' href='" + claimsURL + "' class='green-link view-group-claims' data-subscriberkey='" + group.subscriberKey + "' data-groupname='" + group.subscriberGroupName + "'>" + group.subscriberGroupName + "</a></p><p>" + group.subscriberFirstName + "</p><p>" + group.subscriberLastName + "</p></div>";
                var claimDiv = "<p><div id='groupDetailElement" + index + "' class='claim-details'><p class='bold'><a id='claimId" + index + "' href='javascript:void(0);' class='green-link view-group-claims' data-subscriberkey='" + group.subscriberKey + "' data-groupname='" + group.subscriberGroupName + "'>" + group.subscriberGroupName + "</a></p><p>" + group.subscriberFirstName + "</p><p>" + group.subscriberLastName + "</p></div>";
                //var claimDiv = "<p><div id='groupDetailElement' class='claim-details'><p class='bold'><a id='claimId"+index+"' href='" + claimsURL + "' class='green-link view-group-claims' data-subscriberkey='" + group.subscriberKey + "' data-groupname='" + group.subscriberGroupName + "'>" + group.subscriberGroupName + "</a></p><p>" + group.subscriberFirstName + "</p><p>" + group.subscriberLastName + "</p></div>";
                $('.claims-activity-container').append(claimDiv);
            });
            $('.claims-activity-container .group-message').removeClass('hide');
            $('.claims-activity-container .claims-groups-heading').removeClass('hide');
            $('.claims-activity-container .claims-heading').hide();
            //document.getElementById("claims-daterange").style.display = "none";
        } else if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.claimList) && claimsJson.ClaimStatusResult.claimList.length > 0) {
            console.log('multiple - loadClaimsActivityData');
            var allClaims = claimsJson.ClaimStatusResult.claimList;
            $.each(allClaims, function (index, claim) {

                var claimDiv = "<div class='claim-details'><p class='bold'>" + claim.claimNumber + "</p><p>" + moment(claim.firstDOS).format('ll') + "</p><p>" + claim.claimStatus + "</p>" + "<p><a id='claimId" + index + "' href='" + claimsURL + "' class='green-link view-claim' data-claimnumber='" + claim.claimNumber + "'>" + claimsView + "</a></p></div>";
                $('.claims-activity-container').append(claimDiv);
            });
            $('.claims-activity-container .claims-heading').removeClass('hide');
            $('.claims-activity-container .claims-heading').show();
            $('.claims-activity-container .group-message').hide();
            $('.claims-activity-container .claims-groups-heading').hide();
            document.getElementById("claims-daterange").style.display = "block";
            loadClaimsData(data, className);
        } else if (isObject(claimsJson) && isObject(claimsJson.ClaimStatusResult.claimInformation.subscriberInformation.patientInformation.claim)) {
            console.log("single claim - loadClaimsActivityData");
            var index = 1;
            var singleClaim = claimsJson.ClaimStatusResult.claimInformation.subscriberInformation.patientInformation.claim;
            if (isNumber(singleClaim.claimNumber) || isString(singleClaim.claimNumber)) {
                var claimDiv = "<div class='claim-details'><p class='bold'>" + singleClaim.claimNumber + "</p><p>" + moment(singleClaim.firstDOS).format('ll') + "</p><p>" + singleClaim.claimStatus + "</p>" +
                    "<p><a id='claimId" + index + "' href='" + claimsURL + "' class='green-link view-claim' data-claimnumber='" + singleClaim.claimNumber + "'>" + claimsView + "</a></p></div>";
                $('.claims-activity-container').append(claimDiv);
                $('.claims-activity-container .claims-heading').removeClass('hide');
                $('.claims-activity-container .claims-heading').show();
                $('.claims-activity-container .group-message').hide();
                $('.claims-activity-container .claims-groups-heading').hide();
                document.getElementById("claims-daterange").style.display = "block";
                loadClaimsData(data, className);
            } else if (isString(claimsJson.ClaimStatusResult.claimInformation.messageText)) {
                //$('.claims-heading').hide();
                $('.claims-heading').removeClass('hide');
                $('.claims-groups-heading').hide();
                $('.group-message').hide();
                var claimDiv = "<p class='validRed'>" + claimsJson.ClaimStatusResult.claimInformation.messageText + "</p>";
                $('.claims-activity-container').append(claimDiv);
            }

        }
    } else {
        var claimDiv;
        if (claimsJson.ClaimStatusResult.hasOwnProperty("errorCode")) {
            if (errorCode.indexOf("NC")>=0) {
                claimDiv = "<p class='validRed'>No claims found for search criteria entered.</p>";
            }
            else {
                claimDiv = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.  Error Code ("+ claimsJson.ClaimStatusResult.errorCode + ").</p>";
            }
        }
        else {
            claimDiv = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.</p>";
        }
        var claimsDashboardError = "Claims Dashboard Error: " + errorCode + "-" + claimsJson.ClaimStatusResult.errorMessage + "-" + claimsJson.ClaimStatusResult.supplementalMessage;
        console.log(claimsDashboardError);
        $('.claims-activity-container').append(claimDiv);
    }
    if ($('.claim-details').length < 0) {
        $('.claims-heading').hide();
        $('.claims-groups-heading').hide();
    }

}

function updateClaimData(data, className) {
    console.log("In updateClaimData ");
    if (data && isObject(data) && isObject(data.ClaimStatusResult)) {
        $('.claim-response-details .print-claims-result').siblings().remove();
        let errorCode = data.ClaimStatusResult.errorCode;
        let claimHTMLObj = "";
        if (errorCode == '0') {
            console.log("In updateClaimData show result " + claimHTMLObj);
            claimHTMLObj = data.ClaimStatusResult.htmlResult;
        } else {
            $('.print-claims-result').hide();
            if (claimsJson.ClaimStatusResult.hasOwnProperty("errorCode")) {
                if (errorCode.indexOf("NC")>=0) {
                    claimHTMLObj = "<p class='validRed'>No claims found for search criteria entered.</p>";
                }
                else {
                    claimHTMLObj = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.  Error Code ("+ claimsJson.ClaimStatusResult.errorCode + ").</p>";
                }
            }
            else {
                claimHTMLObj = "<p class='validRed'>We are unable to process your request, sorry for the inconvenience.</p>";
            }
            var claimsDetailError = "Claims Detail Error (HTML): " + errorCode + "-" + data.ClaimStatusResult.errorMessage + "-" + data.ClaimStatusResult.supplementalMessage;
            console.log(claimsDetailError);
        }
        let claimHTML = $('<div/>').html(claimHTMLObj).html();
        console.log * ("")
        $('.claim-response-details').append(claimHTML).show();
        $(".claims-print-container").append(claimHTML);

    }
}

function validateClaims() {
    var validateClaimsFlag = false;

    if ($('.claimdependentfirstname').val().length <= 0) {
        $('.validation_section').removeClass('hide');
        $('.validdependentname').removeClass('hide');
        $('.dependent-fname').addClass('validRed');
        validateClaimsFlag = true;
    } else {
        $('.validation_section').addClass('hide');
        $('.validdependentname').addClass('hide');
        $('.dependent-fname').removeClass('validRed');

    }

    if ($('.claimdependentlastname').val().length <= 0) {
        $('.validation_section').removeClass('hide');
        $('.validdependentname').removeClass('hide');
        $('.dependent-lname').addClass('validRed');
        validateClaimsFlag = true;
    } else {
        $('.validation_section').addClass('hide');
        $('.validdependentname').addClass('hide');
        $('.dependent-lname').removeClass('validRed');
    }

    if ($('.claimsbirthdate').val().length <= 0 || !isValidDate($('.claimsbirthdate').val())) {
        $('.validation_section').removeClass('hide');
        $('.validdateofbirth').removeClass('hide');
        $('.dependent-bdate').addClass('validRed');
        validateClaimsFlag = true;
    } else {
        $('.validation_section').addClass('hide');
        $('.validdateofbirth').addClass('hide');
        $('.dependent-bdate').removeClass('validRed');

    }

    return validateClaimsFlag;

};

function validatebne() {
    var validatebneFlag = false;

    if ($('.dependentfirstname').val().length <= 0) {
        $('.validation_bnesection').removeClass('hide');
        $('.validbnedependentname').removeClass('hide');
        $('.valid-bnefirstname').addClass('validRed');
        validatebneFlag = true;
    } else {
        $('.validation_bnesection').addClass('hide');
        $('.validbnedependentname').addClass('hide');
        $('.valid-bnefirstname').removeClass('validRed');

    }
    if ($('.dependentlastname').is(':visible') && $('.dependentlastname').val().length <= 0) {
        $('.validation_bnesection').removeClass('hide');
        $('.validbnedependentname').removeClass('hide');
        $('.valid-bnelastname').addClass('validRed');
        validatebneFlag = true;
    } else {
        $('.validation_bnesection').addClass('hide');
        $('.validbnedependentname').addClass('hide');
        $('.valid-bnelastname').removeClass('validRed');


    }

    if ($('.bnebirthdate').val().length <= 0 || !isValidDate($('.bnebirthdate').val())) {
        $('.validation_bnesection').removeClass('hide');
        $('.validdatebneofbirth').removeClass('hide');
        $('.valid-bnebirthdate').addClass('validRed');
        validatebneFlag = true;
    } else {
        $('.validation_bnesection').addClass('hide');
        $('.validdatebneofbirth').addClass('hide');
        $('.valid-bnebirthdate').removeClass('validRed');


    }
    return validatebneFlag;

}

// Checks for the following valid date format: MM/DD/YYYY
function isValidDate(dateStr) {
    var datePat = /^(\d{2,2})(\/)(\d{2,2})\2((?:(?:19|20)[0-9]{2}))$/;
    var matchArray = dateStr.match(datePat);
    if (matchArray == null) {
        return false;
    }
    month = matchArray[1];
    day = matchArray[3];
    year = matchArray[4];
    if (month < 1 || month > 12) {
        return false;
    }
    if (day < 1 || day > 31) {
        return false;
    }
    if ((month == 4 || month == 6 || month == 9 || month == 11) && day == 31) {
        return false;
    }
    if (month == 2) { // check for february 29th
        var isleap = (year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
        if (day > 29 || (day == 29 && !isleap)) {
            return false;
        }
    }
    return true;
}

var subscriberOverviewContMsg = getI18nValue('subscriberOverviewContMsg',"NO RESULTS FOUND");
var subscriberOverviewPlanWith = getI18nValue('subscriberOverviewPlanWith',"Plan with:");
var subscriberOverviewAddress = getI18nValue('subscriberOverviewAddress',"Address:");
var subscriberOverviewCall = getI18nValue('subscriberOverviewCall',"Call:");
var overviewClaimAddressLabel = getI18nValue('overviewClaimAddressLabel',"Claim Address:");
var overviewFaxLabel = getI18nValue('overviewFaxLabel',"Fax:");
let stateToPopulate = '';

function generateSubscriberLinks(data,stateToPopulate){
    var links,subscriberLinkDiv;
var subscriberLinks = data;
if(subscriberLinks && typeof subscriberLinks == 'object' && subscriberLinks.subscriberLinkDetails.length > 0){
$.each(subscriberLinks.subscriberLinkDetails,function(index,state){
if(state.stateId == stateToPopulate){
  links = state.links;
  if(links.length > 0 && typeof links == 'object'){
    $.each(links,function(index,link){
        let titlelink = '';
        let subscriberLink = '';
        if(link.title.length > 0){
            titlelink  = link.title;
        }else if(link.url.length > 0){
            titlelink = link.url;
        }
        if(titlelink.length > 0){
            if(link.url.length > 0){
                subscriberLink = "<a target='_blank' href='"+link.url+"' class='green-link underline'>"+titlelink+"</a>";
            }else{
                subscriberLink = "<p class='txt-green'>"+titlelink+"</p>";
            }
        }
        subscriberLinkDiv =  "<div class='subscriber-link'>"+subscriberLink+"<p>"+link.description+"</p></div>";
        $('.subscriber-link-container').append(subscriberLinkDiv);

    });
  }else{

  let userLinksParms = $.extend({}, ajaxParams_default);
  var userLinks = $('.user-links-planJson').val();
  userLinksParms['url'] = userLinks;
  userLinksParms['successCallbackFunction'] = userLinksResults;
  userLinksParms['errorCallBackFunction'] = rendererrorSelectDropdown;
  ajaxCall(userLinksParms);

  }
}
});
}
}

function userLinksResults(data,classname){

    var userLinks = data;

    for(var i=0; i < data.stateDetails.length ;i++){
        var userLinkState = $('.user-links-state').val();
        if(data.stateDetails[i].stateAbbreviation==userLinkState){
             $('.subscriber-link-container').empty();
              userLinkDiv =  "<div class='subscriber-link'><a target='_blank' href='"+data.stateDetails[i].webSiteUrl+"' class='green-link underline'>Delta Dental of "+data.stateDetails[i].stateName +"</a></div>";
             $('.subscriber-link-container').append(userLinkDiv);

        }
    }

}

function generateSubscriberOverview(data,stateToPopulate){
     var overviewStateName,overviewAddress, overviewContact, subscriberOverviewDiv, overviewRedirection,overviewClaimAddress,overviewFax;
     var subscriberOverviews = data;
     if(subscriberOverviews && typeof subscriberOverviews == 'object' && subscriberOverviews.stateDetails.length > 0){
       $.each(subscriberOverviews.stateDetails,function(index,state){
         if(state.stateAbbreviation == stateToPopulate){
            var maUser = $(".user-overview-mauser").val();

            overviewStateName = state.planName;
            overviewAddress= (state.officeContactStreet ? (state.officeContactStreet + '<br/>') : '') + (state.officeContactCity? ((state.officeContactStateAbbreviation ? (state.officeContactCity +', ') : '')):' ') + state.officeContactStateAbbreviation + '&nbsp;&nbsp;'+ state.officeContactZip;
            overviewContact= state.outOfStateNumber;
            overviewRedirection = state.webSiteUrl ? state.webSiteUrl : 'javascript:void(0)';
			overviewClaimAddress = '';
			if(isString(state.claimContactStreet)){
				overviewClaimAddress = state.claimContactStreet;
			}
			if(isString(state.claimContactStreet2) && state.claimContactStreet2.trim().length){
				overviewClaimAddress = overviewClaimAddress +", "+state.claimContactStreet2;
			}
			if(isString(state.claimContactCity) && state.claimContactCity.trim().length){
				overviewClaimAddress = overviewClaimAddress +", "+state.claimContactCity;
			}
			if((isString(state.claimContactZip) && state.claimContactZip.trim().length) || (isNumber(state.claimContactZip) && (state.claimContactZip).length > 0)){
                overviewClaimAddress = overviewClaimAddress +", "+state.claimContactZip;
			}
			if(overviewClaimAddress.charAt(0) == ","){
				overviewClaimAddress = overviewClaimAddress.substring(1);
			}
			if(isString(state.customerServiceFax) || isNumber(state.customerServiceFax)){
				 overviewFax = state.customerServiceFax;
			}
			// AB-550: For MA user, display the data that is authored in Medicare Advantage Contact Info in plans page of that particular state.
			if((maUser == "true") && ((state.maPlanWith != "") || (state.maAddress != "") || (state.maClaimsAddress != "") || (state.maPhone != ""))) {
				if (state.maWebsiteURL !="") {
                	subscriberOverviewDiv = "<div class='subcriber-details'><div class='detail-row'><p class='plan-label  '>" + subscriberOverviewPlanWith + "</p><p class='plan-title'> <a class='txt-green' href='" + state.maWebsiteURL + "'>" + state.maPlanWith + "</a></p></div>" +
                        "<div class='detail-row'><p class='address-label'>" + subscriberOverviewAddress + "</p><p class='address-info txt-green'>" + state.maAddress + "</p></div>" +
                        "<div class='detail-row'><p class='address-label'>" + overviewClaimAddressLabel + "</p><p class='address-info txt-green'>" + state.maClaimsAddress + "</p></div>" +
                        "<div class='detail-row'><p class='call-label'>" + subscriberOverviewCall + "</p><p class='call-info txt-green'><a href='tel:+1" + state.maPhone + "'>" + state.maPhone + "</a></p></div>";
                } else {
                	subscriberOverviewDiv = "<div class='subcriber-details'><div class='detail-row'><p class='plan-label  '>" + subscriberOverviewPlanWith + "</p><p class='plan-title txt-green'>" + state.maPlanWith + "</p></div>" +
                        "<div class='detail-row'><p class='address-label'>" + subscriberOverviewAddress + "</p><p class='address-info txt-green'>" + state.maAddress + "</p></div>" +
                        "<div class='detail-row'><p class='address-label'>" + overviewClaimAddressLabel + "</p><p class='address-info txt-green'>" + state.maClaimsAddress + "</p></div>" +
                        "<div class='detail-row'><p class='call-label'>" + subscriberOverviewCall + "</p><p class='call-info txt-green'><a href='tel:+1" + state.maPhone + "'>" + state.maPhone + "</a></p></div>";
                }
                $('.subscriber-overview-container').append(subscriberOverviewDiv);
                // welcome user data
                $('.welcome-user .welcome-plan').attr("href", state.maWebsiteURL)
                $('.welcome-user .welcome-plan').text(state.maPlanWith);

                //hide benefits last name if flag is false
                if(state.displayLastNameBNE === 'false'){
					$('.benefits-overview .bne-state-lastnamehide').remove();
	            }
            } else {
                if(overviewStateName.length > 0){
	                if(typeof overviewFax == "string" && overviewFax.length > 0) {
	                    subscriberOverviewDiv = "<div class='subcriber-details'><div class='detail-row'><p class='plan-label  '>" + subscriberOverviewPlanWith + "</p><p class='plan-title'> <a class='txt-green' href='" + overviewRedirection + "'>" + overviewStateName + "</a></p></div>" +
	                        "<div class='detail-row'><p class='address-label'>" + subscriberOverviewAddress + "</p><p class='address-info txt-green'>" + overviewAddress + "</p></div>" +
	                        "<div class='detail-row'><p class='address-label'>" + overviewClaimAddressLabel + "</p><p class='address-info txt-green'>" + overviewClaimAddress + "</p></div>" +
	                        "<div class='detail-row'><p class='call-label'>" + subscriberOverviewCall + "</p><p class='call-info txt-green'><a href='tel:+1" + overviewContact + "'>" + overviewContact + "</a></p></div>" +
	                        "<div class='detail-row'><p class='address-label'>" + overviewFaxLabel + "</p><p class='address-info txt-green'>" + overviewFax + "</p></div></div>";
	                    $('.subscriber-overview-container').append(subscriberOverviewDiv);
	                }
	                else {
	                    subscriberOverviewDiv = "<div class='subcriber-details'><div class='detail-row'><p class='plan-label  '>" + subscriberOverviewPlanWith + "</p><p class='plan-title'> <a class='txt-green' href='" + overviewRedirection + "'>" + overviewStateName + "</a></p></div>" +
	                        "<div class='detail-row'><p class='address-label'>" + subscriberOverviewAddress + "</p><p class='address-info txt-green'>" + overviewAddress + "</p></div>" +
	                        "<div class='detail-row'><p class='address-label'>" + overviewClaimAddressLabel + "</p><p class='address-info txt-green'>" + overviewClaimAddress + "</p></div>" +
	                        "<div class='detail-row'><p class='call-label'>" + subscriberOverviewCall + "</p><p class='call-info txt-green'><a href='tel:+1" + overviewContact + "'>" + overviewContact + "</a></p></div></div>";
	                    $('.subscriber-overview-container').append(subscriberOverviewDiv);
	                }
			
	                // welcome user data
	                $('.welcome-user .welcome-plan').attr("href", overviewRedirection)
	                $('.welcome-user .welcome-plan').text(overviewStateName);
	
	                //hide benefits last name if flag is false
	                if(state.displayLastNameBNE === 'false'){
						$('.benefits-overview .bne-state-lastnamehide').remove();
	                }
	
	            }else{
					$('.subscriber-overview-container').append(subscriberOverviewContMsg);
	
	            }
            }
         }
       });
     }
}

function updateUserState(data,classname){
	if(data && data.state.length > 0){
	     stateToPopulate = data.state;
	    // AB-550: set the value to true if the loggedin user is MA user
        if(data.productCode == "60") {
	    	$(".user-overview-mauser").val("true");
        }
	}
      // Subscriber links
    if($('.user-links-json').length > 0 && $('.user-links-json').val().length > 0){

        var linksJsonPath = $('.user-links-json').val();
        let subscriberLinksParams = $.extend({}, ajaxParams_default);
        subscriberLinksParams['url'] = linksJsonPath;
        subscriberLinksParams['successCallbackFunction'] = generateSubscriberLinks;
        subscriberLinksParams['errorCallBackFunction'] = rendererrorSelectDropdown;
        subscriberLinksParams['className'] = stateToPopulate; // Passing the state name as parameter
        ajaxCall(subscriberLinksParams);
    }

     // Subscriber overview
    if($('.user-overview-json').length > 0 && $('.user-overview-json').val().length > 0){

        var overviewJsonPath = $('.user-overview-json').val();
        let subscriberOverviewParams = $.extend({}, ajaxParams_default);
        subscriberOverviewParams['url'] = overviewJsonPath;
        subscriberOverviewParams['successCallbackFunction'] = generateSubscriberOverview;
        subscriberOverviewParams['errorCallBackFunction'] = rendererrorSelectDropdown;
        subscriberOverviewParams['className'] = stateToPopulate; // Passing the state name as parameter
        ajaxCall(subscriberOverviewParams);
    }

}

var dentistSearchAcceptPatients = getI18nValue('dentistSearchAcceptPatients',"accepting new patients");
var dentistSearchNotAcceptPatients = getI18nValue('dentistSearchNotAcceptPatients',"not accepting new patients");
var dentistSearchFacilityId = getI18nValue('dentistSearchFacilityId',"Facility ID :");
var dentistSearchByReferralOnly = getI18nValue('dentistSearchByReferralOnly',"By referral only");
var dentistSearchValueTrue = getI18nValue('dentistSearchValueTrue',"true");
var dentistSearchValueFalse = getI18nValue('dentistSearchValueFalse',"false");
var designationDescriptions = [];
var designations = ['General Dentist','Oral Surgeon','Endodontist','Orthodontist','Pediatric Dentist','Periodontist',
					'Prosthodontist','Oral Pathologist','Public Health','Full Time Faculty','Oral Maxillofacial Radiologist'];
					
					
$(function(){
	designationDescriptions[0] = $("#general-dentist").data('description');
	designationDescriptions[1] = $("#oral-surgeon").data('description');
	designationDescriptions[2] = $("#endodontist").data('description');
	designationDescriptions[3] = $("#orthodontist").data('description');
	designationDescriptions[4] = $("#pediatric-dentist").data('description');
	designationDescriptions[5] = $("#periodontist").data('description');
	designationDescriptions[6] = $("#prosthodontist").data('description');
	designationDescriptions[7] = $("#oral-pathologist").data('description');
	designationDescriptions[8] = $("#public-health").data('description');
	designationDescriptions[9] = $("#full-time-faculty").data('description');
	designationDescriptions[10] = $("#oral-maxillofacial-radiologist").data('description');
	
	
});
function getDesignationDescription(designation){
	let indexOfDesgn = $.inArray(designation,designations);
	let designationDesc = '';
	if(indexOfDesgn != -1){
	   designationDesc = designationDescriptions[indexOfDesgn];
	}
	return designationDesc;
}
function removeDuplicates(array){
   let filteredArray = [];
   array.filter( function( index, item) {
       if($.inArray(index,filteredArray) == -1){
			filteredArray.push(index);
       }
    });
    return filteredArray.join(", ");
}
function getAcceptsText(dentistObject){
 return (dentistObject.prvdrAccptsPatsInd == "Y" || dentistObject.soAccptsPatsInd == "Y" ) ? dentistSearchAcceptPatients :dentistSearchNotAcceptPatients;
}
function getAcceptsValue(dentistObject){
 return (dentistObject.prvdrAccptsPatsInd == "Y" || dentistObject.soAccptsPatsInd == "Y" ) ? dentistSearchValueTrue :dentistSearchValueFalse;
}
function getDentistFacilityContact(dentist){
	var facilityContact = '';
	if(( dentist.specialities != null ) && Array.isArray(dentist.specialties)) {
        if( dentist.specialties.includes("General Dentist") && (isString(dentist.facilityID) || isNumber(dentist.facilityID))){
            facilityContact = ""+dentist.facilityID;
        }
        else if ( !dentist.specialties.includes("General Dentist")){
            facilityContact = dentistSearchByReferralOnly;
        }
	}
	else if ( ( dentist.specialities != null ) && isString(dentist.specialties)){
        if( dentist.specialties == "General Dentist" && (isString(dentist.facilityID) || isNumber(dentist.facilityID))){
            facilityContact = ""+dentist.facilityID;
        }
        else if( dentist.specialties != "General Dentist"){
            facilityContact = dentistSearchByReferralOnly;
        }
    }
    return facilityContact;	
}
function getDentistReferalText(dentist){
	var referalText = '';
	if ( ( dentist.specialties != null ) && Array.isArray(dentist.specialties)){
        if(  dentist.specialties.includes("General Dentist") && (isString(dentist.facilityID) || isNumber(dentist.facilityID))){
            referalText = "<span class='facility-id'> ("+dentistSearchFacilityId+dentist.facilityID+")</span>";
        }else if( !dentist.specialties.includes("General Dentist")){
            referalText = "<span class='facility-id'> ("+dentistSearchFacilityId+ dentistSearchByReferralOnly+")</span>";
        }
	}
	else if ((dentist.specialties != null ) && isString(dentist.specialties)){
        if(  dentist.specialties == "General Dentist" && (isString(dentist.facilityID) || isNumber(dentist.facilityID))){
            referalText = "<span class='facility-id'> ("+dentistSearchFacilityId+dentist.facilityID+")</span>";
        }else if( dentist.specialties != "General Dentist"){
            referalText = "<span class='facility-id'> ("+dentistSearchFacilityId+ dentistSearchByReferralOnly+")</span>";
        }
	}

    return referalText;
}
function getDentistCity(){
  let city = '';
  if($("#dentistSearchCityInput").val() && $("#dentistSearchCityInput").val().length > 0){
    city = $("#dentistSearchCityInput").val();
  }
  return city;
}
function getDentistAddress(){
  return textNotEmpty($("#dentistSearchAddresss").val()) ? $("#dentistSearchAddresss").val() : '';
}
function getDentistState(){
	let state = '';
    if($("#dentistSearchStateInput").val() && $("#dentistSearchStateInput").val().length > 0){
      state = $("#dentistSearchStateInput").val();
    }
    return state;
}

function formatPhoneNumber(phonenumber){
    let formattedNumber = ''+phonenumber;
    if(formattedNumber.length == 10){
		formattedNumber = "("+formattedNumber.substring(0,3) +") "+formattedNumber.substring(3,6)+"-"+formattedNumber.substring(6,10);
    }
    return formattedNumber;
}
function formatZipCode(zipcode){
    let formattedZip = ''+zipcode;
    formattedZip = formattedZip.length > 5 ? formattedZip.substring(0,5) : formattedZip;
    return formattedZip;
}
function getDentistsZipCode(){
  let zipcode = '';
  if($("input.zipcode").val() && $("input.zipcode").val().length > 0){
    zipcode = $("input.zipcode").val();
  }
  return zipcode;
}
function getDentistsParticipation(){
  let productMode = $("input[name='productMode']").val();
   let participates = textNotEmpty($("#dentistSearchPlanType").val()) ? $("#dentistSearchPlanType").val() : 'empty';
   if (participates == 'empty') {
        participates = textNotEmpty($(".local-participation-list").val()) ? $(".local-participation-list").val() : 'empty';
   }
   let privateExchangeParticipation = textNotEmpty($(".private-exchange-list").val()) ? $(".private-exchange-list").val() : 'empty';
   if (  productMode != null && productMode != undefined && productMode == 'privateExchangeMode' ){
     //  private exchanges has bronze, silver, gold and  platinum.  replace with normal product codes
      switch(privateExchangeParticipation) {
        case "Bronze":
          participates = "ppoPlusPremier";
          break;
        case "Silver":
          participates = "ppoPlusPremier";
          break;
        case "Gold":
          participates = "ppoPlusPremier";
          break;
        case "Platinum":
          participates = "Deltacare";
          break;
        default:
          participates = "empty";
          break;
      }
   }
   return participates;
}
function getDentistsSpeciality(){
  let speciality = '';
  if($("#dentistSearchSpecialityType").val() && $("#dentistSearchSpecialityType").val().length > 0 && $("#dentistSearchSpecialityType").val() != 'Any' && $('.speciality-dropdown-wrapper').is(':visible')){
      speciality = $("#dentistSearchSpecialityType").val();
  }
  return speciality;
}
function getDentistsLastName(){
  let lastname = '';
  if($(".last-name").val() && $(".last-name").val().length > 0){
      lastname = $(".last-name").val();
  }
  return lastname;
}
function getDentistsPractise(){
  let practise = '';
  if($(".business-name").val() && $(".business-name").val().length > 0){
    practise = $(".business-name").val();
  }
  return practise;
}
function getDentistsLang(){
  let language = '';
  if($('.language-dropdown').val() && $('.language-dropdown').val().length > 0 && $('.language-dropdown').val() != 'Any' && $('.language-filters').is(':visible')){
      language = $('.language-dropdown').val();
    }
    if($('.language-dropdown-mobile').val() && $('.language-dropdown-mobile').val().length > 0 && $('.language-dropdown-mobile').val() !='Any' && $('.language-filters-mobile').is(':visible')){
      language = $('.language-dropdown-mobile').val();
    }
    return language;
}

function getDentistsDist(){
  let distance = '';
  if($('.distance-dropdown').val() && $('.distance-dropdown').val().length > 0 && $('.distance-filter').is(':visible')){
      distance = $('.distance-dropdown').val();
    }
  if($('.distance-dropdown-mobile').val() && $('.distance-dropdown-mobile').val().length > 0 && $('.distance-filter-mobile').is(':visible')){
   distance = $('.distance-dropdown-mobile').val();
    }
    return distance;

}
function getDentistsOfficeTimes(){
  let officeTimes = '';
  if(textNotEmpty($('.extended-hours-dropdown').val()) && $(".extended-hours-filters").is(':visible') && $('.extended-hours-dropdown').val() != 'All'){
      officeTimes = $('.extended-hours-dropdown').val();
  }
  if(textNotEmpty($('.extended-hours-dropdown-mobile').val()) && $(".extended-hours-filters-mobile").is(':visible') && $(".extended-hours-filters-mobile").val() != 'All'){
    officeTimes =$('.extended-hours-dropdown-mobile').val();
  }
  return officeTimes;
}

function getDentistsSortType(){
  let sortType = '';
  if($(".sort-by-dropdown").val() && $(".sort-by-dropdown").val().length > 0 && $('.sort-by-filter').is(':visible')){
           sortType = $(".sort-by-dropdown").val();
  }
  if($(".sort-by-dropdown-mobile").val() && $(".sort-by-dropdown-mobile").val().length > 0 && $(".sort-by-filter-mobile").is(':visible')){
          sortType = $(".sort-by-dropdown-mobile").val();
  }
  return sortType;
}
function getDentistsSortTypeText(){
  let sortTypeText = '';
  if($(".sort-by-dropdown").val() && $(".sort-by-dropdown").val().length > 0 && $('.sort-by-filter').is(':visible')){
           sortTypeText = $(".sort-by-dropdown option:selected").text();
  }
  if($(".sort-by-dropdown-mobile").val() && $(".sort-by-dropdown-mobile").val().length > 0 && $(".sort-by-filter-mobile").is(':visible')){
          sortTypeText = $(".sort-by-dropdown-mobile option:selected").text();
  }
  return sortTypeText;
}
function getDentistsSpecialityText(){
  let specialityText = '';
  if($(".speciality-list").val() && $(".speciality-list").val().length > 0 && $('.speciality-dropdown-wrapper').is(':visible')){
      specialityText = $(".speciality-list option:selected").text();
  }
  return specialityText;
}
function getDentistsAcceptsNewPatients(){
 let acceptsNewPatients = '';
  if(textNotEmpty($(".new-patients-dropdown ").val()) && $(".new-patients-dropdown ").val() !='All' && $('.new-patients-filters').is(':visible')){
       acceptsNewPatients = $(".new-patients-dropdown ").val();
  }else if(textNotEmpty($(".new-patients-dropdown-mobile").val()) && $(".new-patients-dropdown-mobile").val() !='All' && $(".new-patients-filters-mobile").is(':visible')){
      acceptsNewPatients = $(".new-patients-dropdown-mobile").val();
  }
  return acceptsNewPatients;
}
function getDentistsRecordsToReturn(){
  let numberOfRecordsToReturn = 50;
  if($(".results-dropdown").val() && $(".results-dropdown").val().length > 0 && $('.results-filter').is(':visible')){
       numberOfRecordsToReturn = $(".results-dropdown").val();
  }else if($(".results-dropdown-mobile").val() && $(".results-dropdown-mobile").val().length > 0 && $('.results-filter-mobile').is(':visible')){
      numberOfRecordsToReturn = $(".results-dropdown-mobile").val();
  }
  return parseInt(numberOfRecordsToReturn);
}
function getDentistsLanguages(dentist){
	let languages = 'English';	
	if(textNotEmpty(getDentistsLang())){
		languages = '';
	}   

    if(isString(dentist.officeLanguages)){
		languages = dentist.officeLanguages;
	}else if(isObject(dentist.officeLanguages) && textNotEmpty(dentist.officeLanguages)){
		languages = dentist.officeLanguages.join(',');
	}
    if(isString(dentist.prvdrLanguages)){
		languages = languages + ","+dentist.prvdrLanguages;
	}else if(isObject(dentist.prvdrLanguages) && textNotEmpty(dentist.prvdrLanguages)){
		languages = languages+ ","+dentist.prvdrLanguages.join(',');
	}

    if(languages.charAt(0) == ","){
		languages = languages.substring(1);
    }

    if(textNotEmpty(languages) &&  languages.indexOf(",") > 0){
      return removeDuplicates(languages.split(','));
    }else{
      return languages;
    }
}
function getTotalDentistsSelected(){
  return $(".dentist-result .add-to-list input[type='checkbox']:checked").length;
}
function getHttpLink(url){
	return url.toLowerCase().indexOf("http") == 0 ? url : "http://"+url;    	
}
function showModal(element) {
  var clone = element.clone().addClass("modal-clone");

  $("body")
    .append(clone)
    .find(".modal-clone")
    .on("hidden.bs.modal", function () {
      $(this).remove();
    })
    .modal("show");
}

$(function () {
  $(document).ready(function () {
    $(".findadentist-section").each(function () {
      preSelectPlan($(this));
    });

    $(".findadentist-section").each(function () {
      var randomNum = Math.floor(Math.random() * 10000);
      $(this)
        .find("[id$='share-location']")
        .next()
        .attr("for", (i, val) => val + randomNum);
      $(this)
        .find("[id$='share-location']")
        .attr("name", "sharelocation-" + randomNum);
      $(this)
        .find("[id$='share-location']")
        .attr("id", (i, val) => val + randomNum);

      $(this)
        .find("[id$='dont-share-location']")
        .next()
        .attr("for", (i, val) => val + randomNum);
      $(this)
        .find("[id$='dont-share-location']")
        .attr("name", "sharelocation-" + randomNum);
      $(this)
        .find("[id$='dont-share-location']")
        .attr("id", (i, val) => val + randomNum);

      var wrap = $(this);

      try {
        ddpa.geocoder = new google.maps.Geocoder();
      } catch (err) {
        console.log(err);
      }

      ddpa.findDentistPage =
        $("[id$='findDentistAddress']", wrap).length > 0 ? true : false;
      ddpa.dsrPage =
        $("#dentistSearchAddresss", wrap).length > 0 ? true : false;

      $('[id^="share-location"]', wrap).prop("checked", true);
      $('[id^="topnav-share-location"]', wrap).prop("checked", true);

      $(".search-dentists", wrap).on("click", function () {
        $(".participation-dropdown-container", wrap).removeClass("errorLabel");
        $('input[id$="findDentistPlanType"]').attr(
          "aria-describedby",
          $('input[id$="findDentistPlanType"]')
            .attr("aria-describedby")
            .split(" ")[0]
        );

        $('[id$="findDentistLocation"]', wrap).removeClass("errorLabel");

        var planNetwork = $("[id$='findDentistPlanType']", wrap).val();
        var locationStatus = $(
          "input[name*='sharelocation']:checked",
          wrap
        ).val();
        var addressEntered = $("input[id$='findDentistAddress']", wrap).val();

        if (
          planNetwork &&
          locationStatus == "true" &&
          !$("[id$='findDentistSubmitBtn']", wrap).hasClass("access-denied")
        ) {
          try {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(
                showPosition,
                handleError
              );
            }
          } catch (err) {
            console.log(err);
          }
        } else if (
          planNetwork &&
          locationStatus == "true" &&
          $("[id$='findDentistSubmitBtn']", wrap).hasClass("access-denied")
        ) {
          showModal($("[id$='browserSettings']", wrap));
        } else if (
          planNetwork &&
          locationStatus == "false" &&
          textNotEmpty(addressEntered)
        ) {
          $(".address-fields", wrap).data("address", addressEntered);
          updateLocalStorageOrUrlParams(true);
        } else {
          var planNetworkErrorMsg = $('[id$="findDentistNetwork-error"]', wrap);

          if (!planNetwork) {
            $(".participation-dropdown-container", wrap).addClass("errorLabel");
            $('input[id$="findDentistPlanType"]').attr(
              "aria-describedby",
              `${
                $('input[id$="findDentistPlanType"]')
                  .attr("aria-describedby")
                  .split(" ")[0]
              } ${planNetworkErrorMsg.attr("id")}`
            );
          }

          if (!textNotEmpty(addressEntered) && locationStatus == "false") {
            $('[id$="findDentistLocation"]', wrap).addClass("errorLabel");
          }

          return false;
        }
      });

      $('input[id$="findDentistAddress"]', wrap).on("change", function (e) {
        var addressEntered = e.target.value;
        if (
          $('[id$="findDentistLocation"]', wrap).hasClass("errorLabel") &&
          textNotEmpty(addressEntered)
        ) {
          $('[id$="findDentistLocation"]', wrap).removeClass("errorLabel");
        }
        return;
      });

      $('[id$="findDentistPlanType"]', wrap).on("change", function (event) {
        var planNetwork = event.target.value;
        if (
          $(".participation-dropdown-container", wrap).hasClass("errorLabel") &&
          planNetwork
        ) {
          $(".participation-dropdown-container", wrap).removeClass(
            "errorLabel"
          );
          $('input[id$="findDentistPlanType"]').attr(
            "aria-describedby",
            $('input[id$="findDentistPlanType"]')
              .attr("aria-describedby")
              .split(" ")[0]
          );
        }
        return;
      });

      wrap.find("input.share-location-radio").on("change", function () {
        var shareLocation = $(
          "input[name*='sharelocation']:checked",
          wrap
        ).val();
        if (shareLocation == "true") {
          $(".address-fields", wrap).hide();
          $("[id$='search-location'] .dentist-search-error", wrap).hide();
        } else {
          $("[id$='findDentistAddress']", wrap).val("");
          $(".address-fields", wrap).show();
        }
      });

      if (ddpa.findDentistPage || ddpa.dsrPage) {
        initAutocomplete();
      }

      $("input[id$='findDentistAddress']", wrap).on("keyup", function (e) {
        if (textNotEmpty($(this).val())) {
          var keyCode = e.keyCode || e.which;
          if (keyCode == 13) {
            $(".dentist-search-container .search-dentists", wrap).click();
          }
        }
      });

      function showPosition(position) {
        $(".dentist-search-container .search-dentists", wrap).removeClass(
          "access-not-shared"
        );
        var currentLatLng = new google.maps.LatLng(
          position.coords.latitude,
          position.coords.longitude
        );
        ddpa.geocoder.geocode(
          { latLng: currentLatLng },
          function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {
              if (
                results[0].formatted_address &&
                results[0].formatted_address.length > 0
              ) {
                $(".address-fields", wrap).data(
                  "address",
                  results[0].formatted_address
                );
                updateLocalStorageOrUrlParams(true);
              }
            } else {
              console.log("ERROR: Failed to geocode current location.");
            }
          }
        );
      }

      function handleError(error) {
        /*user selected not to share the location @ error */
        showModal($("[id$='browserSettings']", wrap));
        $("[id$='findDentistSubmitBtn']", wrap)
          .addClass("access-denied")
          .removeClass("access-not-shared");
      }

      function updateLocalStorageOrUrlParams(useCurrentLocation) {
        $("[id$='search-location'] .dentist-search-error", wrap).hide();
        var speciality = textNotEmpty($(".speciality-list", wrap).val())
          ? $(".speciality-list", wrap).val()
          : "";
        var productMode = $("input[name='productMode']", wrap).val();
        var exclusion = $("input[name='exclusion']", wrap).val();
        var findADentistVersion = textNotEmpty(
          $("input[name='dentistSearchResultsVersion']", wrap).val()
        )
          ? $("input[name='dentistSearchResultsVersion']", wrap).val()
          : "findADentist1";
        var participates = textNotEmpty($(".participation-list", wrap).val())
          ? $(".participation-list", wrap).val()
          : "";
        var privateExchangeParticipation = textNotEmpty(
          $(".private-exchange-list", wrap).val()
        )
          ? $(".private-exchange-list", wrap).val()
          : "";
        var disablePnRReview = textNotEmpty(
          $("input[name='disablePnRReview']", wrap).val()
        )
          ? $("input[name='disablePnRReview']", wrap).val()
          : "false";
        if (
          productMode != null &&
          productMode != undefined &&
          productMode == "privateExchangeMode"
        ) {
          //  private exchanges has bronze, silver, gold and  platinum.  replace with normal product codes
          switch (privateExchangeParticipation) {
            case "Bronze":
              participates = "ppoPlusPremier";
              break;
            case "Silver":
              participates = "ppoPlusPremier";
              break;
            case "Gold":
              participates = "ppoPlusPremier";
              break;
            case "Platinum":
              participates = "Deltacare";
              break;
            default:
              participates = "";
              break;
          }
        }

        var dentistLastName = textNotEmpty($("[id$='last-name']", wrap).val())
          ? $("[id$='last-name']", wrap).val()
          : "";

        var address = "";
        if ($(".address-fields", wrap).data("address")) {
          address = $(".address-fields", wrap).data("address");
        } else if (textNotEmpty($("[id$='findDentistAddress']", wrap).val())) {
          address = $("[id$='findDentistAddress']", wrap).val();
        }
        let urlQueryString = "";
        if (findADentistVersion === "findADentist2") {
          var planValue = convertParticipatesToPlan(participates);
          const originalParams = new URLSearchParams(window.location.search);
          // TODO should address be encoded in some way as it is used in an url?
          urlQueryString =
            "address=" +
            address +
            "&specialtyCode=" +
            speciality +
            "&plan=" +
            planValue;
          if (dentistLastName) {
            urlQueryString = urlQueryString + "&lastName=" + dentistLastName;
          }
          if (productMode && productMode === "privateExchangeMode") {
            urlQueryString = urlQueryString + "&privateExchange=true";
          }
          if (exclusion) {
            urlQueryString = urlQueryString + "&excludedNetworks=" + exclusion;
          }
          if (disablePnRReview === "true") {
            urlQueryString = urlQueryString + "&disablePnRReview=true";
          }
          if (originalParams.get("lockplan") === "1" || planValue === "60") {
            urlQueryString = urlQueryString + "&lockplan=1";
          }
        } else {
          urlQueryString = new URL(document.location).searchParams;
          var findADentistJson = {
            address: address,
            speciality: speciality,
            participates: participates,
            dentistLastName: dentistLastName,
            privateExchangeParticipation: privateExchangeParticipation,
          };

          if (localStorageisValid()) {
            localStorage.setItem(
              "findADentistJson",
              JSON.stringify(findADentistJson)
            );
          }
        }
        window.open(
          $("[id$='findDentistSubmitBtn']").data("redirect") +
            "?" +
            urlQueryString.toString(),
          $("[id$='findDentistSubmitBtn']").data("target")
        );
      }

      function initAutocomplete() {
        // Create the autocomplete object, restricting the search to geographical location types.
        if (ddpa.dsrPage) {
          autocomplete = new google.maps.places.Autocomplete(
            wrap.find("#dentistSearchAddresss")[0]
          );
        }
        if (ddpa.findDentistPage) {
          autocomplete = new google.maps.places.Autocomplete(
            wrap.find("[id$='findDentistAddress']")[0]
          );
        }

        autocomplete.setFields(["geometry"]);
      }
    });

    function preSelectPlan(elem) {
      var planParam = window.location.search;
      if (planParam) {
        if (planParam.substr(0, 8) == "?plan=01") {
          $(".participation-list option[value='Premier']", elem).attr(
            "selected",
            "selected"
          );
        } else if (planParam.substr(0, 8) == "?plan=20") {
          $(".participation-list option[value='PPO']", elem).attr(
            "selected",
            "selected"
          );
        } else if (planParam.substr(0, 8) == "?plan=25") {
          $(".participation-list option[value='ppoPlusPremier']", elem).attr(
            "selected",
            "selected"
          );
        } else if (planParam.substr(0, 8) == "?plan=30") {
          $(".participation-list option[value='Deltacare']", elem).attr(
            "selected",
            "selected"
          );
        } else if (planParam.substr(0, 8) == "?plan=40") {
          $(".participation-list option[value='PatientDirect']", elem).attr(
            "selected",
            "selected"
          );
        }
        if (planParam.substr(0, 6) == "?plan=") {
          $(".participation-list option[value='placeholder']", elem).remove();
        }
      }
    }

    function convertParticipatesToPlan(participates) {
      var planValue = "";
      switch (participates) {
        case "PPO":
          planValue = "20";
          break;
        case "Premier":
          planValue = "01";
          break;
        case "ppoPlusPremier":
          planValue = "25";
          break;
        case "Deltacare":
          planValue = "30";
          break;
        case "PatientDirect":
          planValue = "40";
          break;
        case "MedicareAdvantage":
          planValue = "60";
          break;
        case "NationalNetworks":
          planValue = "Any";
          break;
        default:
          planValue = "";
          break;
      }
      return planValue;
    }
  });
});

var suggestDirectoryEmailSuccessMsg = getI18nValue('suggestDirectoryEmailSuccessMsg',"Your email has successfully been sent.");
var suggestDirectoryEmailFailedMsg = getI18nValue('suggestDirectoryEmailFailedMsg',"Mail cannot be sent");

$(function(){

	/* Email functionality */

		$(".send-email").on('click',function(){
			$(".form-email-error,.form-captcha-error").hide();
			var captchaValue = $(".email-captcha-text").html();
			var userEnteredCaptcha = $('.email-captcha-input').val();
			var toEmail = $("#formEmailId").val();
            captchaValue = removeSpaces(captchaValue);
            if(userEnteredCaptcha.length > 0 && toEmail.length > 0 && captchaValue == userEnteredCaptcha && validateEmail(toEmail)){

				let addtoListResultsObj = getAddtoListResults();
				let sendDentistResultParams = $.extend({}, ajaxParams_default);
				sendDentistResultParams['url'] = $('.mail-dentistslist').attr('data-url') ? $('.mail-dentistslist').attr('data-url') : '/';
				sendDentistResultParams['data'] = JSON.stringify(addtoListResultsObj);
				sendDentistResultParams['requestType'] = 'POST';
				sendDentistResultParams['dataType'] = 'json';
				sendDentistResultParams['successCallbackFunction'] = successEmailDentistList;
				sendDentistResultParams['errorCallBackFunction'] = errorEmailDentistList;
				ajaxCall(sendDentistResultParams);
			}else{
                if(!validateEmail(toEmail)){
									$("#sendMailPopUp .form-email-error").show();
                }
                if(captchaValue != userEnteredCaptcha){
                   $("#sendMailPopUp .form-captcha-error").show();
                }
            }
		});

	   // clearing fields on closing the modal @ email popup

    $('#sendMailPopUp').on('hidden.bs.modal', function () {
			$("#sendMailPopUp .form-email-error").hide();
			$("#sendMailPopUp .form-captcha-error").hide();
	});

	$('#moreOptionsPopup').on('hidden.bs.modal',function(){
          $('body').addClass('modal-open');
    });

	$(".mail-dentistslist").on("click",function(){
         if($(".dentist-result.result-visible").length > 0 && getTotalDentistsSelected() > 0){
          $(".to-email-address").val('');
          $(".email-captcha-input").val('');
			$("#sendMailPopUp").modal('show');
            $('#moreOptionsPopup').modal('hide');

         }else{
			$("#noSelectionPopUp").modal('show');
         }
    });

	 // Search results modal drop downs
    var bodyHeight = $("body").height();

     $(".mobile-sub-filters .more-options").on("click",function(){
         $(".more-options-mobile").show();
         $(".overlay-background").css("height",bodyHeight).show();
     });




    $(".mobile-sub-filters .refine-search").on("click",function(){
      $(".refine-options").show();
      $(".overlay-background").css("height",bodyHeight).show();
    });
    $(".close-refine-options a,.close-more-options a,.close-mail-modal a").on("click",function(){
        $(".refine-options").hide();
        $(".more-options-mobile").hide();
        $(".send-mail-container").hide();
        $(".overlay-background").hide();
    });

	/* check box funtionality */

		$(".check-all-results").on("change",function(){
	        let allResultsCheckBox = $(this);
	        let checkBoxStatus = allResultsCheckBox.is(':checked');
	        $(".dentist-result").each(function(){
	         if($(this).find(".add-to-list input[type='checkbox']").is(':checked') != checkBoxStatus){
	  				            $(this).find(".add-to-list input[type='checkbox']").click();
	          }
	        });
	    });

	    $(document).on("click","input[type='checkbox'][name='add-to-list']",function(){
	      $(".selected-list-count .selected-count").text(getTotalDentistsSelected());
	      $("#dentistSearchMobileMoreMenuLink .selected-count").text(getTotalDentistsSelected());
	   });

});
// Submit feedback popup form on submit
var checkCaptchaAndSubmit = function(formName) {
                            var formName = $("#"+formName+"");
                            var str1 = removeSpaces(formName.find(".captcha-text").html());
              var str2 = removeSpaces(formName.find('.captcha-input').val());

    if(str2 && str2.length > 0 && str2 == str1){
        formName.find('.form-captcha-error').hide();
        return true;
    }else{
        formName.find('.form-captcha-error').show();
        return false;
    }

};


var submitsugestedUpdate = function() {
  $(document).on('click', '.suggested-updateform-submit', function(e) {
    e.stopImmediatePropagation();
    var suggestedForm = $(this).closest('form');
    var formId = suggestedForm.attr('id');
    var validateCaptch = checkCaptchaAndSubmit(formId);
    var suggestedUpdateObj = {};
    if(validateCaptch) {
      suggestedUpdateObj = {
        "firstName": suggestedForm.find('.populate-dentist-fname').text().toUpperCase(),
        "lastName": suggestedForm.find('.populate-dentist-lname').text().toUpperCase(),
        "address": suggestedForm.find('.populate-dentist-address').text().toUpperCase(),
        "city": suggestedForm.find('.populate-dentist-city').text().toUpperCase(),
        "phone": suggestedForm.find('.populate-dentist-phone-number').text().toUpperCase(),
        "serviceOfficeEmail": suggestedForm.find('.populate-dentist-service-office-email').text().toUpperCase(),
        "info": suggestedForm.find('#dentistSearchSuggestUpdateReason').val().toUpperCase(),
        "addComments": suggestedForm.find('#additionalComment').val().toUpperCase(),
        "subscriberName": suggestedForm.find('#subscriberName').val().toUpperCase(),
        "subscriberEmail": suggestedForm.find('#subscriberEmailId').val().toUpperCase(),
        "stateCode": suggestedForm.find(".populate-dentist-address").data('stateCode').toUpperCase()
      };
      let suggestedUpdateParams = $.extend({}, ajaxParams_default);
      suggestedUpdateParams['url'] = $(this).data('url') ? $(this).data('url') : '/';
      suggestedUpdateParams['data'] = JSON.stringify(suggestedUpdateObj);
      suggestedUpdateParams['requestType'] = 'POST';
      suggestedUpdateParams['successCallbackFunction'] = successSuggestedEmail;
      suggestedUpdateParams['errorCallBackFunction'] = errorSuggestedEmail;
      ajaxCall(suggestedUpdateParams);
    } else {
       /*Validation failed */
      return false;
    }
  });
};

var successSuggestedEmail = function(data) {
    $('#feedbackPopup').modal('hide');
                            if(data) {

        $('.email-success-popup .success-mail-text').html('<span class="success-icon"></span><label>'+suggestDirectoryEmailSuccessMsg+'</label>');
                  $('.email-success-popup').modal('show');
                  $('.success-mail-btn, .close').on('click', function(){
                      $('.modal').modal('hide');
                      $(this).closest('.modal').hide();
                  });
                            } else {
                                          errorEmailDentistList();
                            }
};


var errorSuggestedEmail = function() {
    $('#feedbackPopup').hide();
    $('.email-success-popup .success-mail-text').html(suggestDirectoryEmailFailedMsg);
    $('.email-success-popup').show();
    $('.success-mail-btn, .close').on('click', function(){
        $('.modal').modal('hide');
        $(this).closest('.modal').hide();
    });
};

$(function(){

	var startingIndex,endingIndex;
    $(document).on('click','.dentist-search-pagination .pagination-list li.page a',function() {
      $('html, body').animate({scrollTop:$('.dentist-search-results .search-results').offset().top-90});
         if(!$(this).parent().hasClass('active')){
           $('.pagination-list li.page').removeClass('active');
           $(this).parent().addClass('active');
           startingIndex = parseInt($(this).data('startresult'));
           endingIndex = parseInt($(this).data('endresult'));
           $('.dentist-result').addClass('result-hidden').removeClass('result-visible');
           for(k = startingIndex ; k <= endingIndex ; k++){
             $('.dentist-result'+k).removeClass('result-hidden').addClass('result-visible');
           }
         }

         if($('.first-page').hasClass('active')){
           $('.dentist-search-pagination .pagination-list li.previous').addClass('visibility-hidden').removeClass('visibility-visible');
           $('.dentist-search-pagination .pagination-list li.next').show();
         }else {
			$('.dentist-search-pagination .pagination-list li.previous').removeClass('visibility-hidden').addClass('visibility-visible');
         }
         if($('.last-page').hasClass('active')){
           $('.dentist-search-pagination .pagination-list li.next').hide();
           $('.dentist-search-pagination .pagination-list li.previous').removeClass('visibility-hidden').addClass('visibility-visible');
         }else{
			$('.dentist-search-pagination .pagination-list li.next').show();
         }
        let pageShown = parseInt($('.pagination-list li.page.active').data('pageno'));
        $(".dentist-search-pagination .page-index .current-page").text(pageShown);
    });

	$(document).on('click','.dentist-search-pagination .pagination-list li.previous a',function() {
    $('html, body').animate({scrollTop:$('.dentist-search-results').offset().top-50});
       if($('.pagination-list li.page.active a').hasClass('change-list-backward')){

             let newPageStartingIndex,newPageEndingIndex;
             let currentPageNo = parseInt($('.pagination-list li.page.active').data('pageno'));
             if($(".page-"+(currentPageNo-1)).length > 0){
                 newPageStartingIndex = currentPageNo-1;
                 newPageEndingIndex = currentPageNo+6;
             }
             $(".pagination-list .page").hide();
             $(".pagination-list .page a").removeClass('change-list-forward change-list-backward');

             for(m = newPageStartingIndex ; m <= newPageEndingIndex ; m++){
				$(".pagination-list .page-"+m).show();
                 if(m == newPageStartingIndex){
					$(".pagination-list .page-"+m).find('a').addClass('change-list-backward');
                 }
                 if(m == newPageEndingIndex){
					$(".pagination-list .page-"+m).find('a').addClass('change-list-forward');
                 }
             }
        }

          if(!$('.first-page').hasClass('active')){
              var activeIndex = $(".pagination-list li.active").index();
              $('.pagination-list li').eq(activeIndex-1).find('a').click();
          }
    });

    $(document).on('click','.dentist-search-pagination .pagination-list li.next a',function() {
      $('html, body').animate({scrollTop:$('.dentist-search-results').offset().top-50});
         if($('.pagination-list li.page.active a').hasClass('change-list-forward')){
             let newPageStartingIndex,newPageEndingIndex;
             let currentPageNo = parseInt($('.pagination-list li.page.active').data('pageno'));
             if($(".page-"+(currentPageNo+1)).length > 0){
                 newPageStartingIndex = currentPageNo-6;
                 newPageEndingIndex = currentPageNo+1;
             }
             $(".pagination-list .page").hide();
             $(".pagination-list .page a").removeClass('change-list-forward change-list-backward');
             for(m = newPageStartingIndex ; m <= newPageEndingIndex ; m++){
				$(".pagination-list .page-"+m).show();
                 if(m == newPageStartingIndex){
					$(".pagination-list .page-"+m).find('a').addClass('change-list-backward');
                 }
                 if(m == newPageEndingIndex){
					$(".pagination-list .page-"+m).find('a').addClass('change-list-forward');
                 }
             }
        }
        if(!$('.last-page').hasClass('active')){
          var activeIndex = $(".pagination-list li.active").index();
          $('.pagination-list li').eq(activeIndex+1).find('a').click();
      }
    });
});
function addButtons(){
  var prevButton =  "<li class='previous'><a class='txt-green' href='javascript:void(0);''><span class='txt-green glyphicon glyphicon-arrow glyphicon-triangle-left'></span>Previous</a></li>";
  var nextButton = "<li class='next'><a class='txt-green' href='javascript:void(0);''>Next<span class='txt-green glyphicon glyphicon-arrow glyphicon-triangle-right'></span></a></li>";
    if(($(".dentist-search-pagination .pagination-list .next").length == 0) && ($(".dentist-search-pagination .pagination-list .previous").length == 0)){
		$(".dentist-search-pagination .pagination-list").append(prevButton);
        $(".dentist-search-pagination .pagination-list").append(nextButton);
    }
}
function updatePagination(totalResults){
  var totalPages = getTotalPages(totalResults);
  $(".dentist-search-pagination .page-index .total-pages").text(totalPages);
  buildPaginationList(totalPages);
}

function updatePaginationList(){
  $('.dentist-search-pagination .pagination-list li.page').hide();
  var indexShown = $('.dentist-search-pagination .pagination-list li.active').index();
  $(".dentist-search-pagination .page-index .current-page").text(indexShown);

}

function getTotalPages(totalResults){
  var count1 = parseInt(totalResults/8);
  var count2 = totalResults%8;
	var totalPages = count1;
	if(count2 > 0){
		totalPages = count1+1;
	}
  return totalPages;
}
function buildPaginationList(totalPages){
  var pageno,pageinfo,changepage= '';
  if(totalPages > 1){
      addButtons();
      $(".dentist-search-pagination .pagination-list li.page").remove();
      for(i = 1; i <= totalPages ; i ++){
    	 pageinfo = '';
          if(i == 1){
            pageinfo = 'first-page';
          }
          if(i == totalPages){
            pageinfo = 'last-page';
          }
          if(i == 8){
            changepage = 'change-list-forward';
          }
        pageno = "<li class='page "+pageinfo+" page-"+i+"' data-pageno='"+i+"'><a href='javascript:void(0);' class='"+changepage+"' data-startResult='"+parseInt(i*8 - 7)+"' data-endResult='"+parseInt(i*8)+"' class='txt-green'>"+i+"</a></li>";
        $(".dentist-search-pagination .pagination-list .next").before(pageno);
      }
      $(".dentist-search-pagination .pagination-list .page-1").addClass('active');
      $(".dentist-search-pagination .pagination-list .next").show();
	  $(".dentist-search-pagination .pagination-list .previous").addClass('visibility-hidden').removeClass('visibility-visible');
      if($(".dentist-search-pagination .pagination-list li.page").length > 8){
          for(m = 9; m <= totalPages ; m++){
			$(".dentist-search-pagination .pagination-list li.page-"+m).hide();
          }
      }

    $(".dentist-search-pagination .pagination-list").show();
  }else{
    $(".dentist-search-pagination .pagination-list").hide();
  }
}
function updateDropDownOnPageLoad(className,pageLoadValue){
  
	$("."+className).val(pageLoadValue);
    $("."+className ).parent().find(".select-options li").each(function(){
        if($(this).attr("rel") == pageLoadValue){
           $("."+className ).parent().find(".select-styled").text($(this).text());
        }
    });
}

$(function(){

    $(document).on('click', '.print-dentistslist', function(){
        if($(".dentist-result.result-visible").length > 0 && getTotalDentistsSelected() > 0){
			let printResultsObj = getAddtoListResults();
			localStorage.setItem("printResultsObj",JSON.stringify(printResultsObj));  
			let redirectURL = $(this).data('url');
			window.open(redirectURL);
        }else{
			$("#noSelectionPopUp").modal('show');
        }
    });


});

function buildParamForLocalStorage(param){
    let localStorageParam = '';
    if(typeof param == 'string'){
        localStorageParam = param.length > 0 ? param+'##' : 'empty##' ;
    }else if(typeof param == "number"){
        localStorageParam = param > 0 ? param+ '##' : 'empty##' ;
    }
    return localStorageParam;
}
function getDentistsProductText(){

    // This wouldn't work for Private Exchange.
  let productText = '';
  if($(".dentistsearchresults .participation-list").val() && $(".dentistsearchresults .participation-list").val().length > 0){
      productText = $(".dentistsearchresults .participation-list option:selected").text();
  }

  return productText;
}
function getDentistsLangText(){
  let languageText = '';
  if($('.language-dropdown').val() && $('.language-dropdown').val().length > 0  && $('.language-filters').is(':visible')){
      languageText = $('.language-dropdown option:selected').text();
    }
    if($('.language-dropdown-mobile').val() && $('.language-dropdown-mobile').val().length > 0 && $('.language-filters-mobile').is(':visible')){
        languageText = $('.language-dropdown-mobile option:selected').text();
    }
    return languageText;
}
function getDentistsGender(){
  let gender = '';
  if(textNotEmpty($('.gender-dropdown').val()) && $('.gender-dropdown').val() != 'Any' && $('.gender-filters').is(':visible')){
     gender = $('.gender-dropdown').val();
  }
  if(textNotEmpty($('.gender-dropdown-mobile').val()) && $('.gender-dropdown-mobile').val() != 'Any' && $('.gender-filters-mobile').is(':visible')){
     gender = $('.gender-dropdown-mobile').val();
  }
  return gender;
}

// Google Maps integration for dentist search results starts
var map;
var markers = [];
var mapCenterLatLng = {};
var prevInfoWindow;
var mapResults = function() {

  var options = {
      zoom: 14,
      mapTypeId: google.maps.MapTypeId.ROADMAP,
  	  scrollwheel:false
  };

  if (map == null) {
    map = new google.maps.Map(document.getElementById('searchResultsMap'), options);
  }

  /* Clear previous pins on the map */
   for (var j = 0; j < markers.length; j++ ) {
    markers[j].setMap(null);
  }
  markers = [];
  var center = new google.maps.LatLng(mapCenterLatLng.latitude,mapCenterLatLng.longitude);
  map.panTo(center);


  var num_markers = locationCoords.length;
            var img=new google.maps.MarkerImage('/etc.clientlibs/ddpa/clientlibs/core/resources/images/location-pin.png',
                new google.maps.Size(28, 38),
                new google.maps.Point(0,0),
                new google.maps.Point(28/2, 38/2)
           );
  for (var i = 0; i < num_markers; i++) {
    let locationPinDentistInfo = i+1+". "+locationCoords[i][2]+" "+locationCoords[i][3]+"<br />"+locationCoords[i][4]+"<br />"+locationCoords[i][5]+", "+locationCoords[i][6]+" "+locationCoords[i][7];
    markers[i] = new google.maps.Marker({
      position: {lat:locationCoords[i][0], lng:locationCoords[i][1]},
      map: map,
      html: locationPinDentistInfo,
      id: i,
      icon: img
    });

    google.maps.event.addListener(markers[i], 'click', function(){
		if(prevInfoWindow){
			prevInfoWindow.close();
        }
      	var infowindow = new google.maps.InfoWindow({
        	id: this.id,
        	content:this.html,
        	position:this.getPosition()
      	});
	    prevInfoWindow = infowindow;
        infowindow.open(map);
    });
  }
};  
var lastName,fname,genderCode,distance,specialties,prvdrLanguages,addressOne,stateCode,zip,telephoneNumber,dentistObj;
$(document).on('click', '.pdf-dentistslist', function(){
   if($(".dentist-result.result-visible").length > 0 && getTotalDentistsSelected() > 0){
    let pdfUrl = $('.pdf-dentistslist').attr('data-url');
    let addtoListResultsObj = getAddtoListResults();
    openWithPost(pdfUrl, 'pdfDentistSearchResults', addtoListResultsObj);
  }else{
    $("#noSelectionPopUp").modal('show');
  }

});

var getAddtoListResults = function() {
	let dentists = [];
    let filters = {};

  $(".dentist-result").each(function(){
      if($(this).find("input").is(':checked')){
      let dentistObj = {};
      dentistObj['lastName'] = $(this).find('span.last-name').text();
      dentistObj['firstName'] = $(this).find('span.first-name').text();
      dentistObj['distance'] = $(this).data('distance');
      dentistObj['genderCode'] = $(this).data('gender');
      dentistObj['specialties'] = $(this).find('.dentist-designation .designation-title').eq(0).text();
      dentistObj['prvdrLanguages'] = $(this).data('prvdrlanguages');
      dentistObj['addressOne'] = $(this).data('address');
      dentistObj['stateCode'] = $(this).data('statecode');
      dentistObj['zip'] = $(this).data('zip');
      dentistObj['telephoneNumber'] = $(this).find('.phone').text();
      dentistObj['handicappedAccessible'] = $(this).data('handicappedaccessible');
      dentistObj['publicTransAvail'] = $(this).data('publictransavail');
      dentistObj['education'] = $(this).data('education');
      dentistObj['participationList'] = $(this).data('participates');
      dentistObj['businessHours'] = $(this).find('.timing .icon-details').text();
      dentistObj['dentistEmail'] = $(this).find('.dentist-email .info-detail').text();
      dentistObj['facilityID'] = $(this).data('facilityid');
      //dentistObj['acceptsPatients'] = $(this).find('.accepts').data('accepts') === 'Y' ? true : false;
      dentistObj['treatsChildren'] = $(this).data('treatschildren');
      dentistObj['treatsAdults'] = $(this).data('treatsadults');
      dentistObj['city'] = $(this).data('city');
      dentistObj['officeLanguages'] = $(this).data('officelanguages');
      dentistObj['businessName'] = $(this).data('businessname');
	  dentistObj['acceptsString'] = $(this).data('acceptsstring');
	  dentistObj['phone'] = $(this).data('phone');
	  dentistObj['dentistWebURL'] = $(this).data('dentistweburl');
	  dentistObj['pnrScore'] = $(this).data('pnrscore');
	  dentistObj['pnrUrl'] = $(this).data('pnrurl');
      dentistObj['teledentistry'] = $(this).data('teledentistry');
      dentistObj['raceEthnicity'] = $(this).data('raceethnicity');
      dentists.push(dentistObj);
    }
  });

  filters['Product'] = getDentistsProductText() ? getDentistsProductText() : '';
  filters['Address'] = $('#dentistSearchAddresss').val();
  filters['resultSortedBy'] = $('.sort-by-dropdown option:selected').text();
  filters['Distance'] = $('.distance-dropdown').val();
  filters['NumberOfResults'] = $(".results-dropdown").val();
  filters['Specialty'] = $(".dentistsearchresults .speciality-list option:selected").text();
  filters['Language'] = $('.language-dropdown').val() ? $('.language-dropdown option:selected').text() : "";
  filters['Gender'] = $('.gender-dropdown').val() ? $('.gender-dropdown option:selected').text() : '';
  filters['TotalResultsFetched'] = getTotalDentistsSelected();
  filters['receiverEmail'] = $('.to-email-address').val().length > 0 ? $('.to-email-address').val() : '';

  let dentistsListObj = {
    'dentists': dentists,
    'filters': filters
  };
  return dentistsListObj;
};

var ddpa = {
    dentistSearchAjaxInProgress: false
};
var dentistSearchSuccessEmail = getI18nValue('dentistSearchSuccessEmail', "Success Message");
var dentistSearchFailedEmail = getI18nValue('dentistSearchFailedEmail', "Failed Message");
var dentistAccessible = getI18nValue('dentistAccessible',"Accessible");
var dentistScheduleAppointment = getI18nValue('dentistScheduleAppointment',"Schedule appointment");
var dentistPublicTransitAccess = getI18nValue('dentistPublicTransitAccess',"Public transit Access");
var dentistTreatsDisabledAdults = getI18nValue('dentistTreatsDisabledAdults',"Treats disabled adults");
var dentistTreatsDisabledChildren = getI18nValue('dentistTreatsDisabledChildren',"Treats disabled children");
var dentistWebsite = getI18nValue('dentistWebsite',"Website");
var dentistMilesAway = getI18nValue('dentistMilesAway',"miles away");
var dentistSearchOffice = getI18nValue('dentistSearchOffice',"Office");
var dentistSearchEmail = getI18nValue('dentistSearchEmail',"Email");
var dentistSearchMale = getI18nValue('dentistSearchMale',"Male");
var dentistSearchFemale = getI18nValue('dentistSearchFemale',"Female");
var dentistSearchNonBinary = getI18nValue('dentistSearchNonBinary',"Non-Binary");
var dentistSearchUndisclosed = getI18nValue('dentistSearchUndisclosed',"Undisclosed");
var dentistSearchListParams = $.extend({}, ajaxParams_default);
var defaultStateSelected = '';
var ethnicityTable = {
    "AIAN": "American Indian or Alaska Native",
    "A": "Asian",
    "BAA": "Black or African American",
    "HL":"Hispanic or Latino",
    "NHOPI":"Native Hawaiian or other Pacific Islander",
    "W":"White",
    "ND":"Preferred not to disclose"
};

$(function() {

    $("#dentistSearchAddresss").each(function() {
        initAutocomplete();

        function initAutocomplete() {
            autocomplete = new google.maps.places.Autocomplete($('#dentistSearchAddresss')[0], {types: ['geocode']});
            autocomplete.setFields(['geometry']);
        }
    });

	var defaultDistance = true;
    // get the search parameters from localStorage and get the dentist search results query paramters
    var queryStringOnLoad = '';
    dentistSearchListParams.successCallbackFunction = loadDentistSearchResults;
    dentistSearchListParams.errorCallBackFunction = dentistResultsAjaxFail;
	dentistSearchListParams.completeCallbackFunction = dentistSearchAjaxCompleted;
    if (localStorageisValid()) {
		var searchValues = JSON.parse(localStorage.getItem("findADentistJson"));

        if (searchValues && typeof searchValues !== "undefined" && searchValues !== null) {
            if (searchValues.address != '') {
                $("#dentistSearchAddresss").val(searchValues.address);
                $("#dentistSearchAddresss").parent().find('.clearTextbtn').show();
                queryStringOnLoad = queryStringOnLoad+"&city=" + encodeURIComponent(searchValues.address.normalize('NFD').replace(/\p{Diacritic}/gu, ""));
            }

            // Dentist Last Name
            if (searchValues.dentistLastName != '') {
                $("#dentistSearchLastNameInput").val(searchValues.dentistLastName);
                queryStringOnLoad = queryStringOnLoad+"&lastName=" + searchValues.dentistLastName;
                setTimeout(function() {
                    $("#toggle-filters").click();
                },2000);
            }

            // Dentist Specialty
            if (searchValues.speciality != '') {
                if (searchValues.speciality != 'Any') {
                    queryStringOnLoad = queryStringOnLoad + "&specialtyCode=" + searchValues.speciality;
                }
                $(".dentist-search-results-container .speciality-list option[value='"+searchValues.speciality+"']").attr('selected','selected');
            }

            // Product Code
            if (searchValues.participates != '') {
                queryStringOnLoad = queryStringOnLoad + "&productCode=" + searchValues.participates;
                var productMode = $("input[name='productMode']").val();
                if ( productMode === null || productMode === undefined || productMode == 'generalMode' ) {
                    $(".dentist-search-results-container .participation-list option[value='" + searchValues.participates + "']").attr('selected','selected');
                }
                else{
                    $(".dentist-search-results-container .private-exchange-list option[value='" + searchValues.privateExchangeParticipation + "']").attr('selected','selected');
                }
            }

            localStorage.removeItem("findADentistJson");
            dentistSearchListParams.url = "/conf/ddpa/paths/dentistsearchrest.json?maximumNumberOfRecordsToReturn=50"+queryStringOnLoad;
            setTimeout(function() {
                $(".dentist-search-results .loading-results").show();
                ajaxCall(dentistSearchListParams);
            },1000);
        }

        $(document).on("click", ".suggest-update", function () {
            var populateDentistFName = $(this).closest(".dentist-result").find(".dentist-title .first-name").html();
            var populateDentistLName = $(this).closest(".dentist-result").find(".dentist-title .last-name").html();
            var populateDentistAddress = $(this).closest(".dentist-result").find(".dentist-details .dentist-location .dentist-adress-street").html();
            var populateDentistAddressCity = $(this).closest(".dentist-result").find(".dentist-details .dentist-location .dentist-adress-city").html();
            var populateDentistPhone = $(this).closest(".dentist-result").find(".dentist-details .dentist-phone .info-detail.phone>a").html();
            var populateDentistServiceOfficeEmail = $(this).closest(".dentist-result").find(".dentist-more-info .dentist-email>a").html();
            var stateCode = $(this).closest(".dentist-result").data('stateCode');
            $(".populate-dentist-address").data('stateCode', stateCode);
            $(".populate-dentist-fname").html(populateDentistFName);
            $(".populate-dentist-lname").html(populateDentistLName);
            $(".populate-dentist-phone-number").html(populateDentistPhone);
            $(".populate-dentist-service-office-email").html(populateDentistServiceOfficeEmail);
            $(".populate-dentist-address").html(populateDentistAddress);
            $(".populate-dentist-city").html(populateDentistAddressCity);
        });

        /* Generates the captcha function */
        function DrawCaptcha() {
            var a = Math.ceil(Math.random() * 10) + '';
            var b = Math.ceil(Math.random() * 10) + '';
            var c = Math.ceil(Math.random() * 10) + '';
            var d = Math.ceil(Math.random() * 10) + '';
            var e = Math.ceil(Math.random() * 10) + '';
            var f = Math.ceil(Math.random() * 10) + '';
            var g = Math.ceil(Math.random() * 10) + '';
            var code = a + ' ' + b + ' ' + ' ' + c + ' ' + d + ' ' + e + ' ' + f + ' ' + g;
            $(".captcha-text").html(code);
        };
        DrawCaptcha();
    }

	if (defaultDistance) {
		 $("#dentistSearchDistanceDropdown option[value='15']").attr('selected','selected');
    }

    // For the case of 'findadentist' only, get the subscriber's product code if they are logged in. Use this for the Product Code dropdown.
    // (For the case of 'dentist-search-result, the product code is taken from localstorage which it is put by 'findadentist'.)


    let getProdCodeParams = $.extend({}, ajaxParams_default);
    getProdCodeParams['url'] = getUserProfileServiceURL();
    getProdCodeParams['successCallbackFunction'] = updateProdCode;
    getProdCodeParams['errorCallBackFunction'] = updateProdCodeFailed;
    ajaxCall(getProdCodeParams);


    $(document).on("click",".dentist-more-info .dentist-other-info-title",function() {
         $(this).find("span").toggleClass("hidden");
         $(this).parent().find(".dentist-other-info").slideToggle();
    });
     $(document).on('click', '.get-map', function() {
			$(".search-results-map").slideToggle(1500);
	 });
     $(document).on('click', '.dentist-location', function() {
         var destAddress = "" + $(this).find(".dentist-adress-street").text();
         destAddress += "%20" + $(this).find(".dentist-adress-city").text();
	     window.open("http://maps.google.com/maps?saddr="+getDentistAddress()+"&daddr="+ destAddress);
    });

	$(document).on("mouseenter", ".dentist-designation .designation-title", function() {
        $(this).parent().parent().find(".designation-description").show();
    });

	$(document).on("mouseleave", ".dentist-designation .designation-title", function() {
        $(this).parent().parent().find(".designation-description").hide();
    });

    if (!$("input.dentist-search-input").val()) {
        $("input.dentist-search-input").parent().find('.clearTextbtn').hide();
    }

    /* Dentist search filters toggling*/
    $("#toggle-filters").on('click',function() {
      $(this).toggleClass('closed');
      $(this).find('span.view-more-filters,span.view-less-filters').toggle();
	  $(this).find('span.caret').toggleClass('ddpa-caret-down  ddpa-caret-up');
      $(".refine-filters").slideToggle('slow');
    });

	/* clearing text on click of remove button */
    $('.clearTextbtn').on( "click", function() {
     $(this).parent().find('input.dentist-search-input').val("").removeClass('activeField');
     $(this).hide();
     if (dentistSearchZipCodeInputEmpty() && dentistSearchAddressInputsEmpty()) {
        $(".dentist-error").hide();
     }
   });

    $("input.dentist-search-input").focus(function() {
        if (textNotEmpty($(this).val())) {
             $(this).parent().find('.clearTextbtn').show();
        }
    });

    $("input#dentistSearchStateInput").focus(function() {
        if ($(this).val()) {
             $(this).parent().parent().find('.clearTextbtn').show();
        }
    });

     $("input.dentist-search-input").on("keyup",function(e) {
         if (textNotEmpty($(this).val())) {
            $(this).addClass('activeField');
            $(this).parent().find('.clearTextbtn').show();
             if (e.which == 13 || e.which == 9) {
				validateTheMandateFields();
             }
         }else{
            $(this).parent().find('.clearTextbtn').hide();
            $(this).removeClass('activeField');
            if (dentistSearchZipCodeInputEmpty() && dentistSearchAddressInputsEmpty()) {
                $(".dentist-error").hide();
            }
         }
    });


	// clearing fields on closing the modal @ feedback popup
	$('#feedbackPopup').on('hidden.bs.modal', function () {
      $("#feedbackPopup #subscriberName").val('').removeClass('activeField');
      $("#feedbackPopup #subscriberEmailId").val('').removeClass('activeField');
      $("#feedbackPopup #captchaInput").val('').removeClass('activeField');
      $("#additionalComment").val('');
      $(".form-captcha-error").hide();
      var defaultText = $(".select-reason-content .select-options li").eq(0).text();
      $(".select-reason-content .select-styled").text(defaultText);
    });

	$(".refine-search-button").on('click',function() {
		 $("#refinePopup").modal('hide');
         validateTheMandateFields();
    });

    $(".find-dentists-button").on("click",function() {
		 validateTheMandateFields();
    });

    $('.fetch-new-results').on('click',function() {
         validateTheMandateFields();
     });


     /**
      * Remove clear button on USWDS dropdowns:
      */
    setTimeout(() => {
        $(".dentist-search-results-container .usa-select.participation-list").siblings(".usa-combo-box__clear-input__wrapper").remove();
        $(".dentist-search-results-container .usa-select.speciality-list").siblings(".usa-combo-box__clear-input__wrapper").remove();
    }, 500);
});
function customDropdownSelectize() {
   $('.custom-dropdown').selectize({
         onChange: function() {
             var dentistSearchPage = textNotEmpty($('.dentist-search-results-container')) ? true : false;
             if (dentistSearchPage) {
                 validateTheMandateFields();
             }
         }
    });

}

function updateProdCode(data, className) {

    if ( data.productCode) {
        $(".findadentist-section option[value='placeholder']").remove();
        switch (data.productCode) {
            case "01":
            case "1":
                $(".findadentist-section option[value='Premier']").attr('selected','selected');
                break;
            case "20":
                $(".findadentist-section option[value='PPO']").attr('selected','selected');
                break;
            case "30":
                $(".findadentist-section option[value='Deltacare']").attr('selected','selected');
                break;
            case "40":
                $(".findadentist-section option[value='PatientDirect']").attr('selected','selected');
                break;
            case "ppoPlusPremier":
            case "25":
            case "26":
                $(".findadentist-section option[value='ppoPlusPremier']").attr('selected','selected');
                break;
        }

    }

    customDropdownSelectize();
}

function updateProdCodeFailed() {
   console.error("getting product code for subscriber failed.");
   customDropdownSelectize();
}


function getDentistSearchResults() {
    var wrap = $('.dentist-search-results-container');

    $(".refine-options").hide();
    $(".overlay-background").hide();
    $(".add-all-to-list-mobile").hide();
    $(".check-all-results").prop("checked", false);
    $(".selected-list-count .selected-count").text(0);
    $("#dentistSearchMobileMoreMenuLink .selected-count").text(0);
    $(".dentist-search-results-container .total-results-message").hide();
    $(".search-results-map").removeClass("has-results");
    $(".add-to-list input[type='checkbox']").prop("checked", false);

    if (ddpa.dentistSearchAjaxInProgress) {
        return;
    }

    ddpa.dentistSearchAjaxInProgress = true;
    $(".dentist-search-results .search-results").empty();
    $('.no-results-found').hide();
    $(".dentist-search-results .loading-results").show();
    var queryString = '';
    var DentistsGender = getDentistsGender();
    var DentistsLang = getDentistsLang();
    var DentistsDist = getDentistsDist();
    var DentistsOfficeTimes = getDentistsOfficeTimes();
    var DentistsSortType = getDentistsSortType();
    var DentistsAcceptsNewPatients = getDentistsAcceptsNewPatients();
    var DentistsRecordsToReturn = getDentistsRecordsToReturn();
    var DentistsZipCode = getDentistsZipCode();
    var DentistsParticipation = textNotEmpty($(".participation-list", wrap).val()) ? $(".participation-list", wrap).val() : '';
    let productMode = $("input[name='productMode']").val();

    if (productMode != null && productMode != undefined && productMode == 'privateExchangeMode') {
        let privateExchangeParticipation = textNotEmpty($(".private-exchange-list",wrap).val()) ? $(".private-exchange-list",wrap).val() : '';
        //  private exchanges has bronze, silver, gold and  platinum.  replace with normal product codes
        switch (privateExchangeParticipation) {
            case "Bronze":
            case "Silver":
            case "Gold":
                DentistsParticipation = "ppoPlusPremier";
                break;
            case "Platinum":
                DentistsParticipation = "Deltacare";
                break;
            default:
                DentistsParticipation = "";
                break;
        }
    }
    var DentistsSpeciality = textNotEmpty($(".speciality-list", wrap).val()) ? $(".speciality-list", wrap).val() :'';
    var DentistsLastName = getDentistsLastName();
    var DentistsPractise = getDentistsPractise();

    queryString = textNotEmpty(DentistsGender) ? queryString+"&genderCode="+DentistsGender : queryString;
    queryString = textNotEmpty(DentistsLang) ? queryString+"&languageCode="+DentistsLang : queryString;
    queryString = textNotEmpty(DentistsDist) ? queryString+"&maximumDistance="+DentistsDist : queryString;
    queryString = textNotEmpty(DentistsOfficeTimes) ? queryString+"&officeTimes="+DentistsOfficeTimes : queryString;
    queryString = textNotEmpty(DentistsSortType) ? queryString+"&sortType="+DentistsSortType : queryString;
    queryString = textNotEmpty(DentistsAcceptsNewPatients) ? queryString+"&isAcceptingNewPatientsOnly="+DentistsAcceptsNewPatients : queryString;
    queryString = textNotEmpty(DentistsZipCode) ? queryString+"&zipCode="+DentistsZipCode : queryString;
    queryString = textNotEmpty(DentistsParticipation) ? queryString+"&productCode="+DentistsParticipation : queryString;
    queryString = (textNotEmpty(DentistsSpeciality) && DentistsSpeciality != "Any") ? queryString+"&specialtyCode="+DentistsSpeciality : queryString;
    queryString = textNotEmpty(DentistsLastName) ? queryString+"&lastName="+DentistsLastName : queryString;
    queryString = textNotEmpty(DentistsPractise) ? queryString+"&businessName="+DentistsPractise : queryString;
    queryString = queryString+"&maximumNumberOfRecordsToReturn="+DentistsRecordsToReturn;

    if ($('.address-fields').data('address') && $('.address-fields').data('address').toString().length > 0) {
        queryString = queryString+"&city=" + $('.address-fields').data('address').toString();
    } else {
        queryString = queryString+"&city="+ $(".dentist-search-results").data('address');
    }

    dentistSearchListParams.url = "/conf/ddpa/paths/dentistsearchrest.json?"+queryString.substring(1);

    ajaxCall(dentistSearchListParams);
}

function loadDentistSearchResults(searchResults) {

    if (searchResults && searchResults.listOfLocations && isObject(searchResults) && searchResults.listOfLocations.length > 0) {
        $(".dentist-search-results .loading-results").hide();
        $("#localsearchresults").hide();
        $(".dentist-search-results .search-results").data('total-results',searchResults.listOfLocations.length);
        $(".dentist-search-results-container .total-results-message .total-results-count").text(searchResults.listOfLocations.length);
        $(".total-results-message-local .total-results-count-local").text(searchResults.listOfLocations.length);
        $(".dentist-search-results-container .total-results-message").show();
        $(".search-results-map").addClass("has-results");
        $('.no-results-found').hide();
        $(".search-results").show();
        $(".search-results-map").show();
        $(".add-all-to-list-mobile").show();
        $(".dentist-search-pagination .page-index .current-page").text("1");
        var searchResultsListSource = $("#searchResultsList").html();
        $(".check-all-results").prop("disabled",false);
		locationCoords = [];
		var searchResultsListTemplate = Handlebars.compile(searchResultsListSource);

        if (searchResults.lastUpdate) {
            $("#last-update").text(searchResults.lastUpdate);
            $(".last-update-container").show();
        } else{
            $(".last-update-container").hide();
        }

		$.each(searchResults.listOfLocations,function(index,dentist) {

			var dentistParticipates = "";
			var dentistLangs = "";
			var access = "";
			var preScheduleURL = textNotEmpty($(".schedule-url").val()) ? $(".schedule-url").val() : '' ;
			var latlonValue = [dentist.latitude, dentist.longitude, dentist.firstName, dentist.lastName, dentist.addressOne, dentist.city, dentist.stateCode, formatZipCode(dentist.zip)];
            var gender = "";

            switch (dentist.genderCode) {
                case "F":
                    gender = dentistSearchFemale;
                    break;
                case "M":
                    gender = dentistSearchMale;
                    break;
                case "X":
                    gender = dentistSearchNonBinary;
                    break;
                case "P":
                default:
                    gender = dentistSearchUndisclosed;
                    break;
            }

            locationCoords.push(latlonValue);

			if (index == 0) {
			    mapCenterLatLng.latitude = dentist.latitude;
                mapCenterLatLng.longitude = dentist.longitude;
            }

            if (isBoolean(dentist.handicappedAccessible) && dentist.handicappedAccessible) {
                access = "<li class='accessible'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+dentistAccessible+"</p></li>";
            }

			// AB-382 : Replace this code to re-enable Medicare Advantage. Repeat for the other AB-382 comments.
			// var events = '',eventsList=['Delta Dental PPO','Delta Dental Premier','DeltaCare USA','Delta Dental Patient Direct','Delta Dental Medicare Advantage'];

            var events = '',eventsList=['Delta Dental PPO','Delta Dental Premier','DeltaCare USA','Delta Dental Patient Direct','Delta Dental Medicare Advantage'];

            if (textNotEmpty(dentist.products)) {
				for(i = 0 ; i < dentist.products.length ; i++) {
					if ($.inArray(dentist.products[i].productDescription,eventsList)!= -1) {
						events = events + ", " + dentist.products[i].productDescription;
					}
				}
				if (textNotEmpty(events)) {
					events = events.substring(1);
				}
			}else{
				if ($.inArray(dentist.products.productDescription,eventsList)!= -1) {
					events = dentist.products.productDescription;
				}
			}

            var referalText = '',ddPPO='',ddpaPremier='',ddpaUSA='',ddpaDirect='',ddpaAdvantage='',acceptsString='',faciltyIdText='';

            if (dentist.products.length > 0) {
				for (i = 0 ; i < dentist.products.length ; i++) {
                    if (dentist.products[i].productDescription == "Delta Dental PPO") {
                        ddPPO = "<p class='info-detail'><span>" + dentist.products[i].productDescription+"</span><span class='block accepts-criteria'>"+getAcceptsText(dentist.products[i])+"</span></p>";
						acceptsString = acceptsString+","+getAcceptsValue(dentist.products[i]);
					}
                    if (dentist.products[i].productDescription == "Delta Dental Premier") {
                        ddpaPremier = "<p class='info-detail'><span>" + dentist.products[i].productDescription+"</span><span class='block accepts-criteria'>"+getAcceptsText(dentist.products[i])+"</span></p>";
						acceptsString = acceptsString+","+getAcceptsValue(dentist.products[i]);
					}
					if (dentist.products[i].productDescription == "DeltaCare USA") {
                        ddpaUSA = "<p class='info-detail'><span>" + dentist.products[i].productDescription+"</span>"+getDentistReferalText(dentist)+"<span class='block accepts-criteria'>"+getAcceptsText(dentist.products[i])+"</span></p>";
						acceptsString = acceptsString+","+getAcceptsValue(dentist.products[i]);
						faciltyIdText = getDentistFacilityContact(dentist);
					}
                    if (dentist.products[i].productDescription == "Delta Dental Patient Direct") {
                        ddpaDirect = "<p class='info-detail'><span>" + dentist.products[i].productDescription+"</span><span class='block accepts-criteria'>"+getAcceptsText(dentist.products[i])+"</span></p>";
						acceptsString = acceptsString+","+getAcceptsValue(dentist.products[i]);
					}
					/*
					AB-382 : Uncomment this code to re-enable Medicare Advantage. Repeat for the other AB-382 comments.*/
				    if (dentist.products[i].productDescription == "Delta Dental Medicare Advantage") {
                        ddpaAdvantage = "<p class='info-detail'><span>" + dentist.products[i].productDescription+"</span><span class='block accepts-criteria'>"+getAcceptsText(dentist.products[i])+"</span></p>";
                        acceptsString = acceptsString+","+getAcceptsValue(dentist.products[i]);
                    }

				}
				acceptsString = acceptsString.substring(1);
				dentistParticipates = ddPPO + ddpaPremier + ddpaUSA + ddpaDirect + ddpaAdvantage;
			} else {
				if ($.inArray(dentist.products.productDescription,eventsList)!= -1) {
					acceptsString = getAcceptsValue(dentist.products);
				}
                if (dentist.products.productDescription == "DeltaCare USA") {
					 referalText = getDentistReferalText(dentist);
					 faciltyIdText = getDentistFacilityContact(dentist);
                }
				if ($.inArray(dentist.products.productDescription,eventsList)!= -1) {
					dentistParticipates = "<p class='info-detail'><span>"+ dentist.products.productDescription +"</span>"+referalText+"<span class='block accepts-criteria'>"+getAcceptsText(dentist.products)+"</span></p>";
				}
            }

            var participatesDiv ='';
            if (textNotEmpty(dentistParticipates)) {
                participatesDiv = "<div class='dentist-participation info-bar'><p class='info-detail'>"+dentistParticipates+"</p></div>";
            }

			var allLanguages = getDentistsLanguages(dentist);
            if (textNotEmpty(allLanguages)) {
			   dentistLangs = "<li class='chat'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+allLanguages+"</p></li>";
            }

            var scheduleAppointment ='';
            if (isString(dentist.providerScheduleUrl)) {
                scheduleAppointment = "<a target='_blank' href='"+preScheduleURL+$.trim(dentist.providerScheduleUrl)+"' class='redirect-link white-link schedule-appointment'>"+dentistScheduleAppointment+"</a>";
            }

            var publicTransAvail = '';
            if (isBoolean(dentist.publicTransAvail) && dentist.publicTransAvail) {
                publicTransAvail = "<li class='transit'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+dentistPublicTransitAccess+"</p></li>";
            }

            var education='', educationInstitute='', educationDesc='', totalEdu = '';
            if (isObject(dentist.education)) {
			    if (Array.isArray(dentist.education) && dentist.education.length >= 1) {
					// var totalEdu = '';
					$.each(dentist.education,function(index,edu) {

                        if (textNotEmpty(edu.educationDesc)) {
                            totalEdu = totalEdu+ "<span>"+edu.educationDesc+"</span><br/>";
                            education = education +", "+edu.educationDesc;
                        }

                        if (textNotEmpty(edu.institutionName)) {
                            totalEdu = totalEdu+ "<span>"+edu.institutionName+"</span><br/>";
                        }
					 });
					 education = education.substring(2);
			    }else{
					education = isString(dentist.education.educationDesc) ? dentist.education.educationDesc : '';
					educationDesc = education;
					if (textNotEmpty(education)) {
						totalEdu = "<span>"+education+"</span><br/>";
					}
					educationInstitute = isString(dentist.education.institutionName) ? dentist.education.institutionName : '';
					if (textNotEmpty(educationInstitute)) {
						totalEdu = totalEdu + "<span>"+educationInstitute+"</span>";
					}
				}
            }

            var facilityID = '';
            if (isString(dentist.facilityID)) {
                facilityID = dentist.facilityID;
            }
			var officeTimesList = '';
            if (isString(dentist.officeTimes)) {
                officeTimesList = "<li class='timing'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+dentist.officeTimes+"</p></li>";
            } else if (isObject(dentist.officeTimes)) {
            	officeTimesList = "<li class='timing'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+dentist.officeTimes.join(', ')+"</p></li>";
            }
            //officeEmail is deprecated
            var officeEmail = '';
            if (isString(dentist.officeEmail) && dentist.officeEmail && textNotEmpty(dentist.officeEmail)) {
                officeEmail = "<div class='dentist-email info-bar col-sm-4'><p class='info-title'>"+dentistSearchEmail+"</p>"+
                "<a href='mailto:"+dentist.officeEmail+"' class='info-detail no-margin bold'>"+dentist.officeEmail+"</a></div>";
            }
			var office = '';
			 if (isString(dentist.businessName) && dentist.businessName && textNotEmpty(dentist.businessName)) {
                office = "<div class='dentist-office info-bar'><p class='info-detail dentist-office'>"+dentist.businessName+"</p></div>";
            }

			var addressFields = '', dentistMilesInfo = '';
			if (isString(dentist.addressOne) && dentist.addressOne) {
            	if (isString(dentist.addressTwo) && dentist.addressTwo) {
            	    addressFields = "<span class='dentist-adress-street block'>" + dentist.addressOne + " " + dentist.addressTwo + "</span><span class='dentist-adress-city block'>";
                }
                else {
                    addressFields = "<span class='dentist-adress-street block'>" + dentist.addressOne + "</span><span class='dentist-adress-city block'>";
                }
            }

            if (isString(dentist.city) && dentist.city) {
				addressFields = addressFields + dentist.city;
			}

            if (isString(dentist.stateCode) && dentist.stateCode) {
				addressFields = addressFields +", "+ dentist.stateCode;
			}

            if ( dentist.zip) {
                addressFields = addressFields +" "+ formatZipCode(dentist.zip) + "</span>";
			}

            var formattedDistance = parseFloat(dentist.distance).toFixed(1);
            if (!isNaN(formattedDistance)) {
            //if (isNumber(dentist.distance) && (dentist.distance >= 0)) {
				dentistMilesInfo = " <span class='miles-away'>"+ formattedDistance +" "+dentistMilesAway+"</span>";
			}

            var treatsAdults =false,treatsChildren =false,treatsText = '',treatsAdultsText='',treatsChildrenText='';
			if (isBoolean(dentist.providerServcDisableAdlt) && dentist.providerServcDisableAdlt) {
                treatsAdults = true;
			}

			if (isBoolean(dentist.providerServcDisableChld) && dentist.providerServcDisableChld) {
				treatsChildren = true;
			}

            if (treatsAdults) {
				treatsAdultsText = "<span class='adults'>"+dentistTreatsDisabledAdults+"</span>";
				if (treatsChildren) {
					treatsAdultsText = "<span class='adults'>"+dentistTreatsDisabledAdults+", </span>";
				}
            }

            if (treatsChildren) {
				if (treatsAdults) {
					treatsChildrenText = "<span class='children pad-left'>"+dentistTreatsDisabledChildren+"</span>";
				}else{
					treatsChildrenText = "<span class='children'>"+dentistTreatsDisabledChildren+"</span>";
				}
            }

            if (textNotEmpty(treatsAdultsText) || textNotEmpty(treatsChildrenText)) {
				treatsText = "<li class='treats'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+treatsAdultsText+treatsChildrenText+"</p></li>";
            }

            if (textNotEmpty(treatsAdultsText) && textNotEmpty(treatsChildrenText)) {
				treatsText = "<li class='treats'><p class='icon no-margin'></p><p class='icon-details no-margin'>"+treatsAdultsText+""+treatsChildrenText+"</p></li>";
            }
            // website here is deprecated
			var website = '',dentistWebURL='';
            if (isString(dentist.urlText) && textNotEmpty(dentist.urlText)) {
				dentistWebURL = getHttpLink(dentist.urlText);
				website = "<div class='dentist-website info-bar col-sm-4'><p class='info-title'>"+dentistWebsite+"</p><p class='info-detail no-margin'><a href='"+getHttpLink(dentist.urlText)+"' target='_blank'>"+dentist.urlText+"</a></p></div>";
			}

            var resultHidden = "";
            if (parseInt(index+1) > 8) {
                resultHidden = 'result-hidden';
            }else{
                resultHidden = 'result-visible';
            }
            var pnrStarsWidth = 100;
            var pnrShow = "";
            if ( dentist.pnrUrl == null) {
               pnrStarsWidth = 0;
               pnrShow = "hide";
            }
            else {
                var score = parseFloat(dentist.pnrScore).toFixed(1);
                if (!isNaN(score)) {
                  pnrStarsWidth = score * 20;
                }
            }
            var howBadgeShow = "hide";
            if (dentist.extendedAttributes != null) {
                for(i = 0 ; i < dentist.extendedAttributes.length ; i++) {
                    if (dentist.extendedAttributes[i].key == "HOW" &&
                        dentist.extendedAttributes[i].value == "true") {
                        howBadgeShow = "";
                        break;
                    }
                }
            }
            var teledentistry = "";
            if (isBoolean(dentist.offersTelehealthServices) && dentist.offersTelehealthServices) {
                teledentistry =
                    "<li class='teledentistry'><p class='icon no-margin'></p><p class='icon-details no-margin'>" +
                    "Teledentistry" +
                    "</p></li>";
            }

            var raceEthnicities = "";
            if ( dentist.raceEthnicity != null ) {
                for (i = 0; i < dentist.raceEthnicity.length; i++) {
                    if (Object.keys(ethnicityTable).includes(dentist.raceEthnicity[i])) {
                        raceEthnicities =
                            raceEthnicities + ethnicityTable[dentist.raceEthnicity[i]] + ",";
                    }
                }
                if (raceEthnicities.length > 0) {
                    raceEthnicities = raceEthnicities.substring(
                        0,
                        raceEthnicities.length - 1
                    );
                }
            }

            var dentistSearchResultItem = {
                    listNum: parseInt(index+1),
                    resultHidden: resultHidden,
                    latitude: dentist.latitude,
                    longitude: dentist.longitude,
                    firstName: dentist.firstName,
                    lastName: dentist.lastName,
                    dentistMiles: dentistMilesInfo,
                    dentistAddressOne: dentist.addressOne,
                    dentistAddressTwo: dentist.addressTwo,
                    dentistAddressFields: addressFields,
                    dentistCity: dentist.city,
                    dentistZip: formatZipCode(dentist.zip),
                    dentistState: dentist.stateCode,
                    dentistNumber: formatPhoneNumber(dentist.telephoneNumber),
                    dentistUnformatNumber: dentist.telephoneNumber,
                    dentistDistance: parseFloat(dentist.distance).toFixed(1),
                    prvdrLanguages: dentist.prvdrLanguages,
                    specialties: dentist.specialties,
                    handicappedAccessible: dentist.handicappedAccessible,
                    publicTransAvail: dentist.publicTransAvail,
                    dentistGenderCode: dentist.genderCode,
                    dentistGender: gender,
                    participatesDiv: participatesDiv,
                    facilityID: faciltyIdText,
                    treatsAdults: treatsAdults,
                    treatsChildren: treatsChildren,
                    officeTimesList: officeTimesList,
                    dentistLangs: dentistLangs,
                    publicTransAvailAccess: publicTransAvail+access,
                    dentistEducationDesc: educationDesc,
                    dentistEducationInst: education+educationInstitute,
                    dentistEmailSite: officeEmail+website,
                    scheduleAppointment: scheduleAppointment,
                    dentistOffice:office,
                    dentistBusinessName: dentist.businessName,
                    dentistTreats:treatsText,
                    designationDescription:getDesignationDescription(dentist.specialties),
                    totalEdu:totalEdu,
                    pnrScore: dentist.pnrScore,
                    pnrUrl: dentist.pnrUrl,
                    pnrStarsWidth:pnrStarsWidth,
                    pnrShow: pnrShow,
                    howBadgeShow: howBadgeShow,
                    officeEmail: dentist.officeEmail,
                    dentistWebsite: dentistWebURL,
                    raceEthnicity: raceEthnicities,
                    teledentistry: teledentistry
    			};
			var searchResultsListRowHtml = searchResultsListTemplate(dentistSearchResultItem);

            $(".search-results").append(searchResultsListRowHtml);

            var dentistResult = $(".search-results .dentist-result" + parseInt(index+1));

            dentistResult.attr({
                'data-latitude':dentist.latitude,
                'data-longitude':dentist.longitude,
                'data-officeLanguages':allLanguages,
                'data-prvdrLanguages':allLanguages,
                'data-zip':formatZipCode(dentist.zip),
                'data-stateCode':dentist.stateCode,
                'data-distance':parseFloat(dentist.distance).toFixed(1),
                'data-city':dentist.city,
                'data-participates':events,
                'data-handicappedaccessible':dentist.handicappedAccessible,
                'data-publictransavail':dentist.publicTransAvail,
                'data-facilityID':faciltyIdText,
                'data-treatsAdults':treatsAdults,
                'data-treatsChildren':treatsChildren,
                'data-gender':gender,
                'data-education':education,
                'data-businessName':dentist.businessName,
                'data-acceptsString':acceptsString,
                'data-phone':formatPhoneNumber(dentist.telephoneNumber),
                'data-dentistWebURL':dentistWebURL,
                'data-urlText':dentistWebURL,
                'data-pnrScore':dentist.pnrScore,
                'data-pnrUrl':dentist.pnrUrl,
                'data-address': (dentist.addressTwo && isString(dentist.addressTwo)) ? dentist.addressOne+dentist.addressTwo : dentist.addressOne,
                'data-teledentistry': dentist.offersTelehealthServices ? (dentist.offersTelehealthServices == true ? "Available" : "") : "",
                'data-raceEthnicity': raceEthnicities
            });

        });

        $(".dentist-search-pagination").show();
    	updatePagination(searchResults.listOfLocations.length);

		mapResults();
        ddpa.dentistSearchAjaxInProgress = false ;


    } else {
        ddpa.dentistSearchAjaxInProgress = false ;
        $(".check-all-results").prop("disabled",true);
		$(".dentist-search-results-container .total-results-message").hide();
		$(".total-results-message-local .total-results-count-local").text("0");
    	$(".search-results-map").removeClass("has-results");
        dentistResultsAjaxFail();
    }


}

function validateTheMandateFields() {
    var address = $("#dentistSearchAddresss").val();

    if (textNotEmpty(address)) {
        $(".dentist-search-results").data('address', address);
        getDentistSearchResults();
    } else {
        dentistResultsAjaxFail();
    }
}
function dentistSearchZipCodeInputValid() {
	if (isValidZipCode($("#dentistSearchZipCodeInput").val())) {
		return true;
     }else{
        $(".dentist-common-error").show();
        return false;
     }
}
function dentistSearchZipCodeInputEmpty() {
    return textNotEmpty($("#dentistSearchZipCodeInput").val()) ? false : true;
}
function dentistSearchAddressInputsEmpty() {

    if (textNotEmpty($("#dentistSearchAddressInput").val()) || textNotEmpty($("#dentistSearchCityInput").val()) || textNotEmpty($("#dentistSearchStateInput").val())) {
       return false;
    }else{
       return true;
    }

}
function dentistSearchAddressInputsValid() {
    const dentistSearchCity = $("#dentistSearchCityInput").val();
    const dentistSearchState = $("#dentistSearchStateInput").val();
    $(".dentist-city-error").hide();
    $(".dentist-state-error").hide();

    if (!dentistSearchCity || !dentistSearchState) {
        if (!dentistSearchCity) {
            $(".dentist-city-error").show();
        }

        if (!dentistSearchState) {
            $(".dentist-state-error").show();
        }

        return false;
    }
    return true;
}

function dentistResultsAjaxFail() {
    $(".dentist-search-results .loading-results").hide();
    $('.no-results-found').show();
    $(".search-results").empty().hide();
    $(".dentist-search-pagination").hide();
    $(".search-results-map").hide();
}

function dentistSearchAjaxCompleted() {
    ddpa.dentistSearchAjaxInProgress = false;
}

function fixDentistMap(mapPostionTop) {
    if (($(window).scrollTop() > mapPostionTop) && ($(window).scrollTop() < $(".search-results").height())) {
        $('.search-results-map').addClass('map-fixed').removeClass('map-placebottom');
    } else if ($(window).scrollTop() > $(".search-results-map").height()) {
        $('.search-results-map').removeClass('map-fixed').addClass('map-placebottom');
    } else {
        $('.search-results-map').removeClass('map-fixed').removeClass('map-placebottom');
    }
};

window.onload = function () {
// Get initial top offset of the map
    var mapPostionTop = 0;
    if ($('.search-results-map').length > 0) {
        mapPostionTop = $('.search-results-map').offset().top;
    }
    $(window).scroll(function () {
        fixDentistMap(mapPostionTop);
    });
};

function errorEmailDentistList() {
    $('#sendMailPopUp').hide();
    $('.email-success-popup .success-mail-text').html(dentistSearchFailedEmail);
    $('.email-success-popup').show();
    $('.success-mail-btn, .close').on('click', function () {
        $('.modal').modal('hide');
        $(this).closest('.modal').hide();
    });
};
function successEmailDentistList(data) {
    if (data) {
        $('#sendMailPopUp').hide();
        $('.email-success-popup .success-mail-text').html('<span class="success-icon"></span><label>' + dentistSearchSuccessEmail + '</label>');
        $('.email-success-popup').show();
        $('.success-mail-btn, .close').on('click', function () {
            $('.modal').modal('hide');
            $(this).closest('.modal').hide();
        });
    } else {
        errorEmailDentistList();
    }
};
$(function(){  
    $(document).ready(() => {
        $('#suggestedFeedbackform').keyup(() => {
            if( $('#dentistSearchSuggestUpdateReason').val().length && $('#additionalComment').val().length && $('#captchaInput').val().length ) {
                $('#dentistSearchSuggestUpdateSubmitBtn').removeClass('inactive-btn');
            }
        });

        // change textarea label
        $('#dentistSearchSuggestUpdateReason').on('change', () => {
            var commentLabel;
            var reason = $('#dentistSearchSuggestUpdateReason').val().toLowerCase();
            switch(reason) {
                case "the dentist address is incorrect":
                    commentLabel = "Please let us know the correct address";
                    break;
                case "the dentist phone number is incorrect":
                    commentLabel = "Please let us know the correct phone number";
                    break;
                case "the dentist is not in the right network":
                    commentLabel = "Please let us know what network";
                    break;
                case "the dentist isn't accepting new patients":
                case "other":
                default:
                    commentLabel = "Type your comment here";
            }
            $('#additionalCommentLabel').html(commentLabel);
        });
        
        // validate form
        $('#suggestedFeedbackform').on('submit', function() {
            if(!$('#dentistSearchSuggestUpdateReason').val().length || $('#additionalComment').val().length) {
                return false;
            }
            return true;
        });
    })
});
$(function(){

  // Header Member locator
   $(".find-delta-dental-component > a,.toggle-find-dental-modal,.close-find-dental-modal").on("click",function() {
       $("#header-member-myemployer").val("headerEmployer");
       $("#header-member-myown").val("headerMyOwnBenefit");
       $(".find-my-doctor").toggle();
       $(".find-my-doctor #findDentalHeaderInput").val('');
       $(".find-my-doctor .matching-dental .user-selected-state, .find-dental-dropdown-content .selected-plan-name").text('');
       //$(".find-my-doctor .matching-dental").hide();
       $(".find-my-doctor #findDentalHeaderInput").removeClass("activeField");
       $("#findDentalHeaderVariationBtn").addClass("inactive-btn").attr("aria-disabled","true");
   });

   $("input.header-benefit-type").on('click',function(){
      let benefitType = $("input[name='header-member-benefit-type']:checked").val();
      let benefitContainer = $(this).parents(".benefits-container");
      $("#findDentalHeaderVariationBtn").addClass("inactive-btn").attr("aria-disabled","true");
      if(benefitType == "headerEmployer"){
        $('#header-member-myemployer-info').show();
        $('#header-member-myown-info').hide();
      }else{
        $('#header-member-myemployer-info').hide();
        $('#header-member-myown-info').show();
      }
  });

$('#header-member-myemployer-input').keyup(function(e){
     if(e.keyCode != 13 && e.keyCode != 9){
       $(this).parent().parent().find(".matching-dental .redirect-link").attr("href","javascript:void(0);").addClass('invalid');
       $(".member-company-info-results-container").hide();
       if($(this).val().length == 0){
        $(this).parent().parent().find(".selected-plan-name").hide();
        $(this).parent().parent().find(".redirect-link").addClass('inactive-btn');
       } else {
           $(this).parent().parent().find(".redirect-link").removeClass('inactive-btn');
       }
     }
   });

});
function headerMemberLocator(data,className){

    let states = [];
    let jsonRes = data;
    if(jsonRes && jsonRes.stateDetails.length > 0 && typeof jsonRes == "object"){
        $.each(jsonRes.stateDetails,function(key,state){
            states.push(state.stateName);
        });
    }
    headerDualMcJs(data,className,states);
    if($('.user-state').length > 0){

        $('.user-state').each(function(){
	       var currentElem = $(this);

		    $(this).typeahead({
                hint: false,
                highlight: true,
                minLength: 1
                },
                {
                    source: substringMatcherStates(jsonRes.stateDetails),
                    autoSelect: true
                }).on('keyup', function(e){
                    var keyCode = e.keyCode || e.which;
                    var totalSuggestions = $(this).parent().find('.tt-dataset-states .tt-suggestion').length;
                    if(totalSuggestions == 1){
                        if(keyCode == 13 || keyCode == 9){
                            $(this).parent().find('.tt-dataset-states .tt-suggestion').first().addClass('tt-cursor').click();
                            $(this).typeahead('close');
                        }
                    }
                });

            $(this).bind('typeahead:selected', function(ev, suggestion) {
                var selectedState = suggestion;
                var counter = 0;
                $.each(jsonRes.stateDetails,function(key,state){
                    if(selectedState == state.stateName){
                        currentElem.parent().parent().find(".selected-plan-name").text(state.planName);
                        currentElem.parent().parent().find(".matching-dental .user-selected-state").text(state.stateName);

                        var stateIndex = $.inArray(selectedState,states);
                        var stateObject = jsonRes.stateDetails[stateIndex];
                        window.dataLayer.push({ event: "gtm.update_data_member_company", memberCompany: stateObject });

                        if ( currentElem.hasClass("redirect-rfp")){
                            let formURLtoRedirectRFP = $(".redirectRfpFormPath").val();
                            currentElem.parent().parent().find(".matching-dental .redirect-link").attr('aria-disabled', 'false');

                            if(state.rfpUrl && typeof state.rfpUrl == "string" && state.rfpUrl.length > 0){
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", state.rfpUrl);
                       }
                            else{
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", formURLtoRedirectRFP+".html");
                            }
                            localStorage.setItem('rfpInquiryState',state.stateName);

                        }
                        else if ( currentElem.hasClass("redirect-mcsite")){
                            if(state.webSiteUrl.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.webSiteUrl);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-sdp")){
                            if(state.shopForDentalPlansUrl.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.shopForDentalPlansUrl);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-jon")){
                            if(state.joinOurNetworks.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.joinOurNetworks);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-copp")){
                            if(state.careerOpportunitiesUrl.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.careerOpportunitiesUrl);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", 'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-inquiryform")){
                            let formURLtoRedirect = $(".redirectInquiryPath").val();
                            if(typeof state.customerServiceEmail == "string" && state.customerServiceEmail.length > 0){
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", formURLtoRedirect+".html?showform=yes");
                            }
                            else{
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", formURLtoRedirect+".html?showform=no");
                            }
                            if(localStorageisValid()){
                                localStorage.setItem('inquiryState',state.stateName);
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcCommunityBenefits")){
                            if(typeof state.communityBenefitsUrl == "string" && state.communityBenefitsUrl.length > 0){
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href", state.communityBenefitsUrl);
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcForSmallBusiness")){
                            if ( state.joinOurNetworks.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.mcForSmallBusiness);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcForRetirees")){
                            if(state.joinOurNetworks.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.mcForRetirees);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcForIndividualFamily")){
                            if(state.joinOurNetworks.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.mcForIndividualFamily);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcHipaaPrivateURL")){
                            if(state.hipaaPrivacyUrl.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.hipaaPrivacyUrl);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcLargeCorpPrivateURL")){
                            if(state.mcLargeCorpPrivateURL.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.mcLargeCorpPrivateURL);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            }
                            else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }
                        else if ( currentElem.hasClass("redirect-mcBrokersPrivateURL")){
                            if(state.mcBrokersPrivateURL.length > 0) {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",state.mcBrokersPrivateURL);
                                currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn');
                            } else {
                                currentElem.parent().parent().find(".matching-dental .redirect-link").attr("href",'javascript:void(0);');
                                currentElem.parent().parent().find(".redirect-link").addClass('inactive-btn');
                            }
                        }

                        currentElem.parent().parent().find(".matching-dental").show();
                        currentElem.parent().parent().find(".help-text").hide();
                        currentElem.parent().parent().find(".redirect-link").removeClass('inactive-btn').attr('aria-disabled', 'false');
                    }
                });
		    });
	    });

   } 

}


function headerDualMcJs(data,className,states){

    if($(".dual-user-state").length > 0){

		 	$(".dual-user-state").typeahead({
				hint: false,
				highlight: true,
			    minLength: 1
				},
				{
				source: substringMatcherStates(data.stateDetails),
				autoSelect: true
			 }).on('keyup', function(e){
           var keyCode = e.keyCode || e.which;
           var totalSuggestions = $(this).parent().find('.tt-dataset-states .tt-suggestion').length;
           if(totalSuggestions == 1){
                    if(keyCode == 13 || keyCode == 9){
                         $(this).parent().find('.tt-dataset-states .tt-suggestion').first().addClass('tt-cursor').click();
                         $(this).typeahead('close');
                    }
           }
 			});

           $(".dual-user-state").bind('typeahead:select', function(ev, selectedState) {

            if($.inArray(selectedState,states) != -1){
                stateIndex = $.inArray(selectedState,states);
                stateObject = data.stateDetails[stateIndex];
                 console.log("stateObject",stateObject);
                 window.dataLayer = window.dataLayer || [];
                 window.dataLayer.push({ event: "gtm.update_data_member_company", memberCompany: stateObject });
                 $(".find-dental-dropdown-content .selected-plan-name").text(stateObject.planName);
                 $("#findDentalHeaderVariationBtn").removeClass("inactive-btn").attr("aria-disabled","false");

                if($("input[type='radio'][name='header-member-benefit-type']:checked").val() == "headerEmployer"){
                    console.log(" employer"+stateObject.webSiteUrl);
                    $("#findDentalHeaderVariationBtn").attr("href",checkIfLinkIsValid(stateObject.webSiteUrl));

                }else if($("input[type='radio'][name='header-member-benefit-type']:checked").val() == "headerMyOwnBenefit"){
                    console.log("Own "+stateObject.shopForDentalPlansUrl);

                     $("#findDentalHeaderVariationBtn").attr("href",checkIfLinkIsValid(stateObject.shopForDentalPlansUrl));
                }

            }

          });
     }

    $(".dual-user-state").keyup(function(e){
         if(e.keyCode != 13 && e.keyCode != 9){
       $(".find-dental-dropdown-content .selected-plan-name").text("");
        $("#findDentalHeaderVariationBtn").attr("href","javascript:void(0);");
         $("#findDentalHeaderVariationBtn").addClass("inactive-btn").attr("aria-disabled", "true");
       }
   });

    let headerOwnPlaceHolder = $("#header-member-input").data("myown-placeholder");
    let headerEmployerPlaceHolder = $("#header-member-input").data("employer-placeholder");

    $("input[type='radio'][name='header-member-benefit-type'][value='headerEmployer']").click();
    $("#header-member-input").attr('placeholder',headerEmployerPlaceHolder);


    $("input[type='radio'][name='header-member-benefit-type']").change(function(){
        $("#findDentalHeaderVariationBtn").attr("href","javascript:void(0);");
        $(".find-dental-dropdown-content .selected-plan-name").text("");
        $(".dual-user-state").val('');

        if($("input[type='radio'][name='header-member-benefit-type']:checked").val() == "headerEmployer"){
			$("#header-member-input").attr('placeholder',headerEmployerPlaceHolder);
            $(".header-find-dental-disclaimer").show();
        }else{
			$("#header-member-input").attr('placeholder',headerOwnPlaceHolder);
            $(".header-find-dental-disclaimer").hide();
        }

    });

}

$(function() {
    $('.twitter-typeahead').on('keyup', function(e) {
        if (e.which == 13) {
            $(".tt-suggestion:first-child", this).trigger('click');
        }
    });

    $('.costestimator, .costestimator-section').hide();
    // Member locator state selector
    if ($("#stateListPath").length > 0 && $("#stateListPath").val().length > 0) {
        stateListJsonPath = $("#stateListPath").val()
    }


    $('.benefit-state,.member-info-state').val("");
    $('.member-info-state,.user-state').keyup(function(e) {
        if (e.keyCode != 13 && e.keyCode != 9) {
            $(this).parent().parent().find(".matching-dental .redirect-link").attr("href", "javascript:void(0);").addClass('invalid inactive-btn');
            $(this).parent().parent().find(".matching-dental .submit-btn").attr("href", "javascript:void(0);").addClass('invalid inactive-btn');
            $(".member-company-info-results-container").hide();
            if ($(this).val().length == 0) {
                $(this).parent().parent().find(".selected-plan-name").text('');
                $(this).parent().parent().find(".help-text").show();
                $(this).parent().parent().find(".matching-dental .redirect-link").attr("aria-disabled", "true");

            }
        }
    });

    $('#employer-benefit-state,#self-benefit-state').keyup(function(e) {
        if (e.keyCode != 13 && e.keyCode != 9) {
            $(this).parents('.benefits').find(".matching-dental .benefit-page-button").attr("href", "javascript:void(0);").addClass('invalid inactive-btn');
            if ($(this).val().length == 0) {
                $(this).parents('.employer-benefits').find(".matching-dental").hide();
                $(this).parents('.self-benefits').find(".matching-dental").hide();
                $(this).parents('.benefits').find(".redirect-help-text-top").show();
            }
        }
    });




    $("input.employer-benefit").click();
    $(".employer-benefits").addClass("checked");
    $("input.benefit-type").on('click', function() {
        $(".benefit-state").typeahead('close');
        let benefitType = $("input[name='benefit-type']:checked").val();
        $(".benefits-container .matching-dental").hide();
        $(".redirect-help-text-top").show();
        let benefitContainer = $(this).parents(".benefits-container");
        if (benefitType == "employer") {
            $(".self-benefit-state").val('').removeClass('activeField');
            benefitContainer.addClass("employer").removeClass("self");
            benefitContainer.find(".self-benefits .benefit-state").attr('disabled', 'disabled');
            benefitContainer.find(".employer-benefits .benefit-state").removeAttr('disabled', 'disabled');
            benefitContainer.find(".self-benefits").removeClass("checked");
            benefitContainer.find(".employer-benefits").addClass("checked");
            $(".redirect-help-text-top").show();

        } else {
            $(".employer-benefit-state").val('').removeClass('activeField');
            benefitContainer.addClass("self").removeClass("employer");
            benefitContainer.find(".employer-benefits .benefit-state").attr('disabled', 'disabled');
            benefitContainer.find(".self-benefits .benefit-state").removeAttr('disabled', 'disabled');
            benefitContainer.find(".self-benefits").addClass("checked");
            benefitContainer.find(".employer-benefits").removeClass("checked");
            $(".redirect-help-text-top").hide();
        }
    });


});

function getStateListJson() {

    let memberLocatorParams = $.extend({}, ajaxParams_default);
    memberLocatorParams['url'] = textNotEmpty(stateListJsonPath) ? stateListJsonPath : '/content/ddpa/us/en/data/plandata/_jcr_content.plans.json';
    memberLocatorParams['successCallbackFunction'] = updateMemberLocator;
    memberLocatorParams['errorCallBackFunction'] = memberLocatorAjaxFailed;
    ajaxCall(memberLocatorParams);
}

function updateMemberLocator(data, className) {

    let results = data;
    let newDataArray = [];
    let newData = new Object();

    // AB-560:Default claims form to subscribers logged in state
    let stateAbbr = $("#claimsDownloadInputState").val();

    if (results && results.stateDetails.length > 0 && typeof results == 'object') {
        $.each(results.stateDetails, function(key, state) {
            //console.log("check for exclusion");
            if (state.stateAbbreviation === "AP" || state.stateAbbreviation === "PM" ||
                state.stateAbbreviation === "NL" || state.stateAbbreviation === "NO" ||
                state.stateAbbreviation === "FS" || state.stateAbbreviation === "NK" ||
                state.stateAbbreviation === "NS" || state.stateAbbreviation === "CL" ||
                state.stateAbbreviation === "NN" || state.stateAbbreviation === "MP" || //PB-136
                state.stateAbbreviation === "WC" ){
                //console.log("excluding " + state.stateAbbreviation);
                results.rem
            } else {
                //console.log("not excluding " + state.stateAbbreviation);
                newDataArray.push(state);
            }
            // AB-560:Default claims form to subscribers logged in state
            if (state.stateAbbreviation == stateAbbr) {
                $("#claimsDownloadInput").val(state.stateName)
            }
        });
    }
    newData = {
        stateDetails: newDataArray
    };
    //console.log(JSON.stringify(newData));

    /* Passing the same JSON to claim form tools  */
    // AB-560:Default claims form to subscribers logged in state
    //Uncomment below code to download claim forms for all the states
    // claimFormDropdownLocator(newData,className);

    // AB-560:Default claims form to subscribers logged in state
    claimFormDropdownLocator();

    /* Passing the same JSON to Member company info */
    loadMemberCompanyInfo(newData, className);
    headerMemberLocator(newData, className)

    let states = [];
    let jsonRes = newData;
    if (jsonRes && jsonRes.stateDetails.length > 0 && typeof jsonRes == "object") {
        $.each(jsonRes.stateDetails, function(key, state) {
            states.push(state.stateName);
            if ((memberCompanyState === state.stateAbbreviation) && state.displayCostEst === 'false' &&
                $('.cost-estimator-type').val() === 'private') {
                $('.costestimator, .costestimator-section').remove();
            } else {
                $('.costestimator, .costestimator-section').show();
            }
        });
    }
    // Bind the type ahead function


    ddpa.employerBenefit = $(".employer-benefit-state");
    ddpa.selfBenefit = $(".self-benefit-state");

    let stateIndex, stateObject, employerBenefitButton, selfBenefitButton;
    employerBenefitButton = ddpa.employerBenefit.parents('.employer-benefits').find(".matching-dental .benefit-page-button");
    selfBenefitButton = ddpa.selfBenefit.parents('.self-benefits').find(".matching-dental .benefit-page-button");
    if ($(".benefit-state").length > 0) {

        $(".benefit-state").typeahead({
            hint: false,
            highlight: true,
            minLength: 1
        }, {
            source: substringMatcherStates(jsonRes.stateDetails),
            autoSelect: true
        }).on('keyup', function(e) {
            var keyCode = e.keyCode || e.which;
            var totalSuggestions = $(this).parent().find('.tt-dataset-states .tt-suggestion').length;
            if (totalSuggestions == 1) {
                if (keyCode == 13 || keyCode == 9) {
                    $(this).parent().find('.tt-dataset-states .tt-suggestion').first().addClass('tt-cursor').click();
                    $(this).typeahead('close');
                }
            }
        });

        ddpa.employerBenefit.bind('typeahead:select', function(ev, selectedState) {
            if ($.inArray(selectedState, states) != -1) {
                ddpa.employerBenefit.parents('.employer-benefits').find(".matching-dental .user-selected-state").text(selectedState);
                stateIndex = $.inArray(selectedState, states);
                stateObject = jsonRes.stateDetails[stateIndex];

                // Get query parameters (deep links) if any
                var urlParams = window.location.search;
                const memberCompanyLocatorParams = new URLSearchParams(urlParams);

                let queryString = `?stateCode=${stateObject.stateAbbreviation}&lineOfBusiness=GROUP`;
                let formURLtoRedirect = $(".redirectInquiryPath").val();
                let memberCompanyVariationStyle = $(".memberCompanyVariationStyle").val();
                if (memberCompanyVariationStyle == "style3") {
                    queryString = queryString + `&selectedFormName=Delta%20Dental%20online%20account%20deletion%20request`;
                    for (let [key, value] of memberCompanyLocatorParams) {
                        if (["errorCode", "digitalProperty"].includes(key)) {
                            queryString = queryString + `&` + key + "=" + value;
                        }
                    }
                    formURLtoRedirect = $(".onlineAccountRemovalFormPath").val();
                }
                else {
                    for (let [key, value] of memberCompanyLocatorParams) {
                        if (["selectedFormName", "errorCode", "digitalProperty"].includes(key)) {
                            queryString = queryString + `&` + key + "=" + value;
                        }
                    }
                }
                ddpa.employerBenefit.parent().parent().parent().find(".matching-dental .redirect-link").attr("href", formURLtoRedirect + ".html" + queryString);

                updateDataOfMemberCompanyLocator(ddpa.employerBenefit, stateObject, employerBenefitButton, 'employer');
            }

        });


        ddpa.selfBenefit.bind('typeahead:select', function(ev, selectedState) {
            if ($.inArray(selectedState, states) != -1) {
                ddpa.selfBenefit.parents('.self-benefits').find(".matching-dental .user-selected-state").text(selectedState);
                stateIndex = $.inArray(selectedState, states);
                stateObject = jsonRes.stateDetails[stateIndex];

                // Get query parameters (deep links) if any
                var urlParams = window.location.search;
                const memberCompanyLocatorParams = new URLSearchParams(urlParams);

                let queryString = `?stateCode=${stateObject.stateAbbreviation}&lineOfBusiness=INDIVIDUAL`;
                let formURLtoRedirect = $(".redirectInquiryPath").val();

                let memberCompanyVariationStyle = $(".memberCompanyVariationStyle").val();

                if (memberCompanyVariationStyle == "style3") {
                    queryString = queryString + `&selectedFormName=Delta%20Dental%20online%20account%20deletion%20request`;
                    for (let [key, value] of memberCompanyLocatorParams) {
                        if (["errorCode", "digitalProperty"].includes(key)) {
                            queryString = queryString + `&` + key + "=" + value;
                        }
                    }
                    formURLtoRedirect = $(".onlineAccountRemovalFormPath").val();
                } else {
                    for (let [key, value] of memberCompanyLocatorParams) {
                        if (["selectedFormName", "errorCode", "digitalProperty"].includes(key)) {
                            queryString = queryString + `&` + key + "=" + value;
                        }
                    }
                }
                ddpa.selfBenefit.parent().parent().parent().find(".matching-dental .redirect-link").attr("href", formURLtoRedirect + ".html" + queryString);

                updateDataOfMemberCompanyLocator(ddpa.selfBenefit, stateObject, selfBenefitButton, 'self');
            }

        });

    }



    // typeahead ends
    // The contact Us form no longer needs this information stored in local storage.
    //
    //if (localStorageisValid() && $('.inquiryform').length > 0) {
    //  if (localStorage.getItem('inquiryState') != null) {
    //      var selectedState = localStorage.getItem('inquiryState');
    //      var type = localStorage.getItem('type');
    //
    //        $.each(jsonRes.stateDetails, function(key, state) {
    //           if (state.stateName == selectedState) {
    //              $('.inquiryform .form-type').val($('.inquiryform > h2.txt-green').text() + ' - ' + type);
    //                $('.inquiryform .admin-company span').text(state.planName);
    //               if (type == "Self Insured Form" && (state.selfInsuredPhone.length || state.selfInsuredMail.length || state.selfInsuredFax.length || state.selfStreetMail.length || state.selfCityMail.length || state.selfStateAbb.length || state.selfZipMail.length > 0)) {
    //                    if (typeof state.selfInsuredPhone == "string") {
    //                        $('.inquiryform .service-phone .service-info').html('<a href="tel:+1' + state.selfInsuredPhone.replace(/-/g, "") + '">' + state.selfInsuredPhone + '</a>');
    //                    } else {
    //                        $('.inquiryform .service-phone').addClass('no-data');
    //                    }
    //                } else {
    //                    if (typeof state.outOfStateNumber == "string" && state.outOfStateNumber.length > 0) {
    //                        $('.inquiryform .service-phone .service-info').html('<a href="tel:+1' + state.outOfStateNumber.replace(/-/g, "") + '">' + state.outOfStateNumber + '</a>');
    //                    } else {
    //                        $('.inquiryform .service-phone').addClass('no-data');
    //                   }
    //                }
    //                if (type == "Self Insured Form" && (state.selfInsuredPhone.length || state.selfInsuredMail.length || state.selfInsuredFax.length || state.selfStreetMail.length || state.selfCityMail.length || state.selfStateAbb.length || state.selfZipMail.length > 0)) {
    //                    if (typeof state.selfInsuredFax == "string" && state.selfInsuredFax.length > 0) {
    //                        $('.inquiryform .service-fax .service-info').text(state.selfInsuredFax);
    //                    } else {
    //                        $('.inquiryform .service-fax').addClass('no-data');
    //                    }
    //                } else {

    //                    if (typeof state.customerServiceFax == "string" && state.customerServiceFax.length > 0) {
    //                        $('.inquiryform .service-fax .service-info').text(state.customerServiceFax);
    //                    } else {
    //                        $('.inquiryform .service-fax').addClass('no-data');
    //                    }
    //                }
    //                if (type == "Self Insured Form" && (state.selfInsuredPhone.length || state.selfInsuredMail.length || state.selfInsuredFax.length || state.selfStreetMail.length || state.selfCityMail.length || state.selfStateAbb.length || state.selfZipMail.length > 0)) {
    //                    if (typeof state.selfInsuredMail == "string" && state.selfInsuredMail.length > 0) {
    //                        $('.inquiryform .service-email .service-info').text(state.selfInsuredMail);
    //                        $('.inquiryform .service-email .service-info').attr("href", "mailto:" + state.selfInsuredMail);

    //                    } else {
    //                        $('.inquiryform .service-email').addClass('no-data');
    //                    }
    //                } else {
    //                    if (typeof state.customerServiceEmail == "string" && state.customerServiceEmail.length > 0) {
    //                        $('.inquiryform .service-email .service-info').text(state.customerServiceEmail);
    //                        $('.inquiryform .service-email .service-info').attr("href", "mailto:" + state.customerServiceEmail);
    //
    //                    } else {
    //                        $('.inquiryform .service-email').addClass('no-data');
    //                    }
    //                }
    //                var mailaddress = '';
    //
    //                if (type == "Self Insured Form" && (state.selfInsuredPhone.length || state.selfInsuredMail.length || state.selfInsuredFax.length || state.selfStreetMail.length || state.selfCityMail.length || state.selfStateAbb.length || state.selfZipMail.length > 0)) {
    //                     if (typeof state.selfStreetMail == "string" && state.selfStreetMail.length > 0) {
    //                        mailaddress = state.selfStreetMail;
    //                    }
    //                     if (typeof state.selfCityMail == "string" && state.selfCityMail.length > 0) {
    //                        mailaddress = mailaddress + "<br/>" + state.selfCityMail;
    //                    }
    //                    if (typeof state.selfStateAbb == "string" && state.selfStateAbb.length > 0) {
    //                        mailaddress = mailaddress + ", " + state.selfStateAbb;
    //                    }
    //                    if (typeof state.selfZipMail == "string" && state.selfZipMail.length > 0) {
    //                        mailaddress = mailaddress + " " + state.selfZipMail;
    //                    }
    //                    if (mailaddress.length > 0) {
    //                        $('.inquiryform .service-address .service-info').html(mailaddress);
    //                    } else {
    //                        $('.inquiryform .service-address').addClass('no-data');
    //                    }
    //                } else {
    //                    if (typeof state.MailContactStreet == "string" && state.MailContactStreet.length > 0) {
    //                        mailaddress = state.MailContactStreet;
    //                    }
    //                    /* if(typeof state.claimContactStreet2 == "string" && state.claimContactStreet2.length > 0){
    //            mailaddress = mailaddress + "<br/>" +state.claimContactStreet2;
    //                       }
    //                    if (typeof state.MailContactCity == "string" && state.MailContactCity.length > 0) {
    //                        mailaddress = mailaddress + "<br/>" + state.MailContactCity;
    //                    }
    //                    if (typeof state.MailContactStateAbbreviation == "string" && state.MailContactStateAbbreviation.length > 0) {
    //                         mailaddress = mailaddress + ", " + state.MailContactStateAbbreviation;
    //                    }
    //                    if (typeof state.MailContactZip == "string" && state.MailContactZip.length > 0) {
    //                        mailaddress = mailaddress + " " + state.MailContactZip;
    //                    }
    //                    if (mailaddress.length > 0) {
    //                        $('.inquiryform .service-address .service-info').html(mailaddress);
    //                    } else {
    //                        $('.inquiryform .service-address').addClass('no-data');
    //                    }
    //                }
    //            }
    //        });
    //     }
    //}
    if (localStorageisValid() && $('.proposalform').length > 0) {
        if (localStorage.getItem('rfpInquiryState') != null) {
            var selectedState = localStorage.getItem('rfpInquiryState');
            $.each(jsonRes.stateDetails, function(key, state) {
                if (state.stateName == selectedState) {
                    $('.proposalform .admin-company span').text(state.planName);
                    if (typeof state.salesContactPhone == "string" && state.salesContactPhone.length > 0) {
                        $('.proposalform .service-phone .service-info').html('<a href="tel:+1' + state.salesContactPhone.replace(/-/g, "") + '">' + state.salesContactPhone + '</a>');
                    } else {
                        $('.proposalform .service-phone').addClass('no-data');
                    }
                    if (typeof state.customerServiceFax == "string" && state.customerServiceFax.length > 0) {
                        $('.proposalform .service-fax .service-info').text(state.customerServiceFax);
                    } else {
                        $('.proposalform .service-fax').addClass('no-data');
                    }
                    if (typeof state.salesContactEmail == "string" && state.salesContactEmail.length > 0) {
                        $('.proposalform .service-email .service-info').text(state.salesContactEmail);
                        $('.proposalform .service-email .service-info').attr("href", "mailto:" + state.salesContactEmail);
                    } else {
                        $('.proposalform .service-email').addClass('no-data');
                    }
                    var mailaddress = '';
                    if (typeof state.MailContactStreet == "string" && state.MailContactStreet.length > 0) {
                        mailaddress = state.MailContactStreet;
                    }
                    if (typeof state.MailContactCity == "string" && state.MailContactCity.length > 0) {
                        mailaddress = mailaddress + "<br/>" + state.MailContactCity;
                    }
                    if (typeof state.MailContactStateAbbreviation == "string" && state.MailContactStateAbbreviation.length > 0) {
                        mailaddress = mailaddress + ", " + state.MailContactStateAbbreviation;
                    }
                    if (typeof state.MailContactZip == "string" && state.MailContactZip.length > 0) {
                        mailaddress = mailaddress + " " + state.MailContactZip;
                    }
                    if (mailaddress.length > 0) {
                        $('.proposalform .service-address .service-info').html(mailaddress);
                    } else {
                        $('.proposalform .service-address').addClass('no-data');
                    }
                    if (typeof state.webSiteUrl == "string" && state.webSiteUrl.length > 0) {
                        $('.proposalform .service-website .service-info').text(state.webSiteUrl);
                        $('.proposalform .service-website .service-info').attr("href", state.webSiteUrl);
                    } else {
                        $('.proposalform .service-website').addClass('no-data');
                    }
                    if (typeof state.salesContactName == "string" && state.salesContactName.length > 0) {
                        $('.proposalform .service-contact .service-info').text(state.salesContactName);
                    } else {
                        $('.proposalform .service-contact').addClass('no-data');
                    }
                }
            });
        }
    }

}

function memberLocatorAjaxFailed() {

}

function checkIfLinkIsValid(linkToValidate) {
    var link = '';
    link = (linkToValidate && linkToValidate.length > 0) ? linkToValidate : 'javascript:void(0)';
    return link;

}

function updateDataOfMemberCompanyLocator(textfield, stateObject, benefitButton, benefitType) {

    let navigateButton = benefitButton,
        showResult = false;
    if (benefitType === "employer") {
        $(".redirect-help-text-top").hide();
    }

    textfield.parents('.benefits').find(".matching-dental .selected-plan-name").text(stateObject.planName);
    textfield.parents('.benefits').find(".matching-dental .member-title").text(stateObject.planName);
    window.dataLayer.push({
        event: "gtm.update_data_member_company",
        memberCompany: stateObject
    });
    if (benefitType === "employer") {
        textfield.parents('.benefits').find(".matching-dental .member-phone").html("<a href='tel:+1" + stateObject.outOfStateNumber + "'>" + formatPhoneNumber(stateObject.outOfStateNumber.replace(/-/g, "")) + "</a>");
        textfield.parents('.benefits').find(".matching-dental .member-link").attr('href', checkIfLinkIsValid(stateObject.webSiteUrl)).text(stateObject.webSiteUrl);
        navigateButton.attr('href', checkIfLinkIsValid(stateObject.webSiteUrl));
    } else {
        textfield.parents('.benefits').find(".matching-dental .member-phone").html("<a href='tel:+1" + stateObject.alternate800Number + "'>" + formatPhoneNumber(stateObject.alternate800Number.replace(/-/g, "")) + "</a>");
        textfield.parents('.benefits').find(".matching-dental .member-link").attr('href', checkIfLinkIsValid(stateObject.shopForDentalPlansUrl)).text(stateObject.shopForDentalPlansUrl);
        navigateButton.attr('href', checkIfLinkIsValid(stateObject.shopForDentalPlansUrl));
    }
    navigateButton.removeClass('inactive-btn');
    textfield.parents('.benefits').find(".matching-dental").show();

}
var memberLocatorStreetAddr = getI18nValue('memberLocatorStreetAddr',"STREET ADDRESS");

$(function(){

    $('.show-member-info').on('click',function(){
  		if(!$(this).hasClass('invalid') && !$(this).hasClass('inactive-btn')){
  			$(".member-company-info-results-container").show();
  		}
    });

});

function loadMemberCompanyInfo(data,className){

	let states = [], jsonRes = data;

    if(jsonRes && jsonRes.stateDetails.length > 0 && typeof jsonRes == "object"){
 		$.each(jsonRes.stateDetails,function(key,state){
        	states.push(state.stateName);
   		});
    }
	/*if($('.dentist-search-container').length > 0){
         updateStatesForDentist(states);
    }
	if($('.dentist-search-results-container').length > 0){
		 updateStatesForDentistSearch(states);
    } */
    $('.member-info-state').each(function(){
	       var currentElem = $(this), result;

		    $(this).typeahead({
				hint: false,
				highlight: true,
			   minLength: 1
				},
				{
				   source: substringMatcherStates(jsonRes.stateDetails),
				   autoSelect: true
			 }).on('keyup', function(e){
           var keyCode = e.keyCode || e.which;
           var totalSuggestions = $(this).parent().find('.tt-dataset-states .tt-suggestion').length;
           if(totalSuggestions == 1){
                    if(keyCode == 13 || keyCode == 9){
                         $(this).parent().find('.tt-dataset-states .tt-suggestion').first().addClass('tt-cursor').click();
                         $(this).typeahead('close');
                    }
           }
 			});

			  $(this).bind('typeahead:select', function(ev, suggestion) {
				  var selectedState = suggestion;
				  var counter = 0;
	            $.each(jsonRes.stateDetails,function(key,state){
	                   if(selectedState == state.stateName){
						   counter++;
						   currentElem.parent().parent().find(".selected-plan-name").text(state.planName);
	                       currentElem.parent().parent().find(".user-selected-state").text(selectedState);
						   currentElem.parent().parent().find('.show-member-info').removeClass('invalid inactive-btn');
						   currentElem.parent().parent().parent().find(".member-company-info-results").empty();

	                      var stateIndex = $.inArray(selectedState,states);
                          var stateObject = jsonRes.stateDetails[stateIndex];
                          window.dataLayer.push({ event: "gtm.update_data_member_company", memberCompany: stateObject });


	                      if(currentElem.hasClass("contact-us") || currentElem.hasClass("plan-info")){
							    var streetAddress = '';
								var streetAddress2 = "";
								if(state.officeContactStreet.length > 0){
									streetAddress2 = state.officeContactStreet;
								}
								if(state.officeContactCity.length > 0){
									streetAddress2 = streetAddress2 + "<br/>" +state.officeContactCity;
								}
								if(state.officeContactStateAbbreviation.length > 0){
									streetAddress2 = streetAddress2 + ", " +state.officeContactStateAbbreviation;
								}
								if(state.officeContactZip.length > 0){
									streetAddress2 = streetAddress2 + " " +state.officeContactZip;
								}

								if(streetAddress2.length > 0){
                                   streetAddress = "<div class='street-address'><h2 class='txt-green'>"+memberLocatorStreetAddr+"</h2><div class='street'><div class='location-icon'><img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/location-icon.png'>"+
										"</div><div class='street-details'><p>"+streetAddress2+"</p></div></div></div>";
                                }

								let phoneNumber = '';
								if(state.outOfStateNumber && state.outOfStateNumber.length > 0){
									phoneNumber = state.outOfStateNumber;
								}
								let fax = '';
								if(state.salesContactFax && state.salesContactFax.length >0){
									fax = "<p class='fax'>" +state.salesContactFax + "  FAX</p>";
								}
								var MailContactCity = state.MailContactCity ?  (state.MailContactCity + ', ') : '';
							    result = "<div class='member-company-info-result'><div class='result-title'><span class='index txt-green'>"+counter+".</span><h2 class='txt-green'>"+state.planName+"</h2></div><div class='address'><div class='location-icon'>"+
										"<img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/location-icon.png'></div><div class='address-details'><p>"+state.MailContactStreet+"</p>"+
										"<p><span class='city'>"+MailContactCity+"  </span><span class='abbr'> "+state.MailContactStateAbbreviation+"</span><span class='zip'>  "+state.MailContactZip+"</span></p>"+
										"</div></div><div class='contact'><p><span><img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/phone-icon.png'></span> "+phoneNumber+"</p>"+fax+
										"</div><div class='website'><p><span><img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/website.png'></span><a href='"+state.webSiteUrl+"'>"+state.webSiteUrl+"</a></p>"+streetAddress+"</div></div>";
								currentElem.parent().parent().parent().find(".member-company-info-results").append(result);
	  					   		currentElem.parent().parent().find(".matching-dental").show();
	                      		currentElem.parent().parent().find(".help-text").hide();
							   return false;
	                       }else if(currentElem.hasClass("claims-info")){

							   let addressDetails = '';
                               if(state.claimContactStreet.length > 0){
										addressDetails = "<p>"+state.claimContactStreet+"</p>";
                               }
							   let street = '';
                               if(state.claimContactStreet2.length > 0){
										street = state.claimContactStreet2 + ", ";
                               }
                               if(state.claimContactCity.length > 0){
										street = street + state.claimContactCity + ", ";
                               }
                               if(state.claimContactStateAbbreviation.length > 0){
										street = street + state.claimContactStateAbbreviation + "  ";
                               }
                               if(state.claimContactZip.length > 0){
										street = street + state.claimContactZip;
                               }
                               addressDetails =addressDetails + "<p>"+street+"</p>";
							   let stateContact = '';

                               if(state.outOfStateNumber.length > 0){
										stateContact = "<p><span><img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/phone-icon.png'></span>"+state.outOfStateNumber+"</p>";
                               }

							    result = "<div class='member-company-info-result'><div class='result-title'><span class='index txt-green'>"+counter+".</span>"+
										 "<h2 class='txt-green'>"+state.planName+"</h2></div><div class='address'><div class='location-icon'>"+
										 "<img src='/etc.clientlibs/ddpa/clientlibs/core/resources/images/location-icon.png'></div><div class='address-details'>"+addressDetails+"</div>"+
										 "</div><div class='contact'>"+stateContact+"</div></div>";

								currentElem.parent().parent().parent().find(".member-company-info-results").append(result);
								currentElem.parent().parent().find(".matching-dental").show();
	                      		currentElem.parent().parent().find(".help-text").hide();
	                           return false;
	                       }else if(currentElem.hasClass("comm-benefits")){
							   let communityTitle = '',communityDescription = '',communityIcon='',communityLearnMore = '';
							   if(typeof state.communityTitle == "string" && state.communityTitle.length > 0){
								   communityTitle = "<h2 class='txt-green'>"+state.communityTitle+"</h2>";
							   }
							   if(typeof state.communityDescription == "string" && state.communityDescription.length > 0){
								   communityDescription = "<p>"+state.communityDescription+"</p>";
							   }
							   if(typeof state.communityIcon == "string" && state.communityIcon.length > 0){
								   communityIcon = "<img alt='"+state.communityTitle+"' title='"+state.communityTitle+"' src='"+state.communityIcon+"'/>";
							   }
							   if(typeof state.communityLearnMore == "string" && state.communityLearnMore.length > 0){
								   communityLearnMore = "<div class='street-details'><p>"+state.communityLearnMore+"</p></div>";
							   }

							   result = "<div class='member-company-info-result'><div class='result-title'>"+communityTitle+"</div><div class='address'>"+
										"<div class='address-details'>"+communityDescription+"</div></div><div class='contact community-icon'>"+communityIcon+
										"</div><div class='street-address'>"+communityLearnMore+"</div></div>";
							    currentElem.parent().parent().parent().find(".member-company-info-results").append(result);
	  					   		currentElem.parent().parent().find(".matching-dental").show();
	                      		currentElem.parent().parent().find(".help-text").hide();
							   return false;
	                       }
	                   }
	                 });


				});


	   });
}

var dentistSearchFemale = getI18nValue('dentistSearchFemale',"Female");
var dentistSearchMale = getI18nValue('dentistSearchMale',"Male");
var dentistSearchNonBinary = getI18nValue('dentistSearchNonBinary',"Non-Binary");
var dentistSearchUndisclosed = getI18nValue('dentistSearchUndisclosed',"Undisclosed");
var dentistSearchAcceptPatients = getI18nValue('dentistSearchAcceptPatients',"accepting new patients");
var dentistSearchNotAcceptPatients = getI18nValue('dentistSearchNotAcceptPatients',"not accepting new patients");
var dentistTreatsDisabledAdults = getI18nValue('dentistTreatsDisabledAdults',"Treats disabled adults");
var dentistTreatsDisabledChildren = getI18nValue('dentistTreatsDisabledChildren',"Treats disabled children");
var dentistSearchWheelChairAccess = getI18nValue('dentistSearchWheelChairAccess',"Wheel Chair Accessible");
var dentistPublicTransitAccess = getI18nValue('dentistPublicTransitAccess',"Public Transit Access");

var dentistSearchPrintSpeciality = getI18nValue('dentistSearchPrintSpeciality',"Specialty: ");
var dentistSearchPrintMiles = getI18nValue('dentistSearchPrintMiles',"miles from your location");
var dentistSearchPrintParticipates = getI18nValue('dentistSearchPrintParticipates',"This provider participates in:");
var dentistSearchPrintGender = getI18nValue('dentistSearchPrintGender',"Gender:");
var dentistSearchPrintEducation = getI18nValue('dentistSearchPrintEducation',"Education:");
var dentistSearchPrintOffcInfo = getI18nValue('dentistSearchPrintOffcInfo',"Office Information");
var dentistSearchPrintProviderInfo = getI18nValue('dentistSearchPrintProviderInfo',"Provider Information");

$(function(){

  /*Get the print parameters from localstorage, ajax to get results and populate on the page */

    if(localStorageisValid() && $('.printview-headinfo').length > 0){
       let dentistsToPrintObj = JSON.parse(localStorage.getItem('printResultsObj'));
       let dentistSearchResultsSource = $("#print-results-container").html();
       let dentistResultsTemplate = Handlebars.compile(dentistSearchResultsSource);
       let dentistToPrintHTML = "",dentistToPrint,treatsChildrenText='',treatsAdultsText='',participationList='',acceptsString='',acceptsText='';

       $.each(dentistsToPrintObj.dentists,function(index,dentist){

          let treatsChildrenText='',
              treatsAdultsText='',
              wheelChairAccessText='',
              publicTransitText='',
              participationList='',
              participationListArray=[],
              acceptsStringArray = [],
              acceptsString='',
              participationHTML='';

          treatsChildrenText = dentist.treatsChildren == true ? dentistTreatsDisabledChildren : "";
          treatsAdultsText = dentist.treatsAdults == true ? dentistTreatsDisabledAdults : "";
          wheelChairAccessText =  dentist.handicappedAccessible == true ? dentistSearchWheelChairAccess : "" ;
          publicTransitText = dentist.publicTransAvail == true ? dentistPublicTransitAccess : "" ;
          participationList = dentist.participationList;
          acceptsString = dentist.acceptsString;
          if(textNotEmpty(participationList)) {
                  participationListArray = participationList.split(',');
          }
          if(textNotEmpty(acceptsString)) {
                  acceptsStringArray = acceptsString.split(',');
          }

          $.each(participationListArray,function(index, participation){
              var acceptsText = "";
              if ( index < acceptsStringArray.length) {
                  acceptsText = acceptsStringArray[index] == "true" ? dentistSearchAcceptPatients : dentistSearchNotAcceptPatients;
              }
              participationHTML = "<p class='participate-category'>"+participation+"</p><p class='participate-info'>"+acceptsText+"</p>"+participationHTML;
          });

          dentistToPrint = {
              firstName:dentist.firstName? dentist.firstName: "",
              lastName:dentist.lastName ? dentist.lastName: "" ,
              businessName:dentist.businessName ? dentist.businessName: "",
              address:dentist.addressOne ? dentist.addressOne: "",
              city:dentist.city ? dentist.city : "",
              stateCode:dentist.stateCode ? dentist.stateCode : "",
              zip:dentist.zip ? dentist.zip: "",
              phone:dentist.phone ? dentist.phone: "",
              specialityText:dentistSearchPrintSpeciality ? dentistSearchPrintSpeciality : "",
              speciality:dentist.specialties ? dentist.specialties : "",
              distance:dentist.distance ? dentist.distance: "",
              distanceText:dentistSearchPrintMiles ? dentistSearchPrintMiles: "",
              participationText:dentistSearchPrintParticipates ? dentistSearchPrintParticipates: "",
              providerInfoText:dentistSearchPrintProviderInfo ? dentistSearchPrintProviderInfo: "",
              genderText:dentistSearchPrintGender ? dentistSearchPrintGender: "",
              gender:dentist.genderCode ? dentist.genderCode: "",
              educationText:dentistSearchPrintEducation ? dentistSearchPrintEducation : "",
              education:dentist.education ? dentist.education: "" ,
              treatsChildren:treatsChildrenText ? treatsChildrenText : "",
              treatsAdults:treatsAdultsText ? treatsAdultsText : "",
              languages:dentist.prvdrLanguages ? dentist.prvdrLanguages: "",
              officeLanguages: dentist.officeLanguages ? dentist.officeLanguages: "",
              officeText:dentistSearchPrintOffcInfo ? dentistSearchPrintOffcInfo: "",
              email:dentist.dentistEmail ? dentist.dentistEmail : "",
              wheelChairAccessText:wheelChairAccessText ? wheelChairAccessText: "",
              publicTransitText:publicTransitText ? publicTransitText: "",
              participationHTML:participationHTML ? participationHTML: "",
              pnrScore:dentist.pnrScore ? dentist.pnrScore: "",
              pnrUrl:dentist.pnrUrl ? dentist.pnrUrl: "",
              teledentistry: dentist.teledentistry ? dentist.teledentistry: "",
              raceEthnicity: dentist.raceEthnicity? dentist.raceEthnicity: ""
          };
           dentistToPrintHTML = dentistResultsTemplate(dentistToPrint);
		   $(".print-dentist-container").append(dentistToPrintHTML);
      });


      $.each(dentistsToPrintObj.filters,function(filter,filterValue){
          if(filter == "Product"){
              $(".results-content .print-product-code").text(filterValue);
          }else if(filter == "Address"){
              $(".results-content .print-filter-address").text(filterValue);
          }else if(filter == "resultSortedBy"){
			  $(".results-content .print-result-sort").text(filterValue);
          }else if(filter == "Distance"){
			 $(".results-content .print-distance-value").text(filterValue);
          }else if(filter == "Specialty"){
             $(".results-content .print-speciality-code").text(filterValue);
          }else if(filter == "Language"){
             $(".results-content .print-language-value").text(filterValue);
          }else if(filter == "Gender"){
              $(".results-content .print-gender-value").text(filterValue);
          }else if(filter == "TotalResultsFetched"){
			$(".total-results-fetched").text(filterValue);
        }
			});
        }
});
  

$(function(){
  $(document).ready(function(){
    $('.dental-care-facts .facts-list').removeClass('list').hide();
    $('.dental-care-facts .plus-icon').show();
    $('.dental-care-facts .minus-icon').hide();
  $('.dental-care-facts .plus-icon').on('click',function(){
    var $SECONDPARENT= $(this).parent().parent(),
        $THIRDPARENT= $(this).parent().parent().parent();
    $THIRDPARENT.find('.facts-list').addClass('list').show();
    $SECONDPARENT.find('.plus-icon').hide();
    $SECONDPARENT.find('.minus-icon').show();
  });
  $('.dental-care-facts .minus-icon').on('click',function(){
    var $SECONDPARENT= $(this).parent().parent(),
        $THIRDPARENT= $(this).parent().parent().parent();
    $THIRDPARENT.find('.facts-list').removeClass('list').hide();
    $SECONDPARENT.find('.plus-icon').show();
    $SECONDPARENT.find('.minus-icon').hide();
  });
  $('.dental-care-facts .fact-number, .dental-care-facts .fact-description').on('click', function() {
    var $SECONDPARENT= $(this).parent().parent(),
        $FIRSTPARENT= $(this).parent();
    var descriptionElement = $SECONDPARENT.find('.facts-list');
    if ($(descriptionElement).is(':visible')) {
      $FIRSTPARENT.find('.minus-icon').trigger('click');
    } else {
      $FIRSTPARENT.find('.plus-icon').trigger('click');
    }
  });
})
});
$(function(){
    var $wind = $(window),
        $html = $('html'),
        $wrap = $('.compare-products');



    if( $wrap.length )
    {
        $wrap.each(function(){
            var $prnt = $(this);

            ////////////////////////////////////////////////////////////////////////////////////////////
            // Add column class to container
            ////////////////////////////////////////////////////////////////////////////////////////////
            var $prim = $('.primary', $prnt);

            $('.table-layout', $prim).addClass('product-quantity-' + $('.product-specs .post-preview', $prim).length);
             $('.specs-table', $prim).addClass('product-quantity-' + $('.product-specs .post-preview', $prim).length);

            ////////////////////////////////////////////////////////////////////////////////////////////


            ////////////////////////////////////////////////////////////////////////////////////////////
            // Mobile Read More Toggle
            ////////////////////////////////////////////////////////////////////////////////////////////
            $('.js_toggle_btn', $prnt).on('click', function(){ togglePanel( $(this) ); });

            togglePanel( $('.post-text', $prnt).first() );
            ////////////////////////////////////////////////////////////////////////////////////////////


            ////////////////////////////////////////////////////////////////////////////////////////////
            // Check options chosen to compare
            ////////////////////////////////////////////////////////////////////////////////////////////
            var chos = 'isChosen',
                chng = 'isChosing',
                maxC = 'maxChosen',
                comp = 'canCompare';
            ////////////////////////////////////////////////////////////////////////////////////////////
            var $mobi = $('.mobile-compare-modal', $prnt);
            ////////////////////////////////////////////////////////////////////////////////////////////
            $('.btn-compare', $prnt).on('click', function(){
                var elem = $(this).parents('.post-preview'),
                    data = elem.attr('data-product'),
                    lngt = function(){ return $('.'+chos, $prnt).length; },

                    chek = $wrap.filter('.'+chng);

                if( chek.length && !$prnt.hasClass(chng) )
                {
                    chek.removeClass(chng+' '+comp+' '+maxC);

                    $('.'+chos).removeClass(chos);

                    $('.cell').removeClass('active');
                }

                if( lngt() < 3 )
                {
                    elem.toggleClass(chos);

                    $('[data-product="'+data+'"]', $mobi).toggleClass('active');

                    $prnt
                    .toggleClass(chng, lngt() > 0)
                    .toggleClass(comp, lngt() > 1);

                    if( lngt() == 3 ) $prnt.addClass('maxChosen');
                }
                else if( elem.hasClass(chos) )
                {
                    elem.removeClass(chos);

                    $('[data-product="'+data+'"]', $mobi).removeClass('active');

                    $prnt.removeClass('maxChosen');
                }

                if( lngt() > 1 ) $('.compare-num', $prnt).text( lngt() );
                $('td.subcategory', $mobi).attr("colspan",lngt());

            });
            ////////////////////////////////////////////////////////////////////////////////////////////


            ////////////////////////////////////////////////////////////////////////////////////////////
            // Open Mobile Compare Modal on clickj
            ////////////////////////////////////////////////////////////////////////////////////////////
            var openModal = 'open-mobile-compare',
                compareTb = $('.compare-table', $mobi);

            $('.js_toggle_modal', $prnt).on('click', function(){
                 $(".mobile.subcategory").each(function(){
                     if ($(this).attr("data-product") != 1) {
                         $(this).remove();
                     }
                  });
                if( !$html.hasClass(openModal) )
                {
                    $('[data-mh]', compareTb).matchHeight({ remove: true });
                    $('.active [data-mh]', compareTb).matchHeight();
                }

                $prnt.toggleClass('active-modal');

                $html.toggleClass(openModal);
            });
            ////////////////////////////////////////////////////////////////////////////////////////////
        });

        ////////////////////////////////////////////////////////////////////////////////////////////
        // Check viewport orientation
        ////////////////////////////////////////////////////////////////////////////////////////////
        checkRotate();

        $wind.on('resize', checkRotate);
        ////////////////////////////////////////////////////////////////////////////////////////////
    }

    // Mobile Read More Toggle
    function togglePanel( element ){ element.parents('.post-preview').toggleClass('isOpen').find('.js_toggle_box').slideToggle(); }

    // Check viewport orientation
    function checkRotate(){ $html.toggleClass('please-rotate', $wind.outerHeight() > $wind.outerWidth()); }

});

$(function(){
	$(".accordion").each(function() {
        var randomNum = Math.floor(Math.random() * 10000);

        $(this).find(".collapse-trigger").attr("id","collapse-btn-" + randomNum);
        $(this).find(".collapse-trigger").attr("data-target","#collapse-item-" + randomNum);
        $(this).find(".collapse-trigger").attr("aria-controls","collapse-item-" + randomNum);
        $(this).find(".collapse").attr("id", "collapse-item-" + randomNum);
        $(this).find(".collapse").attr("aria-labelledby", "collapse-btn-" + randomNum);
	});
});

$(function(){

var getSlider = $('.carousel_container'),
    getParent = getSlider.parents('.section'),
    numSlides = getSlider.children().length;

if( numSlides > 1 )
{
    let intervalTime = $('.carousel_container').data('intervaltime');

    getSlider.slick({
        slidesToShow: 1,
        slidesToScroll: 1,
        dots: true,
        arrows:false,
        autoplay:true,
        autoplaySpeed: intervalTime ? parseFloat(intervalTime)*1000 : 4000,
        adaptiveHeight: true
    });

    getSlider.on('afterChange', function(event, slick, currentSlide, nextSlide){
        $('.carousel-titles_list_item', getParent).eq(currentSlide).addClass("active").siblings().removeClass("active");
    });

    $('.carousel-titles_list_item_link', getParent).on("click",function() {
        let thisTitle = $(this);
        thisTitle.parent().addClass("active").siblings().removeClass("active");

        let thisTitleIndex = $(this).parent().index();
        getSlider.slick('slickGoTo', parseInt(thisTitleIndex));
    });
}

});
!function(i){"use strict";"function"==typeof define&&define.amd?define(["jquery"],i):"undefined"!=typeof exports?module.exports=i(require("jquery")):i(jQuery)}(function(i){"use strict";var e=window.Slick||{};(e=function(){var e=0;return function(t,o){var s,n=this;n.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:i(t),appendDots:i(t),arrows:!0,asNavFor:null,prevArrow:'<button class="slick-prev" aria-label="Previous" type="button">Previous</button>',nextArrow:'<button class="slick-next" aria-label="Next" type="button">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(e,t){return i('<button type="button" />').text(t+1)},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",edgeFriction:.35,fade:!1,focusOnSelect:!1,focusOnChange:!1,infinite:!0,initialSlide:0,lazyLoad:"ondemand",mobileFirst:!1,pauseOnHover:!0,pauseOnFocus:!0,pauseOnDotsHover:!1,respondTo:"window",responsive:null,rows:1,rtl:!1,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,useTransform:!0,variableWidth:!1,vertical:!1,verticalSwiping:!1,waitForAnimate:!0,zIndex:1e3},n.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,scrolling:!1,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,swiping:!1,$list:null,touchObject:{},transformsEnabled:!1,unslicked:!1},i.extend(n,n.initials),n.activeBreakpoint=null,n.animType=null,n.animProp=null,n.breakpoints=[],n.breakpointSettings=[],n.cssTransitions=!1,n.focussed=!1,n.interrupted=!1,n.hidden="hidden",n.paused=!0,n.positionProp=null,n.respondTo=null,n.rowCount=1,n.shouldClick=!0,n.$slider=i(t),n.$slidesCache=null,n.transformType=null,n.transitionType=null,n.visibilityChange="visibilitychange",n.windowWidth=0,n.windowTimer=null,s=i(t).data("slick")||{},n.options=i.extend({},n.defaults,o,s),n.currentSlide=n.options.initialSlide,n.originalSettings=n.options,void 0!==document.mozHidden?(n.hidden="mozHidden",n.visibilityChange="mozvisibilitychange"):void 0!==document.webkitHidden&&(n.hidden="webkitHidden",n.visibilityChange="webkitvisibilitychange"),n.autoPlay=i.proxy(n.autoPlay,n),n.autoPlayClear=i.proxy(n.autoPlayClear,n),n.autoPlayIterator=i.proxy(n.autoPlayIterator,n),n.changeSlide=i.proxy(n.changeSlide,n),n.clickHandler=i.proxy(n.clickHandler,n),n.selectHandler=i.proxy(n.selectHandler,n),n.setPosition=i.proxy(n.setPosition,n),n.swipeHandler=i.proxy(n.swipeHandler,n),n.dragHandler=i.proxy(n.dragHandler,n),n.keyHandler=i.proxy(n.keyHandler,n),n.instanceUid=e++,n.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,n.registerBreakpoints(),n.init(!0)}}()).prototype.activateADA=function(){this.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({tabindex:"0"})},e.prototype.addSlide=e.prototype.slickAdd=function(e,t,o){var s=this;if("boolean"==typeof t)o=t,t=null;else if(t<0||t>=s.slideCount)return!1;s.unload(),"number"==typeof t?0===t&&0===s.$slides.length?i(e).appendTo(s.$slideTrack):o?i(e).insertBefore(s.$slides.eq(t)):i(e).insertAfter(s.$slides.eq(t)):!0===o?i(e).prependTo(s.$slideTrack):i(e).appendTo(s.$slideTrack),s.$slides=s.$slideTrack.children(this.options.slide),s.$slideTrack.children(this.options.slide).detach(),s.$slideTrack.append(s.$slides),s.$slides.each(function(e,t){i(t).attr("data-slick-index",e)}),s.$slidesCache=s.$slides,s.reinit()},e.prototype.animateHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.animate({height:e},i.options.speed)}},e.prototype.animateSlide=function(e,t){var o={},s=this;s.animateHeight(),!0===s.options.rtl&&!1===s.options.vertical&&(e=-e),!1===s.transformsEnabled?!1===s.options.vertical?s.$slideTrack.animate({left:e},s.options.speed,s.options.easing,t):s.$slideTrack.animate({top:e},s.options.speed,s.options.easing,t):!1===s.cssTransitions?(!0===s.options.rtl&&(s.currentLeft=-s.currentLeft),i({animStart:s.currentLeft}).animate({animStart:e},{duration:s.options.speed,easing:s.options.easing,step:function(i){i=Math.ceil(i),!1===s.options.vertical?(o[s.animType]="translate("+i+"px, 0px)",s.$slideTrack.css(o)):(o[s.animType]="translate(0px,"+i+"px)",s.$slideTrack.css(o))},complete:function(){t&&t.call()}})):(s.applyTransition(),e=Math.ceil(e),!1===s.options.vertical?o[s.animType]="translate3d("+e+"px, 0px, 0px)":o[s.animType]="translate3d(0px,"+e+"px, 0px)",s.$slideTrack.css(o),t&&setTimeout(function(){s.disableTransition(),t.call()},s.options.speed))},e.prototype.getNavTarget=function(){var e=this,t=e.options.asNavFor;return t&&null!==t&&(t=i(t).not(e.$slider)),t},e.prototype.asNavFor=function(e){var t=this.getNavTarget();null!==t&&"object"==typeof t&&t.each(function(){var t=i(this).slick("getSlick");t.unslicked||t.slideHandler(e,!0)})},e.prototype.applyTransition=function(i){var e=this,t={};!1===e.options.fade?t[e.transitionType]=e.transformType+" "+e.options.speed+"ms "+e.options.cssEase:t[e.transitionType]="opacity "+e.options.speed+"ms "+e.options.cssEase,!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.autoPlay=function(){var i=this;i.autoPlayClear(),i.slideCount>i.options.slidesToShow&&(i.autoPlayTimer=setInterval(i.autoPlayIterator,i.options.autoplaySpeed))},e.prototype.autoPlayClear=function(){var i=this;i.autoPlayTimer&&clearInterval(i.autoPlayTimer)},e.prototype.autoPlayIterator=function(){var i=this,e=i.currentSlide+i.options.slidesToScroll;i.paused||i.interrupted||i.focussed||(!1===i.options.infinite&&(1===i.direction&&i.currentSlide+1===i.slideCount-1?i.direction=0:0===i.direction&&(e=i.currentSlide-i.options.slidesToScroll,i.currentSlide-1==0&&(i.direction=1))),i.slideHandler(e))},e.prototype.buildArrows=function(){var e=this;!0===e.options.arrows&&(e.$prevArrow=i(e.options.prevArrow).addClass("slick-arrow"),e.$nextArrow=i(e.options.nextArrow).addClass("slick-arrow"),e.slideCount>e.options.slidesToShow?(e.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex"),e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.prependTo(e.options.appendArrows),e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.appendTo(e.options.appendArrows),!0!==e.options.infinite&&e.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true")):e.$prevArrow.add(e.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true",tabindex:"-1"}))},e.prototype.buildDots=function(){var e,t,o=this;if(!0===o.options.dots){for(o.$slider.addClass("slick-dotted"),t=i("<ul />").addClass(o.options.dotsClass),e=0;e<=o.getDotCount();e+=1)t.append(i("<li />").append(o.options.customPaging.call(this,o,e)));o.$dots=t.appendTo(o.options.appendDots),o.$dots.find("li").first().addClass("slick-active")}},e.prototype.buildOut=function(){var e=this;e.$slides=e.$slider.children(e.options.slide+":not(.slick-cloned)").addClass("slick-slide"),e.slideCount=e.$slides.length,e.$slides.each(function(e,t){i(t).attr("data-slick-index",e).data("originalStyling",i(t).attr("style")||"")}),e.$slider.addClass("slick-slider"),e.$slideTrack=0===e.slideCount?i('<div class="slick-track"/>').appendTo(e.$slider):e.$slides.wrapAll('<div class="slick-track"/>').parent(),e.$list=e.$slideTrack.wrap('<div class="slick-list"/>').parent(),e.$slideTrack.css("opacity",0),!0!==e.options.centerMode&&!0!==e.options.swipeToSlide||(e.options.slidesToScroll=1),i("img[data-lazy]",e.$slider).not("[src]").addClass("slick-loading"),e.setupInfinite(),e.buildArrows(),e.buildDots(),e.updateDots(),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),!0===e.options.draggable&&e.$list.addClass("draggable")},e.prototype.buildRows=function(){var i,e,t,o,s,n,r,l=this;if(o=document.createDocumentFragment(),n=l.$slider.children(),l.options.rows>1){for(r=l.options.slidesPerRow*l.options.rows,s=Math.ceil(n.length/r),i=0;i<s;i++){var d=document.createElement("div");for(e=0;e<l.options.rows;e++){var a=document.createElement("div");for(t=0;t<l.options.slidesPerRow;t++){var c=i*r+(e*l.options.slidesPerRow+t);n.get(c)&&a.appendChild(n.get(c))}d.appendChild(a)}o.appendChild(d)}l.$slider.empty().append(o),l.$slider.children().children().children().css({width:100/l.options.slidesPerRow+"%",display:"inline-block"})}},e.prototype.checkResponsive=function(e,t){var o,s,n,r=this,l=!1,d=r.$slider.width(),a=window.innerWidth||i(window).width();if("window"===r.respondTo?n=a:"slider"===r.respondTo?n=d:"min"===r.respondTo&&(n=Math.min(a,d)),r.options.responsive&&r.options.responsive.length&&null!==r.options.responsive){s=null;for(o in r.breakpoints)r.breakpoints.hasOwnProperty(o)&&(!1===r.originalSettings.mobileFirst?n<r.breakpoints[o]&&(s=r.breakpoints[o]):n>r.breakpoints[o]&&(s=r.breakpoints[o]));null!==s?null!==r.activeBreakpoint?(s!==r.activeBreakpoint||t)&&(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):(r.activeBreakpoint=s,"unslick"===r.breakpointSettings[s]?r.unslick(s):(r.options=i.extend({},r.originalSettings,r.breakpointSettings[s]),!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e)),l=s):null!==r.activeBreakpoint&&(r.activeBreakpoint=null,r.options=r.originalSettings,!0===e&&(r.currentSlide=r.options.initialSlide),r.refresh(e),l=s),e||!1===l||r.$slider.trigger("breakpoint",[r,l])}},e.prototype.changeSlide=function(e,t){var o,s,n,r=this,l=i(e.currentTarget);switch(l.is("a")&&e.preventDefault(),l.is("li")||(l=l.closest("li")),n=r.slideCount%r.options.slidesToScroll!=0,o=n?0:(r.slideCount-r.currentSlide)%r.options.slidesToScroll,e.data.message){case"previous":s=0===o?r.options.slidesToScroll:r.options.slidesToShow-o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide-s,!1,t);break;case"next":s=0===o?r.options.slidesToScroll:o,r.slideCount>r.options.slidesToShow&&r.slideHandler(r.currentSlide+s,!1,t);break;case"index":var d=0===e.data.index?0:e.data.index||l.index()*r.options.slidesToScroll;r.slideHandler(r.checkNavigable(d),!1,t),l.children().trigger("focus");break;default:return}},e.prototype.checkNavigable=function(i){var e,t;if(e=this.getNavigableIndexes(),t=0,i>e[e.length-1])i=e[e.length-1];else for(var o in e){if(i<e[o]){i=t;break}t=e[o]}return i},e.prototype.cleanUpEvents=function(){var e=this;e.options.dots&&null!==e.$dots&&(i("li",e.$dots).off("click.slick",e.changeSlide).off("mouseenter.slick",i.proxy(e.interrupt,e,!0)).off("mouseleave.slick",i.proxy(e.interrupt,e,!1)),!0===e.options.accessibility&&e.$dots.off("keydown.slick",e.keyHandler)),e.$slider.off("focus.slick blur.slick"),!0===e.options.arrows&&e.slideCount>e.options.slidesToShow&&(e.$prevArrow&&e.$prevArrow.off("click.slick",e.changeSlide),e.$nextArrow&&e.$nextArrow.off("click.slick",e.changeSlide),!0===e.options.accessibility&&(e.$prevArrow&&e.$prevArrow.off("keydown.slick",e.keyHandler),e.$nextArrow&&e.$nextArrow.off("keydown.slick",e.keyHandler))),e.$list.off("touchstart.slick mousedown.slick",e.swipeHandler),e.$list.off("touchmove.slick mousemove.slick",e.swipeHandler),e.$list.off("touchend.slick mouseup.slick",e.swipeHandler),e.$list.off("touchcancel.slick mouseleave.slick",e.swipeHandler),e.$list.off("click.slick",e.clickHandler),i(document).off(e.visibilityChange,e.visibility),e.cleanUpSlideEvents(),!0===e.options.accessibility&&e.$list.off("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().off("click.slick",e.selectHandler),i(window).off("orientationchange.slick.slick-"+e.instanceUid,e.orientationChange),i(window).off("resize.slick.slick-"+e.instanceUid,e.resize),i("[draggable!=true]",e.$slideTrack).off("dragstart",e.preventDefault),i(window).off("load.slick.slick-"+e.instanceUid,e.setPosition)},e.prototype.cleanUpSlideEvents=function(){var e=this;e.$list.off("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.off("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.cleanUpRows=function(){var i,e=this;e.options.rows>1&&((i=e.$slides.children().children()).removeAttr("style"),e.$slider.empty().append(i))},e.prototype.clickHandler=function(i){!1===this.shouldClick&&(i.stopImmediatePropagation(),i.stopPropagation(),i.preventDefault())},e.prototype.destroy=function(e){var t=this;t.autoPlayClear(),t.touchObject={},t.cleanUpEvents(),i(".slick-cloned",t.$slider).detach(),t.$dots&&t.$dots.remove(),t.$prevArrow&&t.$prevArrow.length&&(t.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.prevArrow)&&t.$prevArrow.remove()),t.$nextArrow&&t.$nextArrow.length&&(t.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",""),t.htmlExpr.test(t.options.nextArrow)&&t.$nextArrow.remove()),t.$slides&&(t.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){i(this).attr("style",i(this).data("originalStyling"))}),t.$slideTrack.children(this.options.slide).detach(),t.$slideTrack.detach(),t.$list.detach(),t.$slider.append(t.$slides)),t.cleanUpRows(),t.$slider.removeClass("slick-slider"),t.$slider.removeClass("slick-initialized"),t.$slider.removeClass("slick-dotted"),t.unslicked=!0,e||t.$slider.trigger("destroy",[t])},e.prototype.disableTransition=function(i){var e=this,t={};t[e.transitionType]="",!1===e.options.fade?e.$slideTrack.css(t):e.$slides.eq(i).css(t)},e.prototype.fadeSlide=function(i,e){var t=this;!1===t.cssTransitions?(t.$slides.eq(i).css({zIndex:t.options.zIndex}),t.$slides.eq(i).animate({opacity:1},t.options.speed,t.options.easing,e)):(t.applyTransition(i),t.$slides.eq(i).css({opacity:1,zIndex:t.options.zIndex}),e&&setTimeout(function(){t.disableTransition(i),e.call()},t.options.speed))},e.prototype.fadeSlideOut=function(i){var e=this;!1===e.cssTransitions?e.$slides.eq(i).animate({opacity:0,zIndex:e.options.zIndex-2},e.options.speed,e.options.easing):(e.applyTransition(i),e.$slides.eq(i).css({opacity:0,zIndex:e.options.zIndex-2}))},e.prototype.filterSlides=e.prototype.slickFilter=function(i){var e=this;null!==i&&(e.$slidesCache=e.$slides,e.unload(),e.$slideTrack.children(this.options.slide).detach(),e.$slidesCache.filter(i).appendTo(e.$slideTrack),e.reinit())},e.prototype.focusHandler=function(){var e=this;e.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(t){t.stopImmediatePropagation();var o=i(this);setTimeout(function(){e.options.pauseOnFocus&&(e.focussed=o.is(":focus"),e.autoPlay())},0)})},e.prototype.getCurrent=e.prototype.slickCurrentSlide=function(){return this.currentSlide},e.prototype.getDotCount=function(){var i=this,e=0,t=0,o=0;if(!0===i.options.infinite)if(i.slideCount<=i.options.slidesToShow)++o;else for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else if(!0===i.options.centerMode)o=i.slideCount;else if(i.options.asNavFor)for(;e<i.slideCount;)++o,e=t+i.options.slidesToScroll,t+=i.options.slidesToScroll<=i.options.slidesToShow?i.options.slidesToScroll:i.options.slidesToShow;else o=1+Math.ceil((i.slideCount-i.options.slidesToShow)/i.options.slidesToScroll);return o-1},e.prototype.getLeft=function(i){var e,t,o,s,n=this,r=0;return n.slideOffset=0,t=n.$slides.first().outerHeight(!0),!0===n.options.infinite?(n.slideCount>n.options.slidesToShow&&(n.slideOffset=n.slideWidth*n.options.slidesToShow*-1,s=-1,!0===n.options.vertical&&!0===n.options.centerMode&&(2===n.options.slidesToShow?s=-1.5:1===n.options.slidesToShow&&(s=-2)),r=t*n.options.slidesToShow*s),n.slideCount%n.options.slidesToScroll!=0&&i+n.options.slidesToScroll>n.slideCount&&n.slideCount>n.options.slidesToShow&&(i>n.slideCount?(n.slideOffset=(n.options.slidesToShow-(i-n.slideCount))*n.slideWidth*-1,r=(n.options.slidesToShow-(i-n.slideCount))*t*-1):(n.slideOffset=n.slideCount%n.options.slidesToScroll*n.slideWidth*-1,r=n.slideCount%n.options.slidesToScroll*t*-1))):i+n.options.slidesToShow>n.slideCount&&(n.slideOffset=(i+n.options.slidesToShow-n.slideCount)*n.slideWidth,r=(i+n.options.slidesToShow-n.slideCount)*t),n.slideCount<=n.options.slidesToShow&&(n.slideOffset=0,r=0),!0===n.options.centerMode&&n.slideCount<=n.options.slidesToShow?n.slideOffset=n.slideWidth*Math.floor(n.options.slidesToShow)/2-n.slideWidth*n.slideCount/2:!0===n.options.centerMode&&!0===n.options.infinite?n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)-n.slideWidth:!0===n.options.centerMode&&(n.slideOffset=0,n.slideOffset+=n.slideWidth*Math.floor(n.options.slidesToShow/2)),e=!1===n.options.vertical?i*n.slideWidth*-1+n.slideOffset:i*t*-1+r,!0===n.options.variableWidth&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,!0===n.options.centerMode&&(o=n.slideCount<=n.options.slidesToShow||!1===n.options.infinite?n.$slideTrack.children(".slick-slide").eq(i):n.$slideTrack.children(".slick-slide").eq(i+n.options.slidesToShow+1),e=!0===n.options.rtl?o[0]?-1*(n.$slideTrack.width()-o[0].offsetLeft-o.width()):0:o[0]?-1*o[0].offsetLeft:0,e+=(n.$list.width()-o.outerWidth())/2)),e},e.prototype.getOption=e.prototype.slickGetOption=function(i){return this.options[i]},e.prototype.getNavigableIndexes=function(){var i,e=this,t=0,o=0,s=[];for(!1===e.options.infinite?i=e.slideCount:(t=-1*e.options.slidesToScroll,o=-1*e.options.slidesToScroll,i=2*e.slideCount);t<i;)s.push(t),t=o+e.options.slidesToScroll,o+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow;return s},e.prototype.getSlick=function(){return this},e.prototype.getSlideCount=function(){var e,t,o=this;return t=!0===o.options.centerMode?o.slideWidth*Math.floor(o.options.slidesToShow/2):0,!0===o.options.swipeToSlide?(o.$slideTrack.find(".slick-slide").each(function(s,n){if(n.offsetLeft-t+i(n).outerWidth()/2>-1*o.swipeLeft)return e=n,!1}),Math.abs(i(e).attr("data-slick-index")-o.currentSlide)||1):o.options.slidesToScroll},e.prototype.goTo=e.prototype.slickGoTo=function(i,e){this.changeSlide({data:{message:"index",index:parseInt(i)}},e)},e.prototype.init=function(e){var t=this;i(t.$slider).hasClass("slick-initialized")||(i(t.$slider).addClass("slick-initialized"),t.buildRows(),t.buildOut(),t.setProps(),t.startLoad(),t.loadSlider(),t.initializeEvents(),t.updateArrows(),t.updateDots(),t.checkResponsive(!0),t.focusHandler()),e&&t.$slider.trigger("init",[t]),!0===t.options.accessibility&&t.initADA(),t.options.autoplay&&(t.paused=!1,t.autoPlay())},e.prototype.initADA=function(){var e=this,t=Math.ceil(e.slideCount/e.options.slidesToShow),o=e.getNavigableIndexes().filter(function(i){return i>=0&&i<e.slideCount});e.$slides.add(e.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true",tabindex:"-1"}).find("a, input, button, select").attr({tabindex:"-1"}),null!==e.$dots&&(e.$slides.not(e.$slideTrack.find(".slick-cloned")).each(function(t){var s=o.indexOf(t);i(this).attr({role:"tabpanel",id:"slick-slide"+e.instanceUid+t,tabindex:-1}),-1!==s&&i(this).attr({"aria-describedby":"slick-slide-control"+e.instanceUid+s})}),e.$dots.attr("role","tablist").find("li").each(function(s){var n=o[s];i(this).attr({role:"presentation"}),i(this).find("button").first().attr({role:"tab",id:"slick-slide-control"+e.instanceUid+s,"aria-controls":"slick-slide"+e.instanceUid+n,"aria-label":s+1+" of "+t,"aria-selected":null,tabindex:"-1"})}).eq(e.currentSlide).find("button").attr({"aria-selected":"true",tabindex:"0"}).end());for(var s=e.currentSlide,n=s+e.options.slidesToShow;s<n;s++)e.$slides.eq(s).attr("tabindex",0);e.activateADA()},e.prototype.initArrowEvents=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},i.changeSlide),i.$nextArrow.off("click.slick").on("click.slick",{message:"next"},i.changeSlide),!0===i.options.accessibility&&(i.$prevArrow.on("keydown.slick",i.keyHandler),i.$nextArrow.on("keydown.slick",i.keyHandler)))},e.prototype.initDotEvents=function(){var e=this;!0===e.options.dots&&(i("li",e.$dots).on("click.slick",{message:"index"},e.changeSlide),!0===e.options.accessibility&&e.$dots.on("keydown.slick",e.keyHandler)),!0===e.options.dots&&!0===e.options.pauseOnDotsHover&&i("li",e.$dots).on("mouseenter.slick",i.proxy(e.interrupt,e,!0)).on("mouseleave.slick",i.proxy(e.interrupt,e,!1))},e.prototype.initSlideEvents=function(){var e=this;e.options.pauseOnHover&&(e.$list.on("mouseenter.slick",i.proxy(e.interrupt,e,!0)),e.$list.on("mouseleave.slick",i.proxy(e.interrupt,e,!1)))},e.prototype.initializeEvents=function(){var e=this;e.initArrowEvents(),e.initDotEvents(),e.initSlideEvents(),e.$list.on("touchstart.slick mousedown.slick",{action:"start"},e.swipeHandler),e.$list.on("touchmove.slick mousemove.slick",{action:"move"},e.swipeHandler),e.$list.on("touchend.slick mouseup.slick",{action:"end"},e.swipeHandler),e.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},e.swipeHandler),e.$list.on("click.slick",e.clickHandler),i(document).on(e.visibilityChange,i.proxy(e.visibility,e)),!0===e.options.accessibility&&e.$list.on("keydown.slick",e.keyHandler),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),i(window).on("orientationchange.slick.slick-"+e.instanceUid,i.proxy(e.orientationChange,e)),i(window).on("resize.slick.slick-"+e.instanceUid,i.proxy(e.resize,e)),i("[draggable!=true]",e.$slideTrack).on("dragstart",e.preventDefault),i(window).on("load.slick.slick-"+e.instanceUid,e.setPosition),i(e.setPosition)},e.prototype.initUI=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.show(),i.$nextArrow.show()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.show()},e.prototype.keyHandler=function(i){var e=this;i.target.tagName.match("TEXTAREA|INPUT|SELECT")||(37===i.keyCode&&!0===e.options.accessibility?e.changeSlide({data:{message:!0===e.options.rtl?"next":"previous"}}):39===i.keyCode&&!0===e.options.accessibility&&e.changeSlide({data:{message:!0===e.options.rtl?"previous":"next"}}))},e.prototype.lazyLoad=function(){function e(e){i("img[data-lazy]",e).each(function(){var e=i(this),t=i(this).attr("data-lazy"),o=i(this).attr("data-srcset"),s=i(this).attr("data-sizes")||n.$slider.attr("data-sizes"),r=document.createElement("img");r.onload=function(){e.animate({opacity:0},100,function(){o&&(e.attr("srcset",o),s&&e.attr("sizes",s)),e.attr("src",t).animate({opacity:1},200,function(){e.removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading")}),n.$slider.trigger("lazyLoaded",[n,e,t])})},r.onerror=function(){e.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),n.$slider.trigger("lazyLoadError",[n,e,t])},r.src=t})}var t,o,s,n=this;if(!0===n.options.centerMode?!0===n.options.infinite?s=(o=n.currentSlide+(n.options.slidesToShow/2+1))+n.options.slidesToShow+2:(o=Math.max(0,n.currentSlide-(n.options.slidesToShow/2+1)),s=n.options.slidesToShow/2+1+2+n.currentSlide):(o=n.options.infinite?n.options.slidesToShow+n.currentSlide:n.currentSlide,s=Math.ceil(o+n.options.slidesToShow),!0===n.options.fade&&(o>0&&o--,s<=n.slideCount&&s++)),t=n.$slider.find(".slick-slide").slice(o,s),"anticipated"===n.options.lazyLoad)for(var r=o-1,l=s,d=n.$slider.find(".slick-slide"),a=0;a<n.options.slidesToScroll;a++)r<0&&(r=n.slideCount-1),t=(t=t.add(d.eq(r))).add(d.eq(l)),r--,l++;e(t),n.slideCount<=n.options.slidesToShow?e(n.$slider.find(".slick-slide")):n.currentSlide>=n.slideCount-n.options.slidesToShow?e(n.$slider.find(".slick-cloned").slice(0,n.options.slidesToShow)):0===n.currentSlide&&e(n.$slider.find(".slick-cloned").slice(-1*n.options.slidesToShow))},e.prototype.loadSlider=function(){var i=this;i.setPosition(),i.$slideTrack.css({opacity:1}),i.$slider.removeClass("slick-loading"),i.initUI(),"progressive"===i.options.lazyLoad&&i.progressiveLazyLoad()},e.prototype.next=e.prototype.slickNext=function(){this.changeSlide({data:{message:"next"}})},e.prototype.orientationChange=function(){var i=this;i.checkResponsive(),i.setPosition()},e.prototype.pause=e.prototype.slickPause=function(){var i=this;i.autoPlayClear(),i.paused=!0},e.prototype.play=e.prototype.slickPlay=function(){var i=this;i.autoPlay(),i.options.autoplay=!0,i.paused=!1,i.focussed=!1,i.interrupted=!1},e.prototype.postSlide=function(e){var t=this;t.unslicked||(t.$slider.trigger("afterChange",[t,e]),t.animating=!1,t.slideCount>t.options.slidesToShow&&t.setPosition(),t.swipeLeft=null,t.options.autoplay&&t.autoPlay(),!0===t.options.accessibility&&(t.initADA(),t.options.focusOnChange&&i(t.$slides.get(t.currentSlide)).attr("tabindex",0).focus()))},e.prototype.prev=e.prototype.slickPrev=function(){this.changeSlide({data:{message:"previous"}})},e.prototype.preventDefault=function(i){i.preventDefault()},e.prototype.progressiveLazyLoad=function(e){e=e||1;var t,o,s,n,r,l=this,d=i("img[data-lazy]",l.$slider);d.length?(t=d.first(),o=t.attr("data-lazy"),s=t.attr("data-srcset"),n=t.attr("data-sizes")||l.$slider.attr("data-sizes"),(r=document.createElement("img")).onload=function(){s&&(t.attr("srcset",s),n&&t.attr("sizes",n)),t.attr("src",o).removeAttr("data-lazy data-srcset data-sizes").removeClass("slick-loading"),!0===l.options.adaptiveHeight&&l.setPosition(),l.$slider.trigger("lazyLoaded",[l,t,o]),l.progressiveLazyLoad()},r.onerror=function(){e<3?setTimeout(function(){l.progressiveLazyLoad(e+1)},500):(t.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error"),l.$slider.trigger("lazyLoadError",[l,t,o]),l.progressiveLazyLoad())},r.src=o):l.$slider.trigger("allImagesLoaded",[l])},e.prototype.refresh=function(e){var t,o,s=this;o=s.slideCount-s.options.slidesToShow,!s.options.infinite&&s.currentSlide>o&&(s.currentSlide=o),s.slideCount<=s.options.slidesToShow&&(s.currentSlide=0),t=s.currentSlide,s.destroy(!0),i.extend(s,s.initials,{currentSlide:t}),s.init(),e||s.changeSlide({data:{message:"index",index:t}},!1)},e.prototype.registerBreakpoints=function(){var e,t,o,s=this,n=s.options.responsive||null;if("array"===i.type(n)&&n.length){s.respondTo=s.options.respondTo||"window";for(e in n)if(o=s.breakpoints.length-1,n.hasOwnProperty(e)){for(t=n[e].breakpoint;o>=0;)s.breakpoints[o]&&s.breakpoints[o]===t&&s.breakpoints.splice(o,1),o--;s.breakpoints.push(t),s.breakpointSettings[t]=n[e].settings}s.breakpoints.sort(function(i,e){return s.options.mobileFirst?i-e:e-i})}},e.prototype.reinit=function(){var e=this;e.$slides=e.$slideTrack.children(e.options.slide).addClass("slick-slide"),e.slideCount=e.$slides.length,e.currentSlide>=e.slideCount&&0!==e.currentSlide&&(e.currentSlide=e.currentSlide-e.options.slidesToScroll),e.slideCount<=e.options.slidesToShow&&(e.currentSlide=0),e.registerBreakpoints(),e.setProps(),e.setupInfinite(),e.buildArrows(),e.updateArrows(),e.initArrowEvents(),e.buildDots(),e.updateDots(),e.initDotEvents(),e.cleanUpSlideEvents(),e.initSlideEvents(),e.checkResponsive(!1,!0),!0===e.options.focusOnSelect&&i(e.$slideTrack).children().on("click.slick",e.selectHandler),e.setSlideClasses("number"==typeof e.currentSlide?e.currentSlide:0),e.setPosition(),e.focusHandler(),e.paused=!e.options.autoplay,e.autoPlay(),e.$slider.trigger("reInit",[e])},e.prototype.resize=function(){var e=this;i(window).width()!==e.windowWidth&&(clearTimeout(e.windowDelay),e.windowDelay=window.setTimeout(function(){e.windowWidth=i(window).width(),e.checkResponsive(),e.unslicked||e.setPosition()},50))},e.prototype.removeSlide=e.prototype.slickRemove=function(i,e,t){var o=this;if(i="boolean"==typeof i?!0===(e=i)?0:o.slideCount-1:!0===e?--i:i,o.slideCount<1||i<0||i>o.slideCount-1)return!1;o.unload(),!0===t?o.$slideTrack.children().remove():o.$slideTrack.children(this.options.slide).eq(i).remove(),o.$slides=o.$slideTrack.children(this.options.slide),o.$slideTrack.children(this.options.slide).detach(),o.$slideTrack.append(o.$slides),o.$slidesCache=o.$slides,o.reinit()},e.prototype.setCSS=function(i){var e,t,o=this,s={};!0===o.options.rtl&&(i=-i),e="left"==o.positionProp?Math.ceil(i)+"px":"0px",t="top"==o.positionProp?Math.ceil(i)+"px":"0px",s[o.positionProp]=i,!1===o.transformsEnabled?o.$slideTrack.css(s):(s={},!1===o.cssTransitions?(s[o.animType]="translate("+e+", "+t+")",o.$slideTrack.css(s)):(s[o.animType]="translate3d("+e+", "+t+", 0px)",o.$slideTrack.css(s)))},e.prototype.setDimensions=function(){var i=this;!1===i.options.vertical?!0===i.options.centerMode&&i.$list.css({padding:"0px "+i.options.centerPadding}):(i.$list.height(i.$slides.first().outerHeight(!0)*i.options.slidesToShow),!0===i.options.centerMode&&i.$list.css({padding:i.options.centerPadding+" 0px"})),i.listWidth=i.$list.width(),i.listHeight=i.$list.height(),!1===i.options.vertical&&!1===i.options.variableWidth?(i.slideWidth=Math.ceil(i.listWidth/i.options.slidesToShow),i.$slideTrack.width(Math.ceil(i.slideWidth*i.$slideTrack.children(".slick-slide").length))):!0===i.options.variableWidth?i.$slideTrack.width(5e3*i.slideCount):(i.slideWidth=Math.ceil(i.listWidth),i.$slideTrack.height(Math.ceil(i.$slides.first().outerHeight(!0)*i.$slideTrack.children(".slick-slide").length)));var e=i.$slides.first().outerWidth(!0)-i.$slides.first().width();!1===i.options.variableWidth&&i.$slideTrack.children(".slick-slide").width(i.slideWidth-e)},e.prototype.setFade=function(){var e,t=this;t.$slides.each(function(o,s){e=t.slideWidth*o*-1,!0===t.options.rtl?i(s).css({position:"relative",right:e,top:0,zIndex:t.options.zIndex-2,opacity:0}):i(s).css({position:"relative",left:e,top:0,zIndex:t.options.zIndex-2,opacity:0})}),t.$slides.eq(t.currentSlide).css({zIndex:t.options.zIndex-1,opacity:1})},e.prototype.setHeight=function(){var i=this;if(1===i.options.slidesToShow&&!0===i.options.adaptiveHeight&&!1===i.options.vertical){var e=i.$slides.eq(i.currentSlide).outerHeight(!0);i.$list.css("height",e)}},e.prototype.setOption=e.prototype.slickSetOption=function(){var e,t,o,s,n,r=this,l=!1;if("object"===i.type(arguments[0])?(o=arguments[0],l=arguments[1],n="multiple"):"string"===i.type(arguments[0])&&(o=arguments[0],s=arguments[1],l=arguments[2],"responsive"===arguments[0]&&"array"===i.type(arguments[1])?n="responsive":void 0!==arguments[1]&&(n="single")),"single"===n)r.options[o]=s;else if("multiple"===n)i.each(o,function(i,e){r.options[i]=e});else if("responsive"===n)for(t in s)if("array"!==i.type(r.options.responsive))r.options.responsive=[s[t]];else{for(e=r.options.responsive.length-1;e>=0;)r.options.responsive[e].breakpoint===s[t].breakpoint&&r.options.responsive.splice(e,1),e--;r.options.responsive.push(s[t])}l&&(r.unload(),r.reinit())},e.prototype.setPosition=function(){var i=this;i.setDimensions(),i.setHeight(),!1===i.options.fade?i.setCSS(i.getLeft(i.currentSlide)):i.setFade(),i.$slider.trigger("setPosition",[i])},e.prototype.setProps=function(){var i=this,e=document.body.style;i.positionProp=!0===i.options.vertical?"top":"left","top"===i.positionProp?i.$slider.addClass("slick-vertical"):i.$slider.removeClass("slick-vertical"),void 0===e.WebkitTransition&&void 0===e.MozTransition&&void 0===e.msTransition||!0===i.options.useCSS&&(i.cssTransitions=!0),i.options.fade&&("number"==typeof i.options.zIndex?i.options.zIndex<3&&(i.options.zIndex=3):i.options.zIndex=i.defaults.zIndex),void 0!==e.OTransform&&(i.animType="OTransform",i.transformType="-o-transform",i.transitionType="OTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.MozTransform&&(i.animType="MozTransform",i.transformType="-moz-transform",i.transitionType="MozTransition",void 0===e.perspectiveProperty&&void 0===e.MozPerspective&&(i.animType=!1)),void 0!==e.webkitTransform&&(i.animType="webkitTransform",i.transformType="-webkit-transform",i.transitionType="webkitTransition",void 0===e.perspectiveProperty&&void 0===e.webkitPerspective&&(i.animType=!1)),void 0!==e.msTransform&&(i.animType="msTransform",i.transformType="-ms-transform",i.transitionType="msTransition",void 0===e.msTransform&&(i.animType=!1)),void 0!==e.transform&&!1!==i.animType&&(i.animType="transform",i.transformType="transform",i.transitionType="transition"),i.transformsEnabled=i.options.useTransform&&null!==i.animType&&!1!==i.animType},e.prototype.setSlideClasses=function(i){var e,t,o,s,n=this;if(t=n.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true"),n.$slides.eq(i).addClass("slick-current"),!0===n.options.centerMode){var r=n.options.slidesToShow%2==0?1:0;e=Math.floor(n.options.slidesToShow/2),!0===n.options.infinite&&(i>=e&&i<=n.slideCount-1-e?n.$slides.slice(i-e+r,i+e+1).addClass("slick-active").attr("aria-hidden","false"):(o=n.options.slidesToShow+i,t.slice(o-e+1+r,o+e+2).addClass("slick-active").attr("aria-hidden","false")),0===i?t.eq(t.length-1-n.options.slidesToShow).addClass("slick-center"):i===n.slideCount-1&&t.eq(n.options.slidesToShow).addClass("slick-center")),n.$slides.eq(i).addClass("slick-center")}else i>=0&&i<=n.slideCount-n.options.slidesToShow?n.$slides.slice(i,i+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"):t.length<=n.options.slidesToShow?t.addClass("slick-active").attr("aria-hidden","false"):(s=n.slideCount%n.options.slidesToShow,o=!0===n.options.infinite?n.options.slidesToShow+i:i,n.options.slidesToShow==n.options.slidesToScroll&&n.slideCount-i<n.options.slidesToShow?t.slice(o-(n.options.slidesToShow-s),o+s).addClass("slick-active").attr("aria-hidden","false"):t.slice(o,o+n.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false"));"ondemand"!==n.options.lazyLoad&&"anticipated"!==n.options.lazyLoad||n.lazyLoad()},e.prototype.setupInfinite=function(){var e,t,o,s=this;if(!0===s.options.fade&&(s.options.centerMode=!1),!0===s.options.infinite&&!1===s.options.fade&&(t=null,s.slideCount>s.options.slidesToShow)){for(o=!0===s.options.centerMode?s.options.slidesToShow+1:s.options.slidesToShow,e=s.slideCount;e>s.slideCount-o;e-=1)t=e-1,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t-s.slideCount).prependTo(s.$slideTrack).addClass("slick-cloned");for(e=0;e<o+s.slideCount;e+=1)t=e,i(s.$slides[t]).clone(!0).attr("id","").attr("data-slick-index",t+s.slideCount).appendTo(s.$slideTrack).addClass("slick-cloned");s.$slideTrack.find(".slick-cloned").find("[id]").each(function(){i(this).attr("id","")})}},e.prototype.interrupt=function(i){var e=this;i||e.autoPlay(),e.interrupted=i},e.prototype.selectHandler=function(e){var t=this,o=i(e.target).is(".slick-slide")?i(e.target):i(e.target).parents(".slick-slide"),s=parseInt(o.attr("data-slick-index"));s||(s=0),t.slideCount<=t.options.slidesToShow?t.slideHandler(s,!1,!0):t.slideHandler(s)},e.prototype.slideHandler=function(i,e,t){var o,s,n,r,l,d=null,a=this;if(e=e||!1,!(!0===a.animating&&!0===a.options.waitForAnimate||!0===a.options.fade&&a.currentSlide===i))if(!1===e&&a.asNavFor(i),o=i,d=a.getLeft(o),r=a.getLeft(a.currentSlide),a.currentLeft=null===a.swipeLeft?r:a.swipeLeft,!1===a.options.infinite&&!1===a.options.centerMode&&(i<0||i>a.getDotCount()*a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else if(!1===a.options.infinite&&!0===a.options.centerMode&&(i<0||i>a.slideCount-a.options.slidesToScroll))!1===a.options.fade&&(o=a.currentSlide,!0!==t?a.animateSlide(r,function(){a.postSlide(o)}):a.postSlide(o));else{if(a.options.autoplay&&clearInterval(a.autoPlayTimer),s=o<0?a.slideCount%a.options.slidesToScroll!=0?a.slideCount-a.slideCount%a.options.slidesToScroll:a.slideCount+o:o>=a.slideCount?a.slideCount%a.options.slidesToScroll!=0?0:o-a.slideCount:o,a.animating=!0,a.$slider.trigger("beforeChange",[a,a.currentSlide,s]),n=a.currentSlide,a.currentSlide=s,a.setSlideClasses(a.currentSlide),a.options.asNavFor&&(l=(l=a.getNavTarget()).slick("getSlick")).slideCount<=l.options.slidesToShow&&l.setSlideClasses(a.currentSlide),a.updateDots(),a.updateArrows(),!0===a.options.fade)return!0!==t?(a.fadeSlideOut(n),a.fadeSlide(s,function(){a.postSlide(s)})):a.postSlide(s),void a.animateHeight();!0!==t?a.animateSlide(d,function(){a.postSlide(s)}):a.postSlide(s)}},e.prototype.startLoad=function(){var i=this;!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&(i.$prevArrow.hide(),i.$nextArrow.hide()),!0===i.options.dots&&i.slideCount>i.options.slidesToShow&&i.$dots.hide(),i.$slider.addClass("slick-loading")},e.prototype.swipeDirection=function(){var i,e,t,o,s=this;return i=s.touchObject.startX-s.touchObject.curX,e=s.touchObject.startY-s.touchObject.curY,t=Math.atan2(e,i),(o=Math.round(180*t/Math.PI))<0&&(o=360-Math.abs(o)),o<=45&&o>=0?!1===s.options.rtl?"left":"right":o<=360&&o>=315?!1===s.options.rtl?"left":"right":o>=135&&o<=225?!1===s.options.rtl?"right":"left":!0===s.options.verticalSwiping?o>=35&&o<=135?"down":"up":"vertical"},e.prototype.swipeEnd=function(i){var e,t,o=this;if(o.dragging=!1,o.swiping=!1,o.scrolling)return o.scrolling=!1,!1;if(o.interrupted=!1,o.shouldClick=!(o.touchObject.swipeLength>10),void 0===o.touchObject.curX)return!1;if(!0===o.touchObject.edgeHit&&o.$slider.trigger("edge",[o,o.swipeDirection()]),o.touchObject.swipeLength>=o.touchObject.minSwipe){switch(t=o.swipeDirection()){case"left":case"down":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide+o.getSlideCount()):o.currentSlide+o.getSlideCount(),o.currentDirection=0;break;case"right":case"up":e=o.options.swipeToSlide?o.checkNavigable(o.currentSlide-o.getSlideCount()):o.currentSlide-o.getSlideCount(),o.currentDirection=1}"vertical"!=t&&(o.slideHandler(e),o.touchObject={},o.$slider.trigger("swipe",[o,t]))}else o.touchObject.startX!==o.touchObject.curX&&(o.slideHandler(o.currentSlide),o.touchObject={})},e.prototype.swipeHandler=function(i){var e=this;if(!(!1===e.options.swipe||"ontouchend"in document&&!1===e.options.swipe||!1===e.options.draggable&&-1!==i.type.indexOf("mouse")))switch(e.touchObject.fingerCount=i.originalEvent&&void 0!==i.originalEvent.touches?i.originalEvent.touches.length:1,e.touchObject.minSwipe=e.listWidth/e.options.touchThreshold,!0===e.options.verticalSwiping&&(e.touchObject.minSwipe=e.listHeight/e.options.touchThreshold),i.data.action){case"start":e.swipeStart(i);break;case"move":e.swipeMove(i);break;case"end":e.swipeEnd(i)}},e.prototype.swipeMove=function(i){var e,t,o,s,n,r,l=this;return n=void 0!==i.originalEvent?i.originalEvent.touches:null,!(!l.dragging||l.scrolling||n&&1!==n.length)&&(e=l.getLeft(l.currentSlide),l.touchObject.curX=void 0!==n?n[0].pageX:i.clientX,l.touchObject.curY=void 0!==n?n[0].pageY:i.clientY,l.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(l.touchObject.curX-l.touchObject.startX,2))),r=Math.round(Math.sqrt(Math.pow(l.touchObject.curY-l.touchObject.startY,2))),!l.options.verticalSwiping&&!l.swiping&&r>4?(l.scrolling=!0,!1):(!0===l.options.verticalSwiping&&(l.touchObject.swipeLength=r),t=l.swipeDirection(),void 0!==i.originalEvent&&l.touchObject.swipeLength>4&&(l.swiping=!0,i.preventDefault()),s=(!1===l.options.rtl?1:-1)*(l.touchObject.curX>l.touchObject.startX?1:-1),!0===l.options.verticalSwiping&&(s=l.touchObject.curY>l.touchObject.startY?1:-1),o=l.touchObject.swipeLength,l.touchObject.edgeHit=!1,!1===l.options.infinite&&(0===l.currentSlide&&"right"===t||l.currentSlide>=l.getDotCount()&&"left"===t)&&(o=l.touchObject.swipeLength*l.options.edgeFriction,l.touchObject.edgeHit=!0),!1===l.options.vertical?l.swipeLeft=e+o*s:l.swipeLeft=e+o*(l.$list.height()/l.listWidth)*s,!0===l.options.verticalSwiping&&(l.swipeLeft=e+o*s),!0!==l.options.fade&&!1!==l.options.touchMove&&(!0===l.animating?(l.swipeLeft=null,!1):void l.setCSS(l.swipeLeft))))},e.prototype.swipeStart=function(i){var e,t=this;if(t.interrupted=!0,1!==t.touchObject.fingerCount||t.slideCount<=t.options.slidesToShow)return t.touchObject={},!1;void 0!==i.originalEvent&&void 0!==i.originalEvent.touches&&(e=i.originalEvent.touches[0]),t.touchObject.startX=t.touchObject.curX=void 0!==e?e.pageX:i.clientX,t.touchObject.startY=t.touchObject.curY=void 0!==e?e.pageY:i.clientY,t.dragging=!0},e.prototype.unfilterSlides=e.prototype.slickUnfilter=function(){var i=this;null!==i.$slidesCache&&(i.unload(),i.$slideTrack.children(this.options.slide).detach(),i.$slidesCache.appendTo(i.$slideTrack),i.reinit())},e.prototype.unload=function(){var e=this;i(".slick-cloned",e.$slider).remove(),e.$dots&&e.$dots.remove(),e.$prevArrow&&e.htmlExpr.test(e.options.prevArrow)&&e.$prevArrow.remove(),e.$nextArrow&&e.htmlExpr.test(e.options.nextArrow)&&e.$nextArrow.remove(),e.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")},e.prototype.unslick=function(i){var e=this;e.$slider.trigger("unslick",[e,i]),e.destroy()},e.prototype.updateArrows=function(){var i=this;Math.floor(i.options.slidesToShow/2),!0===i.options.arrows&&i.slideCount>i.options.slidesToShow&&!i.options.infinite&&(i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false"),0===i.currentSlide?(i.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-i.options.slidesToShow&&!1===i.options.centerMode?(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")):i.currentSlide>=i.slideCount-1&&!0===i.options.centerMode&&(i.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true"),i.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")))},e.prototype.updateDots=function(){var i=this;null!==i.$dots&&(i.$dots.find("li").removeClass("slick-active").end(),i.$dots.find("li").eq(Math.floor(i.currentSlide/i.options.slidesToScroll)).addClass("slick-active"))},e.prototype.visibility=function(){var i=this;i.options.autoplay&&(document[i.hidden]?i.interrupted=!0:i.interrupted=!1)},i.fn.slick=function(){var i,t,o=this,s=arguments[0],n=Array.prototype.slice.call(arguments,1),r=o.length;for(i=0;i<r;i++)if("object"==typeof s||void 0===s?o[i].slick=new e(o[i],s):t=o[i].slick[s].apply(o[i].slick,n),void 0!==t)return t;return o}});

/********************************
** Requires slick.js
** https://www.npmjs.com/package/slick-carousel
*********************************/
$(function(){
    var slick = $('.carousel.hero .slick');

    if( slick.length > 0 )
    {
        slick.each(function(index)
        {
            var elem  = $(this),
                wrap  = elem.parents('.carousel'),
                count = elem.children().length;

            if( count < 2 )
            {
                elem.removeClass('slick').addClass('slick-solo');
                return;
            }

            var resizeTimer,

                mhClasses = [],

                toolHtml = ['<div class="slick-tools-wrap"><div class="slick-tools">'],

                check = function( a ){ return typeof a !== 'undefined' && a !== ''; },

                fade  = wrap.data('fade'),
                dots  = wrap.data('dots'),
                timer = wrap.data('timer'),
                chkAr = wrap.data('arrow'),

                arrow = check( chkAr ) ? chkAr : 'chevron',

                optn = {
                    fade           : check( fade ) ? fade : false,
                    dots           : check( dots ) ? dots : true,
                    arrows         : false,
                    infinite       : true,
                    draggable      : false,
                    slidesToShow   : 1,
                    slidesToScroll : 1,
                    adaptiveHeight : true,

                    autoplay       : true,
                    autoplaySpeed  : check( timer ) ? timer : 4000
                };


            // Create array of MatchHeight Elements
            $('[data-mh]', elem).each(function()
            {
                var cls = $(this).attr('class');

                if( mhClasses.indexOf(cls) == -1 ) mhClasses.push(cls);
            });


            // Wrap elements in container
            elem.wrap('<div class="slick-container" />');


            // Finish building slider tools
            if( arrow || optn.dots )
            {
                if( arrow ) toolHtml.push('<div class="slick-arrow prev"><div class="icon-wrap '+arrow+'"><i class="movicon-'+arrow+'-left"></i></div></div><div class="slick-arrow next"><div class="icon-wrap '+arrow+'"><i class="movicon-'+arrow+'-right"></i></div></div>');

                toolHtml.push('</div></div>');

                elem.after( toolHtml.join('') );

                if( optn.dots ) optn.appendDots = $((optn.customPaging ? '.customPaging' : '.slick-tools'), wrap);
            }


            // Initialize Plugin
            elem.slick(optn);

            slickInit();


            // Add "disable" options for arrows if not infinite
            if( !optn.infinite )
            {
                elem.on('afterChange', function(event, slick, currentSlide)
                {
                    $('.slick-arrow', wrap).removeClass('disable');

                    if( currentSlide == slick.$slides.length-1 )
                    {
                        $('.next', wrap).addClass('disable');
                    }
                    else if( currentSlide == 0 )
                    {
                        $('.prev', wrap).addClass('disable');
                    }
                });
            }


            // Add custom events to arrows
            $('.prev', wrap).on('click', function(){ if( !$(this).hasClass('disable') ) elem.slick('slickPrev'); });
            $('.next', wrap).on('click', function(){ if( !$(this).hasClass('disable') ) elem.slick('slickNext'); });


            // Update slider size when page is resized
            $(window).on('resize', function(){ clearTimeout(resizeTimer); resizeTimer = setTimeout(resetMatchHeight, 250); });


            // Run function once slider is ready
            function slickInit()
            {
                if( !optn.infinite ){ $('.prev', wrap).addClass('disable'); }

                resetMatchHeight();
            }

            // Reset any matchHeight elements
            function resetMatchHeight()
            {
                for(var i=0; i < mhClasses.length; i++)
                {
                    var items = elem.find('.'+mhClasses[i]+'[data-mh]');

                    items.matchHeight({ remove: true });

                    $.fn.matchHeight._apply( items );
                }

                if( (fade && count == 1) || (!fade && optn.infinite && !$('.slick-cloned', wrap).length) )
                     wrap.addClass('hideNav');
                else wrap.removeClass('hideNav');

                elem.slick('setPosition');
            }
        });
    }
});
/**
 * @desc Check to see if element is inside the viewport
 */
$.fn.isInViewport = function( offset )
{
    var element     = $(this),
        elementHt   = element.outerHeight(),
        elementTop  = element.offset().top,
        elementBot  = elementTop + elementHt,

        viewportTop = $(window).scrollTop(),
        viewportBot = viewportTop + $(window).outerHeight(),

        viewportOff = (typeof offset !== 'undefined' ? offset : 0.35) * elementHt; // pecentage of top and bottom

    return (elementBot - viewportOff) > viewportTop && (elementTop + viewportOff) < viewportBot;
};


/**
 * @desc Start dial animation only when the user can see it
 */
function checkOffset( element )
{
    var animateClass = 'circle-chart__animated';

    if( element.isInViewport( 0.75 ) && !element.hasClass(animateClass) )
    {
        element.addClass(animateClass);
    }
}


/**
 * @desc Look for dial components and run function if elements exist
 */
$(document).ready(function() { /* code here */ 

    var dial = $('[data-getdial]');

    if( dial.length )
    {
        dial.each(function(){
            var elem = $(this),
                perc = elem.data('getdial'),
                text = elem.data('dialtext'),

            /********************************
        	** Static Sizing
        	*********************************/
        	// Stroke Width
        	strokeW = 4,

        	// Circle Circumference
        	$cir = 100,


        	/********************************
        	** Equations
        	*********************************/
        	// Circle Radius
        	$rad = $cir / (2 * Math.PI),

        	// SVG canvas size
        	$box = ($rad*2) + strokeW,

        	// Cirlce X/Y coordinates
        	$cXY = $rad + (strokeW/2),


        	/********************************
        	** Build HTML
        	*********************************/
        	$html = '<div class="dial-wrap">'+
        				'<svg class="circle-chart" viewbox="0 0 '+$box+' '+$box+'" xmlns="http://www.w3.org/2000/svg">'+
        					'<circle cx="'+$cXY+'" cy="'+$cXY+'" r="'+$rad+'" stroke-width="'+strokeW+'" fill="none" class="circle-chart__background"/>'+
        					'<circle cx="'+$cXY+'" cy="'+$cXY+'" r="'+$rad+'" stroke-width="'+strokeW+'" fill="none" class="circle-chart__circle" stroke-dasharray="'+($cir * (perc/100))+', '+$cir+'" />'+
        				'</svg>'+
        				'<div class="circle-chart__info">'+
        					'<div>'+
        						'<div class="percent">'+perc+'<sup>%</sup></div>'+
        						(text ? '<div class="bottom">'+text+'</div>' : '')+
        					'</div>'+
        				'</div>'+
        			'</div>';

            elem.after($html);

            var newElem = elem.parent().find('.dial-wrap');

            checkOffset( newElem );

            $(window)
            .resize(function(){ checkOffset( newElem ); })
            .scroll(function(){ checkOffset( newElem ); });

            elem.remove();
        });
    }


    $(".animateddial").each(function() {

        var rows = $(this).find('.post-preview.dial');

        var total = rows.length,temp = 0;
    
        if (total%2 == 0 ) {
            temp = total - 2;
        } else {
            temp = total - 1;
        }
    
        if( rows.length )
        {
            var i = 1;
            rows.each(function() {

                if(i > temp) {
                    $(this).attr('class', 'post-preview dial lastrow');
                }
                i++;
            });
        }
    });
});

$(function()
{
    var checkNotifyBarTimer;

    var notifyBars = $('.notification-bar'),

        $head = isDDI ? $('#ddi-main-header') : ($('.movHeader').length > 0 ? $('.movHeader').first() : $('.header').first()),

        isDDI = $('#ddi-main-header').length > 0,

        headIsFixed = $head.css('position') == 'fixed',

        spacing = headIsFixed ? 'top' : 'margin-top',

        speed = 250;

    if( notifyBars.length > 0 )
    {
        notifyBars.each(function()
        {
            var notifyBar = $(this),
                nBarIsFixed = notifyBar.css('position') == 'fixed',

                $promo_data = notifyBar.attr('data-md5'),
                $promo_getId = notifyBar.attr('data-cookieid'),
                $promo_opts = {
                    name : 'promo_closed' + ($promo_getId ? '_'+$promo_getId : '') + ($promo_data ? '_'+$promo_data : ''),
                    expires : $promo_data ? 365 : false
                };

            if( !Cookies.get($promo_opts.name) )
            {
                if( isDDI ) notifyBar.addClass('full');

                $('.notification-close', notifyBar).on('click', function()
                {
                    var elem = $(this);

                    // elem.attr('aria-expanded', 'false');

                    if( nBarIsFixed ) adjustSpacing( 0, true );

                    notifyBar.slideUp(speed, function(){ $(this).parent().remove(); });

                    Cookies.set($promo_opts.name, 1, { expires:$promo_opts.expires });
                });
            }
            else
            {
                notifyBar.parent().remove();
            }
        });

        var runFunc = function( onloadonly )
        {
            onloadonly = typeof onloadonly == 'boolean' ? onloadonly : false;

            clearTimeout(checkNotifyBarTimer);
            checkNotifyBarTimer = setTimeout(function()
            {
                $('.notification-bar').each(function(index)
                {
                    var notifyBar = $(this),
                        nBarIsFixed = notifyBar.css('position') == 'fixed';

                    // if( !nBarIsFixed && onloadonly ) return;

                    if( (notifyBar.parent().isInViewport() || nBarIsFixed) && !notifyBar.hasClass('inView') )
                    {
                        var navH = notifyBar.outerHeight(),
                            dlay = onloadonly ? (index * speed) : 0;

                        notifyBar.delay(dlay).slideDown(speed, function()
                        {
                            $('#content-component-wrapper.no-ani').removeClass('no-ani');

                            notifyBar.addClass('inView');
                        });

                        if( nBarIsFixed )
                        {
                            setTimeout(function(){ adjustSpacing( navH, true ); }, dlay);

                            $(window).on('resize', function(){ adjustSpacing( notifyBar.outerHeight() ); });
                        }
                    }
                });
            }, 300);
        };

        runFunc(true);

        $(window).on({
            'resize' : runFunc,
            'scroll' : runFunc
        });
    }


    /**
    * @desc Adjust spacing to accomodate for a fixed notification bar
    */
    function adjustSpacing( value, animate )
    {
        if( !$('.notification-bar').length ) return false;

        $.fn.adjust = function( val ) { if( animate ) this.animate(val, speed); else this.css(val); };

        var obj = { };

        obj[spacing] = value;

        $head.adjust( obj );

        if( headIsFixed ) $('html').adjust( {'margin-top':value} );

        if( isDDI )
        {
            $('.nav-wrap', $head).adjust( {'top':(value + $head.outerHeight())} );
        }
        else
        {
            $('.mobile-wrapper').adjust( {'top':value} );
            $('.secondary-navbar.sticky-navbar', $head).adjust( {'margin-top':value} );
            $('.feedback.center').adjust( {'margin-top':value} );
        }
    }
});

/*-------------------------------------------------------------------------------------------------
////////////////////////////////////////////////////////////////////////////////////////////////////
// DELTA DENTAL INSTITUE
////////////////////////////////////////////////////////////////////////////////////////////////////
------------------------------------------------------------------------------------------------- */

$(function(){
    
    var resizeTimer,                   // Add resize class to body when browsexr is resizing

        $docu = $(document),
        $wind = $(window),
        $body = $('body'),             // <body>
        $head = $('#ddi-main-header'); // DDI header


    /*-------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // DOCUMENT.READY - Fires as soon as DOM is ready
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    ------------------------------------------------------------------------------------------------- */
    $docu.ready(function()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Run the double event functions first
        ////////////////////////////////////////////////////////////////////////////////////////////////
        scrollD(); responsiveD();
        ////////////////////////////////////////////////////////////////////////////////////////////////

        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Add stickyAdjust class if the header is fixed
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if( $head.css('position') == 'fixed' ) $body.addClass('stickyAdjust');
        ////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Toggle search form on all search icons
        ////////////////////////////////////////////////////////////////////////////////////////////////
        var searchIcon = $('label[for="show_ddi_search"]');
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if( searchIcon.length )
        {
            searchIcon.on('click', function(){
                $head.toggleClass('search-only');
            });
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////

        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Add a dynamic class that
        ////////////////////////////////////////////////////////////////////////////////////////////////
        var navMenu = $('#ddi-main-header .main'),
            navItems = $('a', navMenu);
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if( navItems.length  )
        {
            if( navItems.length > 5 ) navMenu.addClass('long');
            if( navItems.length < 5 ) navMenu.addClass('short');

            navItems
            .each(function(){
                var elem = $(this),
                    text = elem.text();

                if( text.length > 13 ) { elem.addClass('extend'); }
            })
            .on('click', function(){
                var href = $(this).attr('href'),
                    page = window.location.origin + window.location.pathname;

                if( href.indexOf('#') > -1 ) $('#show_ddi_mobile_menu').prop( "checked", false );
            });
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
    });




    /*--------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // WINDOW.LOAD - Fires only when all content for the page has been downloaded and rendered
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    --------------------------------------------------------------------------------------------------*/
    $wind.on({
        load: function()
        {
            ////////////////////////////////////////////////////////////////////////////////////////////
            // CODE STARTS HERE
            ////////////////////////////////////////////////////////////////////////////////////////////


            // ...


            ////////////////////////////////////////////////////////////////////////////////////////////
            // THIS MUST BE LAST
            ////////////////////////////////////////////////////////////////////////////////////////////
            // Run all functions initially as well as when the browser is resized
            ////////////////////////////////////////////////////////////////////////////////////////////
            responsiveW();
            ////////////////////////////////////////////////////////////////////////////////////////////
        },
        resize: function()
        {
            $docu.addClass('resized');

            clearTimeout(resizeTimer);

            resizeTimer = setTimeout(function(){ $docu.removeClass('resized'); }, 250);


            ////////////////////////////////////////////////////////////////////////////////////////////
            // THIS MUST BE LAST
            ////////////////////////////////////////////////////////////////////////////////////////////
            // Functions also run in Document.ready
            ////////////////////////////////////////////////////////////////////////////////////////////
            responsiveD();
            ////////////////////////////////////////////////////////////////////////////////////////////
            // Functions also run in Window.load
            ////////////////////////////////////////////////////////////////////////////////////////////
            responsiveW();
            ////////////////////////////////////////////////////////////////////////////////////////////
        },
        scroll: function()
        {
            ////////////////////////////////////////////////////////////////////////////////////////////
            // CODE GOES HERE
            ////////////////////////////////////////////////////////////////////////////////////////////


            //...


            ////////////////////////////////////////////////////////////////////////////////////////////
            // THIS MUST BE LAST
            ////////////////////////////////////////////////////////////////////////////////////////////
            scrollD();
            ////////////////////////////////////////////////////////////////////////////////////////////
        }
    });




    /*--------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Functions
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    --------------------------------------------------------------------------------------------------*/
    /**
     * @desc Insert functions here that get called
     *       once onload and also on a page reszie
     */
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / On Page Scroll
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function scrollD()
    {
        // If header is sticky, check scroll position
        if( $head.hasClass('sticky') ) checkScroll();
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / Window Resize
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveD()
    {

    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Window Load / Window Resize
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveW()
    {

    }




    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Custom Functions
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    /**
    * @desc Shrink the header once you begin to scroll the page
    */
    function checkScroll()
    {
        // var runFunctions = false;

        var scrollClass = 'isScrolling';

        if( $docu.scrollTop() < 1 )
        {
            $body.removeClass(scrollClass);

            // runFunctions = true;
        }
        else if( !$body.hasClass(scrollClass) )
        {
            if( $head.hasClass('sticky') ) $body.addClass(scrollClass);

            // runFunctions = true;
        }

    /*
        // Run commands when toggling header size

        if( runFunctions )
        {
            // CODE GOES HERE

            // KEEP LAST
            runFunctions = false;
        }
    */
    }
});

$(function(){

        var $docu = $(document),
		$wind = $(window);

/*-------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // DOCUMENT.READY - Fires as soon as DOM is ready
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    ------------------------------------------------------------------------------------------------- */
    $docu.ready(function()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Run the double event functions first
        ////////////////////////////////////////////////////////////////////////////////////////////////
        scrollD(); responsiveD();
        ////////////////////////////////////////////////////////////////////////////////////////////////

    });



    /*--------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // WINDOW.LOAD - Fires only when all content for the page has been downloaded and rendered
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    --------------------------------------------------------------------------------------------------*/
    $wind.on({
        load: function()
        {
            ////////////////////////////////////////////////////////////////////////////////////////////
            // CODE STARTS HERE
            ////////////////////////////////////////////////////////////////////////////////////////////


            // ...


            ////////////////////////////////////////////////////////////////////////////////////////////
            // THIS MUST BE LAST
            ////////////////////////////////////////////////////////////////////////////////////////////
            // Run all functions initially as well as when the browser is resized
            ////////////////////////////////////////////////////////////////////////////////////////////
            responsiveW();
            ////////////////////////////////////////////////////////////////////////////////////////////
        },
        resize: function()
        {

            waitForFinalEvent(function(){

                ////////////////////////////////////////////////////////////////////////////////////////////
                // THIS MUST BE LAST
                ////////////////////////////////////////////////////////////////////////////////////////////
                // Functions also run in Document.ready
                ////////////////////////////////////////////////////////////////////////////////////////////
                responsiveD();
                ////////////////////////////////////////////////////////////////////////////////////////////
                // Functions also run in Window.load
                ////////////////////////////////////////////////////////////////////////////////////////////
                responsiveW();
                ////////////////////////////////////////////////////////////////////////////////////////////
             }, 500, "tile-hero-collection window resize");
        },
        scroll: function()
        {
            waitForFinalEvent(function(){

                ////////////////////////////  ////////////////////////////////////////////////////////////////
                // CODE GOES HERE
                ////////////////////////////////////////////////////////////////////////////////////////////


                //...


                ////////////////////////////////////////////////////////////////////////////////////////////
                // THIS MUST BE LAST
                ////////////////////////////////////////////////////////////////////////////////////////////
                scrollD();
                ////////////////////////////////////////////////////////////////////////////////////////////
            }, 500, "tile-hero-collection window scroll");
        }
    });




    /*--------------------------------------------------------------------------------------------------
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Functions
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    --------------------------------------------------------------------------------------------------*/
    /**
     * @desc Insert functions here that get called
     *       once onload and also on a page reszie
     */
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / On Page Scroll
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function scrollD()
    {

      var buttons = $('.tile_hero_collection_container_cards_card_wrapper_url_addr .banner-btn');
      $(buttons).removeAttr('style');
      const mqBp1 = window.matchMedia("(min-width: 767px)")
      if (mqBp1.matches ) {
         // window width is at least 767px
         equalizeButtonWidth();
      }

       equalizeTitleHeight();

    }


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / Window Resize
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveD()
    {

    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Window Load / Window Resize
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveW()
    {

      var buttons = $('.tile_hero_collection_container_cards_card_wrapper_url_addr .banner-btn');
      $(buttons).removeAttr('style');
      const mqBp1 = window.matchMedia("(min-width: 767px)")
      if (mqBp1.matches ) {
         // window width is at least 767px
         equalizeButtonWidth();
      }

       equalizeTitleHeight();

    }

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Functions
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    var waitForFinalEvent = (function () {
      var timers = {};
      return function (callback, ms, uniqueId) {
        if (!uniqueId) {
          uniqueId = "Don't call this twice without a uniqueId";
        }
        if (timers[uniqueId]) {
          clearTimeout (timers[uniqueId]);
        }
        timers[uniqueId] = setTimeout(callback, ms);
      };
    }) ();

   function equalizeButtonWidth()
   {
        // Get the largest button size
        var buttons = $('.tile_hero_collection_container_cards_card_wrapper_url_addr .banner-btn');
        var maxOuterWidth = 0;
        for ( var i=0; i < $(buttons).length; i++){
            if ( $(buttons[i]).outerWidth() >  maxOuterWidth ) {
                maxOuterWidth = $(buttons[i]).outerWidth();
            }
        }

        // don't make the buttons larger than the smallest width of card descr
        var addrUrls = $('.tile_hero_collection_container_cards_card_wrapper_content_desc');
        var minAddrUrl = Infinity;
        for ( var i=0; i < $(addrUrls).length; i++){
            if ( $(addrUrls[i]).outerWidth() <  minAddrUrl ) {
                minAddrUrl = $(addrUrls[i]).outerWidth();
            }
        }

        if ( maxOuterWidth < minAddrUrl ) {
            $(buttons).outerWidth(maxOuterWidth);
        }
        else {
            $(buttons).outerWidth(minAddrUrl);
        }

   }

     function equalizeTitleHeight()
     {
          var titles = $('.tile_hero_collection_container_cards_card_wrapper_content_title .rte-list p');
          $(titles).removeAttr('style');
          var maxOuterHeight = 0;

          for ( var i=0; i < $(titles).length; i++){

             var rect =  titles[i].getBoundingClientRect();
              if ( rect.height >  maxOuterHeight ) {
                maxOuterHeight =  rect.height ;
              }
          }
          $(titles).outerHeight(maxOuterHeight);
     }


});



$(function(){
    // updating the titles  and prices for mobile view

    $(".plans_summary_wrapper_plan").each(function(){
        let thisIndex = $(this).parent().index();        
        let title = $(this).find(".plans_summary_wrapper_plan_info_title").text();
        let dollar = $(this).find(".plans_summary_wrapper_plan_info_price_dollar").text();
        let delta = $(this).find(".plans_summary_wrapper_plan_info_price_details_delta").text();
        let freq = $(this).find(".plans_summary_wrapper_plan_info_price_details_freq").text();
        let respectivePlanSummary = $(this).closest(".plans").find(".plans_summary_detail .plans_summary_detail_content").eq(thisIndex);
        respectivePlanSummary.find('.plan_summary_detail_mobile_price_dollar').text(dollar);
        respectivePlanSummary.find('.plan_summary_detail_mobile_price_details_delta').text(delta);
        respectivePlanSummary.find('.plan_summary_detail_mobile_price_details_freq').text(freq);
        respectivePlanSummary.find('.plan_summary_detail_mobile_title').text(title);
    });


          $(".plans #first").each(function(){
    let firstPlanContent = $(this);

    if(!firstPlanContent.hasClass('author')){
        firstPlanContent.show().addClass('active_summary');
    }
   });

    $(".plans_summary_wrapper_plan").on('click',function(){
	    var elem = $(this),
	        prnt = elem.parents('.plans'),
	        index = elem.parent().index();
	    $('.plan_active', prnt).removeClass('plan_active');
	    elem.addClass('plan_active');
	    $(".plans_summary_detail_content", prnt).hide().removeClass('active_summary').eq(index).addClass('active_summary').show();
	});

    
    $(".plans_summary_wrapper_plan_details_readmore_btn").on('click',function(){
	    var elem = $(this),
	        prnt = elem.parents('.plans'),
	        index = elem.parents('.plans_summary_wrapper_plan').parent().index();
	
	    $(".plans_summary_detail .plans_summary_detail_content", prnt).removeClass('show_mobile').eq(index).addClass('show_mobile');
	    $(".plans_summary", prnt).addClass('hide_mobile');
	});

    $(".plan_summary_detail_mobile_previous").on('click',function(){
        $(this).closest(".plans").find(".plans_summary_detail .plans_summary_detail_content").removeClass('show_mobile');
        $(this).closest(".plans").find(".plans_summary").removeClass('hide_mobile');

    });   

  
});
////////////////////////////////////////////////////////////////////////////////////////////////////////
// Enable all events for the navigation menus
//
// As regards highlighting menu items and showing the static horizontal subnav, the rules are
//
// you are on the 1st level menu
//
// horizontal secondary menu will expand
//
// first level menu underline when scrolling down (same rule for mobile and scroll down is irrelevant)
//
// you are on the 2nd level menu (1st and 2nd level menu match)
//
// horizontal secondary menu will expand and underline 2nd level menu
//
// 1st and 2nd level menu will underline when scrolling down  (same rule for mobile and scroll down is irrelevant)
//
// you are on the 2nd level menu (only 2nd level menu match)
//
// no need to highlight anything
//
// no need to expand horizontal menu
//
// if you are on the 3rd level menu (1st level, 2nd, level, and 3rd level menu match)
//
// horizontal secondary menu will expand and underline 2nd level menu and 3 level menu
//
// 1st, 2nd, 3rd level menu will underline when scrolling down  (same rule for mobile and scroll down is irrelevant)
//
// if you are on the 3rd level menu (1st level not match, 1st and 2nd level not match, 2nd level not match)
//
// no need to highlight anything
//
// no need to expand horizontal menu
////////////////////////////////////////////////////////////////////////////////////////////////////////
$(function()
{
    localStorage.screenSize = '';

    var resizeTimer = null;

    var scrollClass = 'isScrolling';

    var $head = $('.header-ddp');

    if( !$head.length ) return;

    var $docu = $(document),
        $wind = $(window),
        $html = $('html'),
        $body = $('body'),

        isDesktop = function(){ return $wind.outerWidth() > 992 },

        headerWrapper = $('.movHeader'),
        mobileButton = $('.mobile-button', headerWrapper),
        mobileWrapper = $('.mobile-wrapper'),
        panelWrappers = $('.panel-wrapper', headerWrapper),
        headerSubMenu = $('.movHeader-sub'),

        $menu = $('nav.primary', $head),
        $mNav = $('> ul > li', $menu),

        openM = 'open-menu',
        pageUrl =  new URL(window.location.href),
        hostname = pageUrl.hostname,
        protocol = pageUrl.protocol,
        pageLinkHref = pageUrl.pathname;

    /////////////////////////////////////////////////////////////////////////////////////////////////
    // Add classes to <body>
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $body.addClass('no-ani ddpa');
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Check if header element is fixed
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    if( $head.css('position') == 'fixed' ) $body.addClass('stickyAdjust');
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Check if the header is using "minimal"
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    if( $head.hasClass('minimal') ) $body.addClass('minimal');
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Remove "no animation" class after page load
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    setTimeout(function(){ $body.removeClass('no-ani'); }, 1000);
    ////////////////////////////////////////////////////////////////////////////////////////////////////

    
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Navigation logic
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // is this page url a link on the top nav i.e. one of the main menu items or one of the dropdown menus ?
    var pageLinkPath = $('nav.primary a[href="'+pageLinkHref+'"]');
    if ( pageLinkPath.length == 0)
    {
       // for some sites, the links have the hostname in front of them i.e. the MCs, however some have only relative urls like /broker/. Add protocol and hostname to these.
       pageLinkHref = protocol + "//" + hostname + pageUrl.pathname;
       pageLinkPath = $('nav.primary a[href="' + pageLinkHref + '"]');
    }

    if  ( pageLinkPath.length > 0 )
    {
        var upOneLevel = pageLinkPath.closest("ul").parent()[0],
            upOneLevelNodeType = upOneLevel.nodeName.toLowerCase();

        if ( upOneLevelNodeType == "nav")
        {
            $('nav.primary a[href="'+pageLinkHref+'"]').parent().addClass('active');
        }
        else if ( upOneLevelNodeType== "li")
        {
            var hrefIncludesFirstLevel = false,
                hrefIncludesSecondLevel = false,
                hrefIncludesThirdLevel = false,
                firstLevel,
                secondLevel,
                thirdLevel;

            // is this secondary or tertiary menu item?

            var upTwoLevels = $(upOneLevel).closest("ul").parent()[0],
                upTwoLevelsNodeType = upTwoLevels.nodeName.toLowerCase();

            var thirdLevelUrl = "", thirdLevelUrlTrunc = "";

            if ( upTwoLevelsNodeType == "li" )
            {
               // 3rd level
               thirdLevel = $('nav.primary a[href="'+pageLinkHref+'"]').parent();
               secondLevel = upOneLevel;
               firstLevel =  upTwoLevels;
               thirdLevelUrl = $('> a', $(thirdLevel)).attr('href');

               // if the URL ends in .html, truncate it
               if ( thirdLevelUrl.length > 5 &&  thirdLevelUrl.substring(thirdLevelUrl.length - 5, thirdLevelUrl.length) == '.html' )
               {
                   thirdLevelUrlTrunc = thirdLevelUrl.substring(0, thirdLevelUrl.length - 5);
               }
            }
            else
            {
                // 2nd level
                secondLevel = $('nav.primary a[href="'+pageLinkHref+'"]').parent();
                firstLevel = upOneLevel;
            }

            var firstLevelUrl = $('> a', $(firstLevel)).attr('href'),
                 firstLevelUrlTrunc = firstLevelUrl;

            var secondLevelUrl = $('> a', $(secondLevel)).attr('href'),
                secondLevelUrlTrunc = secondLevelUrl;

            // if the URL ends in .html, truncate it
            if ( firstLevelUrl.length > 5 && firstLevelUrl.substring(firstLevelUrl.length - 5, firstLevelUrl.length) == '.html' )
            {
                firstLevelUrlTrunc = firstLevelUrl.substring(0, firstLevelUrl.length - 5);
            }

            if ( secondLevelUrl.length > 5 && secondLevelUrl.substring(secondLevelUrl.length - 5, secondLevelUrl.length) == '.html' )
            {
                secondLevelUrlTrunc = secondLevelUrl.substring(0, secondLevelUrl.length - 5);
            }

            var hrefIncludesFirstLevel = false;
            if ( pageLinkHref.includes(firstLevelUrlTrunc)) hrefIncludesFirstLevel = true;
            var hrefIncludesSecondLevel = false;
            if ( pageLinkHref.includes(secondLevelUrlTrunc)) hrefIncludesSecondLevel = true;
            var hrefIncludesThirdLevel = false
            if ( pageLinkHref.includes(thirdLevelUrlTrunc)) hrefIncludesThirdLevel = true;

            if ( hrefIncludesFirstLevel && hrefIncludesSecondLevel && hrefIncludesThirdLevel )
            {
                if ( thirdLevelUrl != "") $('nav.primary a[href="'+thirdLevelUrl+'"]').parent().addClass('active');
                $('nav.primary a[href="'+secondLevelUrl+'"]').parent().addClass('active');
                $('nav.primary a[href="'+firstLevelUrl+'"]').parent().addClass('active');
            }
        }
    }


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Check to see if primary navigation has sub menus
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('nav.primary li').each(function()
    {
        var elem = $(this),
            subM = $('> ul', elem);

        if( elem.hasClass('active') || elem.hasClass('focus') )
        {
            $('> a', elem).wrapInner('<span />');
        }

        if( subM.length > 0 )
        {
            elem.addClass('has-children');
            subM.addClass('sub-menu');

            var item = _a(elem);

            if( elem.parents('.mobile-wrapper').length > 0 )
            {
                item.after('<button type="button" class="drop" aria-expanded="false"></button>');
            }
            else
            {
                item.attr({
                    'aria-expanded' : 'false'
                });
            }
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Toggle sub menu in mobile menu
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.drop', mobileWrapper)
    .each(function(i)
    {
        var dropID = 'mobileMenuItem-'+i;

        $(this).attr('aria-labelledby', dropID)
        .siblings('a').attr('id', dropID);
    })
    .on('click', function()
    {
        var elem = $(this),
            item = elem.parent(),
            show = 'show-submenu';

        if( elem.parents('.sub-menu').length > 0 )
        {
            elem.addClass('viewing');

            mobileWrapper.last().after('<div class="mobile-wrapper visible clone" data-clone><div class="mobile-inner"><div class="text-right"><button type="button" class="mobile-button js_back_mobile_menu"><span class="arrow"></span><span>'+elem.siblings('a').text()+'</span></button></div><nav class="primary"><ul>'+elem.siblings('.sub-menu').html()+'</ul></nav></div></div>');

            var clone = $('.mobile-wrapper[data-clone]');
            
            initTooltip(clone);

            $('.js_back_mobile_menu', clone).on('click', function()
            {
                elem.attr('aria-expanded', false);
    
                clone.removeClass('slideIn');

                var goBack = $('.viewing', mobileWrapper);

                trapFocus(mobileWrapper, goBack);

                goBack.removeClass('viewing');

                setTimeout(function()
                {
                    clone.remove();
                }, 500);

                triggerResize();
            });

            setTimeout(function()
            {
                clone.addClass('slideIn');

                elem.attr('aria-expanded', true);

                triggerResize();
            }, 100);

            trapFocus(clone);
        }
        else
        {
            item.toggleClass(show)
            .children('.sub-menu').stop(0).slideToggle(250, function()
            {
                if( !item.hasClass(show) ){ elem.removeAttr('style'); }

                triggerResize();
            });

            elem.attr('aria-expanded', item.hasClass(show));
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Populate sub menu
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    var activeNavItem = $mNav.filter('.active');
    var activeSubNav = $('> ul', activeNavItem);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    if( activeNavItem.length > 0 && activeSubNav.length > 0 )
    {
        headerWrapper.addClass('showSub');

        $('.inner', headerSubMenu)
        .attr({
            'role' : 'navigation' ,
            'aria-label' : _a(activeNavItem).text().trim() + ' sub navigation'
        })
        .prepend( activeSubNav.clone() );

        $(focusElements, headerSubMenu).attr('tabindex', -1);
    }
    else
    {
        headerSubMenu.remove();
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $menu.addClass('loaded');
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Toggle "menu open" class
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $(document.body)
    .on('click', '.js_toggle_mobile_menu', function()
    {
        $html.toggleClass(openM);

        var menuIsOpen = $html.hasClass(openM);

        mobileButton.attr('aria-expanded', menuIsOpen);

        mobileWrapper.attr('aria-hidden', !menuIsOpen);

        if( menuIsOpen )
        {
            mobileWrapper.addClass('visible');

            trapFocus(mobileWrapper);
        }
        else 
        {
            mobileMenuTimer = setTimeout(function()
            {
                mobileWrapper.removeClass('visible');
            }, 500);

            mobileButton.focus();
        }

        mobileWrapper.toggleClass('slideIn');

        triggerResize();
    })
    .on('click', '.quick-nav [data-openpanel]', function(e)
    {
        var elem = $(this);

        if( elem.parents('.movHeader').length > 0 )
        {
            var prnt = elem.parents('.quick-nav'),
                pNum = elem.data('openpanel'),
                pane = $('[data-panel="'+ pNum +'"]', prnt);

            e.preventDefault();

            if( pane.hasClass('active') )
            {
                elem.attr('aria-expanded', 'false');

                prnt.removeClass('panel-open').find('.active').removeClass('active');

                // $(focusElements, pane).attr('tabindex', -1);
            }
            else
            {
                elem.attr('aria-expanded', 'true');

                prnt.addClass('panel-open').find('.active').removeClass('active');

                pane.addClass('active');

                // $(focusElements, pane).removeAttr('tabindex');

                trapFocus(pane);
            }

            if( $('[data-openpanel="'+pNum+'"]', $head).parents('.align-right').length > 0 )
                 prnt.addClass('move-right');
            else prnt.removeClass('move-right');
        }
    })
    .on('click', function(e)
    {
        if( $(document.body).hasClass('modal-open') ) return;

        var targ = $(e.target);

        if( !targ.parents('.quick-nav').length ||
            targ.hasClass('close_panel') ||
            (targ.parents('.user-login-details').length > 0)
        )
        {
            var activePanel = $('.quick-nav .active', $head);

            // $(focusElements, activePanel).attr('tabindex', -1);

            $('.quick-nav', $head).removeClass('panel-open').find('.active').removeClass('active');

            $('.quick-nav-btn [data-openpanel="'+activePanel.attr('data-panel')+'"]', $('.quick-nav', $head)).attr('aria-expanded', 'false').focus();
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    if( $mNav.length > 5 ){ $menu.addClass('item-count-'+$mNav.length); }
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Remove panels from wrapper
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.panel-wrapper', mobileWrapper).remove();
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////
    // ADA Compliance
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    var isNavMousedown = false;
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $body.on({
        mousedown : function(){ isNavMousedown = true; },
        mouseup : function(){ isNavMousedown = false; }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    var navWrappers = headerWrapper.add(headerSubMenu);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function clearMenuFocus(){ $('.has-children', navWrappers).removeClass('show-submenu').children('a').attr('aria-expanded', 'false'); }
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $(focusElements, navWrappers).focus(clearMenuFocus);
    ////////////////////////////////////////////////////////////////////////////////////////////////
    // $(document).click(clearMenuFocus);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    mobileButton.attr('aria-expanded', false);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    mobileWrapper.attr('aria-hidden', true);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.quick-nav-btn [data-openpanel]', headerWrapper).attr({
        'role' : 'button',
        'aria-expanded' : 'false'
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    var watchers = 'a, li, ul, button, .tooltip';
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $(watchers, $('nav.primary', headerWrapper))
    .add( $(watchers, headerSubMenu) )
    .hover(function()
    {
        var elem = $(this);
        // var prnt = elem.parent();

        // var isPrimary = elem.parents('.movHeader').length > 0;

        // if( (isPrimary && prnt.hasClass('active') && !$body.hasClass(scrollClass)) ) return;

        // if( prnt.hasClass('has-children') )
        // {
        //     _a(prnt).attr('aria-expanded', 'true');
        // }

        _a(elem.parents('li.has-children')).attr('aria-expanded', 'true');
    }, clearMenuFocus);
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    watchers = 'a, button, .tooltip';
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $(watchers, $('nav.primary', headerWrapper))
    .add( $(watchers, headerSubMenu) )
    .on({
        focus : function() {
            var elem = $(this);
            var prnt = elem.parent();

            var isPrimary = elem.parents('.movHeader').length > 0;

            if( (isPrimary && prnt.hasClass('active') && !$body.hasClass(scrollClass)) || isNavMousedown ) return;

            if( prnt.hasClass('has-children') )
            {
                prnt.addClass('show-submenu').children('a').attr('aria-expanded', 'true');
            }

            elem.parents('li.has-children').addClass('show-submenu').children('a').attr('aria-expanded', 'true');
        },
        keydown : function(e) {
            var elem = $(document.activeElement).parent();

            var isPrimary = elem.parents('.movHeader').length > 0;

            // First Level
            if( !elem.parents('li').length )
            {
                switch (e.keyCode)
                {
                    case 37 : // left arrow
                        if( elem.prev().length > 0 )
                            _a( elem.prev() ).focus();
                        break;
                    case 38 : // up arrow
                        if( !isPrimary )
                        {
                            $(focusElements, headerSubMenu).attr('tabindex', -1);

                            _a(activeNavItem).focus();
                        }
                        break;
                    case 39 : // right arrow
                        if( elem.next().length > 0 )
                            _a( elem.next() ).focus();
                        break;
                    case 40 : // down arrow
                        var isActivePrimary = elem.hasClass('active') && isPrimary && !$body.hasClass(scrollClass);

                        if( isActivePrimary ) $(focusElements, headerSubMenu).removeAttr('tabindex');

                        _a( $('li', isActivePrimary ? headerSubMenu : elem).first() ).focus();
                        break;
                    default:
                }
            }
            else
            {
                switch (e.keyCode)
                {
                    case 37 : // left arrow
                        if( elem.parents('.has-children').length > 1 )
                            _a(elem.parents('li').first()).focus();
                        break;
                    case 38 : // up arrow
                        if( elem.prev().length > 0 )
                            _a(elem.prev()).focus();
                        else if( elem.parents('li').length > 0 )
                            _a(elem.parents('li').first()).focus();
                        break;
                    case 39 : // right arrow
                        if( elem.hasClass('has-children') )
                            _a($('li', elem).first()).focus();
                        break;
                    case 40 : // down arrow
                        if( elem.next().length > 0 )
                            _a(elem.next()).focus();
                        break;
                    default:
                }
            }

            if( e.keyCode==38 || e.keyCode==40 ){ e.preventDefault(); return false; }
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////
    if( activeNavItem.length > 0 )
    {
        var focusSubMenu = $(focusElements, headerSubMenu);

        _a($mNav).keydown(function(e) {
            var isTabPressed = (e.key === 'Tab' || e.keyCode === KEYCODE_TAB);

            if (!isTabPressed || $body.hasClass(scrollClass)) return;

            if ( e.shiftKey ) /* shift + tab */ {
                if (document.activeElement === _a(activeNavItem.next())[0]) {
                    focusSubMenu.last().focus();
                    focusSubMenu.removeAttr('tabindex');
                    e.preventDefault();
                }
            } else /* tab */ {
                if (document.activeElement === _a(activeNavItem)[0]) {
                    focusSubMenu.first().focus();
                    focusSubMenu.removeAttr('tabindex');
                    e.preventDefault();
                }
            }
        });

        headerSubMenu.keydown(function(e) {
            var isTabPressed = (e.key === 'Tab' || e.keyCode === KEYCODE_TAB);

            if (!isTabPressed || $body.hasClass(scrollClass)) return;

            if ( e.shiftKey ) /* shift + tab */
            {
                if (document.activeElement === focusSubMenu.first()[0]) {
                    _a(activeNavItem).focus();
                    focusSubMenu.attr('tabindex', -1);
                    e.preventDefault();
                }
            }
            else /* tab */
            {
                if (document.activeElement === focusSubMenu.last()[0]) {
                    _a(activeNavItem.next()).focus();
                    focusSubMenu.attr('tabindex', -1);
                    e.preventDefault();
                }
            }
        });
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    var shortcutJump, shortcutTimer;
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.assistive-text')
    .keydown(function(e)
    {
        clearTimeout(shortcutTimer);
        shortcutJump = true;
    })
    .keyup(function(e)
    {
        clearTimeout(shortcutTimer);
        shortcutTimer = setTimeout(function(){
            shortcutJump = false;
        }, 1000);
    });
    $('#primary-search form').on('submit', function(e)
    {
        if( shortcutJump )
        {
            $('.search-query', $(this)).focus();
            e.preventDefault();
            return false;
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // (Might be placed elsewhere)
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $body.on('keydown', 'a[role="button"]', function(e)
    {
        var id = e.key || e.which || e.keyCode || 0;

        if (id == ' ' || id == 13 || id == 'Enter')
        {
            e.preventDefault();
            $(this).trigger('click');
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Fire Responive Functions
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    responsiveD(); scrollD();
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Window Events
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $wind.on({
        load : function()
        {
            ////////////////////////////////////////////////////////////////////////////////////////////
            // Fire Responive Functions
            ////////////////////////////////////////////////////////////////////////////////////////////
            responsiveW();
            ////////////////////////////////////////////////////////////////////////////////////////////
        },
        scroll : function()
        {
            scrollD();
        },
        resize : function()
        {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(finishedResizing, 500);
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / On Page Scroll
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Insert functions here that get called once onload and also on a page reszie
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function scrollD()
    {
        // If header is sticky, check scroll position
        if( $head.hasClass('sticky') ) checkScroll();
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Fires @ [Document.Ready && Window.Resize]
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveD()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////
        // Center position sub menus for desktop navigation
        ////////////////////////////////////////////////////////////////////////////////////////////
        $mNav.each(function()
        {
            var elem  = $(this),
                child = elem.children('ul');

            if( child.length > 0 )
            {
                var move =  Math.floor(elem.outerWidth() / 2) - Math.floor(child.outerWidth() / 2);

                child.css('left', move+'px');
            }
        });
        ////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////
        //
        ////////////////////////////////////////////////////////////////////////////////////////////
        // updateTabindex();
        ////////////////////////////////////////////////////////////////////////////////////////////
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Fires @ [Window.Load && Window.Resize]
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveW()
    {

    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    /**
    * @desc Shrink the header once you begin to scroll the page
    */
    function checkScroll()
    {
        // var runFunctions = false;
        var scrollAtTop = $docu.scrollTop() < 1;

        if( scrollAtTop )
        {
            $body.removeClass(scrollClass);

            // runFunctions = true;
        }
        else if( !$body.hasClass(scrollClass) )
        {
            if( $head.hasClass('sticky') )
            {
                $body.addClass(scrollClass);
            }

            // runFunctions = true;
        }

        // Check for active nav
        var activeNav = $('nav.primary > ul > li.active', headerWrapper);
        if( activeNav.length > 0 )
        {
            $(focusElements, $('ul',activeNav)).attr('tabindex', scrollAtTop ? -1 : 0);
        }

        // Run commands when toggling header size
        /*
        if( runFunctions )
        {
            // CODE GOES HERE

            // KEEP LAST
            runFunctions = false;
        }
        */
    }


    function updateTabindex()
    {
        var type = localStorage.screenSize,
            navi = headerWrapper.add( $(focusElements, headerWrapper) ),
            mobi = mobileWrapper.add( $(focusElements, mobileWrapper) );

        if( isDesktop() && type!='desktop' )
        {
            localStorage.screenSize = 'desktop';

            // navi.removeAttr('tabindex');

            // $(focusAddition, headerWrapper).attr('tabindex', 0);
        }
        else if( !isDesktop() && type!='mobile' )
        {
            localStorage.screenSize = 'mobile';

            // navi.attr('tabindex', -1);

            // $('.mobile-button, .logo a', headerWrapper).removeAttr('tabindex');
        }

        // if( !$html.hasClass(openM) ) mobi.add( $(focusElements, panelWrappers) ).attr('tabindex', -1);
    }


    function finishedResizing()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////
        // Remove "open menu" class when desktop breakpoint is reached
        ////////////////////////////////////////////////////////////////////////////////////////////
        if( isDesktop() && $html.hasClass(openM) )
        {
            // $html.removeClass(openM);

            $('.js_toggle_mobile_menu', mobileWrapper).trigger('click');
        }
        ////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////
        // Fire Responive Functions
        ////////////////////////////////////////////////////////////////////////////////////////////
        responsiveD();
        ////////////////////////////////////////////////////////////////////////////////////////////
        responsiveW();
        ////////////////////////////////////////////////////////////////////////////////////////////
    }


    function triggerResize()
    {
        setTimeout(function()
        {
            $wind.trigger('resize');
        }, 500);
    }
});
$(function(){
    if ($(".breadcrumb").find(".hidebreadcrumb").length > 0 || $(".breadcrumb").find(".hide").length > 0) {

        if ($(".movHeader-sub.expand").length > 0 ) {
            $(".breadcrumb").hide();
        } else {
            if($(".breadcrumb").find(".hide").length > 0) {
                $(".breadcrumb").hide();
            } else {
            	$(".breadcrumb").show();
            }
        }
    }
});
$(function()
{
    var $anchor = $('.anchor :not(.cq-Editable-dom)');
    if( $anchor.length )
    {

        var notifyBar = $('.headerIPar .notification-bar'),

            isMCTopNav = $('.mctopnavigation').length,

            navH = 0;

        if( notifyBar.length )
        {

            var $promo_data = notifyBar.data('md5'),
                $promo_chek = typeof $promo_data !== typeof undefined && $promo_data !== false,
                $promo_opts = {
                    name : 'promo_closed' + ($promo_chek ? '_'+$promo_data : ''),
                    expires : $promo_chek ? 365 : false
                };

            if( !Cookies.get($promo_opts.name) )
            {
                navH = notifyBar.outerHeight();

            }
        }

         if ( isMCTopNav ){ // this isn't sticky
              if ( navH != 0 ){
                adjustAnchor(navH); // use the height of the site announcement (if there is one)
              }
         }
         else{
              adjustAnchor(navH+170); // use the height of the site announcement (if there is one) and 170px for approx height of sticky header
         }

   }

    /**
    * @desc Adjust spacing to accommodate for a fixed notification bar
    */
    function adjustAnchor( value, animate )
    {
        var speed = 250;
        $.fn.adjust = function( val ) { if( animate ) this.animate(val, speed); else this.css(val); };


        var obj = {'margin-top':-1*value } ;
        $anchor.adjust( obj );
        obj = {'padding-bottom':value } ;
        $anchor.adjust( obj );
    }
});
$(function()
{
    var article = $('.smallarticlefeature');

    if( article.length )
    {
        matchTags();

        $(window).on({'load':matchTags,'resize':matchTags});
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Buttons inside an "equal height" row will force matching widths
    ////////////////////////////////////////////////////////////////////////////////////////////////
    function matchTags()
    {
        article.each(function(){
            var elem = $(this),
                tags = $('.small-article-tag', elem),
                maxW = 0;

            tags.each(function(){
                var elm  = $(this),
                    elmW = Math.ceil(elm.css('width', 'auto')[0].getBoundingClientRect().width);

                if( elmW > maxW ) maxW = elmW;
            })
            .outerWidth(maxW?maxW:'auto');
        });
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////
});

$(function()
{
    var sections = $('.categorytiles.movSection');

    if( sections.length )
    {
        matchWidth();

        $(window).on({'load':matchWidth,'resize':matchWidth});
    }

    ////////////////////////////////////////////////////////////////////////////////////////////////
    // ".post-details" elements will force matching widths
    ////////////////////////////////////////////////////////////////////////////////////////////////
    function matchWidth()
    {
        sections.each(function(){
            var elem = $(this),
                item = $('.post-details', elem),
                maxW = 0;

            item.each(function(){
                var elm = $(this),
                    elmW = Math.ceil(elm.css('width', 'auto')[0].getBoundingClientRect().width);

                if( elmW > maxW ) maxW = elmW;
            })
            .outerWidth(maxW?maxW:'auto');
        });
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////
});

////////////////////////////////////////////////////////////////////////////////////////////////////////
//
////////////////////////////////////////////////////////////////////////////////////////////////////////
$(function()
{
    var resizeTimer = null;

    var $docu = $(document),
        $wind = $(window),
        $html = $('html'),
        $body = $('body'),

        $head = $('.header-grin'),
        $mobi = $('.mobile-wrapper'),

        // Added 2023-09-14
        headerWrapper = $('.movHeader'),
        mobileButton = $('.mobile-button', headerWrapper),
        mobileWrapper = $('.mobile-wrapper'),

        isDesktop = function(){ return $wind.outerWidth() > 992 },

        openM = 'open-menu';

    if( !$head.length ) return;

    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // DOM Ready
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $body.addClass('no-ani grin');

    if( $head.css('position') == 'fixed' ) $body.addClass('stickyAdjust');

    if( $head.hasClass('minimal') ) $body.addClass('minimal');
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Remove "no animation" class after page load
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    setTimeout(function(){ $body.removeClass('no-ani'); }, 1000);
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Search bar toggle
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.js_toggle_grin_search', $head).on('click', function(){
        $head.toggleClass('search-isopen');
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Disable the "active" language selector
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.lang-select li.active a').on('click', function(e){
        e.preventDefault(); return false;
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Toggle "menu open" class
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // $('.js_toggle_mobile_menu').on('click', function(){
    //     $html.toggleClass(openM);
    // });

    // Added 2023-09-14 (and commented out the above)
    $(document.body)
    .on('click', '.js_toggle_mobile_menu', function()
    {
        $html.toggleClass(openM);

        var menuIsOpen = $html.hasClass(openM);

        mobileButton.attr('aria-expanded', menuIsOpen);

        mobileWrapper.attr('aria-hidden', !menuIsOpen);

        if( menuIsOpen )
        {
            mobileWrapper.addClass('visible');

            trapFocus(mobileWrapper);
        }
        else 
        {
            mobileMenuTimer = setTimeout(function()
            {
                mobileWrapper.removeClass('visible');
            }, 500);

            mobileButton.focus();
        }

        mobileWrapper.toggleClass('slideIn');
    })
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Toggle sub menu in mobile menu
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $('.drop', $mobi).on('click', function(){
        var elem = $(this),
            item = elem.parent();

        item.toggleClass('sub-open').children('.sub-menu').stop().slideToggle(function(){
            if( !item.hasClass('sub-open') ) elem.removeAttr('style');
        });
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Window Events
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    $wind.on({
        load   : function(){
            responsiveW();
        },
        scroll : function(){
            scrollD();
        },
        resize : function()
        {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(finishedResizing, 500);
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Document Ready / On Page Scroll
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Insert functions here that get called once onload and also on a page reszie
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function scrollD()
    {
        // If header is sticky, check scroll position
        checkScroll();
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Window Load / Window Resize
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    function responsiveW()
    {

    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////


    /**
    * @desc Shrink the header once you begin to scroll the page
    */
    function checkScroll()
    {
        // var runFunctions = false;
        var scrollClass = 'isScrolling';

        if( $docu.scrollTop() < 1 )
        {
            $body.removeClass(scrollClass);

            // runFunctions = true;
        }
        else if( !$body.hasClass(scrollClass) )
        {
            if( $head.hasClass('sticky') ) $body.addClass(scrollClass);

            // runFunctions = true;
        }

        // Run commands when toggling header size
        /*
        if( runFunctions )
        {
            // CODE GOES HERE

            // KEEP LAST
            runFunctions = false;
        }
        */
    }


    function finishedResizing()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////
        // Remove "open menu" class when desktop breakpoint is reached
        ////////////////////////////////////////////////////////////////////////////////////////////
        if( isDesktop() && $html.hasClass(openM) )
        {
            $('.js_toggle_mobile_menu', mobileWrapper).trigger('click');
        }
        ////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////
        // Fire Responive Functions
        ////////////////////////////////////////////////////////////////////////////////////////////
        // responsiveD();
        ////////////////////////////////////////////////////////////////////////////////////////////
        responsiveW();
        ////////////////////////////////////////////////////////////////////////////////////////////
    }
});

////////////////////////////////////////////////////////////////////////////////////////////////
// Top Item List
////////////////////////////////////////////////////////////////////////////////////////////////
$(function()
{
    var topitem = $('.top-item-list-wrap');

    if( topitem.length )
    {
        topitem.each(function(){

            var slider   = $('.top-item-list-slider', topitem),
                checkRes = function(){
                    if( window.innerWidth > 767  )
                    {
                        if( slider.hasClass('slick-initialized') ) slider.slick('unslick');
                    }
                    else
                    {
                        var opts = {
                            dots: false,
                            arrows: false,
                            infinite: false,
                            centerMode: true,
                            adaptiveHeight: true
                        };

                        if( !slider.hasClass('slick-initialized') && slider.children().length > 1 ) slider.slick(opts);
                    }
                };

            checkRes(); $(window).resize(checkRes);

            //$(window).load(function(){ setTimeout(function(){ checkRes(); slider.slick('setPosition'); }, 500); });
        });
    }
});

$(function()
{
    ////////////////////////////////////////////////////////////////////////////////////////////////
    // PnR | Dentist Search | /dentist-search-results/
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $(document.body).on('click', '.dd-info-badge-chip', function(){
        var elem = $(this);
        var prnt = elem.parents('.dentist-result');
        var name = capitalize($('.first-name', prnt).text()) + ' ' + capitalize($('.last-name', prnt).text());
        var url =  elem.data('href');
        var pnrUrl=url.toLowerCase().indexOf("http") == 0 ? url : "http://"+url;
        $('.dentist-panel-wrapper .dentist-name').text(name).parent().attr('href', pnrUrl);

        $('body').addClass('open-dentist-panel');
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $(document.body).on('click', '.dentist-panel-wrapper .panel-close', function(e)
    {
        e.preventDefault();

        $('body').removeClass('open-dentist-panel');
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////
    function capitalize(str)
    {
        return str.charAt(0).toUpperCase() + str.toLowerCase().slice(1);
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////
});

$(function()
{
    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Get full HTML of an element instead of just its children
    ////////////////////////////////////////////////////////////////////////////////////////////////
    jQuery.fn.outerHTML = function(s) { return s ? this.before(s).remove() : jQuery("<p>").append(this.eq(0).clone()).html(); };
    ////////////////////////////////////////////////////////////////////////////////////////////////

    var results = $('.blog-results');
    var blogCheck = $('.blog-loadmore');

    if( results.length && blogCheck.length )
    {
        results.each(function()
        {
            var prnt  = $(this),
                blogs = $('.blog-item', prnt),
                lMore = $('.blog-loadmore button', prnt),

                init = document.getElementsByClassName("blog-loadmore")[0].getAttribute("loadID"),
                load = document.getElementsByClassName("blog-loadmore")[0].getAttribute("loadValue");

            if( blogs.length > init )
            {
                var html = ['<div>'];

                blogs.each(function(i){
                    if( i==init || (i>init && !((i-init)%load)) ) html.push('</div><div class="lazy" style="display: none;">');

                    html.push( $(this).outerHTML() );
                });

                html.push( '</div>' );

                $('.blog-list', prnt).html(html.join(''));

                lMore.on('click', function(){
                    var lazy = $('.lazy', prnt).first(),
                        prev = lazy.prev();

                    $('html, body').stop(0).animate({ scrollTop : prev.offset().top + prev.outerHeight() }, 500);

                    lazy.removeClass('lazy').slideDown(500);

                    if( $('.lazy', prnt).length )
                    {
                        $(this).blur();
                    }
                    else
                    {
                        $(this).addClass('inactive-btn');
                    }
                });
            }
            else
            {
                lMore.remove();
            }
        });
    }

});

$(function(){
	$(".relatedarticle").each(function() {
        var elem = $(this),
            pageUrl =  new URL(window.location.href),
            hostname = pageUrl.hostname,
            protocol = pageUrl.protocol,
            pageLinkHref = pageUrl.pathname;

        // is this page url a link on the relatedarticle list ?
        var pageLinkPath = $('.nav-list.sub-menu a[href="'+pageLinkHref+'"]', elem);
        if ( pageLinkPath.length == 0 ){
            // for some sites, the links have the hostname in front of them i.e. the MCs, however some have only relative urls like /broker/. Add protocol and hostname to these.
            pageLinkHref = protocol + "//" + hostname + pageUrl.pathname;
            pageLinkPath = $('.nav-list.sub-menu a[href="' + pageLinkHref + '"]', elem);
        }
        //$('.nav-list.sub-menu a', elem).removeClass('active');
        if  ( pageLinkPath.length ){
            $('.nav-list.sub-menu a[href="'+pageLinkHref+'"]', elem).addClass('active').removeAttr( "href" );
        }

	});
});
$(function()
{

    var cookiestatement = $('.cookie-statement');

    if( cookiestatement.length > 0 )
    {
        cookiestatement.each(function()
        {
            var $body = $('body'),
                $cookie = $(this),
                $cookie_data = $cookie.attr('data-md5'),
                $cookie_opts = {
                    name : 'cookies_accepted_' + $cookie_data,
                    expires : 365
                };

            if( !Cookies.get($cookie_opts.name) )
            {
                console.log("!Cookies.get($cookie_opts.name)");
                $('button', $cookie).on('click', function(){
                    $body.removeClass('show-cookiestatement');

                    setTimeout(function(){
                        $(this).parents('.section').remove();
                    }, 750);

                    if( typeof $cookie_data !== 'undefined' ) Cookies.set($cookie_opts.name, 1, { expires:$cookie_opts.expires });
                });

                if( $('.post-text', $cookie).text().trim().length > 200 )
                {
                    $cookie.addClass('extend');
                }

                $body.addClass('show-cookiestatement');
            }
            else
            {
                $cookie.remove();
            }
        });
    }
});

$(function()
{
    var feedback = $('.feedback');
    if( feedback.length > 0 )
    {
        var feedBtn = $('button', feedback);
        var getMinH = 32; // l/r gaps

        $('.inner', feedback).children().each(function(){ getMinH += $(this).outerWidth(true); });

        feedBtn
            .css('min-height', (getMinH > Number(feedBtn.css('min-height').replace('px',''))) ? getMinH : null)
            .on('click', function()
            {
                var elem = $(this);

                window.open(
                    elem.attr('data-href'),
                    '_blank',
                    (elem.hasClass('popout') ? 'width=1000,height=800' : null)
                );
            });

        setTimeout(function(){ feedback.addClass('ready'); }, 1500);
    }
});

var recaptchaCookieToken;

function recaptcha_callback( res) {
    recaptchaCookieToken = res;
    var protect = $('.password-protected');
    if( protect.length > 0 ) {
        $('.alert', protect).hide();
    }

};

function expired_callback() {
    recaptchaCookieToken = '';
    var protect = $('.password-protected');
    if( protect.length > 0 ) {
        $alert = $('.alert', protect).text("Please confirm that you are not a robot before proceeding further.").show();
    }

};

$(function() {
    var protect = $('.password-protected');
    if( protect.length > 0 )
    {
        var $protected_data = protect.attr('data-md5'),
            $protected_opts = {
                name : 'page_protected' + ($protected_data ? '_'+$protected_data : ''),
                expires : false
            },
            protectedCookie = Cookies.get($protected_opts.name);

        if ( protectedCookie == undefined){
             // Create a cookie for the page to record attempts, it will be -1 when correct credentials provided
            Cookies.set($protected_opts.name, 0, { expires:$protected_opts.expires });
            protectedCookie = 0;
        }

        if ( protectedCookie >= 0 ) {
            var $alert = $('.alert', protect);
            var $recapcha = $('div.g-recaptcha', protect);
            var $input = $('input[name="password"]', protect);
            var $path =  $('input[name="currentPath"]', protect);

            var $submit = $('button', protect);
                    
            $(['tabindex="-1"']).addClass('tabignore');

            $(focusElements).attr('tabindex', -1);
            $(focusElements, protect).removeAttr('tabindex');

            trapFocus(protect);

            $('body')
            .prepend(protect.parent())
            .addClass('protected');

            if ( protectedCookie < 5 ){
               $recapcha.hide();
            }
            $input.on('input', function(e){ $alert.hide(); });

            $('form', protect).on('submit', function(e) {
                e.preventDefault();
                var record = {};
                record.path = $path.val();
                record.passcode = $input.val();
                record.checkRecaptchaToken = "false";
                record.recaptchaToken = "";

                if ( Cookies.get($protected_opts.name) >= 5 ) {
                    record.checkRecaptchaToken = "true";

                    if ( recaptchaCookieToken != null && recaptchaCookieToken != "" ) {
                        record.recaptchaToken = recaptchaCookieToken;
                    }
                    else {
                        $('.alert', protect).text("Please confirm that you are not a robot before proceeding further.").show();
                        let failedAttempts = Cookies.get($protected_opts.name);
                        failedAttempts++;
                        Cookies.set($protected_opts.name, failedAttempts);

                        if (failedAttempts >= 5) {
                            $recapcha.show();
                        }

                        return;
                    }
                }


                $submit
                .prop('disabled', true)
                .addClass('inactive-btn buffering');

                let passcodeService = $.extend({}, ajaxParams_default);
                passcodeService.url = "/conf/ddpa/paths/protected/passcode.json";
                passcodeService.successCallbackFunction = inputAccepted;
                passcodeService.errorCallBackFunction = analyseError;
                passcodeService.requestType = 'POST';
                passcodeService.data = JSON.stringify(record);
                ajaxCall(passcodeService)
            });

            $('html, body').scrollTop(0);
        }
        else {
            protect.remove();
        }
    }

    //
    function inputAccepted(res) {

        if (res.passcodeSuccess == "true") {
            goodPasscode(res);
        }
        else {
            badPasscode(res);
        }

    }


    function goodPasscode(res) {
        $submit
            .prop('disabled', false)
            .removeClass('inactive-btn buffering');

        if ( Cookies.get($protected_opts.name) >= 5 ) {
            if (res.tokenSuccess != "true") {
                // You will only get here if the verify token (when the user has definitely clicked on the recaptcha)
                // has failed, I'm not sure if there are any valid circumstances where this can happen.
                errorMessage =  "Please confirm that you are not a robot before proceeding further.";

                $('.alert', protect).text(errorMessage).show();

                let failedAttempts = Cookies.get($protected_opts.name);
                failedAttempts++;
                Cookies.set($protected_opts.name, failedAttempts);

                if (failedAttempts >= 5) {
                    $recapcha.show();
                }
                return;
            }
        }

        $alert.hide();
        $('body').removeClass('protected');

        $(focusElements).removeAttr('tabindex');
        $('.tabignore').attr('tabindex', -1).removeClass('tabignore');

        Cookies.set($protected_opts.name, -1);
        $input.attr('aria-invalid', false);
        protect.parent().remove();

    }



    function badPasscode(res) {
        // enable the submit button again
        $submit
            .prop('disabled', false)
            .removeClass('inactive-btn buffering');


        errorMessage = "Please try the passcode again. ";

        $input.attr('aria-invalid', true).focus();

        $('.alert', protect).text(errorMessage).show();

        let failedAttempts = Cookies.get($protected_opts.name);
        failedAttempts++;
        Cookies.set($protected_opts.name, failedAttempts);

        if (failedAttempts >= 5) {
            $recapcha.show();
        }
    }

    function analyseError(res) {
        console.log(res);
        $submit
            .prop('disabled', false)
            .removeClass('inactive-btn buffering');
        $alert = $('.alert', protect).text("Internal error.").show();

    }
});


$(function()
{
    var stickyBanners = $('.sticky-banner');
    if( stickyBanners.length > 0 )
    {
        ////////////////////////////////////////////////////////////////////////////////////////////
        // Remove sticky classes from body and .header
        ////////////////////////////////////////////////////////////////////////////////////////////
        $('body').removeClass('stickyAdjust isScrolling');
        ////////////////////////////////////////////////////////////////////////////////////////////
        $('.header').removeClass('sticky').find('.sticky-navbar').removeClass('sticky-navbar');
        ////////////////////////////////////////////////////////////////////////////////////////////
        $('.notification-bar').addClass('static');
        ////////////////////////////////////////////////////////////////////////////////////////////

    
        ///////////////////////////////////////////////////////////////////////////////////////////
        // Initialize resize timer
        ///////////////////////////////////////////////////////////////////////////////////////////
        var stickyBannerResizeTimer;
        ///////////////////////////////////////////////////////////////////////////////////////////
        // Initialize sticky functions
        ///////////////////////////////////////////////////////////////////////////////////////////
        checkSticky();
        ///////////////////////////////////////////////////////////////////////////////////////////
        $(window).on({
            'resize' : function()
            {
                $('.sticky-wrap').addClass('no-ani');

                clearTimeout(stickyBannerResizeTimer);
                
                checkSticky();

                stickyBannerResizeTimer = setTimeout(function()
                {
                    $('.sticky-wrap').removeClass('no-ani');
                }, 250);
            },
            'scroll' : checkSticky
        });
        ///////////////////////////////////////////////////////////////////////////////////////////
    }
    
    function checkSticky()
    {
        ////////////////////////////////////////////////////////////////////////////////////////////
        // Loop through all sitcky banners and calculate CSS
        ////////////////////////////////////////////////////////////////////////////////////////////
        stickyBanners.each(function()
        {
            var elem = $(this),
                wrap = $('.sticky-wrap', elem),
                clone = $('.sticky-clone', elem),
                fixed = isFixed(elem);
            console.log("elem");
            console.log(elem);
            console.log("wrap");
            console.log(wrap);
            console.log("clone");
            console.log(clone);
            console.log("fixed=" + fixed);


            clone.outerHeight( $('.sticky-watch', elem).outerHeight() );

            $('.sticky-inner', elem).outerWidth( clone.outerWidth() );
            
            wrap.outerWidth( ( fixed ? $(window) : clone ).outerWidth() );
            
            elem.toggleClass('sticky-static', !fixed).toggleClass('sticky-fixed', fixed);

            if( accOutOfView(elem) )
            {
                $('.collapse-trigger', elem)
                .addClass('collapsed')
                .attr('aria-expanded', false);

                $('.collapse', elem)
                .removeClass('in')
                .attr('aria-expanded', false)
                .removeAttr('style');
            }
        });
        ////////////////////////////////////////////////////////////////////////////////////////////
    }
    
    function isFixed( element )
    {
        return $(document).scrollTop() >= element.offset().top;
    }

    function accOutOfView( element )
    {
        return $('.sticky-mobile', element).css('display') != 'block';
    }
});


$(function()
{
    initTooltip();
});


/**
 * @desc Initialize Toolip
 */
function initTooltip( parent )
{
    var getTooltips = $('[data-toggle="tooltip"]', parent);
    if( getTooltips.length > 0 )
    {
        var tooltipInit = false,
            tooltipTimer = null,
            focusOnButton = [],
            focusOnTooltip = [],
            mouseOverButton = [],
            mouseOverTooltip = [];

        $.fn.toggleToolTip = function( showToolTip )
        {
            if( tooltipInit ) this.attr('aria-expanded', showToolTip);

            $('#'+this.getTooltipID()).toggleClass('in', showToolTip)
            .find('a').attr('tabindex', showToolTip ? 0 : -1);
        };
        
        $.fn.getTooltipID = function()
        {
            if( typeof this.data('toggle') != 'undefined' )
            {
                return this.attr('aria-labelledby');
            }
            else if( this.hasClass('tooltip') )
            {
                return this.attr('id');
            }
        }

        $.fn.getTooltipInfo = function()
        {
            var elem = $(this);

            if( elem.parents('.tooltip').length > 0 ) elem = elem.parents('.tooltip');

            var elemID = elem.getTooltipID(),
                target = $('[aria-labelledby="'+elemID+'"]');
            
            return {
                'ID' : elemID,
                'index' : target.data('index'),
                'target' : target
            };
        }

        $.fn.tooltipIsOpen = function()
        {
            return this.attr('aria-expanded') == 'true';
        }
    
        setTooltip();

        tooltipInit = true;
        
        getTooltips
        .each(function(index)
        {
            var tooltip = $(this);

            tooltip.data('index', index);

            focusOnButton[index] = false;
            focusOnTooltip[index] = false;
            mouseOverButton[index] = false;
            mouseOverTooltip[index] = false;
        })
        .on({
            'mouseover' : function()
            {
                var info = $(this).getTooltipInfo();

                mouseOverButton[info.index] = true;
    
                info.target.toggleToolTip(true);
            },
            'mouseout' : function()
            {
                var info = $(this).getTooltipInfo();
                
                mouseOverButton[info.index] = false;
                
                setTimeout(function()
                { 
                    if (!mouseOverTooltip[info.index]) info.target.toggleToolTip(false);
                }, 100);
            },
            'mousedown' : function(e)
            {
                e.preventDefault();
            },
            'click' : function(e)
            {
                var elem = $(this);
    
                elem.toggleToolTip( !elem.tooltipIsOpen() );
            },
            'focus' : function()
            {
                var info = $(this).getTooltipInfo();
                
                focusOnButton[info.index] = true;
    
                info.target.toggleToolTip(true);
            },
            'blur' : function()
            {
                var info = $(this).getTooltipInfo();
                
                focusOnButton[info.index] = false;
            
                setTimeout(function()
                { 
                    if (!focusOnTooltip[info.index]) info.target.toggleToolTip(false);
                }, 100);
            },
            'keydown' : function(e)
            {
                if( e.keyCode==27 ) $(this).toggleToolTip(false);
            }
        });
    

        if( typeof parent != 'undefined' )
        {
            getScrollParent(parent[0]).addEventListener('scroll', resetTooltips, true);
        }
        else
        {
            $(document.body)
            .on('mouseenter', '.tooltip', function()
            {
                var info = $(this).getTooltipInfo();
                
                mouseOverTooltip[info.index] = true;
            })
            .on('mouseleave', '.tooltip', function()
            {
                var info = $(this).getTooltipInfo();
                
                mouseOverTooltip[info.index] = false;
        
                setTimeout(function()
                { 
                    if( !mouseOverButton[info.index] ) info.target.toggleToolTip(false);
                }, 100);
            })
            .on('focus', '.tooltip a', function()
            {
                var info = $(this).getTooltipInfo();
        
                focusOnTooltip[info.index] = true;
            })
            .on('blur', '.tooltip a', function()
            {
                var info = $(this).getTooltipInfo();
                
                focusOnTooltip[info.index] = false;

                setTimeout(function()
                { 
                    if( !focusOnButton[info.index] ) info.target.toggleToolTip(false);
                }, 100);
            });
            
            $(window).on('scroll resize', resetTooltips);
            
            $('.mobile-wrapper').on('scroll', resetTooltips);
        }
    }
    
    function resetTooltips()
    {
        clearTimeout(tooltipTimer);
    
        tooltipTimer = setTimeout(setTooltip, 100);
    }
    
    function setTooltip()
    {
        getTooltips
        .each(function(index)
        {
            var elem = $(this),
                open = elem.tooltipIsOpen();
    
            elem
            .tooltip({
                html : true,
                trigger: 'manual',
                //viewport: '#content-component-wrapper',
                placement: ( $(window).outerWidth() > 767 ) ? elem.attr('data-placement') : 'top'
            })
            .tooltip('show');
            
            elem.attr('aria-labelledby', elem.attr('aria-describedby') );
            elem.removeAttr('aria-describedby');

            elem.toggleToolTip(open);
        });
    }
}


/**
 * @desc Find first scrollable parent
 */
function getScrollParent(node)
{
    if( node == null )
    {
        return null;
    }
  
    if( node.scrollHeight > node.clientHeight )
    {
        return node;
    }
    else
    {
        return getScrollParent(node.parentNode);
    }
}
/*
 *   This content is licensed according to the W3C Software License at
 *   https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document
 */

'use strict';

// Save a list of named combobox actions, for future readability
const SelectActions = {
  Close: 0,
  CloseSelect: 1,
  First: 2,
  Last: 3,
  Next: 4,
  Open: 5,
  PageDown: 6,
  PageUp: 7,
  Previous: 8,
  Select: 9,
  Type: 10,
};

/*
 * Helper functions
 */

// filter an array of options against an input string
// returns an array of options that begin with the filter string, case-independent
function filterOptions(options = [], filter, exclude = []) {
  return options.filter((option) => {
    const matches = option.toLowerCase().indexOf(filter.toLowerCase()) === 0;
    return matches && exclude.indexOf(option) < 0;
  });
}

// map a key press to an action
function getActionFromKey(event, menuOpen) {
  const { key, altKey, ctrlKey, metaKey } = event;
  const openKeys = ['ArrowDown', 'ArrowUp', 'Enter', ' ']; // all keys that will do the default open action
  // handle opening when closed
  if (!menuOpen && openKeys.includes(key)) {
    return SelectActions.Open;
  }

  // home and end move the selected option when open or closed
  if (key === 'Home') {
    return SelectActions.First;
  }
  if (key === 'End') {
    return SelectActions.Last;
  }

  // handle typing characters when open or closed
  if (
    key === 'Backspace' ||
    key === 'Clear' ||
    (key.length === 1 && key !== ' ' && !altKey && !ctrlKey && !metaKey)
  ) {
    return SelectActions.Type;
  }

  // handle keys when open
  if (menuOpen) {
    if (key === 'ArrowUp' && altKey) {
      return SelectActions.CloseSelect;
    } else if (key === 'ArrowDown' && !altKey) {
      return SelectActions.Next;
    } else if (key === 'ArrowUp') {
      return SelectActions.Previous;
    } else if (key === 'PageUp') {
      return SelectActions.PageUp;
    } else if (key === 'PageDown') {
      return SelectActions.PageDown;
    } else if (key === 'Escape') {
      return SelectActions.Close;
    } else if (key === 'Enter' || key === ' ') {
      return SelectActions.CloseSelect;
    }
  }
}

// return the index of an option from an array of options, based on a search string
// if the filter is multiple iterations of the same letter (e.g "aaa"), then cycle through first-letter matches
function getIndexByLetter(options, filter, startIndex = 0) {
  const orderedOptions = [
    ...options.slice(startIndex),
    ...options.slice(0, startIndex),
  ];
  const firstMatch = filterOptions(orderedOptions, filter)[0];
  const allSameLetter = (array) => array.every((letter) => letter === array[0]);

  // first check if there is an exact match for the typed string
  if (firstMatch) {
    return options.indexOf(firstMatch);
  }

  // if the same letter is being repeated, cycle through first-letter matches
  else if (allSameLetter(filter.split(''))) {
    const matches = filterOptions(orderedOptions, filter[0]);
    return options.indexOf(matches[0]);
  }

  // if no matches, return -1
  else {
    return -1;
  }
}

// get an updated option index after performing an action
function getUpdatedIndex(currentIndex, maxIndex, action) {
  const pageSize = 10; // used for pageup/pagedown

  switch (action) {
    case SelectActions.First:
      return 0;
    case SelectActions.Last:
      return maxIndex;
    case SelectActions.Previous:
      return Math.max(0, currentIndex - 1);
    case SelectActions.Next:
      return Math.min(maxIndex, currentIndex + 1);
    case SelectActions.PageUp:
      return Math.max(0, currentIndex - pageSize);
    case SelectActions.PageDown:
      return Math.min(maxIndex, currentIndex + pageSize);
    default:
      return currentIndex;
  }
}

// check if element is visible in browser view port
function isElementInView(element) {
  var bounding = element.getBoundingClientRect();

  return (
    bounding.top >= 0 &&
    bounding.left >= 0 &&
    bounding.bottom <=
      (window.innerHeight || document.documentElement.clientHeight) &&
    bounding.right <=
      (window.innerWidth || document.documentElement.clientWidth)
  );
}

// check if an element is currently scrollable
function isScrollable(element) {
  return element && element.clientHeight < element.scrollHeight;
}

// ensure a given child element is within the parent's visible scroll area
// if the child is not visible, scroll the parent
function maintainScrollVisibility(activeElement, scrollParent) {
  const { offsetHeight, offsetTop } = activeElement;
  const { offsetHeight: parentOffsetHeight, scrollTop } = scrollParent;

  const isAbove = offsetTop < scrollTop;
  const isBelow = offsetTop + offsetHeight > scrollTop + parentOffsetHeight;

  if (isAbove) {
    scrollParent.scrollTo(0, offsetTop);
  } else if (isBelow) {
    scrollParent.scrollTo(0, offsetTop - parentOffsetHeight + offsetHeight);
  }
}

/*
 * Select Component
 * Accepts a combobox element and an array of string options
 */
const Select = function (el, options = []) {
  // element refs
  this.el = el;
  this.comboEl = el.querySelector('[role=combobox]');
  this.listboxEl = el.querySelector('[role=listbox]');

  // data
  this.idBase = this.comboEl.id || 'combo';
  this.options = options;

  // state
  this.activeIndex = 0;
  this.open = false;
  this.searchString = '';
  this.searchTimeout = null;

  // init
  if (el && this.comboEl && this.listboxEl) {
    this.init();
  }
};

Select.prototype.init = function () {
  // select first option by default
  this.comboEl.innerHTML = this.options[0];

  // add event listeners
  this.comboEl.addEventListener('blur', this.onComboBlur.bind(this));
  this.listboxEl.addEventListener('focusout', this.onComboBlur.bind(this));
  this.comboEl.addEventListener('click', this.onComboClick.bind(this));
  this.comboEl.addEventListener('keydown', this.onComboKeyDown.bind(this));

  // create options
  this.options.map((option, index) => {
    const optionEl = this.createOption(option, index);
    this.listboxEl.appendChild(optionEl);
  });
};

Select.prototype.createOption = function (optionText, index) {
  const optionEl = document.createElement('div');
  optionEl.setAttribute('role', 'option');
  optionEl.id = `${this.idBase}-${index}`;
  optionEl.className =
    index === 0 ? 'combo-option option-current' : 'combo-option';
  optionEl.setAttribute('aria-selected', `${index === 0}`);
  optionEl.innerText = optionText;

  optionEl.addEventListener('click', (event) => {
    event.stopPropagation();
    this.onOptionClick(index);
  });
  optionEl.addEventListener('mousedown', this.onOptionMouseDown.bind(this));

  return optionEl;
};

Select.prototype.getSearchString = function (char) {
  // reset typing timeout and start new timeout
  // this allows us to make multiple-letter matches, like a native select
  if (typeof this.searchTimeout === 'number') {
    window.clearTimeout(this.searchTimeout);
  }

  this.searchTimeout = window.setTimeout(() => {
    this.searchString = '';
  }, 500);

  // add most recent letter to saved search string
  this.searchString += char;
  return this.searchString;
};

Select.prototype.onComboBlur = function (event) {
  // do nothing if relatedTarget is contained within listboxEl
  if (this.listboxEl.contains(event.relatedTarget)) {
    return;
  }

  // select current option and close
  if (this.open) {
    this.selectOption(this.activeIndex);
    this.updateMenuState(false, false);
  }
};

Select.prototype.onComboClick = function () {
  this.updateMenuState(!this.open, false);
};

Select.prototype.onComboKeyDown = function (event) {
  const { key } = event;
  const max = this.options.length - 1;

  const action = getActionFromKey(event, this.open);

  switch (action) {
    case SelectActions.Last:
    case SelectActions.First:
      this.updateMenuState(true);
    // intentional fallthrough
    case SelectActions.Next:
    case SelectActions.Previous:
    case SelectActions.PageUp:
    case SelectActions.PageDown:
      event.preventDefault();
      return this.onOptionChange(
        getUpdatedIndex(this.activeIndex, max, action)
      );
    case SelectActions.CloseSelect:
      event.preventDefault();
      this.selectOption(this.activeIndex);
    // intentional fallthrough
    case SelectActions.Close:
      event.preventDefault();
      return this.updateMenuState(false);
    case SelectActions.Type:
      return this.onComboType(key);
    case SelectActions.Open:
      event.preventDefault();
      return this.updateMenuState(true);
  }
};

Select.prototype.onComboType = function (letter) {
  // open the listbox if it is closed
  this.updateMenuState(true);

  // find the index of the first matching option
  const searchString = this.getSearchString(letter);
  const searchIndex = getIndexByLetter(
    this.options,
    searchString,
    this.activeIndex + 1
  );

  // if a match was found, go to it
  if (searchIndex >= 0) {
    this.onOptionChange(searchIndex);
  }
  // if no matches, clear the timeout and search string
  else {
    window.clearTimeout(this.searchTimeout);
    this.searchString = '';
  }
};

Select.prototype.onOptionChange = function (index) {
  const options = this.el.querySelectorAll('[role=option]');
  
  if( options[index].classList.contains('disabled') ) return;
  
  // update state
  this.activeIndex = index;

  // update aria-activedescendant
  this.comboEl.setAttribute('aria-activedescendant', `${this.idBase}-${index}`);

  // update active option styles
  [...options].forEach((optionEl) => {
    optionEl.classList.remove('option-current');
  });
  options[index].classList.add('option-current');

  // ensure the new option is in view
  if (isScrollable(this.listboxEl)) {
    maintainScrollVisibility(options[index], this.listboxEl);
  }

  // ensure the new option is visible on screen
  // ensure the new option is in view
  if (!isElementInView(options[index])) {
    options[index].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }
};

Select.prototype.onOptionClick = function (index) {
  this.onOptionChange(index);
  this.selectOption(index);
  this.updateMenuState(false);
};

Select.prototype.onOptionMouseDown = function () {
  // Clicking an option will cause a blur event,
  // but we don't want to perform the default keyboard blur action
  this.ignoreBlur = true;
};

Select.prototype.selectOption = function (index) {
  // update state
  this.activeIndex = index;

  // update displayed value
  const selected = this.options[index];
  this.comboEl.innerHTML = selected;

  // update aria-selected
  const options = this.el.querySelectorAll('[role=option]');
  [...options].forEach((optionEl) => {
    optionEl.setAttribute('aria-selected', 'false');
  });
  options[index].setAttribute('aria-selected', 'true');
};

Select.prototype.updateMenuState = function (open, callFocus = true) {
  if (this.open === open) {
    return;
  }

  // update state
  this.open = open;

  // update aria-expanded and styles
  this.comboEl.setAttribute('aria-expanded', `${open}`);
  open ? this.el.classList.add('open') : this.el.classList.remove('open');

  // update activedescendant
  const activeID = open ? `${this.idBase}-${this.activeIndex}` : '';
  this.comboEl.setAttribute('aria-activedescendant', activeID);

  if (activeID === '' && !isElementInView(this.comboEl)) {
    this.comboEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  // move focus back to the combobox, if needed
  callFocus && this.comboEl.focus();
};
var controlKeys = [ 'Alt', 'Tab', 'Meta', 'Shift', 'Escape', 'Control', 'CapsLock', 'Backspace' ];


$(function()
{
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    // Iterate over each select element
    ////////////////////////////////////////////////////////////////////////////////////////////////////
    let usaSelects = document.querySelectorAll('.usa-select');
    usaSelects?.forEach(function(selectElement) {
        ////////////////////////////////////////////////////////////////////////////////////////////////
        // Check if the parent element is already .usa-combo-box
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if (!selectElement.parentNode.classList.contains('usa-combo-box')) {
            // Create a new div element
            var divElement = document.createElement('div');
            // Add the class .usa-combo-box to the new div
            divElement.classList.add('usa-combo-box');
            
            // Wrap the select element with the new div
            selectElement.parentNode.insertBefore(divElement, selectElement);
            divElement.appendChild(selectElement);
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
        var combobox = selectElement.parentNode;
        var selected = selectElement.querySelector('[selected]');
        var placeholder = '';
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if( selectElement.getAttribute('placeholder') )
        {
            placeholder = selectElement.getAttribute('placeholder');
        }
        else if( selectElement.querySelector('[value=""]') )
        {
            placeholder = selectElement.querySelector('[value=""]').textContent;
        }
        else
        {
            placeholder = '- Select -';
        }
        ////////////////////////////////////////////////////////////////////////////////////////////////
        combobox.setAttribute('data-placeholder', placeholder);
        ////////////////////////////////////////////////////////////////////////////////////////////////
        if( selected )
        {
            combobox.setAttribute('data-default-value', selected.getAttribute('value'));
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////////
});



$(window).load(function() {
    ////////////////////////////////////////////////////////////////////////////////////////////////
    // USWDS Autocomplete
    // https://designsystem.digital.gov/components/combo-box/
    ////////////////////////////////////////////////////////////////////////////////////////////////
    let generatedComboboxes = document.querySelectorAll('.usa-combo-box');
    generatedComboboxes?.forEach(function(combobox) {
        var arrowsDisabled;

        var inputElement = combobox.querySelector('.usa-combo-box__input');
        var selectElement = combobox.querySelector('.usa-combo-box__select');
        function disableArrows( state )
        {
            arrowsDisabled = state;
        }

        function forceCursorToFront()
        {
            disableArrows( true );

            setTimeout(function() {
                inputElement.setSelectionRange(0, 0);
            }, 0);
        }

        inputElement.classList.add('form-control');

        disableArrows( true );

        selectElement.addEventListener('change', forceCursorToFront);

        inputElement.addEventListener('focus', forceCursorToFront);
        inputElement.addEventListener('mousedown', function(e)
        {
            if( arrowsDisabled )
            {
                // Ensure this runs after the default action is prevented
                setTimeout(function() {
                    inputElement.setSelectionRange(0, 0);
                    inputElement.focus();
                }, 0);
            }
        });
        inputElement.addEventListener('keydown', function(e)
        {
            switch( e.key )
            {
                case 'ArrowUp':
                case 'ArrowDown':
                case 'ArrowLeft':
                case 'ArrowRight':

                    if( arrowsDisabled ) e.preventDefault();

                    break;

                case 'Enter':

                    if( combobox.querySelectorAll('.usa-combo-box__list-option--no-results').length > 0 )
                    {
                        e.stopPropagation();
                    }
                    else
                    {
                        combobox.querySelector('.usa-combo-box__list').firstChild.click();
                    }

                    break;

                case 'Backspace':

                    if( !inputElement.selectionStart && arrowsDisabled ) combobox.querySelector('.usa-combo-box__clear-input').click();
                    
                    break;

                case 'Escape':
                    
                    forceCursorToFront();
                    
                    break;
                
                default:

                    if( controlKeys.indexOf(e.key) > -1 ) break;

                    if( !inputElement.selectionStart && arrowsDisabled ) inputElement.value = '';
                    
                    disableArrows( false );

                    break;
            }
        });

        document.getElementById(inputElement.id + '--assistiveHint').innerText = 'When autocomplete results are available use up and down arrows to review and enter to select. Touch device users, explore by touch to access list options.';
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Custom Combobox (Select Only)
    // https://www.w3.org/WAI/ARIA/apg/patterns/combobox/examples/combobox-select-only/
    ////////////////////////////////////////////////////////////////////////////////////////////////
    var comboboxes = document.querySelectorAll('.custom-combobox');
    ////////////////////////////////////////////////////////////////////////////////////////////////
    initComboBox(comboboxes, function(el, index) { });
    ////////////////////////////////////////////////////////////////////////////////////////////////
});

/**
  * @desc toggleErrorAttr
  * @param {HTMLInputElement|HTMLSelectElement} elem The element to update
  * @param {Boolean} error A true/false paramter to determine if there is an error present
  */
function toggleErrorAttr( elem, error )
{
    var wrap = elem.parents('.form-group').first();

    if( !wrap.length ) return;
    
    if( elem.hasClass('custom-combobox') )
    {
        elem = $('.combo-input', wrap);
    }

    if( error )
    {
        elem.attr('aria-invalid', 'true');
        elem.attr('aria-describedby', $('.errorMsg', wrap).attr('id'));
    }
    else
    {
        elem.removeAttr('aria-invalid');
        elem.removeAttr('aria-describedby');
    }

    elem.attr({
        'aria-invalid' : error ? 'true' : 'false'
    });

    wrap.toggleClass('errorLabel', error);

    $(window).trigger('resize');
}




/**
  * @desc Init Combobox
  * @param {HTMLSelectElementArray} comboboxes The elements to update
  * @param {function} onChange The callback function after the Combobox changes value
  */
function initComboBox(comboboxes, onChange)
{
    if( comboboxes.length > 0 )
    {
        comboboxes.forEach(function(el, index)
        {
            if (el.tagName === 'SELECT')
            {
                var get_label = el.parentNode.querySelector('label');

                var div_wrap = document.createElement('div');
                var div_input = document.createElement('div');
                var div_menu = document.createElement('div');

                var wrap_ID = el.id ? el.id : 'combobox-'+index;
                var menu_ID = wrap_ID + '-menu';
                var input_ID = wrap_ID + '-input';
                var label_ID = get_label.id ? get_label.id : wrap_ID + '-label';

                var isRequired = el.hasAttribute('required');
                var isSelected = 0;

                var options = [];
                var values = [];

                for (var i=0; i<el.options.length; i++)
                {
                    var option = el.options[i];

                    options.push( option.text );

                    if( option.hasAttribute('selected') ) isSelected = i;
                }

                el.id = wrap_ID;
                el.tabIndex = -1;

                get_label.setAttribute('for', input_ID);
                get_label.id = label_ID;

                var attr_wrap= {
                    "class" : "combo"
                };

                var attr_input = {
                    "aria-labelledby": label_ID,
                    "aria-controls": menu_ID,
                    "aria-expanded": "false",
                    "aria-haspopup": "listbox",
                    "role": "combobox",
                    "id": input_ID,
                    "class": "combo-input form-control",
                    "tabindex": "0"
                };

                var attr_menu = {
                    "aria-labelledby": label_ID,
                    "role": "listbox",
                    "id": menu_ID,
                    "class": "combo-menu",
                    "tabindex": "-1"
                };

                for (var key in attr_input) div_input.setAttribute(key, attr_input[key]);
                for (var key in attr_menu) div_menu.setAttribute(key, attr_menu[key]);
                for (var key in attr_wrap) div_wrap.setAttribute(key, attr_wrap[key]);
        
                el.parentNode.insertBefore(div_wrap, el);
        
                div_wrap.appendChild(div_input);
                div_wrap.appendChild(div_menu);
                div_wrap.appendChild(el);

                var js_select = new Select(div_wrap, options);

                js_select.selectOption(isSelected);

                div_wrap.querySelectorAll('.combo-option').forEach(function(option, j)
                {
                    var val = el.options[j].value;
                    
                    option.setAttribute('data-value', val);

                    if( !val.length && isRequired ) option.classList.add('disabled');
                });

                js_select.selectOption = (function( original )
                {
                    return function( index )
                    {
                        original.call(this, index);

                        el.selectedIndex = index;

                        if( isRequired ) toggleErrorAttr( $(el), !getOptionValue(index) );

                        onChange(el, index);
                    };
                })(js_select.selectOption);

                if( isRequired )
                {
                    $(div_input)
                    .on({
                        'blur' : function(e)
                        {
                            toggleErrorAttr( $(el), !$(el).val() );
                        }
                    });
                }

                function getOptionValue(index)
                {
                    if (index >= 0 && index < el.options.length)
                    {
                        return el.options[index].value;
                    }
                    else
                    {
                        return null;
                    }
                }
            }
        });
    }
    else
    {
        return false;
    }
}




/**
 * set the value of the element and dispatch a change event
 *
 * @param {HTMLInputElement|HTMLSelectElement} el The element to update
 * @param {string} value The new value of the element
 */
var changeElementValue = function(el, value = "") {
    var elementToChange = el;

    elementToChange.value = value;
  
    var event = new CustomEvent("change", {
        bubbles: true,
        cancelable: true,
        detail: { value },
    });

    elementToChange.dispatchEvent(event);
};



/**
 * set the value of a combobox component
 *
 * @param {HTMLSelectElement} el The ComboBox select element
 * @param {HTMLOptionElement} option An optional option element to assign values
 */
var changeComboBox = function(el, option) {
    var selectElement = el;
    var inputElement = selectElement.nextSibling;

    if( typeof option !== 'undefined' )
    {
        var getValue = option ? option.getAttribute('value') : '';
        var getText = option ? option.textContent : '';
    }
    else
    {
        var getSelected = selectElement.querySelector(`[value="${selectElement.value}"]`);
        var getValue = getSelected ? getSelected.getAttribute('value') : '';
        var getText = getSelected ? getSelected.textContent : ''
    }

    changeElementValue(selectElement, getValue);
    changeElementValue(inputElement, getText);
    inputElement.focus();
    inputElement.blur();
};
/**
 * @desc Keep keyboard focus within a parent wrapper
 *
 * @param {HTMLElement} parent Wrapper element that contains the focus
 * @param {HTMLElement} target Target element to begin focus chain
 */
function trapFocus(parent, target)
{
    var focusableEls = function(){ return $(focusElements, parent).filter(':visible'); };
    var firstFocusableEl = function(){ return focusableEls().first(); };
    var lastFocusableEl = function(){ return focusableEls().last(); };

    parent
    .off('.trapfocus')
    .on('keydown.trapfocus', function(e)
    {
        var isTabPressed = (e.key === 'Tab' || e.keyCode === KEYCODE_TAB);

        if (!isTabPressed) return;

        if ( e.shiftKey ) /* shift + tab */ {
            if (document.activeElement === firstFocusableEl()[0]) {
                lastFocusableEl().focus();
                e.preventDefault();
            }
        } else /* tab */ {
            if (document.activeElement === lastFocusableEl()[0]) {
                firstFocusableEl().focus();
                e.preventDefault();
            }
        }
    });

    setTimeout(function()
    {
        (typeof target != 'undefined' ? target : firstFocusableEl()).focus();
    }, 10);
}

/**
 * @desc Return the button that was most recently triggered to trapFocus()
 */
function focusAfterModalNum()
{
    return document.querySelectorAll('[data-focusAfterModal]').length;
}

/**
 * @desc Remeber the trigger before trapFocus() is set
 */
function rememberFocus( element )
{
    element.setAttribute('data-focusAfterModal', focusAfterModalNum() + 1);
}

/**
 * @desc Forget the trigger after trapFocus() is unset
 */
function forgetFocus( parent )
{
    parent = typeof parent != 'undefined' ? parent : document;

    var focusAfterModal = parent.querySelector('[data-focusAfterModal="'+ focusAfterModalNum() +'"]');
    if( focusAfterModal )
    {
        focusAfterModal.removeAttribute('data-focusAfterModal');

        setTimeout(function()
        {
            focusAfterModal.focus();
        }, focusAfterModal.hasAttribute('data-toggle') ? 1000 : 0);
    }
}




/**
 * @desc Check to see if element is inside the viewport
 */
$.fn.isInViewport = function( offset )
{
    offset = (typeof offset !== 'undefined' ? offset : 0.35);

    var element    = $(this),
        elementHt  = element.outerHeight(),
        elementTop = element.offset().top,
        elementBot = elementTop + elementHt,

        viewportTop = $(window).scrollTop(),
        viewportBot = viewportTop + $(window).outerHeight(),
        viewportOff = offset * elementHt; // pecentage of top and bottom

    return (elementBot - viewportOff) > viewportTop && (elementTop + viewportOff) < viewportBot;
};




/**
 * @desc Get parameters from the URL
 * 
 * @param {String} sParam Get parameter to check
 */
function getUrlParameter(sParam)
{
    var sPageURL       = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables  = sPageURL.split('&'),
        sParameterName = null;

    for (var i = 0; i < sURLVariables.length; i++)
    {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam)
        {
            return sParameterName[1] === undefined ? true : sParameterName[1];
        }
    }
}




/**
 * @desc Get the width of the browser scrollbar
 */
function getScrollbarWidth()
{
    // Creating invisible container
    var outer = document.createElement('div');
    outer.style.visibility = 'hidden';
    outer.style.overflow = 'scroll'; // forcing scrollbar to appear
    outer.style.msOverflowStyle = 'scrollbar'; // needed for WinJS apps
    document.body.appendChild(outer);
  
    // Creating inner element and placing it in the container
    var inner = document.createElement('div');
    outer.appendChild(inner);
    
    // Calculating difference between container's full width and the child width
    var scrollbarWidth = (outer.offsetWidth - inner.offsetWidth);
  
    // Removing temporary elements from the DOM
    outer.parentNode.removeChild(outer);
  
    return scrollbarWidth;
}




/**
 * @desc Return anchor children
 * 
 * @param {HTMLElement} element Parent element to check
 */
function _a( element )
{
    return element.children('a');
};




/**
 * set the value of the element and dispatch a change event
 *
 * @param {HTMLInputElement|HTMLSelectElement} el The element to update
 * @param {string} value The new value of the element
 */
var changeElementValue = function(el, value = "") {
    var elementToChange = el;

    elementToChange.value = value;
  
    var event = new CustomEvent("change", {
        bubbles: true,
        cancelable: true,
        detail: { value },
    });

    elementToChange.dispatchEvent(event);
};




/**
 * Create a dynamic click event
 *
 * @param {HTMLInputElement|HTMLSelectElement} el The element to update
 * @param {string} value The new value of the element
 */
function documentOnClick(needle, callback)
{
    document.body.addEventListener('click', function(e)
    {
        var element = e.target;
        var hasAttr = false;

        while( element && element.nodeType === 1 && !hasAttr )
        {
            if( element.hasAttribute(needle) || element.classList.contains(needle) )
            {
                hasAttr = true;
                break;
            }

            element = element.parentNode;
        }

        if( hasAttr ) callback(e, element, needle, element.getAttribute(needle));
    });
}
var tabDisabled = false;

$(function()
{
    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Adjust fixed elements when a modal appears
    ////////////////////////////////////////////////////////////////////////////////////////////////
    var stickyElements = $('.sticky, .sticky-wrap, .notification-bar');
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $('.modal').each(function()
    {
        var $modal = $(this);
        var $modal_header = $('.modal-header', $modal);
        var $modal_dialog = $('.modal-dialog', $modal);

        $modal_header.children().first().attr('tabindex', -1);

        $modal.on({
            'show.bs.modal' : function (e)
            {
                stickyElements.css('padding-right', getScrollbarWidth()+'px');
    
                $modal_dialog.attr('aria-modal', true);
            },
            'shown.bs.modal' : function (e)
            {
                var target = $modal_header.length > 0 ? $modal_header.children().first() : $('.modal-dialog', $modal);
    
                trapFocus($modal, target);
    
                setTimeout(function()
                {
                    tabDisabled = false;
                }, 10);
            },
            'hide.bs.modal' : function (e)
            {
                forgetFocus();
            },
            'hidden.bs.modal' : function (e)
            {
                if( !document.body.classList.contains('modal-open') )
                {
                    stickyElements.css('padding-right', '');
                }
    
                $modal_dialog.attr('aria-modal', false);
            }
        })

        $modal.appendTo( document.body );
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Temporarily disable tabbing while modal is opening
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $('[data-toggle="modal"]').on({
        'click' : function (e)
        {
            $(this).blur();

            tabDisabled = true;
            
            rememberFocus( this );
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////


    ////////////////////////////////////////////////////////////////////////////////////////////////
    // Listen for keydown events to disable tabbing
    ////////////////////////////////////////////////////////////////////////////////////////////////
    $(document).on('keydown', function (e)
    {
        if (tabDisabled && e.key === 'Tab')
        {
            e.preventDefault();
            return false;
        }
    });
    ////////////////////////////////////////////////////////////////////////////////////////////////

});
var planDataResult;
var costEstLocLabel = getI18nValue('costEstLocLabel', "Location:");
var costEstOffcLabel = getI18nValue('costEstOffcLabel', "Office:");
var costEstSelPartLabel = getI18nValue('costEstSelPartLabel', "Participates in:");
var costEstSelInNetLabel = getI18nValue('costEstSelInNetLabel', "In-Network");
var costEstSelOutNetLabel = getI18nValue('costEstSelOutNetLabel', "Out-of-Network");
var costEstInNetMobLabel = getI18nValue('costEstInNetMobLabel', "In-Network:");
var costEstOutNetMobLabel = getI18nValue('costEstOutNetMobLabel', "Out-of-Network:");
var costEstSelTotLabel = getI18nValue('costEstSelTotLabel', "Total");
var costEstViewMore = getI18nValue('costEstViewMore', "View More");
var costEstViewLess = getI18nValue('costEstViewLess', "View Less");
var costEstYourResponsibilityLabel = getI18nValue('costEstYourResponsibilityLabel', "Your Responsibility");
var costEstDeductibleAppliedLabel = getI18nValue('costEstDeductibleAppliedLabel', "Deductible Applied");
var costEstMaximumRemainingLabel = getI18nValue('costEstMaximumRemainingLabel', "Maximum Remaining");
var costEstDisclaimerHeader = getI18nValue('costEstDisclaimerHeader', "NOT A GUARANTEE OF BENEFIT");
var costEstPhaseIIIPlan = false;
var selectedDentistCEIII = false;

var stateListJsonPath = "";
/* Keep a record of where the Cost Estimator is called from, so that we can set the tab focus back to the 
   right place if the dialog is cancelled before going to the new results page
*/
var costEstimatorTriggeredFrom = "";
var costEstimatorSubmitBtn = null;
$(document).ready(function () {

    if ($("#stateListPath").length > 0 && $("#stateListPath").val().length > 0) {
        stateListJsonPath = $("#stateListPath").val();
    }

    doSetParamsForTreatmentDropdown();
    loadPublicCE();
    loadTreatments();

    $(window).resize(function () {
        if ($(window).width() > 767) {
            $(".ce-compared-table-body").show();
        }
    });
    
    $(document).on('click', '.ce-results-viewmore', function (e) {
        e.preventDefault();
        var viewMore = $(this);
        var viewMoreTable = viewMore.closest('.ce-compared-table');
        viewMoreTable.find('.ce-compared-table-body').toggle('1000', function () {
            viewMoreTable.toggleClass('ce-compared-expandinfo');
            viewMore.html() == 'View Less' ? viewMore.html(costEstViewMore) : viewMore.html(costEstViewLess);
            viewMore.html() == 'View Less' ? viewMore.attr('title', costEstViewMore) : viewMore.attr('title', costEstViewLess);
        });
    });
    
    $('.costestimator-section').each(function () {
        const wrap = $(this);
        $('.glyphicon-remove', wrap).on('click', function () {
            let input = $(this).closest('div').find('input');
            input.val('');
            input.blur();
        });
    
        $("[id$='ceSubmitBtn']", wrap).on('click', function () {
            handleCESubmit(wrap);
        });
    
        $('input[id$="ceZipCode"]', wrap).on("change", function (event) {
            var addressEntered = event.target.value;
            if ($('[id$="ceZipCodeGroup"]', wrap).hasClass("errorLabel") && textNotEmpty(addressEntered)) {
              $('[id$="ceZipCodeGroup"]', wrap).removeClass("errorLabel");
            }
            return;
        });
    
        $('[id$="treatmentCategory"]', wrap).on("change", function (event) {
            var planNetwork = event.target.value;
            if (
                $('[id$="treatmentCategoryGroup"]', wrap).hasClass("errorLabel") && planNetwork) {
                $('[id$="treatmentCategoryGroup"]', wrap).removeClass("errorLabel");
                $('input[id$="treatmentCategory"]').attr(
                    "aria-describedby",
                    $('input[id$="treatmentCategory"]')
                      .attr("aria-describedby")
                      .split(" ")[0]
                );
            }
            return;
        });
    
        $('[id$="treatmentCategorySpecs"]', wrap).on("change", function (event) {
            var planNetwork = event.target.value;
            if ($('[id$="treatmentSpecsGroup"]', wrap).hasClass("errorLabel") && planNetwork) {
                $('[id$="treatmentSpecsGroup"]', wrap).removeClass("errorLabel");
                $('input[id$="treatmentCategorySpecs"]').attr(
                    "aria-describedby",
                    $('input[id$="treatmentCategorySpecs"]')
                      .attr("aria-describedby")
                      .split(" ")[0]
                );
            }
            return;
        });
    });
});

function doSetParamsForTreatmentDropdown() {
    // Set parameters for treatment dropdown list
    var treatmentListParams = $.extend({}, ajaxParams_default);
    treatmentListParams.url = $('.treatment-list').attr('data-url') ? $('.treatment-list').attr('data-url') : '/';
    treatmentListParams.successCallbackFunction = renderSelectDropdown;
    treatmentListParams.errorCallBackFunction = () => {
        ajaxResponse = '';
    };
    treatmentListParams.className = 'treatment-list';
    ajaxCall(treatmentListParams);
}

function loadPublicCE() {
    if (!localStorage || (localStorage && typeof localStorage != "object")) {
        return;
    }
    
    var publicValues = "";
    var privateValues = "";

    publicValues = localStorage.getItem("cePublicReq");
    privateValues = JSON.parse(localStorage.getItem("cePrivateResponse"));

    if (privateValues) {
        if ($("#ceComparedResultsList").html()) {
            loadCePublicSearchResults(privateValues);
        }
        return;
    }
    
    if (publicValues && publicValues.length > 0 && publicValues.indexOf('##') != -1) {
        if (!$("#ceComparedPublicResultsList").html()) {
            return;
        }
        
        var queryString = '';
        publicValues = publicValues.split('##');

        if (publicValues[0].length > 0 && publicValues[0] != 'empty') {
            queryString = "treatment=" + publicValues[0];
            $('.get-cetreatment-category').html(publicValues[0]);
        }

        if (publicValues[1].length > 0 && publicValues[1] != 'empty') {
            queryString = queryString + "&zipCode=" + publicValues[1];
            $('.get-cezipcode').html(publicValues[1]);
        }

        if (publicValues[2].length > 0 && publicValues[2] != 'empty') {
            queryString = queryString + "&dentistLastName=" + publicValues[2];
        }

        if ((publicValues[3]) && (publicValues[3] != 'empty')) {
            var ceType = "public";
            if (publicValues[3] == 'private') {
                ceType = "private";
            }

            queryString = queryString + `&ceType=${ceType}`;
        }

        var publicAjaxParams = $.extend({}, ajaxParams_default);
        publicAjaxParams['url'] = "/conf/ddpa/paths/publicEstimateRest.json?" + queryString;
        publicAjaxParams['successCallbackFunction'] = loadCePublicSearchResults;
        ajaxCall(publicAjaxParams);
        return;
    }
}

function getPlanDataJsonResult(data) {
    planDataResult = data;

    for (var i = 0; i < data.stateDetails.length; i++) {
        if (data.stateDetails[i].stateAbbreviation === memberCompanyState) {
            costEstPhaseIIIPlan = data.stateDetails[i].useCostEstPhaseIII;
            if (costEstPhaseIIIPlan === "true") {
                selectedDentistCEIII = true;
            }
        }
    }
}

function loadCePublicSearchResults(data) {
    $('.ce-compared-results-list').empty();

    if (data.estimates) {
        if (Array.isArray(data.estimates)) {
            data.estimates = data.estimates[0];
        }
        if (data.estimates.Errors.Error.ErrorCode != "00") {
            $('.ce-compared-results-list').html('<span class="form-error-msg">' + data.estimates.Errors.Error.ErrorMessage + '</span>');

        } else {
            $('.get-cetreatment-category').html(localStorage.getItem('ceTreatmentCategory'));
            $('.get-cezipcode').html(localStorage.getItem('ceLocation'));
            renderCESearchResults(data);
        }
    } else if (data.length) {
        $('h2.ce-compared-head').html($('h2.ce-compared-head').data('compared-title'));
        $('.get-cetreatment-category').html(data[0].categoriesList.category.categoryCode);
        $('.get-cezipcode').html(localStorage.getItem('ceLocation'));
        $.each(data, function (i, key) {
            renderCESearchResults(key);
        });
    } else {
        if (data.error) {
            $('.ce-compared-results-list').html('<span class="form-error-msg">' + data.error + '</span>');
        } else {
            $('h2.ce-compared-head').html($('h2.ce-compared-head').data('estimated-title'));

            if ($('.get-cetreatment-category').is(':empty')) {
                $('.get-cetreatment-category').html(data.categoriesList.category.categoryCode);
            }

            $('.get-cezipcode').html(localStorage.getItem('ceLocation'));

            renderCESearchResults(data);
        }
    }
};

function renderCESearchResults(data) {
    dentistProdCode = localStorage.getItem("dentistProdCode");
    var selectedDentist = data.selectedDentist ? data.selectedDentist : '';

    if (data.estimates) {
        var phaseIIIEstimates = data.estimates;
        var descHead = localStorage.getItem('ceTreatmentCategoryDescription');

        $('.ce-compared-head-desc').html(descHead && descHead !== 'undefined' ? descHead : '');

    } else {
        var treatmentProduct = data.categoriesList ? data.categoriesList.category.products.product : data.category.products.product;

        var ceComparedHeadDesc = data.categoriesList ? data.categoriesList.category.categoryDescription : data.category.categoryDescription;

        $('.ce-compared-head-desc').html(ceComparedHeadDesc && ceComparedHeadDesc !== 'undefined' ? ceComparedHeadDesc : '');
    }
    var ceComparedResultsListTemplate;

    if (phaseIIIEstimates) {
        //CE PHASE III
        if (!$("#ceComparedResultsList").html()) {
            return;
        }
        
        ceComparedResultsListSource = $("#ceComparedResultsList").html();
        var ceComparedResultsListTemplate = Handlebars.compile(ceComparedResultsListSource);
        selectedDentistCEIII = {
            selectedDentistName: selectedDentist.dentistName,
            selectedDentistDesignation: selectedDentist.dentistDesig,
            selectedDentistAddress: selectedDentist.dentistAddress,
            selectedDentistState: selectedDentist.dentistState,
            selectedDentistOfficeName: selectedDentist.officeName,
            selectedDentistParticipates: selectedDentist.dentistParticipates,
            ceOOPCost: parseFloat(phaseIIIEstimates.OOPCost).toFixed(2),
            ceOOPMessage: phaseIIIEstimates.OOPMessage,
            ceDeductibleApplied: parseFloat(phaseIIIEstimates.Deductible).toFixed(2),
            ceMaximumRemaining: parseFloat(phaseIIIEstimates.RemainingMaximum).toFixed(2),
            ceSelectedLocationLabel: costEstLocLabel,
            ceSelectedOfficeLabel: costEstOffcLabel,
            ceSelectedParticipatesLabel: costEstSelPartLabel,
            ceYourResponsibilityLabel: costEstYourResponsibilityLabel,
            ceDeductibleAppliedLabel: costEstDeductibleAppliedLabel,
            ceMaximumRemainingLabel: costEstMaximumRemainingLabel,
            ceDisclaimerHeader: costEstDisclaimerHeader,
            ceDisclaimer: phaseIIIEstimates.Disclaimer
        }
        var ceComparedResultsListRowHtml = ceComparedResultsListTemplate(selectedDentistCEIII);
        $(".ce-compared-results-list").append(ceComparedResultsListRowHtml);
        return;
    }
    
    if (treatmentProduct.length) {
        if (!$("#ceComparedResultsList").html()) {
            return;
        }
        
        //CE PHASE II
        ceComparedResultsListSource = $("#ceComparedResultsList").html();
        var ceComparedResultsListTemplate = Handlebars.compile(ceComparedResultsListSource);
        var ceComparedDentistProcedureInfo = [];

        var inNetworkIndex = 0, outNetworkIndex = 1;
        if (treatmentProduct[0].productCode === "00") {
            inNetworkIndex = 1;
            outNetworkIndex = 0;
        }
        var procedureComparisonBaseObject = {
            inNetworkTotalLowcost: getProductTotalLowCost(treatmentProduct[inNetworkIndex]),
            inNetworkTotalHighcost: getProductTotalHighCost(treatmentProduct[inNetworkIndex]),
            outNetworkTotalLowcost: getProductTotalLowCost(treatmentProduct[outNetworkIndex]),
            outNetworkTotalHighcost: getProductTotalHighCost(treatmentProduct[outNetworkIndex]),
            ceSelectedInNetworkMobileLabel: costEstInNetMobLabel,
            ceSelectedOutNetworkMobileLabel: costEstOutNetMobLabel
        }
        
        if (treatmentProduct[0].procedures.procedure.length) {
            $.each(treatmentProduct[0].procedures.procedure, function (i, key) {
                ceComparedDentistProcedureInfoItem = {
                    procedureDescription: key.procedureDescription,
                    inNetworkProcedureLowcost: getProcedureLowCost(treatmentProduct[inNetworkIndex].procedures.procedure[i]),
                    inNetworkProcedureHighcost: getProcedureHighCost(treatmentProduct[inNetworkIndex].procedures.procedure[i]),
                    outNetworkProcedureLowcost: getProcedureLowCost(treatmentProduct[outNetworkIndex].procedures.procedure[i]),
                    outNetworkProcedureHighcost: getProcedureHighCost(treatmentProduct[outNetworkIndex].procedures.procedure[i]),
                    ...procedureComparisonBaseObject
                }
                ceComparedDentistProcedureInfo.push(ceComparedDentistProcedureInfoItem);
            });
        } else {
            ceComparedDentistProcedureInfo = [
                {
                    procedureDescription: treatmentProduct[0].procedures.procedure.procedureDescription,
                    inNetworkProcedureLowcost: getProcedureLowCost(treatmentProduct[inNetworkIndex].procedures.procedure),
                    inNetworkProcedureHighcost: getProcedureHighCost(treatmentProduct[inNetworkIndex].procedures.procedure),
                    outNetworkProcedureLowcost: getProcedureLowCost(treatmentProduct[outNetworkIndex].procedures.procedure),
                    outNetworkProcedureHighcost: getProcedureHighCost(treatmentProduct[outNetworkIndex].procedures.procedure),
                    ...procedureComparisonBaseObject
                }
            ];
        }
        var ceSelectedDentistInfo = {
            selectedDentistName: selectedDentist.dentistName,
            selectedDentistDesignation: selectedDentist.dentistDesig,
            selectedDentistAddress: selectedDentist.dentistAddress,
            selectedDentistState: selectedDentist.dentistState,
            selectedDentistOfficeName: selectedDentist.officeName,
            selectedDentistParticipates: selectedDentist.dentistParticipates,
            selectedDentistProcedureLength: treatmentProduct[0].procedures.procedure.length,
            ceComparedDentistProcedureInfo: ceComparedDentistProcedureInfo,
            inNetworkTotalLowcost: ceComparedDentistProcedureInfo[0].inNetworkTotalLowcost,
            inNetworkTotalHighcost: ceComparedDentistProcedureInfo[0].inNetworkTotalHighcost,
            outNetworkTotalLowcost: ceComparedDentistProcedureInfo[0].outNetworkTotalLowcost,
            outNetworkTotalHighcost: ceComparedDentistProcedureInfo[0].outNetworkTotalHighcost,
            ceSelectedLocationLabel: costEstLocLabel,
            ceSelectedOfficeLabel: costEstOffcLabel,
            ceSelectedParticipatesLabel: costEstSelPartLabel,
            ceSelectedInNetworkLabel: costEstSelInNetLabel,
            ceSelectedOutNetworkLabel: costEstSelOutNetLabel,
            ceSelectedInNetworkMobileLabel: costEstInNetMobLabel,
            ceSelectedOutNetworkMobileLabel: costEstOutNetMobLabel,
            ceSelectedTotalLabel: costEstSelTotLabel,
            ceSelectedViewMoreLabel: costEstViewMore
        };
        var ceComparedResultsListRowHtml = ceComparedResultsListTemplate(ceSelectedDentistInfo);
        $(".ce-compared-results-list").append(ceComparedResultsListRowHtml);
    } else {
        if (!$("#ceComparedPublicResultsList").html()) {
            return;
        }
        //CE PHASE I
        ceComparedResultsListSource = $("#ceComparedPublicResultsList").html();
        var ceComparedResultsListTemplate = Handlebars.compile(ceComparedResultsListSource);
        var cePublicResultsData, cePublicResultsDetailData = [];
        const detailDataBaseObject = {
            ceSelectedInNetworkMobileLabel: costEstInNetMobLabel,
            ceSelectedOutNetworkMobileLabel: costEstOutNetMobLabel
        }
        
        if (treatmentProduct.procedures.procedure.length) {
            $.each(treatmentProduct.procedures.procedure, function (i, key) {
                var cePublicResultsItem = {
                    cePublicProdDescription: key.procedureDescription,
                    cePublicProdLowCost: getProcedureLowCost(key),
                    cePublicProdHighCost: getProcedureHighCost(key),
                    ...detailDataBaseObject
                };
                cePublicResultsDetailData.push(cePublicResultsItem);
            });
        } else {
            cePublicResultsDetailData = [
                {
                    cePublicProdDescription: treatmentProduct.procedures.procedure.procedureDescription,
                    cePublicProdLowCost: getProcedureLowCost(treatmentProduct.procedures.procedure),
                    cePublicProdHighCost: getProcedureHighCost(treatmentProduct.procedures.procedure),
                    ...detailDataBaseObject
                }
            ];
        }


        cePublicResultsData = {
            cePublicResultsDetailData: cePublicResultsDetailData,
            cePublicResultTotalLowCost: getProductTotalLowCost(treatmentProduct),
            cePublicResultTotalHighCost: getProductTotalHighCost(treatmentProduct),
            ceSelectedInNetworkLabel: costEstSelInNetLabel,
            ceSelectedOutNetworkLabel: costEstSelOutNetLabel,
            ceSelectedTotalLabel: costEstSelTotLabel,
            ceSelectedViewMoreLabel: costEstViewMore,
            ...detailDataBaseObject
        };
        var ceComparedResultsListRowHtml = ceComparedResultsListTemplate(cePublicResultsData);
        $(".ce-compared-results-list").append(ceComparedResultsListRowHtml);
    }
};

function renderSelectDropdown(data) {
    ajaxResponse = data ? data : '';
}

function loadTreatments() {
    var treatementListParams = $.extend({}, ajaxParams_default);
    treatementListParams.url = '/conf/ddpa/paths/getTreatmentsInSetRest.json';
    treatementListParams.successCallbackFunction = setTreatmentsDropdown;
    treatementListParams.errorCallBackFunction = null;
    treatementListParams.className = 'treatment-list';
    ajaxCall(treatementListParams);
}

function waitForCEDropdownsAndSet(data, attempt, maxAttempts) {
    let dropdowns = $(".usa-select.treatment-list.form-control:not(.specs-level)");
    if (dropdowns.length > 0 || attempt >= maxAttempts) {
        [].forEach.call((dropdowns.length ? dropdowns : []), (dropdown) => doSetTreatmentsDropdown(data, dropdown));
        return;
    }
    setTimeout(() => {
        waitForCEDropdownsAndSet(data, attempt++, maxAttempts)
    }, 500);
}

function setTreatmentsDropdown(data) {
    let jsonData = JSON.stringify(data.entries);
    localStorage.setItem(TREATMENTS_LIST_STORAGE_KEY, jsonData);
    waitForCEDropdownsAndSet(data, 0, 6);
}

function doSetTreatmentsDropdown(data, dropdownObj) {
    const dropdown = $(dropdownObj);
    dropdown.empty();

    let options = "<option value=''>Select treatment type</option>";
    data.entries.forEach((item) => {
        options += `<option value="${item.label}">${item.label}</option>`
    });
    dropdown.append(options);
}

function handleTreatmentCategoryChange(selectObject) {
    let selectedValue = selectObject.value;
    if (!selectedValue) {
        hideSpecsDropdown($(selectObject));
    }

    let selectedTreatment =
        JSON.parse(
            localStorage.getItem(TREATMENTS_LIST_STORAGE_KEY)
        ).find((item) => item.label === selectedValue);

    if (selectedTreatment) {
        if (selectedTreatment.children.length > 0) {
            showSpecsDropdown($(selectObject), selectedTreatment.children);
        } else {
            hideSpecsDropdown($(selectObject));
        }
    }
}

function getCurrentTreatmentSpecsFormGroup(mainDropdown) {
    return $(mainDropdown).parent().parent().parent().children("[id$='treatmentSpecsGroup']");
}

function getCurrentDropdownFromFormGroup(formGroup) {
    return formGroup.find('.usa-select');
}

function showSpecsDropdown(mainDropdown, specsData) {
    let formGroup = getCurrentTreatmentSpecsFormGroup(mainDropdown);
    let specsDropdown = getCurrentDropdownFromFormGroup(formGroup);

    let options = "<option value=''>Select treatment specification</option>";
    specsData.forEach((item) => {
        options += `<option value="${item.treatmentCode}">${item.label}</option>`;
    });

    specsDropdown.empty();
    specsDropdown.val('');
    specsDropdown.siblings('input[id$="treatmentCategorySpecs"]').first().val('');
    specsDropdown.append(options);
    formGroup.find('input[id$="treatmentCategorySpecs"]').attr('required', true);
    formGroup.show();
}

function hideSpecsDropdown(mainDropdown) {
    let formGroup = getCurrentTreatmentSpecsFormGroup(mainDropdown);
    let specsDropdown = getCurrentDropdownFromFormGroup(formGroup);
    specsDropdown.empty();
    specsDropdown.val('');
    specsDropdown.siblings('input[id$="treatmentCategorySpecs"]').first().val('');
    formGroup.find('input[id$="treatmentCategorySpecs"]').removeAttr('required');
    formGroup.hide();
}

function validateCEForm(wrap) {
    $('[id$="ceZipCodeGroup"]', wrap).removeClass('errorLabel');
    $('[id$="treatmentCategoryGroup"]', wrap).removeClass('errorLabel');
    $('[id$="treatmentSpecsGroup"]', wrap).removeClass('errorLabel');
    $('input[id$="treatmentCategory"]').attr('aria-describedby', $('input[id$="treatmentCategory"]').attr('aria-describedby').split(' ')[0]);
    $('input[id$="treatmentCategorySpecs"]').attr('aria-describedby', $('input[id$="treatmentCategorySpecs"]').attr('aria-describedby').split(' ')[0]);

    let treatmentError = $('[id$="treatmentCategory-error"]', wrap);
    let treatmentSpecError = $('[id$="treatmentSpecCategory-error"]', wrap);
    let zipcodeError = $('[id$="ceZipCode-error"]', wrap);
    let ceZipVal = wrap.find("[id$='ceZipCode']").val();
    let treatVal = wrap.find("[id$='treatmentCategory']").siblings('select').val();
    let treatSpec = wrap.find("[id$='treatmentCategorySpecs']").siblings('select').val();

    if (!treatVal || !ceZipVal || (ceZipVal && ceZipVal.length !== 5) || treatSpec === "") {
        if (!treatVal) {
            if (treatmentError.html().trim() === "") {
                treatmentError.html("Please select a treatment type.");
            }

            $('[id$="treatmentCategoryGroup"]', wrap).addClass('errorLabel');
            $('input[id$="treatmentCategory"]').attr('aria-describedby', `${$('input[id$="treatmentCategory"]').attr('aria-describedby').split(' ')[0]} ${treatmentError.attr('id')}`);
        }

        if (treatSpec === "") {
            treatmentSpecError.html("Please select a treatment specification.")
            $('[id$="treatmentSpecsGroup"]', wrap).addClass('errorLabel');
            $('input[id$="treatmentCategorySpecs"]').attr('aria-describedby', `${$('input[id$="treatmentCategorySpecs"]').attr('aria-describedby').split(' ')[0]} ${treatmentSpecError.attr('id')}`);
        }

        if (!ceZipVal) {
            zipcodeError.html("Zip code is required.");
            if (!$('[id$="ceZipCodeGroup"]', wrap).hasClass("errorLabel")) {
                $('[id$="ceZipCodeGroup"]', wrap).addClass('errorLabel');
            }
        }

        if (ceZipVal && ceZipVal.length !== 5) {
            zipcodeError.html("Invalid zip code.");
            if (!$('[id$="ceZipCodeGroup"]', wrap).hasClass("errorLabel")) {
                $('[id$="ceZipCodeGroup"]', wrap).addClass('errorLabel');
            }
        }

        return false;
    }
    return true;
}

function handleCESubmit(wrap) {
    var id = $("[id$='ceSubmitBtn']", wrap).attr('id');
    if (id === 'ceSubmitBtn') {
        costEstimatorTriggeredFrom = "standalone";
        costEstimatorSubmitBtn = $("[id$='ceSubmitBtn']", wrap);
    } else {
        costEstimatorTriggeredFrom = "topnav";
    }

    if (!validateCEForm(wrap)) {
        return;
    };
    
    let ceZipVal = wrap.find("[id$='ceZipCode']").val();
    let treatVal = wrap.find("[id$='treatmentCategory']").siblings('select').val();
    let treatSpec = wrap.find("[id$='treatmentCategorySpecs']").siblings('select').val();
    let lastNVal = wrap.find("[id$='dentistLastName']").val();

    var ceDentistLastName = lastNVal ? lastNVal : '';
    var categorySplit = treatVal.length > 0 ? treatVal.split("|") : 'empty';
    var treatmentCategory = treatSpec ? treatSpec : categorySplit[0];
    var treatmentCategoryDescription = treatSpec ? treatSpec : categorySplit[1];
    var cezipcode = ceZipVal.length > 0 ? ceZipVal : 'empty';
    var dentistlastname = ceDentistLastName.length > 0 ? ceDentistLastName : 'empty';
    var cetype = $("[id$='ceType']", wrap).val() ? $("[id$='ceType']", wrap).val() : 'empty';
    var cePublicStorageValue = treatmentCategory + "##" + cezipcode + "##" + dentistlastname + "##" + cetype;

    localStorage.setItem("ceLocation", ceZipVal);
    localStorage.setItem("ceTreatmentCategory", treatmentCategory);
    localStorage.setItem("ceTreatmentCategoryDescription", treatmentCategoryDescription);

    if (localStorage && typeof localStorage == "object") {
        localStorage.setItem("cePublicReq", cePublicStorageValue);
    }
    
    if (ceDentistLastName.trim().length > 0) {
        //CE phase II or III request
        var memberLocatorParams = $.extend({}, ajaxParams_default);
        memberLocatorParams.url = textNotEmpty(stateListJsonPath) ? stateListJsonPath : '/content/ddpa/us/en/data/plandata/_jcr_content.plans.json';
        memberLocatorParams.successCallbackFunction = getPlanDataJsonResult;
        ajaxCall(memberLocatorParams);

        var dentistPrivateCEParams = $.extend({}, ajaxParams_default);
        dentistPrivateCEParams.url = '/conf/ddpa/paths/secure/retrieveCostEstimatorProvidersRest.json?zipCode=' + ceZipVal + '&lastName=' + ceDentistLastName;
        dentistPrivateCEParams.successCallbackFunction = privateCESuccessCallback;
        dentistPrivateCEParams.errorCallBackFunction = privateCEErrorCallback;

        ajaxCall(dentistPrivateCEParams);
        limitAddDentistCompare(3);
        ceDentistCompareBtn();
        termsHandler();
    } else {
        if (docCookies.getItem('acceptTermsnCond') !== 'Agree') {
            if (costEstimatorTriggeredFrom === 'standalone') {
                $("[id='ce-terms-modal']").modal('show');
            } else {
                $("[id='topnav-ce-terms-modal']").modal('show');
            }
            ceRedirectToResults($('.agree-terms').data('cepublicurl'));
        } else {
            location.href = $('.agree-terms').data('cepublicurl');
        }
    }

    $('.close, .disagree-btn').on('click', function () {
        $(".termsncond-container").animate({scrollTop: $(".termsncond-container .modal-content").offset().top});
        // if the user rejects the Terms and Conditions for the Cost Estimator, just hide all modals
        // and refocus on the last location before the CE dialog was triggered.
        if (costEstimatorTriggeredFrom === 'standalone') {
            $("[id='ce-terms-modal']").modal('hide');
            $("[id='ce-dentist-compare-modal']").modal('hide');
            $(costEstimatorSubmitBtn).focus();
        } else {
            $("[id='topnav-ce-terms-modal']").modal('hide');
            $("[id='topnav-ce-dentist-compare-modal']").modal('hide');
            $("[data-cy='costestimator']").focus();
        }
    });
    
    function privateCESuccessCallback(data) {
        $('.ce-dentist-compare-list').empty();
        if (costEstimatorTriggeredFrom === 'standalone') {
            $("[id='ce-dentist-compare-modal']").modal('show');
        } else {
            $("[id='topnav-ce-dentist-compare-modal']").modal('show');
        }
        $('.ce-popup-lname-input').html("'" + lastNVal + "'");
        var ceDentistCompareListSource = $("#ceDentistCompareList").html();
        var ceDentistCompareListTemplate = Handlebars.compile(ceDentistCompareListSource);
        if (!($.isEmptyObject(data)) && data.providers) {
            if (data.providers.provider.length) {
                $('.ce-total-dentistresults').html(data.providers.provider.length);
                $.each(data.providers.provider, function (ditem, dkey) {
                    var dentistCEPrivateRow = renderDentistCompareList(ditem, dkey);
                    var dentistCEPrivateRowHtml = ceDentistCompareListTemplate(dentistCEPrivateRow);
                    $('.ce-dentist-compare-list').append(dentistCEPrivateRowHtml);
    
                });
            } else {
                $('.ce-total-dentistresults').html('1');
                var dentistCEPrivateRow = renderDentistCompareList(0, data.providers.provider);
                var dentistCEPrivateRowHtml = ceDentistCompareListTemplate(dentistCEPrivateRow);
                $('.ce-dentist-compare-list').append(dentistCEPrivateRowHtml);
            }
            $('.ce-dentist-compare-container .ce-dentist-compare-btn').show();
            $('.ce-dentist-compare-container .ce-results-error').hide();
            estimatePrivateDentistResults(treatmentCategory);
        } else {
            $('.ce-total-dentistresults').html('0');
            $('.ce-dentist-compare-container .ce-dentist-compare-btn').hide();
            $('.ce-dentist-compare-container .ce-results-error').show();
        }
    }

    function privateCEErrorCallback() {
        $('.ce-dentist-compare-list').empty();
            if (costEstimatorTriggeredFrom === 'standalone') {
                $("[id='ce-dentist-compare-modal']").modal('show');
            } else {
                $("[id='topnav-ce-dentist-compare-modal']").modal('show');
            }
            $('.ce-popup-lname-input').html("'" + lastNVal + "'");
            $('.ce-total-dentistresults').html('0');
            $('.ce-dentist-compare-container .ce-dentist-compare-btn').hide();
            $('.ce-dentist-compare-container .ce-results-error').show();
    }
}

function renderDentistCompareList (ditem, dkey) {
    var prodDescription = '';
    var prodCode = '';
    if (dkey.products.product.length) {
        prodDescription = dkey.products.product.map((p) => p.productDescription).join(', ');
        prodCode = dkey.products.product.map((p) => p.productCode).join(',');
    } else {
        prodDescription = dkey.products.product.productDescription;
        prodCode = dkey.products.product.productCode;
    }

    var dentistCEPrivateRow = {
        providerLicense: dkey.prvdrLicense,
        providerType: dkey.prvdrType,
        providerBusId: dkey.prvdrBusId,
        providerCity: dkey.prvdrCity,
        providerZipCode: dkey.prvdrZip,
        providerState: dkey.prvdrState,
        providerSrvcOffTableId: dkey.prvdrSrvcOffTableId,
        providerAddress: dkey.prvdrAddress1,
        providerOfficeName: dkey.prvdrOfficeName,
        providerOffNum: dkey.prvdrSrvcOffNumber,
        listNum: ditem + 1,
        dentistFirstName: dkey.prvdrFirstName,
        dentistLastName: dkey.prvdrLastName,
        specialityCode: dkey.specialties.specialty.specialtyCode,
        specialityDescription: dkey.specialties.specialty.specialtyDescription,
        productDescription: prodDescription,
        providerProdCode: prodCode,
    };

    //CE Phase II or Phase III
    if (costEstPhaseIIIPlan === "true") {
        dentistCEPrivateRow = {
            ...dentistCEPrivateRow,
            providerSrvcOffId: dkey.prvdrSrvcOffNumber
        };
    }

    return dentistCEPrivateRow;
};

function estimatePrivateDentistResults(categoryCode) {
    $(document).on('click', '.ce-compare-dentistname', function (e) {
        var dentistEstInfoObj = {}, dentistNamePostData = [];
        var thisdentistrow = $(this).closest('.ce-dentist-compare-row');

        dentistEstInfoObj['license'] = thisdentistrow.find('.dentistlicense').val();
        dentistEstInfoObj['prvdrType'] = thisdentistrow.find('.dentisttype').val();
        dentistEstInfoObj['speciality'] = thisdentistrow.find('.ce-compare-dentist-desig').children('input').val();
        dentistEstInfoObj['officeName'] = thisdentistrow.find('.dentistofficename').text();
        dentistEstInfoObj['busId'] = thisdentistrow.find('.dentistbusid').val();
        dentistEstInfoObj['zipCode'] = thisdentistrow.find('.dentistzipcode').val();
        dentistEstInfoObj['prvdrState'] = thisdentistrow.find('.dentiststate').val();
        dentistEstInfoObj['prvdrSrvcOffTableId'] = thisdentistrow.find('.dentistsrvcofftableid').val();
        dentistEstInfoObj['prvdrAddress'] = thisdentistrow.find('.dentistaddress').val();
        dentistEstInfoObj['officeNumber'] = thisdentistrow.find('.dentistofficenumber').val();
        dentistEstInfoObj['categoryCode'] = categoryCode;
        dentistEstInfoObj['productCode'] = thisdentistrow.find('.dentistproductCode').val();
        
        //CE Phase II or Phase III
        if (costEstPhaseIIIPlan === "true") {
            dentistEstInfoObj['MemberCompanyID'] = memberCompanyState;
            dentistEstInfoObj['prvdrSrvcOffId'] = thisdentistrow.find('.dentistsrvoffid').val();
        }

        dentistNamePostData.push(dentistEstInfoObj);
        var dentistNamePostDataObj = {
            "costEst": dentistNamePostData
        };
        var dentistInfo = {
            selectedDentist: {
                dentistName: thisdentistrow.find('.ce-compare-dentistname').html(),
                zipCode: thisdentistrow.find('.dentistzipcode').val(),
                dentistDesig: thisdentistrow.find('.ce-compare-dentist-desig').text(),
                officeName: thisdentistrow.find('.dentistofficename').text(),
                dentistAddress: thisdentistrow.find('.ce-compare-dentiststreet').text(),
                dentistState: thisdentistrow.find('.ce-compare-dentiststate').text(),
                dentistParticipates: thisdentistrow.find('.ce-compare-participates').text()
            }
        };
        localStorage.setItem("cePrivateResponse", JSON.stringify(dentistInfo));
        localStorage.setItem("dentistProdCode", thisdentistrow.find('.dentistproductCode').val());
        var dentistPrivateCEParams = $.extend({}, ajaxParams_default);
        //CE Phase II or Phase III
        if (costEstPhaseIIIPlan === "true") {
            dentistPrivateCEParams['url'] = '/conf/ddpa/paths/secure/policyAdjustedEstimateRest.json';
        } else {
            dentistPrivateCEParams['url'] = '/conf/ddpa/paths/secure/providerEstimateRest.json';
        }
        dentistPrivateCEParams['requestType'] = 'POST';
        dentistPrivateCEParams['data'] = JSON.stringify(dentistNamePostDataObj);
        dentistPrivateCEParams['successCallbackFunction'] = dentistPrivateEstSuccess;
        ajaxCall(dentistPrivateCEParams);
    });
};

function dentistPrivateEstSuccess(data) {
    var cePrivateStorageValue = Array.isArray(data) ? data[0] : data;
    cePrivateStorageValue = $.extend(cePrivateStorageValue, JSON.parse(localStorage.getItem("cePrivateResponse")));
    cePrivateStorageValue = JSON.stringify(cePrivateStorageValue);
    if (localStorage && typeof localStorage == "object") {
        localStorage.removeItem("cePublicReq");
        localStorage.setItem("cePrivateResponse", cePrivateStorageValue);
        if (docCookies.getItem('acceptTermsnCond') !== 'Agree') {
            // If there isn't a cookie showing that the user agreed with the Terms and Conditions,
            // then, first hide the "list of dentists retrieved" modal, subsequently show the Terms and
            // Conditions modal. Create a slight delay between the closing of the dentist list modal and
            // the opening of the Terms and Conditions modal, otherwise bootstrap has trouble with the scroll bar
            // on the T&C modal.
            $("[id$='ce-dentist-compare-modal']").modal('hide');
            setTimeout(function () {
                if (costEstimatorTriggeredFrom === 'standalone') {
                    $("[id='ce-terms-modal']").modal('show');
                } else {
                    $("[id='topnav-ce-terms-modal']").modal('show');
                }
            }, 400);

            ceRedirectToResults($('.agree-terms').data('ceprivateurl'));
        } else {
            $("[id$='ce-terms-modal']").modal('hide');
            location.href = $('.agree-terms').data('ceprivateurl');
        }
    }
};

function ceRedirectToResults(dentistResultsUrl) {
    $('.agree-terms').on('click', function (e) {
        e.stopImmediatePropagation();
        e.preventDefault();
        docCookies.setItem('acceptTermsnCond', 'Agree');
        location.href = dentistResultsUrl;
    });
};

function ceDentistCompareBtn() {
    $('.ce-dentist-compare-btn .submit-btn').on('click', function (e) {
        e.stopImmediatePropagation();
        e.preventDefault();
        if ($('.ce-dentist-compare-list input[type="checkbox"]:checked').length === 0) {
            alert('Please select at least one dentist');
            return;
        }
        $("[id$='ce-dentist-compare-modal']").modal('hide');
        var dentistComparePostData = [], dentistInfoArr = [];
        $.each($('.ce-dentist-compare-list input[type="checkbox"]:checked'), function (i, key) {
            var dentistEstInfoObj = {};
            var thisdentistrow = $(this).closest('.ce-dentist-compare-row');
            var getCategoryCode = treatVal.length > 0 ? treatVal : '';
            if (costEstPhaseIIIPlan === "true") {
                dentistEstInfoObj['MemberCompanyID'] = memberCompanyState;
                dentistEstInfoObj['prvdrSrvcOffId'] = thisdentistrow.find('.dentistsrvcoffid').val();
            }
            dentistEstInfoObj['license'] = thisdentistrow.find('.dentistlicense').val();
            dentistEstInfoObj['prvdrType'] = thisdentistrow.find('.dentisttype').val();
            dentistEstInfoObj['speciality'] = thisdentistrow.find('.ce-compare-dentist-desig').children('input').val();
            dentistEstInfoObj['officeName'] = thisdentistrow.find('.dentistofficename').text();
            dentistEstInfoObj['busId'] = thisdentistrow.find('.dentistbusid').val();
            dentistEstInfoObj['zipCode'] = thisdentistrow.find('.dentistzipcode').val();
            dentistEstInfoObj['prvdrState'] = thisdentistrow.find('.dentiststate').val();
            dentistEstInfoObj['prvdrSrvcOffTableId'] = thisdentistrow.find('.dentistsrvcofftableid').val();
            dentistEstInfoObj['prvdrAddress'] = thisdentistrow.find('.dentistaddress').val();
            dentistEstInfoObj['officeNumber'] = thisdentistrow.find('.dentistofficenumber').val();
            dentistEstInfoObj['categoryCode'] = getCategoryCode;
            dentistComparePostData.push(dentistEstInfoObj);
            var dentistInfo = {
                selectedDentist: {
                    dentistName: thisdentistrow.find('.ce-compare-dentistname').html(),
                    zipCode: thisdentistrow.find('.dentistzipcode').val(),
                    dentistDesig: thisdentistrow.find('.ce-compare-dentist-desig').text(),
                    officeName: thisdentistrow.find('.dentistofficename').text(),
                    dentistAddress: thisdentistrow.find('.ce-compare-dentiststreet').text(),
                    dentistState: thisdentistrow.find('.ce-compare-dentiststate').text(),
                    dentistParticipates: thisdentistrow.find('.ce-compare-participates').text()
                }
            };
            dentistInfoArr.push(dentistInfo);

        });
        localStorage.setItem('cePrivateResponse', JSON.stringify(dentistInfoArr));
        var dentistComparePostDataObj = {
            "costEst": dentistComparePostData
        };

        var dentistPrivateCompareParams = $.extend({}, ajaxParams_default);
        //CE Phase II or Phase III
        if (costEstPhaseIIIPlan === "true") {
            dentistPrivateCompareParams['url'] = '/conf/ddpa/paths/secure/policyAdjustedEstimateRest.json';
        } else {
            dentistPrivateCompareParams['url'] = '/conf/ddpa/paths/secure/providerEstimateRest.json';
        }
        dentistPrivateCompareParams['requestType'] = 'POST';
        dentistPrivateCompareParams['data'] = JSON.stringify(dentistComparePostDataObj);
        dentistPrivateCompareParams['successCallbackFunction'] = dentistPrivateCompareSuccess;
        ajaxCall(dentistPrivateCompareParams);
    });
};

function termsHandler() {
    $('.termsncond-container .close, .disagree-btn').on('click', function () {
        $(".termsncond-container, .overlay-background").hide();
        $('html').removeClass('non-scrollable');
        $('.termsncond-container .modal-content').animate({scrollTop: 0}, 100);
    });
}

function dentistPrivateCompareSuccess(data) {
    localStorage.removeItem("cePublicReq");
    if (JSON.parse(localStorage.getItem("cePrivateResponse")).length) {
        var getSelectedDentistsList = JSON.parse(localStorage.getItem("cePrivateResponse"));
        var updatedDentistListObj = {}, updatedDentistListArr = [];
        $.each(getSelectedDentistsList, function (listi, listkey) {
            updatedDentistListObj = $.extend(listkey, data[listi]);
            updatedDentistListArr.push(updatedDentistListObj);
        });

        var cePrivateStorageValue = JSON.stringify(updatedDentistListArr);
        localStorage.setItem('cePrivateResponse', cePrivateStorageValue);
    } else {
        localStorage.setItem('cePrivateResponse', data);
    }

    if (docCookies.getItem('acceptTermsnCond') !== 'Agree') {
        $("[id$='ce-dentist-compare-modal']").modal('hide');
        setTimeout(function () {
            if (costEstimatorTriggeredFrom === 'standalone') {
                $("[id='ce-terms-modal']").modal('show');
            } else {
                $("[id='topnav-ce-terms-modal']").modal('show');
            }
        }, 400);

        ceRedirectToResults($('.agree-terms').data('ceprivatecompareurl'));
    } else {
        $("[id$='ce-terms-modal']").modal('hide');
        location.href = $('.agree-terms').data('ceprivatecompareurl');
    }
};

function limitAddDentistCompare(maxAddCount) {
    $(document).on('change', '.ce-dentist-compare-list input[type="checkbox"]', function () {
        if ($('.ce-dentist-compare-list input[type="checkbox"]:checked').length > maxAddCount) {
            $(this).prop('checked', '');
        }
    });
};

function getProcedureLowCost(procedure) {
    if (!procedure.procedureLowCost || (procedure.procedureLowCost == procedure.procedureHighCost)) {
        return '';
    }
    var procedureLowCost = procedure.procedureLowCost;
    if (procedureLowCost != "N\/A") {
        procedureLowCost = `<span>$</span>${Number(procedureLowCost).toLocaleString('en')}`;
    }
    return procedureLowCost + " - ";
}

function getProcedureHighCost(procedure) {
    var procedureHighCost = procedure.procedureHighCost;
    if (procedureHighCost != "N\/A") {
        procedureHighCost = `<span>$</span>${Number(procedureHighCost).toLocaleString('en')}`;
    }
    return procedureHighCost;
}


function getProductTotalLowCost(treatmentProduct) {
    if (!treatmentProduct.totalLowCost || (treatmentProduct.totalLowCost == treatmentProduct.totalHighCost)) {
        return '';
    }
    var totalLowCost = treatmentProduct.totalLowCost;
    if (totalLowCost != "N\/A") {
        totalLowCost = `<span>$</span>${Number(totalLowCost).toLocaleString('en')}`;
    }
    return totalLowCost + " - ";
}

function getProductTotalHighCost(treatmentProduct) {
    var totalHighCost = treatmentProduct.totalHighCost;
    if (totalHighCost != "N\/A") {
        totalHighCost = `<span>$</span>${Number(totalHighCost).toLocaleString('en')}`;
    }
    return totalHighCost;
}
$(document).ready(function () {

    if (getCookie('show_cookie_message') != 'yes') {
        $('#cookie_box').show();
    }

    $('.cookie_box_close').click(function () {
        $('#cookie_box').hide();
        setCookie('show_cookie_message', 'yes');
        return false;
    });
});

function setCookie(cookie_name, value) {
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + (365 * 25));
    document.cookie = cookie_name + "=" + escape(value) + "; expires=" + exdate.toUTCString() + "; path=/";
}

function getCookie(cookie_name) {
    if (document.cookie.length > 0) {
        cookie_start = document.cookie.indexOf(cookie_name + "=");
        if (cookie_start != -1) {
            cookie_start = cookie_start + cookie_name.length + 1;
            cookie_end = document.cookie.indexOf(";", cookie_start);
            if (cookie_end == -1) {
                cookie_end = document.cookie.length;
            }
            return unescape(document.cookie.substring(cookie_start, cookie_end));
        }
    }
    return "";
}
